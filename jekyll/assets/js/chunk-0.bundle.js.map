{"version":3,"sources":["webpack://pendora/./src/core/Publisher.js","webpack://pendora/./src/core/errors.js","webpack://pendora/./src/core/utility.js","webpack://pendora/./src/menu2/DropDown.js","webpack://pendora/./src/menu2/Menu.js","webpack://pendora/./src/menu2/MenuBar.js","webpack://pendora/./src/menu2/MenuItem.js","webpack://pendora/./src/menu2/MenuNode.js","webpack://pendora/./src/menu2/decorators.js"],"names":["Publisher","_topics","topic","callback","push","fn","on","off","args","apply","arguments","length","callbacks","i","cb","splice","slice","ExtendableError","message","name","constructor","Error","captureStackTrace","stack","IndexError","KeyError","ValueError","NotImplemented","ValidationError","node","children","AssertionError","REG_WHITESPACE","clamp","value","minValue","maxValue","Math","max","min","firstValue","item","undefined","all","iterable","any","proto","descriptor","placement","randomChoice","array","floor","random","arraysEqual","array1","array2","l","parseHTML","html","template","document","createElement","innerHTML","trim","content","fragment","createDocumentFragment","firstChild","appendChild","isEmptyObject","object","key","emptyElement","element","removeChild","addClasses","classes","split","classList","add","removeClasses","remove","assignAttributes","attributes","hasOwnProperty","setAttribute","setElementOffset","coords","nodeType","getElementOffset","Array","isArray","left","top","offset","getBoundingClientRect","style","getComputedStyle","parseInt","box","window","pageXOffset","pageYOffset","getScroll","isWindow","scrollLeft","scrollTop","variable","setInterval","setScroll","scroll","scrollTo","selectElement","selector","context","querySelector","jquery","assert","condition","parseBooleanOrInt","radix","defaultValue","TypeError","type","Number","isNaN","parseBooleanOrFloat","parseFloat","parseBoolean","parseIntValue","parseFloatValue","parseAny","parsers","parser","e","validateChoice","choices","indexOf","choice","findChild","child","filterChildren","r","getOwnProperty","obj","propName","getPropertyByPath","path","parts","part","DropDown","target","text","closeOnBlur","timeout","autoActivate","toggle","closeOnSelect","menuNodeType","render","init","button","isActive","clearTimer","parent","activate","setActiveItem","event","MenuNode","Menu","multiple","openOnHover","deactivateOnItemHover","delay","id","events","MenuItemClass","MenuItem","SubMenuClass","isVisible","activeItems","activeItem","deactivate","onClick","onMouseOver","onMouseOut","onSelect","createItems","arrow","body","className","_captureDocumentClick","onDocumentClick","contains","addEventListener","publish","dispatchEvent","CustomEvent","detail","bubbles","clearItems","removeEventListener","data","submenu","_submenu","attachSubMenu","append","action","index","_children","parentElement","getMenuBody","removeItem","appendTo","isMenuItem","_parent","querySelectorAll","originalEvent","relatedTarget","startTimer","toggleOff","toggleOn","MenuBar","SubMenu","href","nodeName","addClass","addAction","inherit","show","hide","dispatchTopic","location","hasEvent","detachSubMenu","hasSubMenu","isDisabled","getDisabled","preventDefault","isSubMenuVisible","select","MENU_MAP","WeakMap","_props","_timers","_element","_isActive","_isVisible","isController","boundEvents","handleEvent","getTargetNode","wrappedEvent","getEventDelegator","hasElement","o","call","getDescendants","grandchild","time","interval","clear","cancel","timer","status","clearInterval","setTimeout","clearTimeout","instance","get","isMenu","closest","getOffsetSibling","set","dataset","initializer","kind","configurable","enumerable","root","publishTargetEvent","bubble","desc","wrapper"],"mappings":"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","file":"chunk-0.bundle.js","sourcesContent":["\r\n\r\nexport default class Publisher {\r\n    constructor() {\r\n        this._topics = {};\r\n    }\r\n\r\n    on(topic, callback) {\r\n        if(!this._topics[topic]) this._topics[topic] = [];\r\n        this._topics[topic].push(callback);\r\n        return this;\r\n    }\r\n\r\n    once(topic, fn) {\r\n        let on = (...args) => {\r\n            this.off(topic, fn);\r\n            return fn.apply(this, args);\r\n        };\r\n\r\n        on.fn = fn;\r\n        this.on(topic, fn);\r\n        return this;\r\n    }\r\n\r\n    off(topic, callback) {\r\n        if(arguments.length === 0) {\r\n            // CLear all topics.\r\n            this._topics = {};\r\n            return this;\r\n        } else if(arguments.length === 1) {\r\n            // Clear single topic.\r\n            this._topics[topic] = [];\r\n            return this;\r\n        }\r\n\r\n        if(!this._topics || !this._topics[topic] || !this._topics[topic].length) {\r\n            // Topic list was either empty or didn't exist.  No need to remove anything.  Return;\r\n            return this;\r\n        }\r\n\r\n        let callbacks = this._topics[topic];\r\n\r\n        for(let i = 0; i < callback.length; i++) {\r\n            let cb = callbacks[i];\r\n            if(cb === callback || cb.fn === callback) {\r\n                callbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(callbacks.length === 0) {\r\n            delete this._topics[topic];\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    hasEvent(topic, callback) {\r\n        if(arguments.length === 1) {\r\n            return !!this._topics[topic];\r\n        } else {\r\n            let callbacks = this._topics[topic];\r\n\r\n            for(let i = 0; i < callbacks.length; i++) {\r\n                let cb = callbacks[i];\r\n                if(cb === callback || cb.fn === callback) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    publish(topic, ...args) {\r\n        if(this._topics[topic]) {\r\n            let callbacks = this._topics[topic].slice(0);\r\n\r\n            for(let cb of callbacks) {\r\n                cb.apply(this, args);\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n}","\r\nexport class ExtendableError extends Error {\r\n    constructor(message) {\r\n        // noinspection JSCheckFunctionSignatures\r\n        super(message);\r\n        this.name = this.constructor.name;\r\n\r\n        // noinspection JSUnresolvedVariable\r\n        if(typeof Error.captureStackTrace === 'function') {\r\n            // noinspection JSUnresolvedFunction\r\n            Error.captureStackTrace(this, this.constructor);\r\n        } else {\r\n            this.stack = (new Error(message)).stack;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class IndexError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class KeyError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class ValueError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class NotImplemented extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class ValidationError extends ExtendableError {\r\n    constructor(message, node) {\r\n        super(message);\r\n        this.node = node;\r\n        this.children = [];\r\n    }\r\n}\r\n\r\n\r\nexport class AssertionError extends ExtendableError {\r\n    constructor(message) {\r\n        super(message);\r\n    }\r\n}\r\n","import {AssertionError} from './errors';\r\nconst REG_WHITESPACE = /\\s+/;\r\n\r\n\r\n/**\r\n * Clamps a value between a minimum and maximum values.\r\n * @param value\r\n * @param minValue\r\n * @param maxValue\r\n * @returns {*}\r\n */\r\nexport function clamp(value, minValue=null, maxValue=null) {\r\n    if(minValue !== null) {\r\n        value = Math.max(value, minValue);\r\n    }\r\n\r\n    if(maxValue !== null) {\r\n        value = Math.min(value, maxValue);\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Takes an iterable and returns the first none null or undefined value.\r\n * @param args\r\n */\r\nexport function firstValue(args) {\r\n    for(let item of args) {\r\n        if(item !== null && item !== undefined) {\r\n            return item;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Takes an iterable and returns true if all of the values are trueish.\r\n * @param iterable\r\n */\r\nexport function all(iterable) {\r\n    for(let item of iterable) {\r\n        if(!item) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n/**\r\n * Takes an iterable and returns true if any of the values are trueish.\r\n * @param iterable\r\n */\r\nexport function any(iterable) {\r\n    for(let item of iterable) {\r\n        if(item) return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n\r\nexport function proto(descriptor) {\r\n    descriptor.placement = \"prototype\";\r\n    return descriptor;\r\n}\r\n\r\n\r\n/**\r\n * Returns a random value from an array.\r\n * @param array\r\n * @returns {*}\r\n */\r\nexport function randomChoice(array) {\r\n    return array[Math.floor(Math.random()*array.length)];\r\n}\r\n\r\n\r\n/**\r\n * Checks to see if 2 arrays are \"equal\".\r\n * @param array1\r\n * @param array2\r\n */\r\nexport function arraysEqual(array1, array2) {\r\n    if(array1 === array2) return true; // The same object.\r\n    if(array1 == null || array2 == null) return false;\r\n    if(array1.length !== array2.length) return false;\r\n\r\n    for(let i = 0, l = array1.length; i < l; i++) {\r\n        if(array1[i] !== array2[i]) return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n/**\r\n * Parses an html string into a document fragment.\r\n *\r\n * @param html\r\n * @return {DocumentFragment}\r\n */\r\nexport function parseHTML(html) {\r\n    let template = document.createElement('template');\r\n    template.innerHTML = html.trim();\r\n\r\n    if(template.content) {\r\n        return template.content;\r\n    } else {\r\n        // Doesn't support template tag.\r\n        let fragment = document.createDocumentFragment();\r\n        while(template.firstChild) fragment.appendChild(template.firstChild);\r\n        return fragment;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Tests to see if the object is empty.\r\n *\r\n * @param object\r\n * @return {boolean}\r\n */\r\nexport function isEmptyObject(object) {\r\n    // noinspection LoopStatementThatDoesntLoopJS\r\n    for(let key in object) {\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n/**\r\n * Empties a dom element.\r\n *\r\n * @param element\r\n */\r\nexport function emptyElement(element) {\r\n    while(element.firstChild) element.removeChild(element.firstChild);\r\n}\r\n\r\n\r\n/**\r\n * Adds classes to an element.  Can take a space separated list of classes.\r\n *\r\n * @param element\r\n * @param classes\r\n */\r\nexport function addClasses(element, classes) {\r\n    if(typeof classes === 'string') {\r\n        classes = classes.split(REG_WHITESPACE);\r\n    }\r\n\r\n    element.classList.add(...classes);\r\n}\r\n\r\n\r\n/**\r\n * Removes classes to an element.  Can take a space separated list of classes.\r\n *\r\n * @param element\r\n * @param classes\r\n */\r\nexport function removeClasses(element, classes) {\r\n    if(typeof classes === 'string') {\r\n        classes = classes.split(REG_WHITESPACE);\r\n    }\r\n\r\n    element.classList.remove(...classes);\r\n}\r\n\r\n\r\n/**\r\n * Assigns attributes in an object to an element.\r\n * @param element\r\n * @param attributes\r\n */\r\nexport function assignAttributes(element, attributes) {\r\n    for(let key in attributes) {\r\n        if(attributes.hasOwnProperty(key)) {\r\n            element.setAttribute(key, attributes[key]);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Sets an elements position relative to the document.\r\n *\r\n * @param element\r\n * @param coords\r\n */\r\nexport function setElementOffset(element, coords) {\r\n    if(coords.nodeType) {\r\n        coords = getElementOffset(element);\r\n    } else if(Array.isArray(coords)) {\r\n        coords = {\r\n            left: coords.left,\r\n            top: coords.top\r\n        };\r\n    }\r\n\r\n    let offset = element.getBoundingClientRect();\r\n\r\n    let style = getComputedStyle(element),\r\n        left = parseInt(style.left, 10) || 0,\r\n        top = parseInt(style.top, 10) || 0;\r\n\r\n    element.style.left = (left + (coords.left - offset.left)) + 'px';\r\n    element.style.top = (top + (coords.top - offset.top)) + 'px';\r\n}\r\n\r\n\r\n/**\r\n * Returns the top and left position of an element relative to the document.\r\n *\r\n * @param element\r\n * @return {{top: number, left: number}}\r\n */\r\nexport function getElementOffset(element) {\r\n    let box = element.getBoundingClientRect();\r\n\r\n    return {\r\n        left: box.left + window.pageXOffset,\r\n        top: box.top + window.pageYOffset\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Normalizing accessing scroll position for an element.\r\n *\r\n * Windows and elements have different ways of accessing their scroll left and scroll top values on IE.\r\n * This function normalizes this behavior so getScroll(variable).scrollLeft always works.\r\n * @param element\r\n * @returns {{left, top}}\r\n */\r\nexport function getScroll(element) {\r\n    if(isWindow(element)) {\r\n        return {\r\n            scrollLeft: element.pageXOffset,\r\n            scrollTop: element.pageYOffset\r\n        };\r\n    } else {\r\n        return {\r\n            scrollLeft: element.scrollLeft,\r\n            scrollTop: element.scrollTop\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Test to see if the variable is a window.\r\n * @param variable\r\n * @returns {boolean}\r\n */\r\nexport function isWindow(variable) {\r\n    return variable && typeof variable === 'object' && setInterval in variable;\r\n}\r\n\r\n\r\n/**\r\n * Normalizes setting a scroll position for an element.\r\n * Windows on ie and elements with overflow scroll have different ways of setting the scroll position.\r\n * This methods normalizes them.\r\n * @param element - The element to scroll\r\n * @param scroll - An object with a left or a top property or both.\r\n */\r\nexport function setScroll(element, scroll) {\r\n    if(element.scrollTo) {\r\n        element.scrollTo(scroll);\r\n    } else {\r\n        element.scrollLeft = scroll.left;\r\n        element.scrollTop = scroll.top;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Matches a single dom element based on the given selector.\r\n * Can take a css selector string, a jquery object, a dom element, a document element or a document fragment.\r\n * If a css selector is passed it will query for the element.\r\n * If a jquery object is passed it will return the first matched element.\r\n * If an element is passed it will return that element.\r\n *\r\n * If a context is provided and the selector was a css selector, the selectors scope will be limited to that element.\r\n * Otherwise the context will be the document.\r\n *\r\n * @param selector\r\n * @param context\r\n * @returns {Element|Document|DocumentFragment}\r\n */\r\nexport function selectElement(selector, context=null) {\r\n    if(!context) {\r\n        context = document;\r\n    } else {\r\n        context = selectElement(context);\r\n    }\r\n\r\n    if(typeof selector === 'string') {\r\n        return context.querySelector(selector);\r\n    } else if(selector.jquery) {\r\n        return selector[0];\r\n    } else if(selector.nodeType === 1 || selector.nodeType === 9 || selector.nodeType === 11) {\r\n        return selector;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Asserts that a condition is true or raises an AssertionError.\r\n * @param condition - condition to check.\r\n * @param message - message on fail.\r\n * @throws AssertionError\r\n */\r\nexport function assert(condition, message) {\r\n    if(!condition) {\r\n        throw new AssertionError(message);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse the value into a boolean value or a integer.  Returns the default value on failure if provided.\r\n * Otherwise throws a TypeError.\r\n * @param value\r\n * @param radix\r\n * @param defaultValue\r\n * @returns {boolean|number|*}\r\n */\r\nexport function parseBooleanOrInt(value, radix=10, defaultValue=TypeError) {\r\n    let type = typeof value;\r\n\r\n    if(type === 'boolean' || type === 'number') {\r\n        return value;\r\n    }\r\n\r\n    if(value === 'true') {\r\n        return true;\r\n    } else if(value === 'false') {\r\n        return false;\r\n    }\r\n\r\n    value = parseInt(value, radix);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into boolean or int.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse the value into a boolean value or a float.  Returns the default value on failure if provided.\r\n * Otherwise throws a TypeError.\r\n * @param value\r\n * @param defaultValue\r\n * @returns {boolean|number|*}\r\n */\r\nexport function parseBooleanOrFloat(value, defaultValue=TypeError) {\r\n    let type = typeof value;\r\n\r\n    if(type === 'boolean' || type === 'number') {\r\n        return value;\r\n    }\r\n\r\n    if(value === 'true') {\r\n        return true;\r\n    } else if(value === 'false') {\r\n        return false;\r\n    }\r\n\r\n    value = parseFloat(value);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into boolean or int.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Attempts for parse a boolean value from a string.  Returns the defaultValue on failure if provided.  Otherwise throws\r\n * a TypeError.\r\n * @param value\r\n * @param defaultValue\r\n * @returns {boolean|*}\r\n */\r\nexport function parseBoolean(value, defaultValue=TypeError) {\r\n    if(typeof value === 'boolean') {\r\n        return value;\r\n    } else if(value === 'true') {\r\n        return true;\r\n    } else if(value === 'false') {\r\n        return false;\r\n    } else {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into boolean.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse a string into an integer.  Returns the default value on failure if set.  Otherwise throws a\r\n * TypeError.\r\n * @param value\r\n * @param radix\r\n * @param defaultValue\r\n * @returns {number}\r\n */\r\nexport function parseIntValue(value, radix=10, defaultValue=TypeError) {\r\n    value = parseInt(value, radix);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into integer.\");\r\n        } else {\r\n            // noinspection JSValidateTypes\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse a string into an integer.  Returns the default value on failure if set.  Otherwise throws a\r\n * TypeError.\r\n * @param value\r\n * @param defaultValue\r\n * @returns {number}\r\n */\r\nexport function parseFloatValue(value, defaultValue=TypeError) {\r\n    value = parseFloat(value);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into float.\");\r\n        } else {\r\n            // noinspection JSValidateTypes\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Runs multiple parsers and returns the first one that doesn't throw a TypeError.\r\n * @param value\r\n * @param parsers\r\n * @returns {*}\r\n */\r\nexport function parseAny(value, ...parsers) {\r\n    for(let parser of parsers) {\r\n        try {\r\n            return parser(value);\r\n        } catch(e) {\r\n            if(!(e instanceof TypeError)) {\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n\r\n    throw new TypeError(\"Could not parse value.\");\r\n}\r\n\r\n\r\n/**\r\n * Validates that the value is one of the given choices.\r\n * @param value\r\n * @param choices\r\n * @param defaultValue\r\n * @returns {TypeErrorConstructor|*}\r\n */\r\nexport function validateChoice(value, choices, defaultValue=TypeError) {\r\n    if(choices.indexOf(value) === -1) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Invalid choice.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\nexport function choice(...args) {\r\n    return function(value) {\r\n        if(args.indexOf(value) === -1) {\r\n            throw new TypeError(\"Invalid Choice\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns first child element that matches the test function.\r\n * @param element - Parent element\r\n * @param fn - Test Function\r\n * @returns {Element}\r\n */\r\nexport function findChild(element, fn) {\r\n    for(let i = 0, l = element.children.length; i < l; i++) {\r\n        let child = element.children[i];\r\n\r\n        if(fn(child)) {\r\n            return child;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Creates a filtered list of element from the children that match the test function.\r\n * @param element - Parent element.\r\n * @param fn - Test function.\r\n * @returns {Array}\r\n */\r\nexport function filterChildren(element, fn) {\r\n    let r = [];\r\n\r\n    for(let i = 0, l = element.children.length; i < l; i++) {\r\n        let child = element.children[i];\r\n\r\n        if(fn(child)) {\r\n            r.push(child);\r\n        }\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Returns the object own property or the default value if it does not have that property.\r\n * @param obj\r\n * @param propName\r\n * @param defaultValue\r\n * @returns {*}\r\n */\r\nexport function getOwnProperty(obj, propName, defaultValue=undefined) {\r\n    if(obj.hasOwnProperty(propName)) {\r\n        return obj[propName];\r\n    } else {\r\n        return defaultValue;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the obj value by following it's property path.  For example getPropertyByPath(a, 'b.c.d') is equivalent to\r\n * a.b.c.d but can be passed in string form.\r\n * @param obj\r\n * @param path\r\n * @returns {*}\r\n */\r\nexport function getPropertyByPath(obj, path) {\r\n    let parts = path.split('.'),\r\n        r = obj;\r\n\r\n    for(let part of parts) {\r\n        r = r[part];\r\n    }\r\n\r\n    return r;\r\n}\r\n","import MenuNode from \"./MenuNode\";\r\n\r\n\r\nexport default class DropDown extends MenuNode {\r\n    constructor({target, text, closeOnBlur=true, timeout=false, autoActivate=false, toggle=\"both\", closeOnSelect=true}) {\r\n        super();\r\n\r\n        this.menuNodeType = \"dropdown\";\r\n\r\n        this.closeOnBlur = closeOnBlur;\r\n        this.timeout = timeout;\r\n        this.autoActivate = autoActivate;\r\n        this.toggle = toggle;\r\n        this.closeOnSelect = closeOnSelect;\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render(text);\r\n        }\r\n\r\n        this.init();\r\n    }\r\n\r\n    render(text) {\r\n        let element = document.createElement('div'),\r\n            button = document.createElement('button');\r\n\r\n        button.type = \"button\";\r\n        button.innerHTML = text;\r\n\r\n        element.appendChild(button);\r\n\r\n        return element;\r\n    }\r\n\r\n    activate() {\r\n        if(this.isActive) return; // Already active\r\n\r\n        this.isActive = true;\r\n\r\n        this.clearTimer('autoActivate');\r\n\r\n        if(this.parent) {\r\n            if(!this.parent.isActive) {\r\n                this.parent.activate();\r\n            }\r\n\r\n            this.parent.setActiveItem(this, true);\r\n        }\r\n    }\r\n\r\n    deactivate() {\r\n\r\n    }\r\n\r\n    onMouseOver(event) {\r\n\r\n    }\r\n\r\n    onMouseOut(event) {\r\n\r\n    }\r\n\r\n    onClick(event) {\r\n\r\n    }\r\n}\r\n","import MenuNode from \"./MenuNode\";\r\nimport MenuItem from \"./MenuItem\";\r\nimport {addClasses} from \"core/utility\";\r\nimport {inherit} from \"./decorators\";\r\n\r\n\r\nexport default class Menu extends MenuNode {\r\n    constructor({target=null, closeOnBlur=false, timeout=false, autoActivate=true, multiple=false, openOnHover=true,\r\n                    toggle=\"on\", closeOnSelect=true, deactivateOnItemHover=true, delay=false, id=null, classes=null,\r\n                    children=null, ...context}={}) {\r\n        super();\r\n        this.menuNodeType = \"menu\";\r\n        this.events = null;\r\n        this.MenuItemClass = MenuItem;\r\n        this.SubMenuClass = Menu;\r\n\r\n        this.closeOnBlur = closeOnBlur;\r\n        this.timeout = timeout;\r\n        this.autoActivate = autoActivate;\r\n        this.multiple = multiple;\r\n        this.openOnHover = openOnHover;\r\n        this.toggle = toggle;\r\n        this.closeOnSelect = closeOnSelect;\r\n        this.deactivateOnItemHover = deactivateOnItemHover;\r\n        this.delay = delay;\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render(context);\r\n        }\r\n\r\n        this.isVisible = false;\r\n\r\n        this.init();\r\n\r\n        // On child is activate\r\n        // deactivate siblings if multiple is false.\r\n        this.on('activate', (target) => {\r\n            if(target.parent === this) {\r\n                if (!this.isActive) {\r\n                    this.activate();\r\n                }\r\n\r\n                if (!this.multiple) {\r\n                    for (let activeItem of this.activeItems) {\r\n                        if (activeItem !== target) {\r\n                            activeItem.deactivate();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        this.on('deactivate', (target) => {\r\n            if(target.parent === this) {\r\n                if (this.isActive && this.activeItems.length === 0) {\r\n                    this.deactivate();\r\n                }\r\n            }\r\n        });\r\n\r\n        this.on('event.click', (event) => this.onClick(event));\r\n        this.on('event.mouseover', (event) => this.onMouseOver(event));\r\n        this.on('event.mouseout', (event) => this.onMouseOut(event));\r\n        this.on('menuitem.selected', (event) => this.onSelect(event));\r\n\r\n        if(classes) addClasses(this.element, classes);\r\n        if(id) this.element.id = id;\r\n\r\n        if(children) {\r\n            this.createItems(children);\r\n        }\r\n    }\r\n\r\n    render({arrow=false}={}) {\r\n        let element = document.createElement('div'),\r\n            body = document.createElement('div');\r\n\r\n        element.className = \"menu\";\r\n        body.className = \"menu__body\";\r\n\r\n        if(arrow) {\r\n            let arrow = document.createElement('div');\r\n            arrow.className = \"menu__arrow\";\r\n            element.appendChild(arrow);\r\n        }\r\n\r\n        element.appendChild(body);\r\n        return element;\r\n    }\r\n\r\n    activate() {\r\n        if(!this.isActive) {\r\n            let parent = this.parent;\r\n\r\n            // Set isActivate flag and add active classes.\r\n            this.isActive = true;\r\n\r\n            // Register document click handler\r\n            if(this.closeOnBlur && !this._captureDocumentClick) {\r\n                this._captureDocumentClick = {\r\n                    target: document,\r\n\r\n                    onDocumentClick: (event) => {\r\n                        if(!this.element.contains(event.target)) {\r\n                            this.deactivate();\r\n                        }\r\n                    }\r\n                };\r\n\r\n                this._captureDocumentClick.target.addEventListener('click', this._captureDocumentClick.onDocumentClick);\r\n            }\r\n\r\n            // Notify parent that submenu activated.\r\n            if(parent) {\r\n                parent.publish('submenu.activate', this);\r\n            }\r\n\r\n            this.publish('menu.activate');\r\n\r\n            // Dispatch dom events.\r\n            this.element.dispatchEvent(new CustomEvent('menu.activate', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    deactivate() {\r\n        if(this.isActive) {\r\n            // Set flag and remove active classes.\r\n            this.isActive = false;\r\n\r\n            // Clear any active child items.\r\n            this.clearItems();\r\n\r\n            // Remove document click handler that tracks user clicks outside of menu tree.\r\n            if(this._captureDocumentClick) {\r\n                this._captureDocumentClick.target.removeEventListener('click', this._captureDocumentClick.onDocumentClick);\r\n                this._captureDocumentClick = null;\r\n            }\r\n\r\n            // clear timers\r\n            this.clearTimer('timeout');\r\n\r\n            for(let child of this.children) {\r\n                child.clearTimer('activateItem');\r\n            }\r\n\r\n            // Notify parent that submenu deactivated.\r\n            let parent = this.parent;\r\n            if(parent) {\r\n                parent.publish('submenu.deactivate', this);\r\n            }\r\n\r\n            this.publish('menu.deactivate');\r\n\r\n            // Dispatch dom events.\r\n            this.element.dispatchEvent(new CustomEvent('menu.deactivate', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    show() {\r\n        if(!this.isVisible) {\r\n            this.isVisible = true;\r\n\r\n            if(this.parent) this.parent.publish('submenu.show', this);\r\n            this.publish('menu.show', this);\r\n\r\n            this.element.dispatchEvent(new CustomEvent('menu.show', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    hide() {\r\n        if(this.isVisible) {\r\n            this.isVisible = false;\r\n\r\n            if(this.parent) this.parent.publish('submenu.hide', this);\r\n            this.publish('menu.hide', this);\r\n\r\n            this.element.dispatchEvent(new CustomEvent('menu.hide', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Tree methods.\r\n\r\n    createItems(data) {\r\n        for(let {submenu, ...args} of data) {\r\n            let item = new this.MenuItemClass(args);\r\n\r\n            if(submenu) {\r\n                let _submenu = new this.SubMenuClass(submenu);\r\n                item.attachSubMenu(_submenu);\r\n            }\r\n\r\n            this.append(item);\r\n        }\r\n    }\r\n\r\n    addItem(text, action) {\r\n        let item = new this.MenuItemClass({text, action});\r\n        this.append(item);\r\n        return this;\r\n    }\r\n\r\n    removeItem(item) {\r\n        let index = this._children.indexOf(item);\r\n        if(index !== -1) {\r\n            this._children.splice(index, 1);\r\n            if(item.element.parentElement) item.element.parentElement.removeChild(item.element);\r\n        }\r\n    }\r\n\r\n    hasItem(item) {\r\n        return this._children.indexOf(item) !== -1;\r\n    }\r\n\r\n    append(item) {\r\n        let body = this.getMenuBody();\r\n\r\n        body = body[body.length - 1];\r\n\r\n        if(item.nodeType) {\r\n            body.appendChild(item);\r\n            return this;\r\n        }\r\n\r\n        if(item.parent) {\r\n            item.parent.removeItem(item);\r\n        }\r\n\r\n        item.appendTo(body);\r\n\r\n        if(item.isMenuItem && item.isMenuItem()) {\r\n            item._parent = this;\r\n            this._children.push(item);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    get activeItems() {\r\n        let r = [];\r\n\r\n        for(let item of this.children) {\r\n            if(item.isActive) {\r\n                r.push(item);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    clearItems() {\r\n        for(let child of this.activeItems) {\r\n            child.deactivate();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns list of all menu bodies for the menu.\r\n     *\r\n     * Menu bodies are where item are appended when using function like addItem or append.  They will be added to the\r\n     * last menu body in the menu.\r\n     *\r\n     * @returns {NodeListOf<HTMLElementTagNameMap[string]> | NodeListOf<Element> | NodeListOf<SVGElementTagNameMap[string]>}\r\n     */\r\n    getMenuBody() {\r\n        return this.element.querySelectorAll(':scope > .menu__body');\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Event Handlers\r\n\r\n    onMouseOver(event) {\r\n        this.clearTimer('timeout');\r\n    }\r\n\r\n    onMouseOut(event) {\r\n        if(!this.element.contains(event.originalEvent.relatedTarget)) {\r\n            if(this.isActive && typeof this.timeout === 'number' && this.timeout >= 0) {\r\n                this.startTimer('timeout', () => {\r\n                    this.deactivate();\r\n                }, this.timeout);\r\n            }\r\n        }\r\n    }\r\n\r\n    onClick(event) {\r\n        if(event.target === this) {\r\n            if(this.isActive && this.toggleOff) {\r\n                this.deactivate();\r\n            } else if(!this.isActive && this.toggleOn) {\r\n                this.activate();\r\n            }\r\n        }\r\n    }\r\n\r\n    onSelect(event) {\r\n        if(this.closeOnSelect && this.isActive) {\r\n            this.deactivate();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Will return true if menu items should toggle on.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get toggleOn() {\r\n        return this.toggle === 'on' || this.toggle === 'both';\r\n    }\r\n\r\n    /**\r\n     * Will return true if menu items should toggle off.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get toggleOff() {\r\n        return this.toggle === 'off' || this.toggle === 'both';\r\n    }\r\n}","import Menu from \"./Menu\";\r\n\r\n\r\nexport default class MenuBar extends Menu {\r\n    constructor({target=null, closeOnBlur=true, timeout=false, autoActivate=false, multiple=false, openOnHover=true,\r\n                    toggle=\"both\", closeOnSelect=true, deactivateOnItemHover=true, delay=false, ...context}={}) {\r\n        super({\r\n            target, closeOnBlur, timeout, autoActivate, multiple, openOnHover,\r\n            toggle, closeOnSelect, deactivateOnItemHover, delay: false, ...context\r\n        });\r\n\r\n        this.SubMenuClass = class SubMenu extends Menu {\r\n            constructor(args={}) {\r\n                super({\r\n                    delay,\r\n                    ...args\r\n                });\r\n\r\n                this.SubMenuClass = SubMenu;\r\n            }\r\n        };\r\n\r\n        this.isVisible = true;\r\n    }\r\n\r\n    render(context) {\r\n        let element = document.createElement('div');\r\n\r\n        element.className = \"menubar\";\r\n\r\n        return element;\r\n    }\r\n\r\n    getMenuBody() {\r\n        return [this.element];\r\n    }\r\n}\r\n","import MenuNode from \"./MenuNode\";\r\nimport {inherit} from \"./decorators\";\r\n\r\n\r\nexport default class MenuItem extends MenuNode {\r\n    @inherit toggle;\r\n    @inherit autoActivate;\r\n    @inherit openOnHover;\r\n    /**@type{boolean|Number|\"inherit\"|\"root\"}*/\r\n    @inherit delay = false;\r\n\r\n    constructor({text, action, href=null, target, classes, nodeName=\"div\", ...context}={}) {\r\n        super();\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render({text, nodeName, href, ...context});\r\n        }\r\n\r\n        if(classes) {\r\n            this.addClass(classes);\r\n        }\r\n\r\n        if(action) this.addAction(action);\r\n\r\n        this.toggle = 'inherit';\r\n        this.autoActivate = 'inherit';\r\n        this.openOnHover = 'inherit';\r\n        this.delay = 'inherit';\r\n\r\n        this.on('event.click', (event) => this.onClick(event));\r\n        this.on('event.mouseover', (event) => this.onMouseOver(event));\r\n        this.on('event.mouseout', (event) => this.onMouseOut(event));\r\n        this.on('menuitem.selected', (event) => this.onSelect(event));\r\n    }\r\n\r\n    render({text, nodeName=\"div\", href=null}={}) {\r\n        let element = document.createElement(nodeName),\r\n            button = document.createElement('a');\r\n\r\n        element.className = \"menuitem\";\r\n        button.type = \"button\";\r\n        button.innerHTML = text;\r\n        button.className = \"menuitem__button\";\r\n\r\n        if(href) {\r\n            button.href = href;\r\n        }\r\n\r\n        element.appendChild(button);\r\n        return element;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param show {boolean|number}\r\n     */\r\n    activate(show=true) {\r\n        if(this.isActive) return;\r\n        this.isActive = true;\r\n\r\n        this.clearTimer('activateItem');\r\n\r\n        if(this.submenu) {\r\n            if(show === true) {\r\n                this.submenu.show();\r\n            } else if(typeof show === 'number' && show >= 0) {\r\n                this.startTimer('showTimer', () => {\r\n                    this.submenu.show();\r\n                }, show);\r\n            }\r\n        }\r\n\r\n        this.publish('activate', this);\r\n\r\n        if(this.parent) {\r\n            this.parent.publish('activate', this);\r\n        }\r\n\r\n        this.element.dispatchEvent(new CustomEvent('menuitem.activate', {\r\n            detail: this,\r\n            bubbles: true\r\n        }));\r\n    }\r\n\r\n    deactivate() {\r\n        if(!this.isActive) return;\r\n        this.isActive = false;\r\n        this.clearTimer('showTimer');\r\n\r\n        if(this.submenu) {\r\n            this.submenu.deactivate();\r\n            this.submenu.hide();\r\n        }\r\n\r\n        this.publish('deactivate', this);\r\n        if(this.parent) this.parent.publish('deactivate', this);\r\n\r\n        this.element.dispatchEvent(new CustomEvent('menuitem.deactivate', {\r\n            detail: this,\r\n            bubbles: true\r\n        }));\r\n    }\r\n\r\n    select() {\r\n        this.publish('selected');\r\n        this.dispatchTopic('menuitem.selected', {target: this});\r\n\r\n        this.element.dispatchEvent(new CustomEvent('menuitem.selected', {\r\n            detail: this,\r\n            bubbles: true\r\n        }));\r\n    }\r\n\r\n    isMenuItem() {\r\n        return true;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Action management\r\n\r\n    addAction(action) {\r\n        if(typeof action === 'string') {\r\n            let fn = () => {\r\n                window.location = action;\r\n            };\r\n\r\n            this.on('selected', fn);\r\n            return fn;\r\n        } else {\r\n            this.on('selected', action);\r\n            return action;\r\n        }\r\n    }\r\n\r\n    removeAction(action) {\r\n        this.off('selected', action);\r\n    }\r\n\r\n    hasAction(action) {\r\n        return this.hasEvent('selected', action);\r\n    }\r\n\r\n    clearActions() {\r\n        this.off('selected');\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Manage submenu\r\n\r\n    attachSubMenu(submenu) {\r\n        if(this.submenu) {\r\n            throw new Error(\"MenuItem can only have one submenu.\");\r\n        }\r\n\r\n        if(submenu.parent) {\r\n            submenu.parent.detachSubMenu();\r\n        }\r\n\r\n        submenu._parent = this;\r\n        this._children = [submenu];\r\n\r\n        if(!submenu.element.parentElement) {\r\n            submenu.appendTo(this.element);\r\n        }\r\n    }\r\n\r\n    detachSubMenu(remove=true) {\r\n        let submenu = this.submenu;\r\n\r\n        if(submenu) {\r\n            this._children = [];\r\n            submenu._parent = null;\r\n            if(remove) submenu.remove();\r\n        }\r\n\r\n        return submenu;\r\n    }\r\n\r\n    hasSubMenu() {\r\n        return !!this.submenu;\r\n    }\r\n\r\n    isSubMenuVisible() {\r\n        return this.hasSubMenu() ? this.submenu.isVisible : false;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Event handlers\r\n\r\n    onSelect() {\r\n        if(this.closeOnSelect && this.isActive) {\r\n            this.deactivate();\r\n        }\r\n    }\r\n\r\n    onClick(event) {\r\n        let isDisabled = this.getDisabled();\r\n\r\n        if(isDisabled) {\r\n            event.preventDefault();\r\n        }\r\n\r\n        if(event.target !== this) return;\r\n\r\n        if(this.parent) {\r\n            this.parent.publish('click-item', this, event);\r\n        }\r\n\r\n        if(!isDisabled) {\r\n            if (this.isActive && this.hasSubMenu() && !this.isSubMenuVisible()) {\r\n                this.submenu.show();\r\n            } else if (!this.isActive && this.toggleOn) {\r\n                this.activate();\r\n            } else if (this.isActive && this.toggleOff && this.hasSubMenu()) {\r\n                this.deactivate();\r\n            }\r\n\r\n            if (this.isActive && !this.hasSubMenu()) {\r\n                this.select();\r\n            }\r\n        }\r\n    }\r\n\r\n    onMouseOver(event) {\r\n        this.clearTimer('timeout');\r\n\r\n        if(event.target === this) {\r\n            // When the mouse moves on an item clear any active items in it's submenu.\r\n            if (this.submenu) {\r\n                this.submenu.clearItems();\r\n            }\r\n\r\n            if(this.element.contains(event.originalEvent.relatedTarget)) return;\r\n\r\n            let activate = this.parent && this.parent.isActive ? this.openOnHover : this.autoActivate;\r\n\r\n            if (this.parent) {\r\n                this.parent.publish('mouse-enter-item', this, event);\r\n            }\r\n\r\n            if (!this.isActive && !this.isDisabled) {\r\n                if (activate === true) {\r\n                    this.activate(typeof this.delay === 'boolean' ? !this.delay : this.delay);\r\n                } else if (typeof activate === 'number' && activate >= 0) {\r\n                    this.startTimer('activateItem', () => {\r\n                        if (!this.isDisabled) {\r\n                            this.activate(typeof this.delay === 'boolean' ? !this.delay : this.delay);\r\n                        }\r\n                    }, activate);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    onMouseOut(event) {\r\n        if(this.element.contains(event.originalEvent.relatedTarget)) return;\r\n\r\n        this.clearTimer('activateItem');\r\n\r\n        if(this.parent) {\r\n            this.parent.publish('mouse-leave-item', this, event);\r\n        }\r\n\r\n        if(event.target === this && (!this.hasSubMenu() || !this.submenu.isVisible) && this.isActive) {\r\n            this.deactivate();\r\n        }\r\n\r\n        if(this.isActive && typeof this.timeout === 'number' && this.timeout >= 0) {\r\n            this.startTimer('timeout', () => {\r\n                this.deactivate();\r\n            }, this.timeout);\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Getters and Setters\r\n\r\n    /**\r\n     * Will return true if menu items should toggle on.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get toggleOn() {\r\n        return this.toggle === 'on' || this.toggle === 'both';\r\n    }\r\n\r\n    /**\r\n     * Will return true if menu items should toggle off.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get toggleOff() {\r\n        return this.toggle === 'off' || this.toggle === 'both';\r\n    }\r\n\r\n    get submenu() {\r\n        return this._children[0];\r\n    }\r\n\r\n    set submenu(value) {\r\n        if(!value) {\r\n            this.detachSubMenu();\r\n        } else {\r\n            this.attachSubMenu(value);\r\n        }\r\n    }\r\n}","import Publisher from \"core/Publisher\";\r\nimport {KeyError} from \"core/errors\";\r\nimport {addClasses, removeClasses} from \"core/utility\";\r\n\r\n\r\nexport const MENU_MAP = new WeakMap();\r\n\r\n\r\nexport default class MenuNode extends Publisher {\r\n    constructor() {\r\n        super();\r\n        this._parent = null;\r\n        this._children = [];\r\n        this._props = {};\r\n        this._timers = {};\r\n        /**\r\n         * @type {undefined|null|HTMLElement}\r\n         * @private\r\n         */\r\n        this._element = undefined;\r\n\r\n        this._isActive = false;\r\n        this._isVisible = true;\r\n\r\n        this.nodeType = null;\r\n        this.isController = false;\r\n    }\r\n\r\n    init() {\r\n        if(this.boundEvents) return;\r\n\r\n        this.boundEvents = {};\r\n\r\n        let handleEvent = (event) => {\r\n            let target = this.getTargetNode(event.target),\r\n                wrappedEvent = {\r\n                    target,\r\n                    originalEvent: event\r\n                };\r\n\r\n            if(target.getEventDelegator() === this) {\r\n                target.dispatchTopic(`event.${event.type}`, wrappedEvent);\r\n            }\r\n        };\r\n\r\n        this.boundEvents.onMouseOver = handleEvent;\r\n        this.boundEvents.onMouseOut = handleEvent;\r\n        this.boundEvents.onClick = handleEvent;\r\n\r\n        this.element.addEventListener('click', this.boundEvents.onClick);\r\n        this.element.addEventListener('mouseover', this.boundEvents.onMouseOver);\r\n        this.element.addEventListener('mouseout', this.boundEvents.onMouseOut);\r\n        this.isController = true;\r\n    }\r\n\r\n    destroy() {\r\n        if(this.events && this.hasElement()) {\r\n            this.element.removeEventListener('click', this.boundEvents.onClick);\r\n            this.element.removeEventListener('onMouseOut', this.boundEvents.onMouseOut);\r\n            this.element.removeEventListener('onMouseOver', this.boundEvents.onMouseOver);\r\n        }\r\n\r\n        this.isController = false;\r\n        this.boundEvents = null;\r\n        this.element = null;\r\n    }\r\n\r\n    /**\r\n     * Renders the component.\r\n     */\r\n    render() {\r\n\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Actions\r\n\r\n    /**\r\n     * Returns the parent MenuNode\r\n     * @returns {null|MenuNode}\r\n     */\r\n    get parent() {\r\n        return this._parent || null;\r\n    }\r\n\r\n    /**\r\n     * Returns the root node of the menu tree.\r\n     *\r\n     * @returns {MenuNode}\r\n     */\r\n    get root() {\r\n        let r = this,\r\n            o = this;\r\n\r\n        while(o) {\r\n            o = o.parent;\r\n\r\n            if(o) {\r\n                r = o;\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Returns the closest parent menu.\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get parentMenu() {\r\n        let parent = this.parent;\r\n        return parent.closest(node => node.nodeType === 'menu');\r\n    }\r\n\r\n    /**\r\n     * Returns the closest parent item.\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get parentItem() {\r\n        let parent = this.parent;\r\n        return parent.closest(node => node.nodeType === 'menuitem' || node.nodeType === 'dropdown');\r\n    }\r\n\r\n    /**\r\n     * Returns the next sibling node.\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get nextSibling() {\r\n        return this.getOffsetSibling(1);\r\n    }\r\n\r\n    /**\r\n     * Returns the previous sibling node.\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get previousSibling() {\r\n        return this.getOffsetSibling(-1);\r\n    }\r\n\r\n    get children() {\r\n        return this._children.slice(0);\r\n    }\r\n\r\n    get isActive() {\r\n        return this._isActive;\r\n    }\r\n\r\n    set isActive(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this._isActive) {\r\n            if(value) {\r\n                this.element.classList.add('active');\r\n            } else {\r\n                this.element.classList.remove('active');\r\n            }\r\n\r\n            this._isActive = value;\r\n        }\r\n    }\r\n\r\n    get isDisabled() {\r\n        return this.element.classList.contains('disabled');\r\n    }\r\n\r\n    set isDisabled(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this.isDisabled) {\r\n            if(value) {\r\n                this.element.classList.add('disabled');\r\n            } else {\r\n                this.element.classList.remove('disabled');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns true if the current node is disabled or if any ancestor node is disabled.\r\n     * @returns {boolean}\r\n     */\r\n    getDisabled() {\r\n        let o = this;\r\n\r\n        while(o) {\r\n            if(o.isDisabled) {\r\n                return true;\r\n            }\r\n\r\n            o = o.parent;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    get isVisible() {\r\n        return this._isVisible;\r\n    }\r\n\r\n    set isVisible(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this._isVisible) {\r\n            if(value) {\r\n                this.element.classList.remove('hidden');\r\n            } else {\r\n                this.element.classList.add('hidden');\r\n            }\r\n\r\n            this._isVisible = value;\r\n        }\r\n    }\r\n\r\n    hasElement() {\r\n        return !!this._element;\r\n    }\r\n\r\n    get element() {\r\n        if(this._element === undefined) {\r\n            this.element = this.render();\r\n        }\r\n\r\n        return this._element;\r\n    }\r\n\r\n    set element(element) {\r\n        if(typeof element === 'string') {\r\n            element = document.querySelector(element);\r\n        } else if(typeof element === 'function') {\r\n            element = element.call(this);\r\n        }\r\n\r\n        if(this._element === element) return;\r\n\r\n        if(MENU_MAP.get(element)) {\r\n            throw new Error(\"Element is already bound to menu controller\");\r\n        }\r\n\r\n        if(this._element) {\r\n            MENU_MAP.delete(this._element);\r\n            this._element = undefined;\r\n        }\r\n\r\n        MENU_MAP.set(element, this);\r\n        this._element = element;\r\n    }\r\n\r\n    /**\r\n     * Return the sibling offset from the current node.\r\n     *\r\n     * @param offset\r\n     * @returns {null|MenuNode}\r\n     */\r\n    getOffsetSibling(offset=1) {\r\n        let parent = this.parent;\r\n\r\n        if(parent) {\r\n            let children = parent.children,\r\n                i = children ? children.indexOf(this) : -1;\r\n\r\n            if(i >= 0) {\r\n                i += offset;\r\n\r\n                if(i >= 0) {\r\n                    return children[i];\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Appends the component to the target selector.\r\n     *\r\n     * @param selector {string|HTMLElement|{append}}\r\n     */\r\n    appendTo(selector) {\r\n        if(typeof selector === 'string') {\r\n            document.querySelector(selector).appendChild(this.element);\r\n        } else if(selector.appendChild) {\r\n            selector.appendChild(this.element);\r\n        } else if(selector.append) {\r\n            selector.append(this.element);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes the component from the dom.\r\n     *\r\n     * @returns {MenuNode}\r\n     */\r\n    remove() {\r\n        if(this.element.parentElement) {\r\n            this.element.parentElement.removeChild(this.element);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Returns the closest MenuNode up the tree that matches the provided test function.\r\n     *\r\n     * @param fn {function(node)}\r\n     * @returns {MenuNode|null}\r\n     */\r\n    closest(fn) {\r\n        let o = this;\r\n\r\n        while(o) {\r\n            if(fn.call(this, o)) return o;\r\n            o = o.parent;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    contains(node) {\r\n        while(node) {\r\n            if(node.parent === this) {\r\n                return true;\r\n            }\r\n\r\n            node = node.parent;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Yields all descendants.\r\n     *\r\n     * @returns {IterableIterator<MenuNode>}\r\n     */\r\n    *getDescendants() {\r\n        for(let child of this.children) {\r\n            yield child;\r\n\r\n            for(let grandchild of child.getDescendants()) {\r\n                yield grandchild;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a timer with the given name.  Only one timer with that name can be active per object.\r\n     * If another timer with the same name is created the previous one will be cleared if `clear` is true.\r\n     * Otherwise if `clear` is false a KeyError with be thrown.  The callback function for the timer is called\r\n     * with the current object as it's `this` and the timer object as it's only parameter following the pattern\r\n     *\r\n     * this::fn(timer);\r\n     *\r\n     * @param name {String} The name of the timer.\r\n     * @param fn {function(timer)} Function to call.\r\n     * @param time {Number} The time to wait.\r\n     * @param interval If true setInterval will be used instead of setTimeout\r\n     * @param clear If true an previous timers of the same name will be canceled before creating a new one.  Otherwise a KeyError will be thrown.\r\n     * @returns {{status, id, cancel, type}}\r\n     */\r\n    startTimer(name, fn, time, interval=false, clear=true) {\r\n        if(clear && this._timers[name]) {\r\n            this._timers[name].cancel();\r\n        } else if(this._timers[name]) {\r\n            throw new KeyError(\"Timer already exists.\");\r\n        }\r\n\r\n        let timer = this._timers[name] = {\r\n            status: 'running',\r\n            id: null,\r\n            cancel: null,\r\n            type: null,\r\n        };\r\n\r\n        if(interval) {\r\n            let id = timer.id = setInterval((timer) => {\r\n                fn.call(this, timer);\r\n            }, time, timer);\r\n\r\n            timer.type = 'interval';\r\n\r\n            timer.cancel = () => {\r\n                if(this._timers[name] === timer) {\r\n                    clearInterval(id);\r\n                    delete this._timers[name];\r\n                    timer.status = 'canceled';\r\n                }\r\n            };\r\n        } else {\r\n            let id = timer.id = setTimeout((timer) => {\r\n                delete this._timers[name];\r\n                timer.status = 'complete';\r\n                fn.call(this, timer);\r\n            }, time, timer);\r\n\r\n            timer.type = 'timeout';\r\n\r\n            timer.cancel = () => {\r\n                if(this._timers[name] === timer) {\r\n                    clearTimeout(id);\r\n                    delete this._timers[name];\r\n                    timer.status = 'canceled';\r\n                }\r\n            };\r\n        }\r\n\r\n        return timer;\r\n    }\r\n\r\n    /**\r\n     * Clears the timer with the given name.\r\n     *\r\n     * @param name\r\n     * @returns {boolean} True if a timer was canceled. False if not timer exists.\r\n     */\r\n    clearTimer(name) {\r\n        if(this._timers[name]) {\r\n            this._timers[name].cancel();\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Returns the timer object if it exists.\r\n     *\r\n     * @param name\r\n     * @returns {*}\r\n     */\r\n    getTimer(name) {\r\n        return this._timers[name];\r\n    }\r\n\r\n    /**\r\n     * Returns the MenuNode that is responsible for delegating the events.\r\n     *\r\n     * @returns {null|{isController}|any}\r\n     */\r\n    getEventDelegator() {\r\n        let o = this.element;\r\n\r\n        while(o) {\r\n            let instance = MENU_MAP.get(o);\r\n\r\n            if(instance && instance.isController) {\r\n                return instance;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    getTargetNode(target) {\r\n        let o = target;\r\n\r\n        while(o) {\r\n            let instance = MENU_MAP.get(o);\r\n\r\n            if(instance) {\r\n                return instance;\r\n            }\r\n\r\n            if(o === this.element) {\r\n                break;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    getTargetItem(target) {\r\n        let o = target;\r\n\r\n        while(o) {\r\n            let instance = MENU_MAP.get(o);\r\n\r\n            if(instance && instance.isMenuItem()) {\r\n                return instance;\r\n            }\r\n\r\n            if(o === this.element) {\r\n                break;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    getTargetMenu(target) {\r\n        let o = target;\r\n\r\n        while(o) {\r\n            let instance = MENU_MAP.get(o);\r\n\r\n            if(instance && instance.isMenu()) {\r\n                return instance;\r\n            }\r\n\r\n            if(o === this.element) {\r\n                break;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    isMenuItem() {\r\n        return false;\r\n    }\r\n\r\n    isMenu() {\r\n        return false;\r\n    }\r\n\r\n    dispatchTopic(topic, ...args) {\r\n        let o = this;\r\n\r\n        while(o) {\r\n            o.publish(topic, ...args);\r\n            o = o.parent;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Getters and Setters\r\n\r\n    get id() {\r\n        return this.element.id;\r\n    }\r\n\r\n    set id(id) {\r\n        if(this.element) this.element.id = id;\r\n    }\r\n\r\n    get classList() {\r\n        return this.element.classList;\r\n    }\r\n\r\n    get dataset() {\r\n        return this.element.dataset;\r\n    }\r\n\r\n    get style() {\r\n        return this.element.style;\r\n    }\r\n\r\n    set style(style) {\r\n        this.element.style = style;\r\n    }\r\n\r\n    addClass(classes) {\r\n        return addClasses(this.element, classes);\r\n    }\r\n\r\n    removeClass(classes) {\r\n        return removeClasses(this.element, classes);\r\n    }\r\n\r\n    static getInstance(element) {\r\n        return MENU_MAP.get(element);\r\n    }\r\n}","/**\r\n * Decorates a property so that it can take special keywords to inherit it's value up the parent tree.\r\n *\r\n * If it's value is \"inherit\" or \"root\" special actions are taken.\r\n *\r\n * On \"inherit\" the getter will use this.parent[key] as it's value or return undefined.\r\n * On \"root\" the getter will use this.root[key] as it's value or return undefined.\r\n *\r\n * If the value is anything else is behaves like normal.\r\n *\r\n * Usage:\r\n *  @inherit myField = <default value>;\r\n *\r\n * @param target\r\n * @returns {{kind: string, placement: string, descriptor: {set(*): void, enumerable: boolean, get(): (*|*), configurable: boolean}, key: *}|undefined|*}\r\n */\r\nexport function inherit(target) {\r\n    let key = target.key,\r\n        initializer = target.initializer || function() { return undefined };\r\n\r\n    return {\r\n        kind: 'method',\r\n        placement: 'prototype',\r\n        key: target.key,\r\n        descriptor: {\r\n            configurable: true,\r\n            enumerable: false,\r\n\r\n            get() {\r\n                let value = this._props[key];\r\n\r\n                if(value === 'inherit' || value === undefined) {\r\n                    value = this.parent ? this.parent[key] : undefined;\r\n                } else if(value === 'root') {\r\n                    let root = this.root;\r\n                    value = root ? root[key] : undefined;\r\n                } else {\r\n                    return value;\r\n                }\r\n\r\n                if(value === undefined) value = initializer ? initializer() : undefined;\r\n                return value;\r\n            },\r\n\r\n            set(value) {\r\n                this._props[key] = value;\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\n\r\nexport function publishTargetEvent(topic, bubble=false) {\r\n    return function(descriptor) {\r\n        let {value, ...desc} = descriptor.descriptor;\r\n\r\n        function wrapper(event) {\r\n            if(this.getTargetNode(event.target) === this) {\r\n                if(bubble) {\r\n                    this.dispatchTopic(topic, this, event);\r\n                } else {\r\n                    this.publish(topic, this, event);\r\n                }\r\n\r\n                return value.call(this, event);\r\n            }\r\n        }\r\n\r\n        return {\r\n            placement: descriptor.placement,\r\n            key: descriptor.key,\r\n            kind: descriptor.kind,\r\n            descriptor: {\r\n                value: wrapper,\r\n                ...desc\r\n            }\r\n        };\r\n    };\r\n}"],"sourceRoot":""}