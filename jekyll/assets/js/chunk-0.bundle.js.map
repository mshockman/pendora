{"version":3,"sources":["webpack://pendora/./jekyll/js/pages/documentation/test_draggable.js","webpack://pendora/./src/core/fx/Animation.js","webpack://pendora/./src/core/fx/FX.js","webpack://pendora/./src/core/fx/easing.js","webpack://pendora/./src/core/fx/frame.js","webpack://pendora/./src/core/fx/types.js","webpack://pendora/./src/core/ui/Draggable2.js"],"names":["TestDraggablePage","drag1","Draggable2","resistance","delay","scrollSpeed","container","ScrollArea","drag2","helper","clone","revert","revertDuration","drag3","drag4","drag5","axis","drag6","drag7","grid","drag8","dz1","document","querySelector","connect","addEventListener","event","console","log","classList","add","remove","Animation","duration","frames","applyFrame","defaultApplyFrame","bubbleFrameEvent","finishFrame","element","easing","onStart","onFrame","onPause","onCancel","onEnd","onComplete","FX","animation","fx","EASING","linear","position","autoPlay","init","call","destroy","play","animate","complete","config","defaults","_options","Object","assign","canceled","paused","pending","error","playing","regNumberWithUnit","regColor","regFunction","TYPE_FUNCTIONS","hex","RGBA","parseHexColorStringArg","rgb","parseRGBAColorStringArgs","rgba","DeadFXError","ExtendableError","assertFXAlive","status","doPromiseAction","onAction","value","resolveOrReject","_prepareValue","trim","m","exec","NumberWithUnit","parseFloat","_getFrames","r","keyframeIndex","hasOwnProperty","frame","property","Symbol","toStringTag","selectElement","undefined","key","pos","freeze","push","properties","sort","a","b","startPosition","startValue","endPosition","endValue","getFrameFX","options","p","delta","subtract","scalar","tick","performance","now","frameFN","timestamp","dispatchEvent","CustomEvent","bubbles","detail","window","requestAnimationFrame","_complete","cancelAnimationFrame","_triggerEndEvent","completeAnimation","_cancel","getFrame","onResolve","state","onReject","Promise","resolve","reject","onFinally","then","slice","style","toString","unit","TypeError","Error","startingPosMap","WeakMap","cursor","target","rect","Rect","x","clientX","left","y","clientY","top","TOLERANCE","intersect","targetRect","isOverlapping","exclude","offset","handle","selector","tolerance","setHelperSize","onMouseDown","pageXOffset","pageYOffset","currentPosition","cancelMouseTracking","cancelTimer","closest","contains","Array","isArray","preventDefault","distanceBrokenPromise","isDistanceBroken","onMouseMove","calcDistance","removeEventListener","timerPromise","timer","setTimeout","clearTimeout","onMouseUp","all","timerStatus","distanceStatus","startDragging","offsetX","offsetY","startingX","startingY","cancel","scroller","dropTargets","translate","get","set","width","height","pointerEvents","parentElement","appendChild","_moveElementToPosition","_selectElementRect","ScrollHelper","buildScrollHelper","currentDropTargets","getDropTargets","mouseX","mouseY","dropTarget","indexOf","_dispatchDropEvent","originalEvent","publish","draggable","name","accepted","isDefaultPrevented","reverted","isAccepted","accept","removeChild","setElementClientPosition","_revert","initial","mousePos","testFunction","droppable","i","splice","Publisher","self","customEvent","bubble","starting","startingRect","moveTo","right","bottom","Math","floor","fit","dragInstance","originalTarget","type","_getScrollParent","o","scrollWidth","clientWidth","scrollHeight","clientHeight","scrollXSpeed","scrollYSpeed","frameID","scrollLeft","scrollTop","scrollParentRect","clamp","scrollParent","speed","getScrollSpeed","scrollRect","scroll","getScroll","opacity","className","zIndex","nodeType","cloneNode"],"mappings":"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","file":"chunk-0.bundle.js","sourcesContent":["import Draggable2, {ScrollArea, clone} from \"core/ui/Draggable2\";\r\n\r\n\r\nexport default class TestDraggablePage {\r\n    load() {\r\n        this.drag1 = new Draggable2(\"#drag-example1\", {resistance: 0, delay: 0, scrollSpeed: 1000, container: ScrollArea('#ez1')});\r\n        this.drag2 = new Draggable2(\"#drag-example2\", {resistance: 0, delay: 0, container: ScrollArea('#ez2'), helper: clone(0.5), revert: true, revertDuration: 1000});\r\n        this.drag3 = new Draggable2(\"#drag-example3\", {resistance: 0, delay: 0, container: ScrollArea('#ez3'), revert: true, revertDuration: 1000});\r\n        this.drag4 = new Draggable2(\"#drag-example4\", {resistance: 0, delay: 0, container: ScrollArea('#ez4')});\r\n        this.drag5 = new Draggable2(\"#drag-example5\", {resistance: 0, delay: 0, container: ScrollArea('#ez5'), axis: 'x'});\r\n        this.drag6 = new Draggable2(\"#drag-example6\", {resistance: 0, delay: 0, container: ScrollArea('#ez6'), axis: 'y'});\r\n        this.drag7 = new Draggable2(\"#drag-example7\", {resistance: 0, delay: 0, container: ScrollArea('#ez7'), grid: 50});\r\n        this.drag8 = new Draggable2(\"#drag-example8\", {resistance: 0, delay: 0, container: ScrollArea('#ez8')});\r\n\r\n        let dz1 = document.querySelector('#dz1');\r\n\r\n        this.drag4.connect(dz1);\r\n\r\n        dz1.addEventListener('drag.enter', event => {\r\n            console.log(event);\r\n            dz1.classList.add('active');\r\n        });\r\n\r\n        dz1.addEventListener('drag.leave', event => {\r\n            console.log(event);\r\n            dz1.classList.remove('active');\r\n        });\r\n    }\r\n}\r\n","import {EASING} from \"./easing\";\r\nimport FX from \"./FX\";\r\nimport {defaultApplyFrame} from \"./frame\";\r\n\r\n\r\nexport default class Animation {\r\n    static defaultApplyFrame = defaultApplyFrame;\r\n\r\n    static complete = FX.complete;\r\n    static canceled = FX.canceled;\r\n    static paused = FX.paused;\r\n    static pending = FX.pending;\r\n    static error = FX.error;\r\n    static playing = FX.playing;\r\n\r\n    /**\r\n     *\r\n     * @param duration\r\n     * @param frames {{}|function(Element element, Animation animation):{}}\r\n     * @param applyFrame - The function that takes a frame and applies it to the element.\r\n     * @param bubbleFrameEvent\r\n     * @param finishFrame\r\n     */\r\n    constructor({duration=null, frames, applyFrame = defaultApplyFrame, bubbleFrameEvent = false, finishFrame = null}) {\r\n        this.frames = frames;\r\n        this.applyFrame = applyFrame || Animation.defaultApplyFrame;\r\n        this.bubbleFrameEvent = bubbleFrameEvent;\r\n        this.finishFrame = finishFrame;\r\n        this.duration = duration;\r\n    }\r\n\r\n    /**\r\n     * Creates an fx object.\r\n     *\r\n     * @param element\r\n     * @param frames\r\n     * @param duration\r\n     * @param applyFrame\r\n     * @param easing\r\n     * @param onStart\r\n     * @param onFrame\r\n     * @param onPause\r\n     * @param onCancel\r\n     * @param onEnd\r\n     * @param onComplete\r\n     * @param bubbleFrameEvent\r\n     * @param finishFrame\r\n     * @returns {FX}\r\n     */\r\n    init({element, frames, duration, applyFrame, easing, onStart, onFrame, onPause, onCancel, onEnd, onComplete, bubbleFrameEvent, finishFrame}) {\r\n        return new FX(element, frames, duration, {\r\n            applyFrame,\r\n            easing,\r\n            animation: this,\r\n            onStart,\r\n            onFrame,\r\n            onPause,\r\n            onCancel,\r\n            onEnd,\r\n            onComplete,\r\n            bubbleFrameEvent,\r\n            finishFrame,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Ran after the fx completes.\r\n     * @param fx\r\n     */\r\n    destroy(fx) {\r\n\r\n    }\r\n\r\n    /**\r\n     * Animates the given element.  Returns the FX object that can be used to control the animation.\r\n     *\r\n     * @param element {HTMLElement|Element} The element to animate.\r\n     * @param duration {Number} The duration of the animation in milliseconds.\r\n     * @param easing {function(Number)} An easing function that controls the rate of change for the animation.  If null linear animation is used.\r\n     * @param onStart {function(FX)} A callback function that is called right before the animation starts playing.\r\n     * @param onFrame {function(FX, frame)} A callback that is called per frame.\r\n     * @param onPause {function(FX)} A callback that is called when the FX pauses.\r\n     * @param onCancel {function(FX)} A callback that is called when the FX cancels.\r\n     * @param onEnd {function(FX)} A callback that is called when the animation ends.  Whether by completing, pausing, or canceling.  See Fx.status to determine what happened.\r\n     * @param onComplete {function(FX)} A callback that is called when the animation complete successfully.\r\n     * @param position\r\n     * @param autoPlay\r\n     * @returns {FX}\r\n     */\r\n    animate(element, {duration=null, easing = EASING.linear, onStart = null, onFrame = null, onPause = null, onCancel = null, onEnd = null, onComplete = null, position=0, autoPlay=true} = {}) {\r\n        if(duration === null) {\r\n            duration = this.duration;\r\n        }\r\n\r\n        let fx = this.init({\r\n            element: element,\r\n            frames: this.frames,\r\n            duration,\r\n            applyFrame: this.applyFrame,\r\n            easing,\r\n            animation: this,\r\n            onStart,\r\n            onFrame,\r\n            onPause,\r\n            onCancel,\r\n            onEnd: (fx) => {\r\n                if(onEnd) onEnd.call(fx, fx);\r\n                this.destroy(fx);\r\n            },\r\n            onComplete,\r\n            bubbleFrameEvent: this.bubbleFrameEvent,\r\n            finishFrame: this.finishFrame\r\n        });\r\n\r\n        if(position) {\r\n            fx.goto(position);\r\n        }\r\n\r\n        if(autoPlay) {\r\n            fx.play();\r\n        }\r\n        return fx;\r\n    }\r\n\r\n    goto(element, position) {\r\n        this.animate(element, {autoPlay: false, position: position});\r\n        return Animation.complete;\r\n    }\r\n\r\n    /**\r\n     * Creates a function that calls the animate method with the bound parameters.\r\n     * Parameters can be overridden in the created function when called.\r\n     * Method has the same signature as the animate method.\r\n     *\r\n     * Usage:\r\n     * let animation = new Animation(...),\r\n     *     fx = animation.bind(null, 2000);\r\n     *\r\n     * fx(element) // Animation the element over 2000 milliseconds.\r\n     *\r\n     * @param element\r\n     * @param config\r\n     * @returns {function(HTMLElement element, Number duration, Object config): FX}\r\n     */\r\n    bind(element = null, config = null) {\r\n        let defaults = {\r\n            element,\r\n            config\r\n        };\r\n\r\n        return (element = defaults, config=null) => {\r\n            element = element === defaults ? element.defaults : element;\r\n\r\n            let _options = {};\r\n            if (defaults.config) Object.assign(_options, defaults.config);\r\n            if (config) Object.assign(_options, config);\r\n\r\n            return this.animate(element, _options);\r\n        };\r\n    }\r\n}\r\n","import {ExtendableError} from \"../errors\";\r\nimport {selectElement} from \"../utility\";\r\nimport {RGBA} from \"../vectors\";\r\nimport {NumberWithUnit} from \"./types\";\r\nimport {EASING} from \"./easing\";\r\nimport {defaultApplyFrame} from \"./frame\";\r\n\r\n\r\nconst regNumberWithUnit = /^(\\d+\\.?\\d*)([a-z]+|%)$/i,\r\n    regColor = /^(?:#([a-f0-9]{3})|#([a-f0-9]{6})|#([a-f0-9]{8}))$/i,\r\n    regFunction = /^([a-z_][a-z_0-9]*)\\((.+?)\\)$/i;\r\n\r\n\r\nconst TYPE_FUNCTIONS = {\r\n    hex: RGBA.parseHexColorStringArg,\r\n    rgb: RGBA.parseRGBAColorStringArgs,\r\n    rgba: RGBA.parseRGBAColorStringArgs\r\n};\r\n\r\n\r\nexport class DeadFXError extends ExtendableError {}\r\n\r\n\r\nfunction assertFXAlive(fx) {\r\n    if (fx.status === FX.complete || fx.status === FX.error || fx.status === FX.complete) {\r\n        throw new DeadFXError(\"FX object is dead.\");\r\n    }\r\n}\r\n\r\n\r\nfunction doPromiseAction(onAction, value, resolveOrReject) {\r\n    if (typeof onAction === 'function') {\r\n        value = onAction(value);\r\n    }\r\n\r\n    resolveOrReject(value);\r\n}\r\n\r\n\r\nfunction _prepareValue(value) {\r\n    if (typeof value === 'string') {\r\n        value = value.trim();\r\n\r\n        let m = regNumberWithUnit.exec(value);\r\n\r\n        if (m) {\r\n            return new NumberWithUnit(parseFloat(m[1]), m[2]);\r\n        }\r\n\r\n        m = regColor.exec(value);\r\n\r\n        if (m) {\r\n            return TYPE_FUNCTIONS.hex(m[0]);\r\n        }\r\n\r\n        m = regFunction.exec(value);\r\n\r\n        if (m) {\r\n            return TYPE_FUNCTIONS[m[1]](m[2]);\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\nfunction _getFrames(fx, element, frames) {\r\n    let r = {};\r\n\r\n    if (typeof frames === 'function') {\r\n        frames = frames.call(fx, element, fx);\r\n    }\r\n\r\n    for (let keyframeIndex in frames) {\r\n        if (!frames.hasOwnProperty(keyframeIndex)) continue;\r\n\r\n        let frame = frames[keyframeIndex];\r\n        r[keyframeIndex] = {};\r\n\r\n        for (let property in frame) {\r\n            if (!frame.hasOwnProperty(property)) continue;\r\n            r[keyframeIndex][property] = _prepareValue(frame[property]);\r\n        }\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * @implements Promise\r\n */\r\nexport default class FX {\r\n    static pending = \"Pending\";\r\n    static complete = \"Complete\";\r\n    static error = \"Error\";\r\n    static paused = \"Paused\";\r\n    static canceled = \"Canceled\";\r\n    static playing = \"Playing\";\r\n\r\n    #element;\r\n    #chained;\r\n    #frames;\r\n    #internalValue;\r\n\r\n    #animation;\r\n\r\n    #frameId;\r\n    #status;\r\n    #position;\r\n\r\n    #finishFrame;\r\n    #applyFrame;\r\n    #easing;\r\n    #duration;\r\n\r\n    [Symbol.toStringTag] = \"[Object FX]\";\r\n\r\n    constructor(element, frames, duration, {applyFrame = defaultApplyFrame, animation = null, easing = EASING.linear, onComplete = null, onCancel = null, onFrame = null, onStart = null, onEnd = null, bubbleFrameEvent = false, finishFrame = null, init = null} = {}) {\r\n        this.#frames = [];\r\n        this.#chained = [];\r\n        this.#element = selectElement(element);\r\n        this.#internalValue = undefined;\r\n\r\n        this.onComplete = onComplete;\r\n        this.onCancel = onCancel;\r\n        this.onFrame = onFrame;\r\n        this.onStart = onStart;\r\n        this.onEnd = onEnd;\r\n        this.bubbleFrameEvent = bubbleFrameEvent;\r\n\r\n        this.#animation = animation;\r\n        this.#finishFrame = finishFrame;\r\n        this.#applyFrame = applyFrame;\r\n        this.#easing = easing;\r\n        this.#frameId = null;\r\n        this.#status = FX.pending;\r\n\r\n        this.#duration = duration;\r\n        this.#position = 0;\r\n\r\n        if (init) {\r\n            init.call(this, this);\r\n        }\r\n\r\n        // Prepare frames\r\n        frames = _getFrames(this, this.#element, frames);\r\n\r\n        for (let key in frames) {\r\n            if (frames.hasOwnProperty(key)) {\r\n                let frame = frames[key],\r\n                    pos = parseFloat(key) / 100;\r\n\r\n                if (typeof frame === 'function') {\r\n                    frame = frame.call(this, this.#element);\r\n                }\r\n\r\n                frame = Object.freeze(Object.assign({}, frame));\r\n\r\n                this.#frames.push(Object.freeze({\r\n                    position: pos,\r\n                    properties: frame\r\n                }));\r\n            }\r\n        }\r\n\r\n        this.#frames.sort((a, b) => a.position - b.pos);\r\n    }\r\n\r\n    get animation() {\r\n        return this.#animation;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get easing() {\r\n        return this.#easing;\r\n    }\r\n\r\n    get status() {\r\n        return this.#status;\r\n    }\r\n\r\n    get position() {\r\n        return this.#position;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get duration() {\r\n        return this.#duration;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get frames() {\r\n        return this.#frames.slice();\r\n    }\r\n\r\n    get element() {\r\n        return this.#element;\r\n    }\r\n\r\n    // set position(value) {\r\n    //     if (typeof value === 'string') {\r\n    //         value = (parseFloat(value) / 100) * this.#duration;\r\n    //     }\r\n    //\r\n    //     this.#position = Math.max(0.0, Math.min(this.#duration, value));\r\n    // }\r\n\r\n    get state() {\r\n        if (this.status === FX.complete || this.status === FX.canceled) {\r\n            return \"Fulfilled\";\r\n        } else if (this.status === FX.error) {\r\n            return \"Rejected\";\r\n        } else {\r\n            return \"Pending\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the frame options at the given position.\r\n     * @param position\r\n     */\r\n    getFrameFX(position) {\r\n        // position can either be a percentage string (aka 50%) or the time in milliseconds into the animation\r\n        // which will be converted into a percentage.\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        // At this point position should be a value between 0.0 and 1.0.\r\n        // Easing functions specify that rate of change in the properties.\r\n        // It takes the position and maps it to another value between 0.0f and 1.0f.\r\n        // By default linear easing is used.\r\n        if (this.#easing) {\r\n            position = this.#easing(position);\r\n        }\r\n\r\n        let r = {};\r\n\r\n        for (let frame of this.#frames) {\r\n            for (let key in frame.properties) {\r\n                if (frame.properties.hasOwnProperty(key)) {\r\n                    let value = frame.properties[key];\r\n\r\n                    if (!r[key]) {\r\n                        r[key] = {startPosition: null, startValue: null, endPosition: null, endValue: null};\r\n                    }\r\n\r\n                    if (frame.position <= position) {\r\n                        r[key].startPosition = frame.position;\r\n                        r[key].startValue = value;\r\n                    } else if (frame.position > position && r[key].endPosition === null) {\r\n                        r[key].endPosition = frame.position;\r\n                        r[key].endValue = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Returns the final frame at the given position.  All options at this point should be parsed and there final values\r\n     * should be available.\r\n     *\r\n     * @param position\r\n     */\r\n    getFrame(position) {\r\n        let frame = this.getFrameFX(position),\r\n            r = {};\r\n\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        // Takes the frame config options and calculates the final values.\r\n        for (let property in frame) {\r\n            if (frame.hasOwnProperty(property)) {\r\n                let options = frame[property];\r\n\r\n                if ((options.endPosition === null || options.endPosition <= position) && options.startValue !== null) {\r\n                    r[property] = options.startValue;\r\n                } else if (options.startValue !== null) {\r\n                    if (typeof options.startValue === 'object') {\r\n                        let p = (position - options.startPosition) / (options.endPosition - options.startPosition),\r\n                            delta = options.endValue.subtract(options.startValue);\r\n\r\n                        r[property] = options.startValue.add(delta.scalar(p));\r\n                    } else if (typeof options.startValue === 'number') {\r\n                        let duration = (options.endPosition - options.startPosition),\r\n                            p = (position - options.startPosition) / duration,\r\n                            delta = options.endValue - options.startValue;\r\n\r\n                        r[property] = options.startValue + (delta * p);\r\n                    } else {\r\n                        r[property] = options.startValue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // User provided hook that can perform the final touch ups on the frame.\r\n        if (this.#finishFrame) {\r\n            r = this.#finishFrame(this, frame);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    play() {\r\n        assertFXAlive(this);\r\n\r\n        if (this.#frameId === null) {\r\n            this.goto(this.#position);\r\n\r\n            let tick = performance.now();\r\n\r\n            let frameFN = () => {\r\n                let timestamp = performance.now(),\r\n                    delta = timestamp - tick,\r\n                    position = this.#position + (delta / this.duration);\r\n\r\n                tick = timestamp;\r\n                let frame = this.goto(position);\r\n                this.#status = FX.playing;\r\n\r\n                if (this.onFrame) this.onFrame.call(this, this, frame);\r\n\r\n                this.#element.dispatchEvent(new CustomEvent('animation.frame', {\r\n                    bubbles: this.bubbleFrameEvent,\r\n                    detail: this\r\n                }));\r\n\r\n                if (this.#position < 1) {\r\n                    this.#frameId = window.requestAnimationFrame(frameFN);\r\n                } else {\r\n                    this._complete(FX.complete, FX.complete);\r\n                    this.#frameId = null;\r\n                }\r\n            };\r\n\r\n            if (this.onStart) {\r\n                this.onStart.call(this, this);\r\n            }\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.start', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n\r\n            this.#frameId = window.requestAnimationFrame(frameFN);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Pauses the animation.  Does not resolve it.\r\n     * @returns {FX}\r\n     */\r\n    pause() {\r\n        if (this.#frameId) {\r\n            window.cancelAnimationFrame(this.#frameId);\r\n            this.#frameId = null;\r\n            this.#status = FX.paused;\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.paused', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    _cancel(complete = false, status = FX.canceled) {\r\n        if (this.#frameId) {\r\n            window.cancelAnimationFrame(this.#frameId);\r\n            this.#frameId = null;\r\n\r\n            if (complete) {\r\n                this.goto(1);\r\n                this._complete(status, status);\r\n            } else {\r\n                this.#status = status;\r\n                this.#internalValue = status;\r\n            }\r\n\r\n            if (this.onCancel) this.onCancel.call(this, this);\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.canceled', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n\r\n            this._triggerEndEvent();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Cancel the animation with the canceled state.   optionally sets the animation to it's final frame if\r\n     * completeAnimation is true.\r\n     *\r\n     * @param completeAnimation\r\n     * @returns {FX}\r\n     */\r\n    cancel(completeAnimation = false) {\r\n        return this._cancel(completeAnimation, FX.canceled);\r\n    }\r\n\r\n    /**\r\n     * Completes the animation immediately and sets is status to complete.\r\n     * @returns {FX}\r\n     */\r\n    complete() {\r\n        return this._cancel(true, FX.complete);\r\n    }\r\n\r\n    goto(position) {\r\n        assertFXAlive(this);\r\n\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        this.#position = position;\r\n        return this.applyFrame(this.position);\r\n    }\r\n\r\n    applyFrame(position) {\r\n        let frame = this.getFrame(position);\r\n        this.#applyFrame.call(this, this, frame);\r\n        return frame;\r\n    }\r\n\r\n    _triggerEndEvent() {\r\n        if (this.onEnd) this.onEnd.call(this, this);\r\n\r\n        this.#element.dispatchEvent(new CustomEvent('animation.end', {\r\n            bubbles: true,\r\n            detail: this\r\n        }));\r\n\r\n        for (let {onResolve} of this.#chained) {\r\n            if (onResolve) onResolve(this.#internalValue);\r\n        }\r\n        this.#chained = [];\r\n    }\r\n\r\n    _complete(value, status = FX.complete) {\r\n        if (this.state !== \"Pending\") {\r\n            return;\r\n        }\r\n\r\n        this.#status = status;\r\n        this.#internalValue = value;\r\n\r\n        if (this.onComplete) this.onComplete.call(this, this);\r\n\r\n        this.#element.dispatchEvent(new CustomEvent('animation.complete', {\r\n            bubbles: true,\r\n            detail: this\r\n        }));\r\n\r\n        this._triggerEndEvent();\r\n    }\r\n\r\n    then(onResolve, onReject) {\r\n        if (this.state === \"Pending\") {\r\n            return new Promise((resolve, reject) => {\r\n                // noinspection JSUnusedGlobalSymbols\r\n                this.#chained.push({\r\n                    onResolve: (value) => {\r\n                        doPromiseAction(onResolve, value, resolve);\r\n                    },\r\n\r\n                    onReject: (value) => {\r\n                        doPromiseAction(onReject, value, reject);\r\n                    }\r\n                });\r\n            });\r\n        } else if (this.state === 'Fulfilled' && typeof onResolve === 'function') {\r\n            return new Promise((resolve) => {\r\n                doPromiseAction(onResolve, this.#internalValue, resolve);\r\n            });\r\n        } else if (this.state === 'Rejected' && typeof onReject === 'function') {\r\n            return new Promise((resolve, reject) => {\r\n                doPromiseAction(onReject, this.#internalValue, reject);\r\n            });\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    finally(onFinally) {\r\n        onFinally = (value) => {\r\n            if (typeof onFinally === 'function') {\r\n                onFinally();\r\n            }\r\n\r\n            return value;\r\n        };\r\n\r\n        return this.then(onFinally, onFinally);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    catch(onReject) {\r\n        return this.then(undefined, onReject);\r\n    }\r\n}\r\n","/**\r\n *\r\n * @param p\r\n * @returns {*}\r\n */\r\nexport function linear(p) {\r\n    return p;\r\n}\r\n\r\n\r\n// noinspection JSUnusedGlobalSymbols\r\nexport const EASING = {\r\n    linear: linear\r\n};\r\n","export function defaultApplyFrame(fx, frame) {\r\n    for (let key in frame) {\r\n        if (frame.hasOwnProperty(key)) {\r\n            fx.element.style[key] = frame[key].toString();\r\n        }\r\n    }\r\n}\r\n","export class NumberWithUnit {\r\n    constructor(value, unit) {\r\n        this.value = value;\r\n        this.unit = unit;\r\n    }\r\n\r\n    add(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n\r\n        return new NumberWithUnit(this.value + value, this.unit);\r\n    }\r\n\r\n    subtract(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value - value, this.unit);\r\n    }\r\n\r\n    scalar(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value * value, this.unit);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    divide(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value / value, this.unit);\r\n    }\r\n\r\n    toString() {\r\n        return `${this.value}${this.unit}`;\r\n    }\r\n}\r\n","import Publisher from \"../Publisher\";\r\nimport {calcDistance, clamp} from \"../utility\";\r\nimport Rect from \"../vectors/Rect\";\r\nimport {getScroll} from \"../utility\";\r\nimport {setElementClientPosition} from \"./position\";\r\nimport Animation from \"../fx/Animation\";\r\n\r\n\r\nconst startingPosMap = new WeakMap();\r\n\r\n\r\nexport function cursor(target, event) {\r\n    let rect = new Rect(target);\r\n\r\n    return {\r\n        x: event.clientX - rect.left,\r\n        y: event.clientY - rect.top\r\n    };\r\n}\r\n\r\n\r\nexport const TOLERANCE = {\r\n    intersect(element, rect) {\r\n        let targetRect = new Rect(element);\r\n\r\n        return targetRect.isOverlapping(rect);\r\n    }\r\n};\r\n\r\n\r\nexport default class Draggable2 extends Publisher {\r\n    #element;\r\n    #droppables;\r\n    #boundOnMouseDown;\r\n    #revertFX;\r\n    #isDragging;\r\n\r\n    constructor(element, {container=null, axis='xy', exclude='', delay=0, offset=cursor,\r\n        resistance=0, handle=null, helper=null, revert=false, revertDuration=0,\r\n        scrollSpeed=0, selector=null, tolerance='intersect', setHelperSize=false, grid=null}={}) {\r\n        super();\r\n\r\n        if(typeof element === 'string') {\r\n            this.#element = document.querySelector(element);\r\n        } else {\r\n            this.#element = element;\r\n        }\r\n\r\n        this.#droppables = [];\r\n        this.#revertFX = null;\r\n        this.#isDragging = false;\r\n\r\n        this.container = container;\r\n        this.axis = axis;\r\n        this.exclude = exclude;\r\n        this.delay = delay;\r\n        this.offset = offset;\r\n        this.resistance = resistance;\r\n        this.handle = handle;\r\n        this.helper = helper;\r\n        this.revert = revert;\r\n        this.revertDuration = revertDuration;\r\n        this.scrollSpeed = scrollSpeed;\r\n        this.selector = selector;\r\n        this.tolerance = tolerance;\r\n        this.setHelperSize = setHelperSize;\r\n        this.grid = grid;\r\n\r\n        if(typeof this.container === 'string') {\r\n            this.container = document.querySelector(this.container);\r\n        }\r\n\r\n        this.#boundOnMouseDown = event => {\r\n            return this.onMouseDown(event);\r\n        };\r\n\r\n        this.element.addEventListener('mousedown', this.#boundOnMouseDown);\r\n    }\r\n\r\n    /**\r\n     * Starts dragging if the correct elements have been targeted and delay and resistance have been meet.\r\n     *\r\n     * @param event\r\n     * @returns {Promise<void>}\r\n     */\r\n    async onMouseDown(event) {\r\n        let startPosition = {x: event.clientX + window.pageXOffset, y: event.clientY + window.pageYOffset},\r\n            currentPosition = {x: startPosition.x, y: startPosition.y},\r\n            target = this.#element,\r\n            cancelMouseTracking = null,\r\n            cancelTimer = null,\r\n            distanceBrokenPromise,\r\n            timerPromise,\r\n            offset;\r\n\r\n        // Only start dragging if a draggable child of the element is targeted.\r\n        // If selector is null then the entire element is draggable and should be the target.\r\n        if(this.selector) {\r\n            target = event.target.closest(this.selector);\r\n\r\n            if(!target || !this.#element.contains(target)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Only start dragging if the handle was targeted.\r\n        // If handle is null then the entire target is the handle.\r\n        if(this.handle) {\r\n            let handle = event.target.closest(this.handle);\r\n\r\n            if(!handle || !target.contains(handle)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // If any excluded elements are targeted ignore the event.\r\n        if(this.exclude) {\r\n            let exclude = event.target.closest(this.exclude);\r\n\r\n            if(exclude && target.contains(exclude)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Find the offset of the event.\r\n        if(typeof this.offset === 'function') {\r\n            offset = this.offset(target, event);\r\n        } else if(Array.isArray(this.offset)) {\r\n            offset = {\r\n                x: this.offset[0],\r\n                y: this.offset[1]\r\n            };\r\n        } else if(typeof this.offset === 'object') {\r\n            offset = {\r\n                x: this.offset.x,\r\n                y: this.offset.y\r\n            };\r\n        } else {\r\n            offset = {x: 0, y: 0};\r\n        }\r\n\r\n        // Prevent default browser actions.\r\n        event.preventDefault();\r\n\r\n        // At this point we can be sure that a draggable item was\r\n        // targeted by it's handle and no excluded items where clicked.\r\n\r\n        // Creates a promise that both tracks the current mouse coords and resolve\r\n        // when the user passes the given resistance.\r\n        distanceBrokenPromise = new Promise(resolve => {\r\n            let isDistanceBroken = this.resistance <= 0;\r\n\r\n            if(isDistanceBroken) {\r\n                resolve('complete');\r\n            }\r\n\r\n            let onMouseMove = event => {\r\n                currentPosition.x = event.clientX + window.pageXOffset;\r\n                currentPosition.y = event.clientY + window.pageYOffset;\r\n                event.preventDefault();\r\n\r\n                if(!isDistanceBroken && calcDistance(currentPosition.x, currentPosition.y, startPosition.x, startPosition.y) > this.resistance) {\r\n                    resolve('complete');\r\n                    isDistanceBroken = true;\r\n                }\r\n            };\r\n\r\n            // Cancel mouse tracking and resolve the promise to canceled if hasn't already been resolve.\r\n            // This function must be called or their will be a memory leak before onMouseDown completes.\r\n            cancelMouseTracking = () => {\r\n                if(onMouseMove) {\r\n                    document.removeEventListener('mousemove', onMouseMove);\r\n\r\n                    if(!isDistanceBroken) {\r\n                        resolve('canceled');\r\n                    }\r\n\r\n                    onMouseMove = null;\r\n                }\r\n            };\r\n\r\n            document.addEventListener('mousemove', onMouseMove);\r\n        });\r\n\r\n        // Creates a promise that resolve when after the delay time passes or the user cancels the drag by\r\n        // releasing the mouse button.\r\n        timerPromise = new Promise(resolve => {\r\n            let timer = null;\r\n\r\n            if(this.delay >= 0) {\r\n                timer = setTimeout(() => {\r\n                    resolve(\"complete\");\r\n                    timer = null;\r\n                }, this.delay);\r\n            } else {\r\n                resolve('complete');\r\n            }\r\n\r\n            // cancel the timer and resolve it to canceled if it is still active.\r\n            cancelTimer = () => {\r\n                if(timer) {\r\n                    clearTimeout(timer);\r\n                    resolve('canceled');\r\n                }\r\n            };\r\n        });\r\n\r\n        // cancel the timer and mouse tracking if they are still active.\r\n        let onMouseUp = event => {\r\n            event.preventDefault();\r\n            cancelTimer();\r\n            cancelMouseTracking();\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n        };\r\n\r\n        document.addEventListener('mouseup', onMouseUp);\r\n\r\n        // Wait until the delay time and distance have passed or failed.\r\n        let [timerStatus, distanceStatus] = await Promise.all([timerPromise, distanceBrokenPromise]);\r\n\r\n        // Ensure that mouse tracking has been canceled.\r\n        if(cancelMouseTracking) cancelMouseTracking();\r\n\r\n        // At this point both the timer and distance status should have passed or failed.\r\n        // If either failed do nothing.\r\n        if(timerStatus === 'complete' && distanceStatus === 'complete') {\r\n            this.startDragging(target, {\r\n                offsetX: offset.x,\r\n                offsetY: offset.y,\r\n                // Make relative to client.\r\n                startingX: currentPosition.x,\r\n                startingY: currentPosition.y\r\n            });\r\n        }\r\n    }\r\n\r\n    startDragging(element, pos) {\r\n        if(this.#isDragging) {\r\n            return;\r\n        }\r\n\r\n        this.#isDragging = true;\r\n\r\n        if(this.#revertFX) {\r\n            this.#revertFX.cancel();\r\n            this.#revertFX = null;\r\n        }\r\n\r\n        let target = element,\r\n            container = this.container,\r\n            scroller = null,\r\n            dropTargets = [],\r\n            startPosition = new Rect(element);\r\n\r\n        startPosition = startPosition.translate(\r\n            window.pageXOffset,\r\n            window.pageYOffset\r\n        );\r\n\r\n        if(!startingPosMap.get(element)) {\r\n            startingPosMap.set(element, startPosition);\r\n        }\r\n\r\n        if(typeof container === 'string') {\r\n            container = document.querySelector(container);\r\n        }\r\n\r\n        if(this.helper) {\r\n            if(typeof this.helper === 'function') {\r\n                target = this.helper(element);\r\n            } else {\r\n                target = this.helper;\r\n            }\r\n\r\n            if(this.setHelperSize) {\r\n                target.style.width = startPosition.width + \"px\";\r\n                target.style.height = startPosition.height + \"px\";\r\n            }\r\n\r\n            target.style.pointerEvents = 'none';\r\n        }\r\n\r\n        if(target !== element && !target.parentElement && element.parentElement) {\r\n            element.parentElement.appendChild(target);\r\n        }\r\n\r\n        let onMouseMove = event => {\r\n            event.preventDefault();\r\n            let rect = _moveElementToPosition(this, target, event.clientX, event.clientY, pos.offsetX, pos.offsetY, _selectElementRect(container, this, target, element));\r\n\r\n            if(this.scrollSpeed > 0) {\r\n                if(scroller) {\r\n                    scroller.cancel();\r\n                    scroller = null;\r\n                }\r\n\r\n                scroller = ScrollHelper.buildScrollHelper(element, target, rect, pos, this, event, this.scrollSpeed, container);\r\n            }\r\n\r\n            // drag-enter\r\n            let currentDropTargets = this.getDropTargets(rect, {mouseX: event.clientX, mouseY: event.clientY});\r\n\r\n            for(let dropTarget of currentDropTargets) {\r\n                if(dropTargets.indexOf(dropTarget) === -1) {\r\n                    _dispatchDropEvent(this, dropTarget, 'drag.enter', {bubbles: true, detail: {clientX: event.clientX, clientY: event.clientY, target, element, originalEvent: event}});\r\n                }\r\n            }\r\n\r\n            for(let dropTarget of dropTargets) {\r\n                if(currentDropTargets.indexOf(dropTarget) === -1) {\r\n                    _dispatchDropEvent(this, dropTarget, 'drag.leave', {bubbles: false, detail: {clientX: event.clientX, clientY: event.clientY, target, element, originalEvent: event}});\r\n                }\r\n            }\r\n\r\n            // drag-leave\r\n            dropTargets = currentDropTargets;\r\n\r\n            this.publish('drag.move', {\r\n                draggable: this,\r\n                name: 'drag.enter',\r\n                target: target,\r\n                element: element,\r\n                originalEvent: event,\r\n                clientX: event.clientX,\r\n                clientY: event.clientY\r\n            });\r\n        };\r\n\r\n        let onMouseUp = async event => {\r\n            event.preventDefault();\r\n            document.removeEventListener('mousemove', onMouseMove);\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n\r\n            if(scroller) {\r\n                scroller.cancel();\r\n                scroller = null;\r\n            }\r\n\r\n            dropTargets = this.getDropTargets();\r\n            let accepted = false,\r\n                isDefaultPrevented = false,\r\n                reverted = false;\r\n\r\n            this.publish('drag.drop', {\r\n                name: 'drag.drop',\r\n                draggable: this,\r\n                target,\r\n                element,\r\n                originalEvent: event,\r\n                clientX: event.clientX,\r\n                clientY: event.clientY,\r\n\r\n                isDefaultPrevented() {\r\n                    return isDefaultPrevented;\r\n                },\r\n\r\n                isAccepted() {\r\n                    return accepted;\r\n                },\r\n\r\n                accept() {\r\n                    accepted = true;\r\n                },\r\n\r\n                preventDefault() {\r\n                    isDefaultPrevented = true;\r\n                }\r\n            });\r\n\r\n            if(this.revert && !accepted) {\r\n                if(!this.revertDuration) {\r\n                    if(target !== element) {\r\n                        target.parentElement.removeChild(target);\r\n                    } else {\r\n                        let pos = startPosition.translate(\r\n                            -window.pageXOffset,\r\n                            -window.pageYOffset\r\n                        );\r\n\r\n                        setElementClientPosition(target, pos, 'translate3d');\r\n                    }\r\n\r\n                    startingPosMap.delete(element);\r\n                } else {\r\n                    let pos = startingPosMap.get(element);\r\n\r\n                    this.#revertFX = _revert(target, pos, this.revertDuration);\r\n\r\n                    if(await this.#revertFX === Animation.complete) {\r\n                        startingPosMap.delete(element);\r\n                    }\r\n\r\n                    this.#revertFX = null;\r\n\r\n                    if(target !== element) {\r\n                        target.parentElement.removeChild(target);\r\n                        startingPosMap.delete(element); // don't need to save.\r\n                    }\r\n                }\r\n\r\n                reverted = true;\r\n            } else {\r\n                if(target !== element) {\r\n                    target.parentElement.removeChild(target);\r\n                }\r\n\r\n                if(isDefaultPrevented) _moveElementToPosition(this, element, event.clientX, event.clientY, pos.offsetX, pos.offsetY, _selectElementRect(container, this, target, element));\r\n                startingPosMap.delete(element);\r\n            }\r\n\r\n            this.publish('drag.end', {\r\n                draggable: this,\r\n                name: 'drag.end',\r\n                target: target,\r\n                element: element,\r\n                originalEvent: event,\r\n                clientX: event.clientX,\r\n                clientY: event.clientY,\r\n                accepted: accepted,\r\n                reverted: reverted\r\n            });\r\n        };\r\n\r\n        // Set target to starting position.\r\n        if(pos.startingX !== undefined && pos.startingY !== undefined) {\r\n            let rect = _moveElementToPosition(this, target, pos.startingX - window.pageXOffset, pos.startingY - window.pageYOffset, pos.offsetX, pos.offsetY, _selectElementRect(container, this, target, element));\r\n            dropTargets = this.getDropTargets(rect, {mouseX: pos.startingX - window.pageXOffset, mouseY: pos.startingY - window.pageYOffset});\r\n\r\n            for(let dropTarget of dropTargets) {\r\n                _dispatchDropEvent(this, dropTarget, 'drag.enter', {bubbles: true, detail: {initial: true, clientX: pos.startingX - window.pageXOffset, clientY: pos.startingY - window.pageYOffset, target, element}});\r\n            }\r\n        }\r\n\r\n        document.addEventListener('mousemove', onMouseMove);\r\n        document.addEventListener('mouseup', onMouseUp);\r\n        this.#isDragging = false;\r\n\r\n        this.publish('drag.start', {\r\n            draggable: this,\r\n            element,\r\n            target,\r\n            clientX: pos.startingX - window.pageXOffset,\r\n            clientY: pos.startingY - window.pageYOffset,\r\n            name: 'drag.start',\r\n            originalEvent: null\r\n        });\r\n    }\r\n\r\n    getDropTargets(rect, mousePos) {\r\n        let r = [];\r\n\r\n        let testFunction = this.tolerance;\r\n\r\n        if(typeof testFunction === 'string') {\r\n            testFunction = TOLERANCE[testFunction];\r\n        }\r\n\r\n        for(let droppable of this.#droppables) {\r\n            if(testFunction(droppable, rect, mousePos, this)) {\r\n                r.push(droppable);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    connect(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        this.#droppables.push(droppable);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    disconnect(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        let i = this.#droppables.indexOf(droppable);\r\n\r\n        if(i !== -1) {\r\n            this.#droppables.splice(i, 1);\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    hasDroppable(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        return this.#droppables.indexOf(droppable) !== -1;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get droppables() {\r\n        return this.#droppables.slice(0);\r\n    }\r\n\r\n    get element() {\r\n        return this.#element;\r\n    }\r\n}\r\n\r\n\r\nfunction _dispatchDropEvent(self, target, name, options) {\r\n    let customEvent = new CustomEvent(name, {\r\n        bubbles: options.bubble,\r\n\r\n        detail: {\r\n            name,\r\n            target,\r\n            draggable: self,\r\n            ...options.detail\r\n        }\r\n    });\r\n\r\n    target.dispatchEvent(customEvent);\r\n}\r\n\r\n\r\nfunction _revert(target, position, revertDuration) {\r\n    let starting = new Rect(target);\r\n\r\n    let animation = new Animation({\r\n        frames: {\r\n            '0%': {\r\n                left: starting.left + window.pageXOffset,\r\n                top: starting.top + window.pageYOffset\r\n            },\r\n\r\n            '100%': {\r\n                left: position.left,\r\n                top: position.top\r\n            }\r\n        },\r\n\r\n        applyFrame(fx, frame) {\r\n            setElementClientPosition(fx.element, {\r\n                left: frame.left - window.pageXOffset,\r\n                top: frame.top - window.pageYOffset\r\n            }, 'translate3d');\r\n        }\r\n    });\r\n\r\n    return animation.animate(target, {duration: revertDuration});\r\n}\r\n\r\n\r\n/**\r\n * Takes a client (x, y) position and some offset coords and move the element to the given position.\r\n *\r\n * @param self\r\n * @param element\r\n * @param x\r\n * @param y\r\n * @param offsetX\r\n * @param offsetY\r\n * @param container\r\n * @private\r\n * @returns {*|Rect}\r\n */\r\nfunction _moveElementToPosition(self, element, x, y, offsetX, offsetY, container) {\r\n    let rect = new Rect(element),\r\n        startingRect = rect;\r\n\r\n    rect = rect.moveTo({left: x, top: y});\r\n\r\n    offsetX = offsetX || 0;\r\n    offsetY = offsetY || 0;\r\n\r\n    rect = rect.translate(-offsetX, -offsetY);\r\n\r\n    if(self.axis === 'y') {\r\n        rect = new Rect(\r\n            startingRect.left,\r\n            rect.top,\r\n            startingRect.right,\r\n            rect.bottom\r\n        );\r\n    } else if(self.axis === 'x') {\r\n        rect = new Rect(\r\n            rect.left,\r\n            startingRect.top,\r\n            rect.right,\r\n            startingRect.bottom\r\n        );\r\n    }\r\n\r\n    if(typeof self.grid === 'number' && self.grid) {\r\n        let left = Math.floor(rect.left / self.grid) * self.grid,\r\n            top = Math.floor(rect.top / self.grid) * self.grid;\r\n\r\n        rect = new Rect(left, top, left + startingRect.width, top + startingRect.height);\r\n    }\r\n\r\n    if(container) {\r\n        container = new Rect(container);\r\n        rect = rect.fit(container);\r\n    }\r\n\r\n    setElementClientPosition(element, rect, 'translate3d');\r\n    return rect;\r\n}\r\n\r\n\r\n// noinspection JSCommentMatchesSignature\r\n/**\r\n * For module use only.  Selects the element either by css selector, if it's a string, or resolve a function.\r\n * If the element is already element is is returned direction.  Returns null if not element is provided.\r\n *\r\n * @param element\r\n * @param dragInstance\r\n * @param target\r\n * @returns {null|*}\r\n * @private\r\n */\r\nfunction _selectElementRect(element, dragInstance, target, originalTarget) {\r\n    if(element) {\r\n        let type = typeof element;\r\n\r\n        if(type === 'function') {\r\n            return new Rect(element.call(dragInstance, target, originalTarget, dragInstance));\r\n        } else if(type === 'string') {\r\n            return new Rect(document.querySelector(element));\r\n        }\r\n\r\n        return new Rect(element);\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\n/**\r\n * Returns the first scrollable parent.\r\n *\r\n * @param element\r\n * @returns {HTMLElement|null}\r\n * @private\r\n */\r\nfunction _getScrollParent(element) {\r\n    let o = element.parentElement;\r\n\r\n    while(o) {\r\n        if (o.scrollWidth > o.clientWidth || o.scrollHeight > o.clientHeight) {\r\n            return o;\r\n        }\r\n\r\n        o = o.parentElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\n/**\r\n * Helper class that is used to control scrolling when the element is dragged outside of bounds.\r\n */\r\nclass ScrollHelper {\r\n    constructor(element, scrollXSpeed=0, scrollYSpeed=0, onFrame=null) {\r\n        this.frameID = null;\r\n        this.element = element;\r\n        this.scrollXSpeed = scrollXSpeed;\r\n        this.scrollYSpeed = scrollYSpeed;\r\n        this.onFrame = onFrame;\r\n        this.timestamp = performance.now();\r\n\r\n        let frame = timestamp => {\r\n            let delta = (timestamp - this.timestamp) / 1000;\r\n\r\n            this.timestamp = timestamp;\r\n\r\n            this.element.scrollLeft += delta * this.scrollXSpeed;\r\n            this.element.scrollTop += delta * this.scrollYSpeed;\r\n\r\n            if(this.onFrame) {\r\n                this.onFrame(this);\r\n            }\r\n\r\n            this.frameID = window.requestAnimationFrame(frame);\r\n        };\r\n\r\n        this.frameID = window.requestAnimationFrame(frame);\r\n    }\r\n\r\n    cancel() {\r\n        if(this.frameID) {\r\n            window.cancelAnimationFrame(this.frameID);\r\n            this.frameID = null;\r\n        }\r\n    }\r\n\r\n    static getScrollSpeed(rect, scrollParentRect) {\r\n        let r = {x: 0, y: 0};\r\n\r\n        if(rect.right > scrollParentRect.right) {\r\n            r.x = clamp((rect.right - scrollParentRect.right) / rect.width, -1, 1);\r\n        } else if(rect.left < scrollParentRect.left) {\r\n            r.x = clamp((rect.left - scrollParentRect.left) / rect.width, -1, 1);\r\n        }\r\n\r\n        if(rect.bottom > scrollParentRect.bottom) {\r\n            r.y = clamp((rect.bottom - scrollParentRect.bottom) / rect.width, -1, 1);\r\n        } else if(rect.top < scrollParentRect.top) {\r\n            r.y = clamp((rect.top - scrollParentRect.top) / rect.width, -1, 1);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static buildScrollHelper(element, target, rect, pos, dragInstance, event, scrollSpeed, container) {\r\n        let scrollParent = _getScrollParent(element);\r\n\r\n        if(scrollParent) {\r\n            let scrollParentRect = new Rect(scrollParent),\r\n                speed = ScrollHelper.getScrollSpeed(rect, scrollParentRect);\r\n\r\n            if(speed.x || speed.y) {\r\n                return new ScrollHelper(scrollParent, speed.x * scrollSpeed, speed.y * scrollSpeed, (scroller) => {\r\n                    let rect = _moveElementToPosition(this, target, event.clientX, event.clientY, pos.offsetX, pos.offsetY, _selectElementRect(container, dragInstance, target, element));\r\n\r\n                    let scrollRect = new Rect(scroller.element);\r\n\r\n                    setElementClientPosition(target, rect, 'translate3d');\r\n\r\n                    if(scrollRect.contains(rect)) {\r\n                        scroller.cancel();\r\n                        scroller = null;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function ScrollArea(selector) {\r\n    return function() {\r\n        let element = selector;\r\n\r\n        if(typeof element === 'string') {\r\n            element = document.querySelector(element);\r\n        }\r\n\r\n        let rect = new Rect(element),\r\n            scroll = getScroll(element);\r\n\r\n        rect.left -= scroll.scrollLeft;\r\n        rect.top -= scroll.scrollTop;\r\n        rect.right = rect.left + element.scrollWidth;\r\n        rect.bottom = rect.top + element.scrollHeight;\r\n\r\n        return rect;\r\n    }\r\n}\r\n\r\n\r\nexport function clone(opacity=null, className=null, zIndex=null) {\r\n    if(typeof opacity === 'object' && opacity.nodeType) {\r\n        return opacity.cloneNode(true);\r\n    }\r\n\r\n    return function(element) {\r\n        let r = element.cloneNode(true);\r\n\r\n        if(opacity !== null) {\r\n            r.style.opacity = opacity;\r\n        }\r\n\r\n        if(className) {\r\n            r.className = className;\r\n        }\r\n\r\n        r.style.position = \"absolute\";\r\n        if(zIndex !== null) r.style.zIndex = zIndex;\r\n\r\n        return r;\r\n    }\r\n}\r\n"],"sourceRoot":""}