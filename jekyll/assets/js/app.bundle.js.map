{"version":3,"sources":["webpack://pendora/webpack/universalModuleDefinition","webpack://pendora/webpack/bootstrap","webpack://pendora/./jekyll/js/app.js","webpack://pendora/./src/app.js","webpack://pendora/./src/autoloader.js","webpack://pendora/./src/core/Publisher.js","webpack://pendora/./src/core/attributes.js","webpack://pendora/./src/core/data.js","webpack://pendora/./src/core/errors.js","webpack://pendora/./src/core/position.js","webpack://pendora/./src/core/serialize.js","webpack://pendora/./src/core/utility.js","webpack://pendora/./src/core/vectors.js","webpack://pendora/./src/forms/FormWidgetBase.js","webpack://pendora/./src/forms/HiddenInputWidget.js","webpack://pendora/./src/forms/InputWidget.js","webpack://pendora/./src/forms/SelectInputWidget.js","webpack://pendora/./src/forms/index.js","webpack://pendora/./src/menu/DropDown.js","webpack://pendora/./src/menu/Menu.js","webpack://pendora/./src/menu/MenuBar.js","webpack://pendora/./src/menu/MenuItem.js","webpack://pendora/./src/menu/MenuNode.js","webpack://pendora/./src/menu/Select2.js","webpack://pendora/./src/menu/decorators.js","webpack://pendora/./src/menu/positioners.js","webpack://pendora/./src/menu/utility.js","webpack://pendora/./src/ui/ItemFilter.js"],"names":["__webpack_public_path__","app","Application","window","addEventListener","document","body","dataset","page","init","classes","isLoaded","register","key","hasOwnProperty","registerPage","name","importer","Error","context","pageClassImporter","PageClass","load","AutoLoader","registry","func","querySelector","widgets","querySelectorAll","element","components","split","windowBind","c","parts","cls","namespace","length","initialized","privateCache","get","set","fn","loader","Toggle","_onClick","event","onClick","removeEventListener","target","toggle","method","startsWith","substr","classList","instance","getInitializedInstance","autoLoad","STOP","Publisher","_topics","topic","callback","push","on","off","args","apply","arguments","callbacks","i","cb","splice","slice","e","DROP","REQUIRED","FALSE","TRUE","Attribute","type","missing","nullable","validator","data","fields","r","field","value","undefined","KeyError","ValueError","uuid","prefix","Math","random","replace","Data","expando","owner","cache","acceptData","nodeType","Object","defineProperty","configurable","prop","keys","isEmptyObject","ExtendableError","message","constructor","captureStackTrace","stack","IndexError","NotImplemented","ValidationError","node","children","AssertionError","regMatrix","getOffsetElement","o","parentElement","position","getComputedStyle","getClientRect","Rect","innerWidth","innerHeight","getBoundingOffsetRect","offsetParent","offsetRect","getBoundingClientRect","rect","left","top","right","bottom","getBoundingDocumentRect","scrollX","scrollY","getTranslation","transform","m","exec","Vec3","parseFloat","setTranslation","x","y","z","style","getCssPosition","Vec2","parseInt","setCssPosition","setElementClientPosition","fromVertex","box","deltaX","deltaY","cssPosition","clientRectToDocumentSpace","fromRect","documentRectToClientSpace","snapToGrid","gridSize","roundingFunction","round","Number","isNaN","convertDomRectToObject","domRect","getPointOnElement","referenceElement","point","offset","constrain","Array","isArray","clamp","getSubBoundingBox","width","height","getDistanceBetweenRects","rect1","rect2","vec1","vec2","isXOverlapping","isYOverlapping","min","abs","x1","y1","x2","y2","sqrt","pow","REG_COMMA","NULL","Type","Integer","radix","allowInfinity","trim","Infinity","Float","fixed","toFixed","Bool","toLowerCase","Str","allow_empty","CSV","separator","join","CompoundType","types","t","choice","choices","indexOf","minLength","maxLength","l","range","max","regex","pattern","flags","reg","RegExp","test","all","validators","any","deserialize","AttributeSchema","attributes","REG_WHITESPACE","minValue","maxValue","modulo","mod","proto","descriptor","placement","randomChoice","array","floor","arraysEqual","array1","array2","parseHTML","html","template","createElement","innerHTML","content","fragment","createDocumentFragment","firstChild","appendChild","object","emptyElement","removeChild","addClasses","add","removeClasses","remove","assignAttributes","setAttribute","setElementOffset","coords","getElementOffset","pageXOffset","pageYOffset","getScroll","isWindow","scrollLeft","scrollTop","variable","setInterval","setScroll","scroll","scrollTo","selectElement","selector","jquery","assert","condition","parseBooleanOrInt","defaultValue","TypeError","parseBooleanOrFloat","parseBoolean","parseIntValue","parseFloatValue","parseAny","parsers","parser","validateChoice","findChild","child","filterChildren","getOwnProperty","obj","propName","getPropertyByPath","path","part","regPercentage","regWhitespace","regPositionPart","regTypedNumber","UnitError","positionShortHandValues","vec4","vertex","vec3","toString","g","b","hex","Vec4","valueOrVec4","_new","a","domElement","bb","subtract","my","at","of","inside","collision","anchor","evaluatePositionString","reference","translate","contains","flip","collisionX","collisionY","containsX","center","containsY","middle","collsionX","collsionY","clampX","clampY","string","pos","rx","ry","_evaluatePositionStringComponent","direction","p","RGBA","substring","FormWidgetBase","append","id","getName","setName","getValue","setValue","MultiHiddenInputWidget","container","display","_name","inputs","_value","v","input","map","item","render","HiddenInputWidget","InputWidget","placeholder","SelectInputWidget","select","multiple","hidden","isHidden","option","selected","values","options","found","DropDown","closeOnSelect","closeOnBlur","positioner","positioners","MenuItem","FromHTML","INT_OR_BOOL_TYPE","BOOL_TYPE","MENU_ATTRIBUTE_SCHEMA","timeout","autoActivate","openOnHover","delay","visible","_isNavigableChild","isNavigable","_findFirstNavigableChild","find","_findAllNavigableChildren","filter","AbstractMenu","SubMenuClass","MenuItemClass","inherit","_isTopicInit","parent","isActive","activate","deactivate","activeChild","onMouseOver","onMouseOut","onSelect","_captureDocumentClick","onDocumentClick","publish","dispatchEvent","CustomEvent","detail","bubbles","clearActiveChild","clearTimer","isVisible","call","submenu","_submenu","attachSubMenu","text","action","index","_children","getMenuBody","removeItem","appendTo","isMenuItem","_parent","isDisabled","bodies","prototype","originalEvent","relatedTarget","startTimer","dispatchTopic","showSubMenu","show","hasSubMenu","allowTargetKeys","_depth","ARROW_BACK","ARROW_FORWARD","ARROW_NEXT","ARROW_PREVIOUS","arrowKeys","arrowKeyPressed","preventDefault","_navigateToItem","isRoot","ret","firstSubMenuChild","_navigate","hideSubMenu","childToActivate","firstEnabledChild","targetChild","targetKey","MenuNode","Menu","MenuClass","open","events","registerTopics","parseDOM","createItems","arrow","MenuBar","enableKeyboardNavigation","initKeyboardNavigation","className","STRING_TYPE","MENU_ITEM_ATTRIBUTE_SCHEMA","AbstractMenuItem","clearSubItemsOnHover","autoDeactivateItems","location","hasEvent","hide","detachSubMenu","getDisabled","isDefaultPrevented","isSubMenuVisible","_button","matches","button","innerText","href","nodeName","addClass","addAction","tabIndex","_props","_eventListeners","_keyboardNavigationEnabled","_timers","_element","isController","handleEvent","getTargetNode","wrappedEvent","getEventDelegator","_rootKeyDown","clearAllRegisteredEvents","__keyboardNavigationEnabled","getClosestMenuNodeByElement","containsElement","getDescendants","grandchild","getMenuInstance","isMenu","time","interval","clear","cancel","timer","status","clearInterval","setTimeout","clearTimeout","listener","bubble","activeElement","blur","activeItem","parentMenu","invalidateTree","walk","hasMenuInstance","setParent","hasMenuItemAttribute","hasAttribute","hasMenuAttribute","menu","closest","getOffsetSibling","root","detachMenuInstance","attachMenuInstance","_registerAllEvents","config","getAttributes","SelectOption","textNode","topicData","isSelected","ctrlKey","deselect","isSelect","parentSelect","multiSelect","isFiltered","FILTERS","istartsWith","icontains","SelectMenu","filterDelay","filterPlaceholderText","enableShiftSelect","enableCtrlToggle","clearOldSelection","_initFilter","clearFilter","selection","_lastClick","shiftKey","targetIndex","lastIndex","startIndex","endingIndex","change","deselected","shiftSelect","lastTarget","start","end","getFilteredItems","filterInput","getClosestMenuByElement","filterContainer","insertBefore","_timer","Select2","widget","labelToItemMap","WeakMap","itemToLabelMap","ItemFilter","items","tabindex","li","wrapper","allItemsFiltered","placeholderNode","isFocused","_isChoiceElement","getLabels","focus","renderLabels","output","pill","exitButton","span","_getSelectedValues","inFilter","replaceWith","__attributes__","AbstractSelect","refreshUI","selectedOptions","replaceChild","ComboBox","wait","textbox","_label","isSelectMenu","labels","hasFilter","_destroyFilter","_filterMethod","applyFilter","f","onInput","onKeyDown","readOnly","MultiComboBox","optionToPillMap","pilltoOptionMap","pills","firstItem","textContainer","_buildChoicePill","changed","_renderLabel","RichSelect","initializer","kind","enumerable","publishTargetEvent","desc","opposites","getInheritedPosition","_applyPosition","overlay","overlayRect","targetRect","containerRect","myX","myY","atX","atY","methodX","methodY","refresh","dropdown","topLevelPosition","defaultPosition","containerElement","DROPDOWN","SIDE_MENU","MENU_MAP","has","getClosestMenuItemByElement","innerTextCompare","compareFunction","onHide","onShow","allItemsHidden","getFilterItems","_showItem","_hideItem"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;QACA;QACA;QACA;;QAEA;QACA;QACA;QACA,QAAQ,oBAAoB;QAC5B;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA,iBAAiB,4BAA4B;QAC7C;QACA;QACA,kBAAkB,2BAA2B;QAC7C;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;;QAEA;;QAEA;QACA;QACA,gDAAgD;QAChD;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;QAEA;QACA;QACA;QACA;;;QAGA;;QAEA;QACA,iCAAiC;;QAEjC;QACA;QACA;QACA,KAAK;QACL;QACA;QACA;QACA,MAAM;QACN;;QAEA;QACA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,wBAAwB,kCAAkC;QAC1D,MAAM;QACN;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;QAEA;QACA,0CAA0C,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","file":"app.bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pendora\"] = factory();\n\telse\n\t\troot[\"pendora\"] = factory();\n})(window, function() {\nreturn "," \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"chunk-\" + ({}[chunkId]||chunkId) + \".bundle.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/tests/dist/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonppendora\"] = window[\"webpackJsonppendora\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import \"@babel/polyfill\";\r\nimport Application from \"app\";\r\nimport \"autoloader\";\r\nimport \"menu\";\r\n\r\n__webpack_public_path__ = \"/assets/js/\";\r\n\r\n\r\nlet app = new Application({\r\n    // 'menubar': () =>  import(\"./pages/menubar_example.js\"),\r\n    // 'menu_examples': () =>  import(\"./pages/menu_examples.js\"),\r\n    'menu_page_index': () =>  import(\"./pages/menus/page_index\"),\r\n});\r\n\r\n\r\nwindow.addEventListener('load', async () => {\r\n    if(document.body.dataset.page) {\r\n        await app.init(document.body.dataset.page);\r\n    }\r\n});\r\n\r\n\r\nwindow.app = app;\r\n","\r\n\r\n/**\r\n * Page loader class.\r\n *\r\n * Allows for the class to registers application pages that can be dynamically loaded when needed.\r\n */\r\nexport default class Application {\r\n    constructor(classes) {\r\n        this.classes = {};\r\n        this.page = null;\r\n        this.isLoaded = false;\r\n        this.register(classes);\r\n    }\r\n\r\n    /**\r\n     * Register an dictionary of page importers.\r\n     * @param classes\r\n     */\r\n    register(classes) {\r\n        for(let key in classes) {\r\n            if(classes.hasOwnProperty(key)) {\r\n                this.registerPage(key, classes[key]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Register a single page.\r\n     * @param name\r\n     * @param importer\r\n     */\r\n    registerPage(name, importer) {\r\n        if(this.classes.hasOwnProperty(name) && this.classes[name]) {\r\n            throw new Error(\"Duplicate page class registered\");\r\n        }\r\n\r\n        this.classes[name] = importer;\r\n    }\r\n\r\n    /**\r\n     * Loads the page with the given context.\r\n     * @param page\r\n     * @param context\r\n     */\r\n    async init(page, context) {\r\n        if(this.page) {\r\n            throw new Error(\"Page is already loaded\");\r\n        }\r\n\r\n        // window.addEventListener('load', async () => {\r\n        //     this.isLoaded = true;\r\n        //\r\n        //     const pageClassImporter = this.classes[page],\r\n        //         PageClass = (await pageClassImporter()).default;\r\n        //\r\n        //     this.page = new PageClass(context);\r\n        //     if(this.page.load) this.page.load();\r\n        // });\r\n\r\n        this.isLoaded = true;\r\n\r\n        const pageClassImporter = this.classes[page],\r\n            PageClass = (await pageClassImporter()).default;\r\n\r\n        this.page = new PageClass(context);\r\n        if(this.page.load) this.page.load();\r\n    }\r\n}\r\n","import {privateCache} from \"./core/data\";\r\n\r\n\r\nexport default class AutoLoader {\r\n    static autoLoad = true;\r\n\r\n    constructor() {\r\n        this.registry = {};\r\n    }\r\n\r\n    register(name, func) {\r\n        if(this.registry.hasOwnProperty(name) && this.registry[name]) {\r\n            throw new Error(\"Duplicate component registered\");\r\n        }\r\n\r\n        this.registry[name] = func;\r\n    }\r\n\r\n    load(context) {\r\n        if(!context) {\r\n            context = document;\r\n        } else if(typeof context === 'string') {\r\n            context = document.querySelector(context);\r\n        }\r\n\r\n        let widgets = context.querySelectorAll('[data-init]');\r\n\r\n        for(let element of widgets) {\r\n            let components = element.dataset.init.split(/\\s+/),\r\n                windowBind = element.dataset.windowBind;\r\n\r\n            for(let c of components) {\r\n                let parts = c.split(':'),\r\n                    cls = this.registry[parts[0]],\r\n                    namespace = parts.length > 1 ? parts[1] : '',\r\n                    key = namespace ? `${parts[0]}.${parts[1]}` : parts[0];\r\n\r\n                if(cls) {\r\n                    let initialized = privateCache.get(element, 'initialized');\r\n\r\n                    if(!initialized) {\r\n                        initialized = {};\r\n                        privateCache.set(element, 'initialized', initialized);\r\n                    }\r\n\r\n                    if(!initialized[key]) {\r\n                        initialized[key] = cls(element);\r\n\r\n                        if(windowBind) {\r\n                            window[windowBind] = initialized[key];\r\n                        }\r\n                    } // else component is already loaded do nothing.  Could be encountered if load is called multiple times.\r\n                } else {\r\n                    throw new Error(`No component registered called ${key}`);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  Registers a loader function will the global autoloader instance.\r\n     *\r\n     * @param name {String}\r\n     * @param fn {function(HTMLElement) : Object}\r\n     */\r\n    static register(name, fn) {\r\n        return this.loader.register(name, fn);\r\n    }\r\n\r\n    static load(context) {\r\n        return this.loader.load(context);\r\n    }\r\n\r\n    static getInitializedInstance(element, name) {\r\n        let initialized = privateCache.get(element, 'initialized');\r\n\r\n        if(initialized) {\r\n            return initialized[name] || null;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * A UI class that adds the toggle behavior to an element.\r\n * The Toggle behavior is added using the autoloader using `data-init=\"toggle\"` attribute.\r\n * It will target another element and attempt to call the toggle method of an initialized component.\r\n *\r\n * The toggle class takes two configuration attributes, data-target and data-toggle.\r\n *\r\n * data-target determines what element is targeted.  It takes a css selector that will be passed to document.querySelector().\r\n *\r\n * data-toggle determines the initialized component to toggle.  It takes the name of the component registered with AutoLoader.\r\n * For instance if you are toggling on a modal you should pass modal here.\r\n *\r\n * If the component does not offer a toggle method and another method needs to be called, you can set the optional\r\n * attribute data-method.  This attribute determines what method is called and defaults to the string toggle.\r\n *\r\n * Example Usage:\r\n *\r\n * <button type=\"button\" data-init=\"toggle\" data-target=\"#myModalId\" data-toggle=\"modal\">Show Modal</button>\r\n *\r\n * ---\r\n *\r\n * # Toggle classes on and off\r\n *\r\n * If you want to toggle a class on the target element on or off the toggle needs to be a css class string.  For\r\n * example to toggle the class \"test\" with a button you can use the following code:\r\n *\r\n * <button type=\"button\" data-init=\"toggle\" data-target=\"#mytarget\" data-toggle=\".test\">Toggle Class</button>\r\n *\r\n * ---\r\n * # Target self\r\n *\r\n * If you an element to target itself, specify the string \"self\" as the target.\r\n *\r\n * <button type=\"button\" data-init=\"toggle\" data-target=\"self\" data-toggle=\".test\">Toggle Class</button>\r\n */\r\nexport class Toggle {\r\n    constructor(element) {\r\n        if(typeof element === 'string') {\r\n            this.element = document.querySelector(element);\r\n        } else {\r\n            this.element = element;\r\n        }\r\n\r\n        this._onClick = (event) => {\r\n            this.onClick(event);\r\n        };\r\n\r\n        this.element.addEventListener('click', this._onClick);\r\n    }\r\n\r\n    destroy() {\r\n        this.element.removeEventListener('click', this._onClick);\r\n        this._onClick = null;\r\n    }\r\n\r\n    onClick() {\r\n        let target = this.element.dataset.target,\r\n            toggle = this.element.dataset.toggle,\r\n            method = this.element.dataset.method || 'toggle';\r\n\r\n        if(target === 'self') {\r\n            target = this.element;\r\n        } else {\r\n            target = document.querySelector(target);\r\n        }\r\n\r\n        if(toggle.startsWith('.')) {\r\n            toggle = toggle.substr(1);\r\n            target.classList.toggle(toggle);\r\n        } else {\r\n            let instance = AutoLoader.getInitializedInstance(target, toggle);\r\n\r\n            if(instance) {\r\n                instance[method](this.element);\r\n            } else {\r\n                throw new Error(\"Could not find initialized instance during toggle action.\");\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nAutoLoader.loader = new AutoLoader();\r\nAutoLoader.register('toggle', (element) => new Toggle(element));\r\n\r\n\r\nwindow.addEventListener('load', () => {\r\n    if(AutoLoader.autoLoad) {\r\n        AutoLoader.load();\r\n    }\r\n});\r\n","\r\n\r\nexport function STOP() {\r\n    throw STOP;\r\n}\r\n\r\n\r\nexport default class Publisher {\r\n    constructor() {\r\n        this._topics = {};\r\n    }\r\n\r\n    on(topic, callback) {\r\n        if(!this._topics[topic]) this._topics[topic] = [];\r\n        this._topics[topic].push(callback);\r\n        return this;\r\n    }\r\n\r\n    once(topic, fn) {\r\n        let on = (...args) => {\r\n            this.off(topic, fn);\r\n            return fn.apply(this, args);\r\n        };\r\n\r\n        on.fn = fn;\r\n        this.on(topic, fn);\r\n        return this;\r\n    }\r\n\r\n    off(topic, callback) {\r\n        if(arguments.length === 0) {\r\n            // CLear all topics.\r\n            this._topics = {};\r\n            return this;\r\n        } else if(arguments.length === 1) {\r\n            // Clear single topic.\r\n            this._topics[topic] = [];\r\n            return this;\r\n        }\r\n\r\n        if(!this._topics || !this._topics[topic] || !this._topics[topic].length) {\r\n            // Topic list was either empty or didn't exist.  No need to remove anything.  Return;\r\n            return this;\r\n        }\r\n\r\n        let callbacks = this._topics[topic];\r\n\r\n        for(let i = 0; i < callback.length; i++) {\r\n            let cb = callbacks[i];\r\n            if(cb === callback || cb.fn === callback) {\r\n                callbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(callbacks.length === 0) {\r\n            delete this._topics[topic];\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    hasEvent(topic, callback) {\r\n        if(arguments.length === 1) {\r\n            return !!this._topics[topic];\r\n        } else {\r\n            let callbacks = this._topics[topic];\r\n\r\n            for(let i = 0; i < callbacks.length; i++) {\r\n                let cb = callbacks[i];\r\n                if(cb === callback || cb.fn === callback) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    publish(topic, ...args) {\r\n        if(this._topics[topic]) {\r\n            let callbacks = this._topics[topic].slice(0);\r\n\r\n            for(let cb of callbacks) {\r\n                try {\r\n                    cb.apply(this, args);\r\n                } catch (e) {\r\n                    if(e === STOP) {\r\n                        return e;\r\n                    } else {\r\n                        throw e;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n}\r\n","import {KeyError, ValueError} from './errors';\r\n\r\n\r\nexport const DROP = {};\r\nexport const REQUIRED = {};\r\nexport const FALSE = {};\r\nexport const TRUE = {};\r\n\r\n\r\n/**\r\n * Used to help deserialize attributes on an element.\r\n * @deprecated\r\n */\r\nexport default class Attribute {\r\n    static DROP = DROP;\r\n    static REQUIRED = REQUIRED;\r\n    static FALSE = FALSE;\r\n    static TRUE = TRUE;\r\n\r\n    constructor(type, missing=DROP, nullable=null, validator=null) {\r\n        this.type = type;\r\n        this.missing = missing;\r\n        this.validator = validator;\r\n        this.nullable = nullable;\r\n    }\r\n\r\n    static deserialize(data, fields) {\r\n        let r = {};\r\n\r\n        for(let key in fields) {\r\n            if(fields.hasOwnProperty(key)) {\r\n                let field = fields[key],\r\n                    missing = field ? field.missing : DROP,\r\n                    nullable = field ? field.nullable : null,\r\n                    value = data.hasOwnProperty(key) ? data[key]: undefined;\r\n\r\n                if(value === undefined) {\r\n                    if(missing === REQUIRED) {\r\n                        throw new KeyError(`${key} is required`);\r\n                    } else if(missing === DROP) {\r\n                        continue;\r\n                    } else {\r\n                        r[key] = missing;\r\n                        continue;\r\n                    }\r\n                }\r\n\r\n                if(value === null) {\r\n                    if(nullable === FALSE) {\r\n                        throw new ValueError(`${key} cannot be null`);\r\n                    } else if(nullable === TRUE || nullable === null) {\r\n                        r[key] = null;\r\n                        continue;\r\n                    } else if(nullable === DROP) {\r\n                        continue;\r\n                    } else {\r\n                        r[key] = nullable;\r\n                        continue;\r\n                    }\r\n                }\r\n\r\n                if(field) {\r\n                    if(field.type) {\r\n                        value = field.type(value);\r\n                    }\r\n\r\n                    if(field.validator) {\r\n                        value = field.validator(value);\r\n                    }\r\n                }\r\n\r\n                r[key] = value;\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n}\r\n","import {isEmptyObject} from \"./utility\";\r\n\r\n\r\nlet uuid = 1,\r\n    prefix = 'p-' + (''+Math.random()).replace(/\\D/g, '');\r\n\r\n\r\nexport class Data {\r\n    constructor() {\r\n        this.expando = `${prefix}-${uuid++}`;\r\n    }\r\n\r\n    static acceptData(owner) {\r\n        return owner.nodeType === 1 || owner.nodeType === 9 || !(+owner.nodeType);\r\n    }\r\n\r\n    cache(owner) {\r\n        let cache = owner[this.expando];\r\n\r\n        if(!cache) {\r\n            cache = {};\r\n\r\n            if(Data.acceptData(owner)) {\r\n                if(owner.nodeType) {\r\n                    owner[this.expando] = cache;\r\n                } else {\r\n                    Object.defineProperty(owner, this.expando, {\r\n                        value: cache,\r\n                        configurable: true\r\n                    });\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        return cache;\r\n    }\r\n\r\n    set(owner, key, value) {\r\n        let cache = this.cache(owner);\r\n\r\n        if(typeof key === 'object') {\r\n            for(let prop in key) {\r\n                cache[prop] = key[prop];\r\n            }\r\n        } else {\r\n            cache[key] = value;\r\n        }\r\n\r\n        return cache;\r\n    }\r\n\r\n    get(owner, key) {\r\n        if(key === undefined) {\r\n            return this.cache(owner);\r\n        } else {\r\n            let cache = owner[this.expando];\r\n\r\n            if(cache) {\r\n                return cache[key];\r\n            }\r\n        }\r\n    }\r\n\r\n    access(owner, key, value) {\r\n        if(arguments.length === 2) {\r\n            if(typeof key === 'object') {\r\n                return this.set(owner, key);\r\n            } else {\r\n                return this.get(owner, key);\r\n            }\r\n        } else if(arguments.length === 1) {\r\n            return this.cache(owner);\r\n        } else if(arguments.length === 3) {\r\n            return this.set(owner, key, value);\r\n        }\r\n    }\r\n\r\n    remove(owner, ...keys) {\r\n        let cache = owner[this.expando];\r\n\r\n        if(!cache) return;\r\n\r\n        if(arguments.length === 1) {\r\n            if(owner.nodeType) {\r\n                owner[this.expando] = undefined;\r\n            } else {\r\n                delete owner[this.expando];\r\n            }\r\n        } else {\r\n            for(let key of keys) {\r\n                delete cache[key];\r\n            }\r\n        }\r\n    }\r\n\r\n    hasData(owner) {\r\n        let cache = owner[this.expando];\r\n        return cache && !isEmptyObject(cache);\r\n    }\r\n}\r\n\r\n\r\nexport let privateCache = new Data();","\r\nexport class ExtendableError extends Error {\r\n    constructor(message) {\r\n        // noinspection JSCheckFunctionSignatures\r\n        super(message);\r\n        this.name = this.constructor.name;\r\n\r\n        // noinspection JSUnresolvedVariable\r\n        if(typeof Error.captureStackTrace === 'function') {\r\n            // noinspection JSUnresolvedFunction\r\n            Error.captureStackTrace(this, this.constructor);\r\n        } else {\r\n            this.stack = (new Error(message)).stack;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class IndexError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class KeyError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class ValueError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class NotImplemented extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class ValidationError extends ExtendableError {\r\n    constructor(message, node) {\r\n        super(message);\r\n        this.node = node;\r\n        this.children = [];\r\n    }\r\n}\r\n\r\n\r\nexport class AssertionError extends ExtendableError {\r\n    constructor(message) {\r\n        super(message);\r\n    }\r\n}\r\n","import {Vec2, Vec3, Rect} from \"./vectors\";\r\nimport {clamp} from \"./utility\";\r\n\r\n\r\nconst regMatrix = /matrix(3d)?\\(([^)]+)\\)/;\r\n\r\n\r\n/**\r\n * Returns the elements offset parent.\r\n *\r\n * @param element\r\n * @returns {HTMLElement}\r\n */\r\nexport function getOffsetElement(element) {\r\n    let o = element.parentElement;\r\n\r\n    while(o) {\r\n        let position = getComputedStyle(o).position;\r\n        if(position !== 'static') return o;\r\n        o = o.parentElement;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the rectangle of the client area.\r\n *\r\n * @returns {Rect}\r\n */\r\nexport function getClientRect() {\r\n    return new Rect(\r\n        0,\r\n        0,\r\n        window.innerWidth,\r\n        window.innerHeight\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns a bounding rect who's positions are relative to the provided offsetParent.\r\n * If offsetParent is null then the targets natural offsetParent is used as returned by the getOffsetElement function.\r\n * @param element\r\n * @param offsetParent\r\n * @returns {{top: number, left: number, bottom: number, width: number, right: number, height: number}}\r\n */\r\nexport function getBoundingOffsetRect(element, offsetParent=null) {\r\n    if(!offsetParent) offsetParent = getOffsetElement(element);\r\n\r\n    let offsetRect = offsetParent.getBoundingClientRect(),\r\n        rect = element.getBoundingClientRect();\r\n\r\n    return new Rect(\r\n        rect.left - offsetRect.left,\r\n        rect.top - offsetRect.top,\r\n        rect.right - offsetRect.right,\r\n        rect.bottom - offsetRect.bottom\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns a bounding rect who's positions are relative to the document.\r\n * @param element\r\n * @returns {{top: number, left: number, bottom: number, width: number, x: number, y: number, right: number, height: number}}\r\n */\r\nexport function getBoundingDocumentRect(element) {\r\n    let rect = element.getBoundingClientRect();\r\n\r\n    return new Rect(\r\n        rect.left + window.scrollX,\r\n        rect.top + window.scrollY,\r\n        rect.right + window.scrollX,\r\n        rect.bottom + window.scrollY\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns the css translation from the transformation matrix applied to the element.\r\n *\r\n * @param element\r\n * @returns {Vec3}\r\n */\r\nexport function getTranslation(element) {\r\n    let transform = getComputedStyle(element).transform,\r\n        m = regMatrix.exec(transform);\r\n\r\n    if(!m) {\r\n        return new Vec3(\r\n            0,\r\n            0,\r\n            0\r\n        );\r\n    }\r\n\r\n    let data = m[2].split(/\\s*,\\s*/);\r\n\r\n    if(m[1]) {\r\n        return new Vec3(\r\n            parseFloat(data[12]),\r\n            parseFloat(data[13]),\r\n            parseFloat(data[14])\r\n        );\r\n    } else {\r\n        return new Vec3(\r\n            parseFloat(data[4]),\r\n            parseFloat(data[5]),\r\n            0\r\n        );\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Sets the element's transformation matrix to 2d translate with the specified left and top properties.\r\n *\r\n * @param element\r\n * @param x\r\n * @param y\r\n * @param z\r\n */\r\nexport function setTranslation(element, {x, y, z=null}) {\r\n    if(z !== null) {\r\n        element.style.transform = `translate3d(${x}px, ${y}px, ${z}px)`;\r\n    } else {\r\n        element.style.transform = `translate(${x}px, ${y}px)`;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Gets the elements left and top style properties as numbers.\r\n *\r\n * @param element\r\n * @returns {Vec2}\r\n */\r\nexport function getCssPosition(element) {\r\n    let style = getComputedStyle(element);\r\n\r\n    return new Vec2(\r\n        parseInt(style.left, 10),\r\n        parseInt(style.top, 10)\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Sets the left and top style properties of an element.  If the element is positioned statically it will be changed to\r\n * relative.\r\n *\r\n * @param element\r\n * @param left\r\n * @param top\r\n */\r\nexport function setCssPosition(element, {left=null, top=null}) {\r\n    let style = getComputedStyle(element);\r\n\r\n    if(style.position === 'static') {\r\n        style.position = 'relative';\r\n    }\r\n\r\n    if(left !== null && left !== undefined) {\r\n        element.style.left = `${left}px`;\r\n    }\r\n\r\n    if(top !== null && top !== undefined) {\r\n        element.style.top = `${top}px`;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Sets the elements position relative to the client window.  The `method` parameter controls how the elements position\r\n * is modified.  The options are 'top-left', 'top-right', 'bottom-left', 'bottom-right', 'translate', and 'translate3d'.\r\n *\r\n * top-left, top-right, bottom-left and bottom-right set the css left, top, right, and bottom properties of the element.\r\n * translate and translate3d position the element by setting the transform property.\r\n *\r\n * @param element {HTMLElement}\r\n * @param position {{x, y}|{left, top}|Array|Vec2}\r\n * @param method {'top-left'|'top-right'|'bottom-left'|'bottom-right'|'translate'|'translate3d'}\r\n */\r\nexport function setElementClientPosition(element, position, method='top-left') {\r\n    position = Vec2.fromVertex(position);\r\n\r\n    if(method === 'top-left' || method === 'top-right' || method === 'bottom-left' || method === 'bottom-right') {\r\n        let style = getComputedStyle(element);\r\n\r\n        // position can't be static for this operation.  Switch to relative.\r\n        if(style.position === 'static') {\r\n            element.style.position = 'relative';\r\n            style = getComputedStyle(element);\r\n        }\r\n\r\n        let left = parseInt(style.left, 10),\r\n            top = parseInt(style.top, 10),\r\n            right = parseInt(style.right, 10),\r\n            bottom = parseInt(style.bottom, 10),\r\n            box = Rect.getBoundingClientRect(element),\r\n            deltaX = position.left - box.left,\r\n            deltaY = position.top - box.top;\r\n\r\n        if(method === 'top-left') {\r\n            element.style.left = (left + deltaX) + 'px';\r\n            element.style.top = (top + deltaY) + 'px';\r\n            element.style.right = '';\r\n            element.style.bottom = '';\r\n        } else if(method === 'top-right') {\r\n            element.style.right = (right - deltaX) + 'px';\r\n            element.style.top = (top + deltaY) + 'px';\r\n            element.style.left = '';\r\n            element.style.bottom = '';\r\n        } else if(method === 'bottom-left') {\r\n            element.style.left = (left + deltaX) + 'px';\r\n            element.style.bottom = (bottom - deltaY) + 'px';\r\n            element.style.right = '';\r\n            element.style.top = '';\r\n        } else { // bottom-right\r\n            element.style.right = (right - deltaX) + 'px';\r\n            element.style.bottom = (bottom - deltaY) + 'px';\r\n            element.style.left = '';\r\n            element.style.top = '';\r\n        }\r\n    } else if(method === 'translate') {\r\n        let box = Rect.getBoundingClientRect(element),\r\n            deltaX = position.left - box.left,\r\n            deltaY = position.top - box.top,\r\n            cssPosition = getTranslation(element);\r\n\r\n        setTranslation(element, {\r\n            x: cssPosition.x + deltaX,\r\n            y: cssPosition.y + deltaY\r\n        });\r\n    } else if(method === 'translate3d') {\r\n        let box = Rect.getBoundingClientRect(element),\r\n            deltaX = position.left - box.left,\r\n            deltaY = position.top - box.top,\r\n            cssPosition = getTranslation(element);\r\n\r\n        setTranslation(element, {\r\n            x: cssPosition.x + deltaX,\r\n            y: cssPosition.y + deltaY,\r\n            z: cssPosition.z\r\n        });\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Transforms the coordinates of a BoundingClientRect like object from client space to document space.\r\n * @param rect\r\n */\r\nexport function clientRectToDocumentSpace(rect) {\r\n    let r = Rect.fromRect(rect);\r\n\r\n    r.left += window.scrollX;\r\n    r.right += window.scrollX;\r\n    if(typeof r.top === 'number') r.top += window.scrollY;\r\n    if(typeof r.bottom === 'number') r.bottom += window.scrollY;\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Transforms the coordinates of a BoundingClientRect like object from document space to client space.\r\n * @param rect\r\n */\r\nexport function documentRectToClientSpace(rect) {\r\n    let r = Rect.fromRect(rect);\r\n\r\n    r.left -= window.scrollX;\r\n    r.right -= window.scrollX;\r\n    if(typeof r.top === 'number') r.top -= window.scrollY;\r\n    if(typeof r.bottom === 'number') r.bottom -= window.scrollY;\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Snaps the value to the specified grid using the provided rounding function.\r\n * @param value\r\n * @param gridSize\r\n * @param roundingFunction\r\n * @returns {number|*}\r\n */\r\nexport function snapToGrid(value, gridSize, roundingFunction=Math.round) {\r\n    if(gridSize !== null && gridSize !== undefined && !Number.isNaN(gridSize)) {\r\n        return roundingFunction(value / gridSize) * gridSize;\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Deprecated in favor of calling Rect.fromRect() class method.\r\n *\r\n * @deprecated\r\n * @param domRect\r\n * @returns {Rect}\r\n */\r\nexport function convertDomRectToObject(domRect) {\r\n    return Rect.fromRect(domRect);\r\n}\r\n\r\n\r\n/**\r\n * Returns the {x, y} point calculated relative to the reference element.\r\n *\r\n * @param referenceElement\r\n * @param point\r\n * @param offset\r\n * @param constrain\r\n * @returns {Vec2}\r\n */\r\nexport function getPointOnElement(referenceElement, point, offset=null, constrain=null) {\r\n    let rect = referenceElement;\r\n\r\n    if(rect.getBoundingClientRect) {\r\n        rect = rect.getBoundingClientRect();\r\n    }\r\n\r\n    if(constrain) {\r\n        if (typeof constrain === 'string') {\r\n            constrain = document.querySelector(constrain);\r\n        }\r\n\r\n        if (constrain.getBoundingClientRect) {\r\n            constrain = Rect.fromRect(constrain.getBoundingClientRect());\r\n        }\r\n    }\r\n\r\n    // Convert array to {x, y} object.\r\n    if(Array.isArray(point)) {\r\n        point = {\r\n            x: point[0],\r\n            y: point[1]\r\n        };\r\n    } else if(typeof point === 'string') {\r\n        if(point === 'top-left') {\r\n            point = {x: 0, y: 0};\r\n        } else if(point === 'top') {\r\n            point = {x: '50%', y: 0};\r\n        } else if(point === 'top-right') {\r\n            point = {x: '100%', y: 0};\r\n        } else if(point === 'right') {\r\n            point = {x: '100%', y: '50%'};\r\n        } else if(point === 'bottom-right') {\r\n            point = {x: '100%', y: '100%'};\r\n        } else if(point === 'bottom') {\r\n            point = {x: '50%', y: '100%'};\r\n        } else if(point === 'bottom-left') {\r\n            point = {x: 0, y: '100%'};\r\n        } else if(point === 'left') {\r\n            point = {x: 0, y: '50%'};\r\n        } else if(point === 'middle') {\r\n            point = {x: '50%', y: '50%'};\r\n        } else {\r\n            throw new Error(`Unknown point option ${point}`);\r\n        }\r\n    }\r\n\r\n    if(typeof point.x === 'string') {\r\n        point.x = (rect.right - rect.left) * (parseFloat(point.x) / 100);\r\n    }\r\n\r\n    if(typeof point.y === 'string') {\r\n        point.y = (rect.bottom - rect.top) * (parseFloat(point.y) / 100);\r\n    }\r\n\r\n    if(constrain) {\r\n        if(typeof constrain.left === 'string') {\r\n            constrain.left = (rect.right - rect.left) * (parseFloat(constrain.left) / 100);\r\n        }\r\n\r\n        if(typeof constrain.right === 'string') {\r\n            constrain.right = (rect.right - rect.left) * (parseFloat(constrain.right) / 100);\r\n        }\r\n\r\n        if(typeof constrain.top === 'string') {\r\n            constrain.top = (rect.bottom - rect.top) * (parseFloat(constrain.top) / 100);\r\n        }\r\n\r\n        if(typeof constrain.bottom === 'string') {\r\n            constrain.bottom = (rect.bottom - rect.top) * (parseFloat(constrain.bottom) / 100);\r\n        }\r\n\r\n        point.x = clamp(point.x, constrain.left, constrain.right);\r\n        point.y = clamp(point.y, constrain.top, constrain.bottom);\r\n    }\r\n\r\n    if(offset) {\r\n        if(Array.isArray(offset)) {\r\n            offset = {\r\n                x: offset[0],\r\n                y: offset[1]\r\n            };\r\n        }\r\n\r\n        if(offset.x !== null) {\r\n            point.x += offset.x;\r\n        }\r\n\r\n        if(offset.y !== null) {\r\n            point.y += offset.y;\r\n        }\r\n    }\r\n\r\n    return new Vec2(rect.left + point.x, rect.top + point.y);\r\n}\r\n\r\n\r\n/**\r\n * Gets the bounding client rect for a rectangle defined by the position rectangle with left, top, right and bottom\r\n * properties relative to the element's position.\r\n *\r\n * @param element {{getBoundingClientRect}|Element|String|{left, top, right, bottom}}\r\n * @param position {{left, top, bottom, right}}\r\n * @return {Rect}\r\n */\r\nexport function getSubBoundingBox(element, position) {\r\n    let rect;\r\n\r\n    // Get the bounding client rect of the element.   The user should have passed either a css selector, an object with a\r\n    // getBoundingClientRect interface.  Or a bounding client rect directly.\r\n    if(element.getBoundingClientRect) {\r\n        rect = element.getBoundingClientRect();\r\n    } else if(typeof element === 'string') {\r\n        rect = document.querySelector(element).getBoundingClientRect();\r\n    } else {\r\n        rect = element;\r\n    }\r\n\r\n    let width = rect.right - rect.left,\r\n        height = rect.bottom - rect.top;\r\n\r\n    // The user can pass a rect with left, top, right and bottom properties.  The value can either be the desired\r\n    // coordinates relative to the top-left corner of the reference element or a percentage.  Another possibility\r\n    // is that the user passes one of the keyword properties that coorispond to a specific section of the element.\r\n    // Map those keywords to their rectangle.\r\n    if(typeof position === 'string') {\r\n        if(position === 'border-top') {\r\n            position = {left: 0, right: '100%', top: 0, bottom: 0};\r\n        } else if(position === 'border-right') {\r\n            position = {left: '100%', right: '100%', top: 0, bottom: '100%'};\r\n        } else if(position === 'border-bottom') {\r\n            position = {left: 0, right: '100%', top: '100%', bottom: '100%'};\r\n        } else if(position === 'border-left') {\r\n            position = {left: 0, top: 0, right: 0, bottom: '100%'};\r\n        } else if(position === 'top-left') {\r\n            position = {left: 0, top: 0, right: 0, bottom: 0};\r\n        } else if(position === 'top') {\r\n            position = {top: 0, left: '50%', right: '50%', bottom: 0};\r\n        } else if(position === 'top-right') {\r\n            position = {top: 0, left: '100%', right: '100%', bottom: 0};\r\n        } else if(position === 'left') {\r\n            position = {left: 0, top: '50%', bottom: '50%', right: 0};\r\n        } else if(position === 'origin') {\r\n            position = {left: '50%', right: '50%', top: '50%', bottom: '50%'};\r\n        } else if(position === 'bottom-left') {\r\n            position = {left: 0, right: 0, top: '100%', bottom: '100%'};\r\n        } else if(position === 'bottom') {\r\n            position = {left: '50%', right: '50%', top: '100%', bottom: '100%'};\r\n        } else if(position === 'bottom-right') {\r\n            position = {left: '100%', right: '100%', top: '100%', bottom: '100%'};\r\n        } else if(position === 'right') {\r\n            position = {left: '100%', right: '100%', top: '50%', bottom: '50%'};\r\n        }\r\n    }\r\n\r\n    position.left = position.left || 0;\r\n    position.right = position.right || 0;\r\n    position.top = position.top || 0;\r\n    position.bottom = position.bottom || 0;\r\n\r\n    // left and right percentages are a percentage of the elements width.\r\n    // top and bottom percentages are a percentage of the elements height.\r\n    if(typeof position.left === 'string') {\r\n        position.left = (parseFloat(position.left) / 100) * width;\r\n    }\r\n\r\n    if(typeof position.right === 'string') {\r\n        position.right = (parseFloat(position.right) / 100) * width;\r\n    }\r\n\r\n    if(typeof position.bottom === 'string') {\r\n        position.bottom = (parseFloat(position.bottom) / 100) * height;\r\n    }\r\n\r\n    if(typeof position.top === 'string') {\r\n        position.top = (parseFloat(position.top) / 100) * height;\r\n    }\r\n\r\n    // Convert to client space.\r\n    return new Rect(\r\n        rect.left + position.left,\r\n        rect.top + position.top,\r\n        rect.left + position.right,\r\n        rect.top + position.bottom\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns the distance in between the provided Rect objects.  If the objects are touching or overlapping 0\r\n * will be returned.\r\n *\r\n * @param rect1 {{left, top, right, bottom}}\r\n * @param rect2 {{left, top, right, bottom}}\r\n * @returns {Number}\r\n */\r\nexport function getDistanceBetweenRects(rect1, rect2) {\r\n    let vec1 = Rect.fromRect(rect1),\r\n        vec2 = Rect.fromRect(rect2);\r\n\r\n    let isXOverlapping = vec1.isXOverlapping(vec2),\r\n        isYOverlapping = vec1.isYOverlapping(vec2);\r\n\r\n    if(isXOverlapping && isYOverlapping) {\r\n        // Items are overlapping\r\n        return 0;\r\n    } else if(isXOverlapping) {\r\n        return Math.min(\r\n            Math.abs(vec1.bottom - vec2.top),\r\n            Math.abs(vec1.top - vec2.bottom)\r\n        );\r\n    } else if(isYOverlapping) {\r\n        return Math.min(\r\n            Math.abs(vec1.right - vec2.left),\r\n            Math.abs(vec1.left - vec2.right)\r\n        );\r\n    } else {\r\n        let x1, y1, x2, y2;\r\n\r\n        if(vec1.right <= vec2.left) {\r\n            x1 = vec1.right;\r\n            x2 = vec2.left;\r\n        } else {\r\n            x1 = vec1.left;\r\n            x2 = vec2.right;\r\n        }\r\n\r\n        if(vec1.bottom <= vec2.top) {\r\n            y1 = vec1.bottom;\r\n            y2 = vec2.top;\r\n        } else {\r\n            y1 = vec1.top;\r\n            y2 = vec2.bottom;\r\n        }\r\n\r\n        // Use distance formula to calculate distance.\r\n        return Math.round(Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)));\r\n    }\r\n}\r\n","/**\r\n * A module for creating schema that can be used to create objects that can serialize and deserialize data structures\r\n * into different formats.\r\n */\r\n\r\n\r\nimport {ValidationError} from './errors';\r\n\r\n\r\nconst REG_COMMA = /\\s*,\\s*/;\r\n\r\n\r\nexport const NULL = {},\r\n    TRUE = {},\r\n    FALSE = {},\r\n    REQUIRED = {},\r\n    DROP = {};\r\n\r\n\r\nexport class Type {\r\n    /**\r\n     * @abstract\r\n     * @param value\r\n     */\r\n    deserialize(value) {\r\n\r\n    }\r\n\r\n    /**\r\n     * @param value\r\n     */\r\n    serialize(value) {\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport class Integer extends Type {\r\n    constructor(radix=10, allowInfinity=false) {\r\n        super();\r\n        this.radix = radix;\r\n        this.allowInfinity = allowInfinity;\r\n    }\r\n\r\n    deserialize(value) {\r\n        if(this.allowInfinity) {\r\n            if(typeof value === 'string') {\r\n                value = value.trim();\r\n            }\r\n\r\n            if(value === 'Infinity') {\r\n                return Infinity;\r\n            } else if(value === '-Infinity') {\r\n                return -Infinity;\r\n            }\r\n        }\r\n\r\n        value = parseInt(value, this.radix);\r\n\r\n        if(Number.isNaN(value)) {\r\n            throw ValidationError(\"Could not parse integer.\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport class Float extends Type {\r\n    constructor(fixed=null, allowInfinity=false) {\r\n        super();\r\n        this.fixed = fixed;\r\n        this.allowInfinity = allowInfinity;\r\n    }\r\n\r\n    deserialize(value) {\r\n        if(this.allowInfinity) {\r\n            if(typeof value === 'string') {\r\n                value = value.trim();\r\n            }\r\n\r\n            if(value === 'Infinity') {\r\n                return Infinity;\r\n            } else if(value === '-Infinity') {\r\n                return -Infinity;\r\n            }\r\n        }\r\n\r\n        if(this.fixed !== null) {\r\n            value = (value + '').toFixed(this.fixed);\r\n        }\r\n\r\n        value = parseFloat(value);\r\n\r\n        if(Number.isNaN(value)) {\r\n            throw new ValidationError(\"Could not parse float\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport class Bool extends Type {\r\n    deserialize(value) {\r\n        if(value === true || value === false) {\r\n            return value;\r\n        }\r\n\r\n        if(typeof value === 'string') {\r\n            value = value.toLowerCase().trim();\r\n\r\n            if(value === 'true') {\r\n                return true;\r\n            } else if(value === 'false') {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        throw new ValidationError(\"Could not parse boolean from value.\");\r\n    }\r\n}\r\n\r\n\r\nexport class Str extends Type {\r\n    constructor(allow_empty=true, trim=false, transform=null) {\r\n        super();\r\n        this.allow_empty = allow_empty;\r\n        this.trim = trim;\r\n        this.transform = transform;\r\n    }\r\n\r\n    deserialize(value) {\r\n        value = value + '';\r\n\r\n        if(this.trim) {\r\n            value = value.trim();\r\n        }\r\n\r\n        if(this.transform) {\r\n            value = value.transform();\r\n        }\r\n\r\n        if(value === '' && !this.allow_empty) {\r\n            throw new ValidationError(\"String cannot be empty\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport class CSV extends Type {\r\n    constructor(separator=REG_COMMA) {\r\n        super();\r\n        this.separator = separator;\r\n    }\r\n\r\n    deserialize(value) {\r\n        let type = typeof value;\r\n\r\n        if(type !== 'string') {\r\n            throw new ValidationError(`Could not deserialize ${type}`);\r\n        }\r\n\r\n        value = value.trim().split(this.separator);\r\n\r\n        return value;\r\n    }\r\n\r\n    serialize(value) {\r\n        return value.join(', ');\r\n    }\r\n}\r\n\r\n\r\nexport class CompoundType extends Type {\r\n    constructor(...types) {\r\n        super();\r\n        this.types = [];\r\n\r\n        for(let type of types) {\r\n            this.types.push(typeof type === 'function' ? new type() : type);\r\n        }\r\n    }\r\n\r\n    deserialize(value) {\r\n        for(let t of this.types) {\r\n            try {\r\n                return t(value);\r\n            } catch (e) {\r\n                if(!(e instanceof ValidationError)) {\r\n                    throw e;\r\n                }\r\n            }\r\n        }\r\n\r\n        throw new ValidationError(\"Value did not match any type.\");\r\n    }\r\n}\r\n\r\n\r\nexport function choice(...choices) {\r\n    return function(value) {\r\n        if(choices.indexOf(value) === -1) {\r\n            throw new ValidationError(\"Invalid choice\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport function length(minLength=null, maxLength=null) {\r\n    return function(value) {\r\n        let l = value.length;\r\n\r\n        if(minLength !== null && l < minLength) {\r\n            throw new ValidationError(\"Array length is to small\");\r\n        }\r\n\r\n        if(maxLength !== null && l > maxLength) {\r\n            throw new ValidationError(\"Array length is to big\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport function range(min=null, max=null) {\r\n    return function(value) {\r\n        if(min !== null && value < min) {\r\n            throw new ValidationError(\"Value is to small.\");\r\n        }\r\n\r\n        if(max !== null && value > max) {\r\n            throw new ValidationError(\"Value is to big.\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport function regex(pattern, flags=null) {\r\n    let reg = flags ? new RegExp(pattern, flags) : new RegExp(pattern);\r\n\r\n    return function(value) {\r\n        if(!reg.test(value)) {\r\n            throw new ValidationError(\"Value did not match pattern.\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport function all(...validators) {\r\n    return function(value) {\r\n        for(let validator of validators) {\r\n            value = validator(value);\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport function any(...validators) {\r\n    return function(value) {\r\n        for(let validator of validators) {\r\n            try {\r\n                value = validator(value);\r\n                return value;\r\n            } catch (e) {\r\n                if(!(e instanceof ValidationError)) {\r\n                    throw e;\r\n                }\r\n            }\r\n        }\r\n\r\n        throw new ValidationError(\"Value did not pass any validator.\");\r\n    }\r\n}\r\n\r\n\r\nexport class Attribute {\r\n    static DROP = DROP;\r\n    static TRUE = TRUE;\r\n    static FALSE = FALSE;\r\n    static REQUIRED = REQUIRED;\r\n\r\n    constructor(type, missing=DROP, nullable=null, validator=null) {\r\n        this.type = typeof type === 'function' ? new type() : type;\r\n\r\n        this.missing = missing;\r\n        this.nullable = nullable;\r\n        this.validator = validator;\r\n    }\r\n\r\n    deserialize(data, key) {\r\n        let value = data[key];\r\n\r\n        if(value === undefined) {\r\n            if(this.missing === REQUIRED) {\r\n                throw new ValidationError(`Attribute ${key} is required`);\r\n            } else if(this.missing === DROP) {\r\n                throw DROP;\r\n            } else {\r\n                return this.missing;\r\n            }\r\n        } else if(value === null) {\r\n            if(this.nullable === FALSE || this.nullable === REQUIRED) {\r\n                throw new ValidationError(`Attribute ${key} cannot be null.`);\r\n            } if(this.nullable === null || this.nullable === true) {\r\n                return null;\r\n            } else {\r\n                return this.nullable;\r\n            }\r\n        }\r\n\r\n        if(this.type) {\r\n            value = this.type.deserialize(value);\r\n        }\r\n\r\n        if(this.validator) {\r\n            value = this.validator(value);\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\nexport class AttributeSchema {\r\n    constructor(attributes) {\r\n        this.attributes = attributes;\r\n    }\r\n\r\n    deserialize(data) {\r\n        let r = {};\r\n\r\n        for(let key in this.attributes) {\r\n            if(this.attributes.hasOwnProperty(key)) {\r\n                try {\r\n                    r[key] = this.attributes[key].deserialize(data, key);\r\n                } catch (e) {\r\n                    if(e !== DROP) {\r\n                        throw e;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n}","import {AssertionError} from './errors';\r\nconst REG_WHITESPACE = /\\s+/;\r\n\r\n\r\n/**\r\n * Clamps a value between a minimum and maximum values.\r\n * @param value\r\n * @param minValue\r\n * @param maxValue\r\n * @returns {*}\r\n */\r\nexport function clamp(value, minValue=null, maxValue=null) {\r\n    if(minValue !== null) {\r\n        value = Math.max(value, minValue);\r\n    }\r\n\r\n    if(maxValue !== null) {\r\n        value = Math.min(value, maxValue);\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\nexport function modulo(value, mod) {\r\n    return ((value % mod) + mod) % mod;\r\n}\r\n\r\n\r\nexport function proto(descriptor) {\r\n    descriptor.placement = \"prototype\";\r\n    return descriptor;\r\n}\r\n\r\n\r\n/**\r\n * Returns a random value from an array.\r\n * @param array\r\n * @returns {*}\r\n */\r\nexport function randomChoice(array) {\r\n    return array[Math.floor(Math.random()*array.length)];\r\n}\r\n\r\n\r\n/**\r\n * Checks to see if 2 arrays are \"equal\".\r\n * @param array1\r\n * @param array2\r\n */\r\nexport function arraysEqual(array1, array2) {\r\n    if(array1 === array2) return true; // The same object.\r\n    if(array1 == null || array2 == null) return false;\r\n    if(array1.length !== array2.length) return false;\r\n\r\n    for(let i = 0, l = array1.length; i < l; i++) {\r\n        if(array1[i] !== array2[i]) return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n/**\r\n * Parses an html string into a document fragment.\r\n *\r\n * @param html\r\n * @return {DocumentFragment}\r\n */\r\nexport function parseHTML(html) {\r\n    let template = document.createElement('template');\r\n    template.innerHTML = html.trim();\r\n\r\n    if(template.content) {\r\n        return template.content;\r\n    } else {\r\n        // Doesn't support template tag.\r\n        let fragment = document.createDocumentFragment();\r\n        while(template.firstChild) fragment.appendChild(template.firstChild);\r\n        return fragment;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Tests to see if the object is empty.\r\n *\r\n * @param object\r\n * @return {boolean}\r\n */\r\nexport function isEmptyObject(object) {\r\n    // noinspection LoopStatementThatDoesntLoopJS\r\n    for(let key in object) {\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n/**\r\n * Empties a dom element.\r\n *\r\n * @param element\r\n */\r\nexport function emptyElement(element) {\r\n    while(element.firstChild) element.removeChild(element.firstChild);\r\n}\r\n\r\n\r\n/**\r\n * Adds classes to an element.  Can take a space separated list of classes.\r\n *\r\n * @param element\r\n * @param classes\r\n */\r\nexport function addClasses(element, classes) {\r\n    if(typeof classes === 'string') {\r\n        classes = classes.split(REG_WHITESPACE);\r\n    }\r\n\r\n    element.classList.add(...classes);\r\n}\r\n\r\n\r\n/**\r\n * Removes classes to an element.  Can take a space separated list of classes.\r\n *\r\n * @param element\r\n * @param classes\r\n */\r\nexport function removeClasses(element, classes) {\r\n    if(typeof classes === 'string') {\r\n        classes = classes.split(REG_WHITESPACE);\r\n    }\r\n\r\n    element.classList.remove(...classes);\r\n}\r\n\r\n\r\n/**\r\n * Assigns attributes in an object to an element.\r\n * @param element\r\n * @param attributes\r\n */\r\nexport function assignAttributes(element, attributes) {\r\n    for(let key in attributes) {\r\n        if(attributes.hasOwnProperty(key)) {\r\n            element.setAttribute(key, attributes[key]);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Sets an elements position relative to the document.\r\n *\r\n * @param element\r\n * @param coords\r\n */\r\nexport function setElementOffset(element, coords) {\r\n    if(coords.nodeType) {\r\n        coords = getElementOffset(element);\r\n    } else if(Array.isArray(coords)) {\r\n        coords = {\r\n            left: coords.left,\r\n            top: coords.top\r\n        };\r\n    }\r\n\r\n    let offset = element.getBoundingClientRect();\r\n\r\n    let style = getComputedStyle(element),\r\n        left = parseInt(style.left, 10) || 0,\r\n        top = parseInt(style.top, 10) || 0;\r\n\r\n    element.style.left = (left + (coords.left - offset.left)) + 'px';\r\n    element.style.top = (top + (coords.top - offset.top)) + 'px';\r\n}\r\n\r\n\r\n/**\r\n * Returns the top and left position of an element relative to the document.\r\n *\r\n * @param element\r\n * @return {{top: number, left: number}}\r\n */\r\nexport function getElementOffset(element) {\r\n    let box = element.getBoundingClientRect();\r\n\r\n    return {\r\n        left: box.left + window.pageXOffset,\r\n        top: box.top + window.pageYOffset\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Normalizing accessing scroll position for an element.\r\n *\r\n * Windows and elements have different ways of accessing their scroll left and scroll top values on IE.\r\n * This function normalizes this behavior so getScroll(variable).scrollLeft always works.\r\n * @param element\r\n * @returns {{left, top}}\r\n */\r\nexport function getScroll(element) {\r\n    if(isWindow(element)) {\r\n        return {\r\n            scrollLeft: element.pageXOffset,\r\n            scrollTop: element.pageYOffset\r\n        };\r\n    } else {\r\n        return {\r\n            scrollLeft: element.scrollLeft,\r\n            scrollTop: element.scrollTop\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Test to see if the variable is a window.\r\n * @param variable\r\n * @returns {boolean}\r\n */\r\nexport function isWindow(variable) {\r\n    return variable && typeof variable === 'object' && setInterval in variable;\r\n}\r\n\r\n\r\n/**\r\n * Normalizes setting a scroll position for an element.\r\n * Windows on ie and elements with overflow scroll have different ways of setting the scroll position.\r\n * This methods normalizes them.\r\n * @param element - The element to scroll\r\n * @param scroll - An object with a left or a top property or both.\r\n */\r\nexport function setScroll(element, scroll) {\r\n    if(element.scrollTo) {\r\n        element.scrollTo(scroll);\r\n    } else {\r\n        element.scrollLeft = scroll.left;\r\n        element.scrollTop = scroll.top;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Matches a single dom element based on the given selector.\r\n * Can take a css selector string, a jquery object, a dom element, a document element or a document fragment.\r\n * If a css selector is passed it will query for the element.\r\n * If a jquery object is passed it will return the first matched element.\r\n * If an element is passed it will return that element.\r\n *\r\n * If a context is provided and the selector was a css selector, the selectors scope will be limited to that element.\r\n * Otherwise the context will be the document.\r\n *\r\n * @param selector\r\n * @param context\r\n * @returns {Element|Document|DocumentFragment}\r\n */\r\nexport function selectElement(selector, context=null) {\r\n    if(!context) {\r\n        context = document;\r\n    } else {\r\n        context = selectElement(context);\r\n    }\r\n\r\n    if(typeof selector === 'string') {\r\n        return context.querySelector(selector);\r\n    } else if(selector.jquery) {\r\n        return selector[0];\r\n    } else if(selector.nodeType === 1 || selector.nodeType === 9 || selector.nodeType === 11) {\r\n        return selector;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Asserts that a condition is true or raises an AssertionError.\r\n * @param condition - condition to check.\r\n * @param message - message on fail.\r\n * @throws AssertionError\r\n */\r\nexport function assert(condition, message) {\r\n    if(!condition) {\r\n        throw new AssertionError(message);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse the value into a boolean value or a integer.  Returns the default value on failure if provided.\r\n * Otherwise throws a TypeError.\r\n * @param value\r\n * @param radix\r\n * @param defaultValue\r\n * @returns {boolean|number|*}\r\n */\r\nexport function parseBooleanOrInt(value, radix=10, defaultValue=TypeError) {\r\n    let type = typeof value;\r\n\r\n    if(type === 'boolean' || type === 'number') {\r\n        return value;\r\n    }\r\n\r\n    if(value === 'true') {\r\n        return true;\r\n    } else if(value === 'false') {\r\n        return false;\r\n    }\r\n\r\n    value = parseInt(value, radix);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into boolean or int.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse the value into a boolean value or a float.  Returns the default value on failure if provided.\r\n * Otherwise throws a TypeError.\r\n * @param value\r\n * @param defaultValue\r\n * @returns {boolean|number|*}\r\n */\r\nexport function parseBooleanOrFloat(value, defaultValue=TypeError) {\r\n    let type = typeof value;\r\n\r\n    if(type === 'boolean' || type === 'number') {\r\n        return value;\r\n    }\r\n\r\n    if(value === 'true') {\r\n        return true;\r\n    } else if(value === 'false') {\r\n        return false;\r\n    }\r\n\r\n    value = parseFloat(value);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into boolean or int.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Attempts for parse a boolean value from a string.  Returns the defaultValue on failure if provided.  Otherwise throws\r\n * a TypeError.\r\n * @param value\r\n * @param defaultValue\r\n * @returns {boolean|*}\r\n */\r\nexport function parseBoolean(value, defaultValue=TypeError) {\r\n    if(typeof value === 'boolean') {\r\n        return value;\r\n    } else if(value === 'true') {\r\n        return true;\r\n    } else if(value === 'false') {\r\n        return false;\r\n    } else {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into boolean.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse a string into an integer.  Returns the default value on failure if set.  Otherwise throws a\r\n * TypeError.\r\n * @param value\r\n * @param radix\r\n * @param defaultValue\r\n * @returns {number}\r\n */\r\nexport function parseIntValue(value, radix=10, defaultValue=TypeError) {\r\n    value = parseInt(value, radix);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into integer.\");\r\n        } else {\r\n            // noinspection JSValidateTypes\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse a string into an integer.  Returns the default value on failure if set.  Otherwise throws a\r\n * TypeError.\r\n * @param value\r\n * @param defaultValue\r\n * @returns {number}\r\n */\r\nexport function parseFloatValue(value, defaultValue=TypeError) {\r\n    value = parseFloat(value);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into float.\");\r\n        } else {\r\n            // noinspection JSValidateTypes\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Runs multiple parsers and returns the first one that doesn't throw a TypeError.\r\n * @param value\r\n * @param parsers\r\n * @returns {*}\r\n */\r\nexport function parseAny(value, ...parsers) {\r\n    for(let parser of parsers) {\r\n        try {\r\n            return parser(value);\r\n        } catch(e) {\r\n            if(!(e instanceof TypeError)) {\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n\r\n    throw new TypeError(\"Could not parse value.\");\r\n}\r\n\r\n\r\n/**\r\n * Validates that the value is one of the given choices.\r\n * @param value\r\n * @param choices\r\n * @param defaultValue\r\n * @returns {TypeErrorConstructor|*}\r\n */\r\nexport function validateChoice(value, choices, defaultValue=TypeError) {\r\n    if(choices.indexOf(value) === -1) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Invalid choice.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\nexport function choice(...args) {\r\n    return function(value) {\r\n        if(args.indexOf(value) === -1) {\r\n            throw new TypeError(\"Invalid Choice\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns first child element that matches the test function.\r\n * @param element - Parent element\r\n * @param fn - Test Function\r\n * @returns {Element}\r\n */\r\nexport function findChild(element, fn) {\r\n    for(let i = 0, l = element.children.length; i < l; i++) {\r\n        let child = element.children[i];\r\n\r\n        if(fn(child)) {\r\n            return child;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Creates a filtered list of element from the children that match the test function.\r\n * @param element - Parent element.\r\n * @param fn - Test function.\r\n * @returns {Array}\r\n */\r\nexport function filterChildren(element, fn) {\r\n    let r = [];\r\n\r\n    for(let i = 0, l = element.children.length; i < l; i++) {\r\n        let child = element.children[i];\r\n\r\n        if(fn(child)) {\r\n            r.push(child);\r\n        }\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Returns the object own property or the default value if it does not have that property.\r\n * @param obj\r\n * @param propName\r\n * @param defaultValue\r\n * @returns {*}\r\n */\r\nexport function getOwnProperty(obj, propName, defaultValue=undefined) {\r\n    if(obj.hasOwnProperty(propName)) {\r\n        return obj[propName];\r\n    } else {\r\n        return defaultValue;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the obj value by following it's property path.  For example getPropertyByPath(a, 'b.c.d') is equivalent to\r\n * a.b.c.d but can be passed in string form.\r\n * @param obj\r\n * @param path\r\n * @returns {*}\r\n */\r\nexport function getPropertyByPath(obj, path) {\r\n    let parts = path.split('.'),\r\n        r = obj;\r\n\r\n    for(let part of parts) {\r\n        r = r[part];\r\n    }\r\n\r\n    return r;\r\n}\r\n","import {clamp} from './utility';\r\nimport {ExtendableError, ValueError} from \"./errors\";\r\n\r\n\r\nconst regPercentage = /^(\\d+\\.?\\d*)%$/,\r\n    regWhitespace = /\\s+/,\r\n    regPositionPart = /^([a-zA-Z]*)([+-]?\\d*\\.?\\d*)([a-z%]*)$/, // Parses string like \"left+10px\" into [\"left\", \"+10px\"]\r\n    regTypedNumber = /^([+-]?\\d+\\.?\\d*)([a-z%]*)$/; // parses strings like \"+10px\" into [\"+10\", \"px\"].  AKA, parses the unit out of a number string.\r\n\r\n\r\nexport class UnitError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nconst positionShortHandValues = {\r\n    top: 'center top',\r\n    right: 'right middle',\r\n    bottom: 'center bottom',\r\n    left: 'left middle'\r\n};\r\n\r\n\r\n/**\r\n * Stores a 2 value Vector.\r\n */\r\nexport class Vec2 {\r\n    constructor(x=0, y=0) {\r\n        this[0] = x;\r\n        this[1] = y;\r\n    }\r\n\r\n    add(vec2) {\r\n        if(typeof vec2 === 'number') {\r\n            return new Vec2(\r\n                this[0] + vec2,\r\n                this[1] + vec2\r\n            );\r\n        } else {\r\n            return new Vec2(\r\n                this[0] + vec2[0],\r\n                this[1] + vec2[1]\r\n            );\r\n        }\r\n    }\r\n\r\n    subtract(vec2) {\r\n        if(typeof vec2 === 'number') {\r\n            return new Vec2(\r\n                this[0] - vec2,\r\n                this[1] - vec2\r\n            );\r\n        } else {\r\n            return new Vec2(\r\n                this[0] - vec2[0],\r\n                this[1] - vec2[1]\r\n            );\r\n        }\r\n    }\r\n\r\n    scalar(value) {\r\n        return new Vec2(this[0] * value, this[1] * value);\r\n    }\r\n\r\n    mod(vec2) {\r\n        if(typeof vec2 === 'number') {\r\n            return new Vec2(\r\n                this[0] % vec2,\r\n                this[1] % vec2\r\n            );\r\n        } else {\r\n            return new Vec2(\r\n                this[0] % vec2[0],\r\n                this[1] % vec2[1]\r\n            );\r\n        }\r\n    }\r\n\r\n    equals(vec2) {\r\n        return this === vec2 || (this[0] === vec2[0] && this[1] === vec2[1]);\r\n    }\r\n\r\n    set(value) {\r\n        if(typeof value !== 'object') {\r\n            this[0] = value;\r\n            this[1] = value;\r\n        } else {\r\n            this[0] = value[0];\r\n            this[1] = value[1];\r\n        }\r\n    }\r\n\r\n    clone() {\r\n        return Vec2(this[0], this[1]);\r\n    }\r\n\r\n    get x() {\r\n        return this[0];\r\n    }\r\n\r\n    get y() {\r\n        return this[1];\r\n    }\r\n\r\n    get left() {\r\n        return this[0];\r\n    }\r\n\r\n    get top() {\r\n        return this[1];\r\n    }\r\n\r\n    set x(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set y(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    set left(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set top(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    get width() {\r\n        return this[0];\r\n    }\r\n\r\n    set width(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    get height() {\r\n        return this[1];\r\n    }\r\n\r\n    set height(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    toTranslate() {\r\n        return `translate(${this.x}px, ${this.y}px)`;\r\n    }\r\n\r\n    toTranslate3d() {\r\n        return `translate3d(${this.x}px, ${this.y}px, 0)`;\r\n    }\r\n\r\n    clamp(vec4) {\r\n        return new Vec2(\r\n            clamp(this.left, vec4.left, vec4.right),\r\n            clamp(this.top, vec4.top, vec4.bottom)\r\n        );\r\n    }\r\n\r\n    static fromVertex(vertex) {\r\n        if(Array.isArray(vertex)) {\r\n            return new Vec2(vertex[0], vertex[1]);\r\n        } else if(vertex.hasOwnProperty('left')) {\r\n            return new Vec2(vertex.left, vertex.top);\r\n        } else {\r\n            return new Vec2(vertex.x, vertex.y);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Stores a 3 value vector.\r\n */\r\nexport class Vec3 {\r\n    constructor(x=0, y=0, z=0) {\r\n        this[0] = x;\r\n        this[1] = y;\r\n        this[2] = z;\r\n    }\r\n\r\n    get x() {\r\n        return this[0];\r\n    }\r\n\r\n    get y() {\r\n        return this[1];\r\n    }\r\n\r\n    get z() {\r\n        return this[2];\r\n    }\r\n\r\n    set x(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set y(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    set z(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    get r() {\r\n        return this[0];\r\n    }\r\n\r\n    get g() {\r\n        return this[1];\r\n    }\r\n\r\n    get b() {\r\n        return this[2];\r\n    }\r\n\r\n    set r(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set g(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    set b(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    set(value) {\r\n        if(typeof value !== 'object') {\r\n            this[0] = value;\r\n            this[1] = value;\r\n            this[2] = value;\r\n        } else {\r\n            this[0] = value[0];\r\n            this[1] = value[1];\r\n            this[2] = value[2];\r\n        }\r\n    }\r\n\r\n    add(vec3) {\r\n        if(typeof vec3 === 'number') {\r\n            return new Vec3(\r\n                this[0] + vec3,\r\n                this[1] + vec3,\r\n                this[2] + vec3\r\n            );\r\n        } else {\r\n            return new Vec3(\r\n                this[0] + vec3[0],\r\n                this[1] + vec3[1],\r\n                this[2] + vec3[2]\r\n            );\r\n        }\r\n    }\r\n\r\n    subtract(vec3) {\r\n        if(typeof vec3 === 'number') {\r\n            return new Vec3(\r\n                this[0] - vec3,\r\n                this[1] - vec3,\r\n                this[2] - vec3\r\n            );\r\n        } else {\r\n            return new Vec3(\r\n                this[0] - vec3[0],\r\n                this[1] - vec3[1],\r\n                this[2] - vec3[2]\r\n            );\r\n        }\r\n    }\r\n\r\n    scalar(value) {\r\n        return new Vec3(\r\n            this[0] * value,\r\n            this[1] * value,\r\n            this[2] * value\r\n        );\r\n    }\r\n\r\n    equals(vec3) {\r\n        return vec3 === this || (vec3[0] === this[0] && vec3[1] === this[1] && vec3[2] === this[2]);\r\n    }\r\n\r\n    mod(vec3) {\r\n        if(typeof vec3 === 'number') {\r\n            return new Vec3(\r\n                this[0] % vec3,\r\n                this[1] % vec3,\r\n                this[2] % vec3\r\n            );\r\n        } else {\r\n            return new Vec3(\r\n                this[0] % vec3[0],\r\n                this[1] % vec3[1],\r\n                this[2] % vec3[2]\r\n            );\r\n        }\r\n    }\r\n\r\n    clone() {\r\n        return new Vec3(this[0], this[1], this[2]);\r\n    }\r\n\r\n    toHex() {\r\n        let r = Math.round(this.r).toString(16),\r\n            g = Math.round(this.g).toString(16),\r\n            b = Math.round(this.b).toString(16);\r\n\r\n        if(r.length === 1) {\r\n            r = '0' + r;\r\n        }\r\n\r\n        if(g.length === 1) {\r\n            g = '0' + g;\r\n        }\r\n\r\n        if(b.length === 1) {\r\n            b = '0' + b;\r\n        }\r\n\r\n        return `#${r}${g}${b}`;\r\n    }\r\n\r\n    toRGB() {\r\n        return `rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`;\r\n    }\r\n\r\n    toTranslate3d() {\r\n        return `translate3d(${this.x}px, ${this.y}px, ${this.z}px)`;\r\n    }\r\n\r\n    static fromHex(hex) {\r\n        let m = /^#?([0-9a-f]{3})$/i.exec(hex);\r\n\r\n        if(m) {\r\n            hex = m[1][0] + m[1][0] + m[1][1] + m[1][1] + m[1][2] + m[1][2];\r\n        } else {\r\n            m = /^#?([0-9a-f]{6})$/i.exec(hex);\r\n\r\n            if(m) {\r\n                hex = m[1];\r\n            } else {\r\n                throw new Error(`Could not parse value ${hex}`);\r\n            }\r\n        }\r\n\r\n        hex = parseInt(hex, 16);\r\n\r\n        // r, g, b\r\n        return new Vec3(\r\n            hex & 0xff0000 >> 16,\r\n            hex & 0x00ff00 >> 8,\r\n            hex & 0x0000ff\r\n        );\r\n    }\r\n\r\n    static fromRGB(value) {\r\n        let m = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/.exec(value);\r\n\r\n        if(!m) {\r\n            throw new Error(`Could not parse rgb value ${value}`);\r\n        }\r\n\r\n        return new Vec3(\r\n            parseInt(m[1], 10),\r\n            parseInt(m[2], 10),\r\n            parseInt(m[3], 10),\r\n        );\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Class to store a 4 value vector.\r\n * Provides DOMRect interface.\r\n */\r\nexport class Vec4 {\r\n    /**\r\n     * r, g, b, a\r\n     * left, top, right, bottom\r\n     *\r\n     * @param left\r\n     * @param top\r\n     * @param right\r\n     * @param bottom\r\n     */\r\n    constructor(left, top, right, bottom) {\r\n        this[0] = left;\r\n        this[1] = top;\r\n        this[2] = right;\r\n        this[3] = bottom;\r\n    }\r\n\r\n    get r() {\r\n        return this[0];\r\n    }\r\n\r\n    set r(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    get g() {\r\n        return this[1];\r\n    }\r\n\r\n    set g(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    get b() {\r\n        return this[2];\r\n    }\r\n\r\n    set b(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    get a() {\r\n        return this[3];\r\n    }\r\n\r\n    set a(value) {\r\n        this[3] = value;\r\n    }\r\n\r\n    set(valueOrVec4) {\r\n        if(typeof valueOrVec4 !== 'object') {\r\n            this[0] = valueOrVec4;\r\n            this[1] = valueOrVec4;\r\n            this[2] = valueOrVec4;\r\n            this[3] = valueOrVec4;\r\n        } else {\r\n            this[0] = valueOrVec4[0];\r\n            this[1] = valueOrVec4[1];\r\n            this[2] = valueOrVec4[2];\r\n            this[3] = valueOrVec4[3];\r\n        }\r\n    }\r\n\r\n    add(valueOrVec4) {\r\n        if(typeof valueOrVec4 === 'number') {\r\n            return this._new(\r\n                this[0] + valueOrVec4,\r\n                this[1] + valueOrVec4,\r\n                this[2] + valueOrVec4,\r\n                this[3] + valueOrVec4\r\n            );\r\n        } else {\r\n            return this._new(\r\n                this[0] + valueOrVec4[0],\r\n                this[1] + valueOrVec4[1],\r\n                this[2] + valueOrVec4[2],\r\n                this[3] + valueOrVec4[3]\r\n            );\r\n        }\r\n    }\r\n\r\n    subtract(valueOrVec4) {\r\n        if(typeof valueOrVec4 === 'number') {\r\n            return this._new(\r\n                this[0] - valueOrVec4,\r\n                this[1] - valueOrVec4,\r\n                this[2] - valueOrVec4,\r\n                this[3] - valueOrVec4\r\n            );\r\n        } else {\r\n            return this._new(\r\n                this[0] - valueOrVec4[0],\r\n                this[1] - valueOrVec4[1],\r\n                this[2] - valueOrVec4[2],\r\n                this[3] - valueOrVec4[3]\r\n            );\r\n        }\r\n    }\r\n\r\n    scalar(value) {\r\n        return this._new(\r\n            this[0] * value,\r\n            this[1] * value,\r\n            this[2] * value,\r\n            this[3] * value\r\n        );\r\n    }\r\n\r\n    equals(vec4) {\r\n        return vec4 === this || (vec4[0] === this[0] && vec4[1] === this[1] && vec4[2] === this[2] && vec4[3] === this[3]);\r\n    }\r\n\r\n    mod(valueOrVec4) {\r\n        if(typeof valueOrVec4 === 'number') {\r\n            return this._new(\r\n                this[0] % valueOrVec4,\r\n                this[1] % valueOrVec4,\r\n                this[2] % valueOrVec4,\r\n                this[3] % valueOrVec4,\r\n            );\r\n        } else {\r\n            return this._new(\r\n                this[0] % valueOrVec4[0],\r\n                this[1] % valueOrVec4[1],\r\n                this[2] % valueOrVec4[2],\r\n                this[3] % valueOrVec4[3]\r\n            );\r\n        }\r\n    }\r\n\r\n    toRGBA() {\r\n        return `rgba(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)}, ${this.a})`;\r\n    }\r\n\r\n    clone() {\r\n        return new this.constructor(this[0], this[1], this[2], this[3]);\r\n    }\r\n\r\n    _new(left, top, right, bottom) {\r\n        return new this.constructor(left, top, right, bottom);\r\n    }\r\n\r\n    static fromRGBAObject({r, g, b, a}) {\r\n        return new Vec4(r, g, b, a);\r\n    }\r\n\r\n    static fromRGBA(value) {\r\n        let m = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d+\\.?\\d*)\\)$/.exec(value);\r\n\r\n        if(!m) {\r\n            throw new Error(`Could not parse rgba value ${value}`);\r\n        }\r\n\r\n        return new Vec4(\r\n            parseInt(m[1], 10),\r\n            parseInt(m[2], 10),\r\n            parseInt(m[3], 10),\r\n            parseFloat(m[4]),\r\n        );\r\n    }\r\n}\r\n\r\n\r\nexport class Rect extends Vec4 {\r\n    constructor(left, top, right, bottom, domElement=null) {\r\n        if(typeof left === 'object' && left.getBoundingClientRect) {\r\n            if(left.getBoundingClientRect) {\r\n                domElement = left;\r\n                let bb = domElement.getBoundingClientRect();\r\n                left = bb.left;\r\n                top = bb.top;\r\n                right = bb.right;\r\n                bottom = bb.bottom;\r\n            } else {\r\n                top = left.top;\r\n                right = left.right;\r\n                bottom = left.bottom;\r\n                left = left.left;\r\n            }\r\n        }\r\n\r\n        super(left, top, right, bottom);\r\n        this.domElement = domElement;\r\n    }\r\n\r\n    bind(element) {\r\n        return this._new(this.left, this.top, this.right, this.bottom, element);\r\n    }\r\n\r\n    _new(left, top, right, bottom, domElement=undefined) {\r\n        return new this.constructor(left, top, right, bottom, domElement === undefined ? this.domElement : domElement);\r\n    }\r\n\r\n    toPoint() {\r\n        return new Vec2(this[0], this[1]);\r\n    }\r\n\r\n    getArea() {\r\n        return this.width * this.height;\r\n    }\r\n\r\n    translate(x, y) {\r\n        if(typeof x === 'object') {\r\n            y = x.y;\r\n            x = x.x;\r\n        }\r\n\r\n        return this._new(\r\n            this[0] + x,\r\n            this[1] + y,\r\n            this[2] + x,\r\n            this[3] + y\r\n        );\r\n    }\r\n\r\n    addMargins({left, top, right, bottom}) {\r\n        return this._new(\r\n            this.left - left,\r\n            this.top - top,\r\n            this.right + right,\r\n            this.bottom + bottom\r\n        );\r\n    }\r\n\r\n    addPaddings({left, top, right, bottom}) {\r\n        return this._new(\r\n            this.left + left,\r\n            this.top + top,\r\n            this.right - right,\r\n            this.bottom - bottom\r\n        );\r\n    }\r\n\r\n    moveTo({left, top}) {\r\n        let deltaX = left - this.left,\r\n            deltaY = top - this.top;\r\n\r\n        return this._new(\r\n            this.left + deltaX,\r\n            this.top + deltaY,\r\n            this.right + deltaX,\r\n            this.bottom + deltaY\r\n        );\r\n    }\r\n\r\n    intersection({left, top, right, bottom}) {\r\n        left = Math.max(this.left, left);\r\n        right = Math.min(this.right, right);\r\n        bottom = Math.min(this.bottom, bottom);\r\n        top = Math.max(this.top, top);\r\n\r\n        if(left > right || top > bottom) {\r\n            return null;\r\n        }\r\n\r\n        return this._new(left, top, right, bottom);\r\n    }\r\n\r\n    contains(rect) {\r\n        return this.left <= rect.left && this.right >= rect.right && this.top <= rect.top && this.bottom >= rect.bottom;\r\n    }\r\n\r\n    containsX(rect) {\r\n        return this.left <= rect.left && this.right >= rect.right;\r\n    }\r\n\r\n    containsY(rect) {\r\n        return this.top <= rect.top && this.bottom >= rect.bottom;\r\n    }\r\n\r\n    isXOverlapping(rect) {\r\n        return (rect.left <= this.right && rect.right >= this.left);\r\n    }\r\n\r\n    isYOverlapping(rect) {\r\n        return (rect.top <= this.bottom && rect.bottom >= this.top);\r\n    }\r\n\r\n    clampXY(rect) {\r\n        let width = this.right - this.left,\r\n            height = this.bottom - this.top,\r\n            left = clamp(this.left, rect.left, rect.right),\r\n            top = clamp(this.top, rect.top, rect.bottom);\r\n\r\n        return this._new(left, top, left + width, top + height);\r\n    }\r\n\r\n    clamp(rect) {\r\n        rect = rect.subtract(new Rect(0, 0, this.width, this.height));\r\n\r\n        let width = this.width,\r\n            height = this.height,\r\n            left = clamp(this.left, rect.left, rect.right),\r\n            top = clamp(this.top, rect.top, rect.bottom);\r\n\r\n        return this._new(\r\n            left,\r\n            top,\r\n            left + width,\r\n            top + height\r\n        );\r\n    }\r\n\r\n    clampX(rect) {\r\n        rect = rect.subtract(new Rect(0, 0, this.width, this.height));\r\n\r\n        let width = this.width,\r\n            left = clamp(this.left, rect.left, rect.right);\r\n\r\n        return this._new(\r\n            left,\r\n            this.top,\r\n            left + width,\r\n            this.bottom\r\n        );\r\n    }\r\n\r\n    clampY(rect) {\r\n        rect = rect.subtract(new Rect(0, 0, this.width, this.height));\r\n\r\n        let height = this.height,\r\n            top = clamp(this.top, rect.top, rect.bottom);\r\n\r\n        return this._new(\r\n            this.left,\r\n            top,\r\n            this.right,\r\n            top + height\r\n        );\r\n    }\r\n\r\n    getDistanceBetween(rect) {\r\n        rect = Rect.fromRect(rect);\r\n\r\n        let isXOverlapping = this.isXOverlapping(rect),\r\n            isYOverlapping = this.isYOverlapping(rect);\r\n\r\n        if(isXOverlapping && isYOverlapping) {\r\n            // Items are overlapping\r\n            return 0;\r\n        } else if(isXOverlapping) {\r\n            return Math.min(\r\n                Math.abs(this.bottom - rect.top),\r\n                Math.abs(this.top - rect.bottom)\r\n            );\r\n        } else if(isYOverlapping) {\r\n            return Math.min(\r\n                Math.abs(this.right - rect.left),\r\n                Math.abs(this.left - rect.right)\r\n            );\r\n        } else {\r\n            let x1, y1, x2, y2;\r\n\r\n            if(this.right <= rect.left) {\r\n                x1 = this.right;\r\n                x2 = rect.left;\r\n            } else {\r\n                x1 = this.left;\r\n                x2 = rect.right;\r\n            }\r\n\r\n            if(this.bottom <= rect.top) {\r\n                y1 = this.bottom;\r\n                y2 = rect.top;\r\n            } else {\r\n                y1 = this.top;\r\n                y2 = rect.bottom;\r\n            }\r\n\r\n            // Use distance formula to calculate distance.\r\n            return Math.round(Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)));\r\n        }\r\n    }\r\n\r\n    position({my, at, of, inside=null, collision=null}) {\r\n        if(of.getBoundingClientRect) {\r\n            of = new Rect(of);\r\n        }\r\n\r\n        if(inside && inside.getBoundingClientRect) {\r\n            inside = new Rect(inside);\r\n        }\r\n\r\n        // collision can be string with a space separating the x and y values.\r\n        // for example \"fit flipfit\"\r\n        // normalize it to an {x, y} object.\r\n        if(collision && typeof collision === 'string') {\r\n            let parts = collision.trim().split(regWhitespace);\r\n            collision = {\r\n                x: parts[0],\r\n                y: parts[1]\r\n            };\r\n        }\r\n\r\n        let anchor = this.evaluatePositionString(my),\r\n            reference = of.evaluatePositionString(at),\r\n            deltaX = reference.x - anchor.x,\r\n            deltaY = reference.y - anchor.y;\r\n\r\n        let rect = this.translate(deltaX, deltaY);\r\n\r\n        if(!collision || !inside || inside.contains(rect)) {\r\n            return rect;\r\n        }\r\n\r\n        let flip = false,\r\n            collisionX = 'none',\r\n            collisionY = 'none';\r\n\r\n        if(!inside.containsX(rect)) {\r\n            if(collision.x === 'flip' || collision.x === 'flipfit') {\r\n                let center = this.left + (this.width / 2);\r\n                anchor.x = ((anchor.x - center) * -1) + center;\r\n\r\n                center = of.left + (of.width / 2);\r\n                reference.x = ((reference.x - center)*-1) + center;\r\n                flip = true;\r\n                collisionX = 'flip';\r\n            }\r\n        }\r\n\r\n        if(!inside.containsY(rect)) {\r\n            if(collision.y === 'flip' || collision.y === 'flipfit') {\r\n                let middle = this.top + (this.height / 2);\r\n                anchor.y = ((anchor.y - middle)*-1) + middle;\r\n\r\n                middle = of.top + (of.height / 2);\r\n                reference.y = ((reference.y - middle)*-1) + middle;\r\n                flip = true;\r\n                collisionY = 'flip';\r\n            }\r\n        }\r\n\r\n        if(flip) {\r\n            deltaX = reference.x - anchor.x;\r\n            deltaY = reference.y - anchor.y;\r\n            rect = this.translate(deltaX, deltaY);\r\n\r\n            if(inside.contains(rect)) {\r\n                rect.collsionX = collisionX;\r\n                rect.collsionY = collisionY;\r\n                return rect;\r\n            }\r\n        }\r\n\r\n        if(collision.x === 'fit' || collision.x === 'flipfit') {\r\n            rect = rect.clampX(inside);\r\n            collisionX = collisionX === 'flip' ? 'flipfit': 'fit';\r\n        }\r\n\r\n        if(collision.y === 'fit' || collision.y === 'flipfit') {\r\n            rect = rect.clampY(inside);\r\n            collisionY = collisionY === 'flip' ? 'flipfit': 'fit';\r\n        }\r\n\r\n        rect.collsionX = collisionX;\r\n        rect.collsionY = collisionY;\r\n        return rect;\r\n    }\r\n\r\n    evaluatePositionString(string) {\r\n        if(positionShortHandValues[string]) {\r\n            string = positionShortHandValues[string];\r\n        }\r\n\r\n        let pos = string.trim().split(regWhitespace),\r\n            x = pos[0],\r\n            y = pos[1],\r\n            rx = null,\r\n            ry = null;\r\n\r\n        if(x) {\r\n            rx = this._evaluatePositionStringComponent(x, 'x');\r\n        }\r\n\r\n        if(y) {\r\n            ry = this._evaluatePositionStringComponent(y, 'y');\r\n        }\r\n\r\n        return new Vec2(rx, ry);\r\n    }\r\n\r\n    /**\r\n     * Evaluates a position string value such as \"left+10px\" into it final position on the rect.\r\n     * @param value - The value to evaluate.\r\n     * @param direction - The direction type.  Should be either \"x\" or \"y\".\r\n     * @returns {number}\r\n     * @private\r\n     */\r\n    _evaluatePositionStringComponent(value, direction) {\r\n        let parts = regPositionPart.exec(value),\r\n            r = 0;\r\n\r\n        if(parts[1]) {\r\n            let p = parts[1];\r\n\r\n            if(direction === 'x') {\r\n                if(p === 'left') {\r\n                    r = this.left;\r\n                } else if(p === 'center' || p === 'middle') {\r\n                    r = this.left + (this.width / 2);\r\n                } else if(p === 'right') {\r\n                    r = this.left + this.width;\r\n                } else {\r\n                    throw new ValueError(`Invalid Option: ${p}`);\r\n                }\r\n            } else {\r\n                if(p === 'top') {\r\n                    r = this.top;\r\n                } else if(p === 'middle' || p === 'center') {\r\n                    r = this.top + (this.height / 2);\r\n                } else if(p === 'bottom') {\r\n                    r = this.top + this.height;\r\n                } else {\r\n                    throw new ValueError(`Invalid Option: ${p}`);\r\n                }\r\n            }\r\n        } else if(direction === 'x') {\r\n            r = this.left;\r\n        } else {\r\n            r = this.top;\r\n        }\r\n\r\n        if(parts[2]) {\r\n            let value = parseFloat(parts[2]),\r\n                type = parts[3] || 'px';\r\n\r\n            if(type === 'px') {\r\n                r += value;\r\n            } else if(type === '%') {\r\n                if(direction === 'x') {\r\n                    r += (value / 100) * this.width;\r\n                } else {\r\n                    r += (value / 100) * this.height;\r\n                }\r\n            } else {\r\n                throw new UnitError(\"Invalid unit: Must be either % or px.\");\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static fromRect({left, top, right, bottom}) {\r\n        return new Rect(left, top, right, bottom);\r\n    }\r\n\r\n    static getBoundingClientRect(element) {\r\n        return new Rect(element);\r\n    }\r\n\r\n    get left() {\r\n        return this[0];\r\n    }\r\n\r\n    get top() {\r\n        return this[1];\r\n    }\r\n\r\n    get right() {\r\n        return this[2];\r\n    }\r\n\r\n    get bottom() {\r\n        return this[3];\r\n    }\r\n\r\n    set left(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set top(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    set right(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    set bottom(value) {\r\n        this[3] = value;\r\n    }\r\n\r\n    get width() {\r\n        return this.right - this.left;\r\n    }\r\n\r\n    get height() {\r\n        return this.bottom - this.top;\r\n    }\r\n\r\n    set width(value) {\r\n        this.right = this.left + value;\r\n    }\r\n\r\n    set height(value) {\r\n        this.bottom = this.top + value;\r\n    }\r\n\r\n    get x() {\r\n        return this.left;\r\n    }\r\n\r\n    get y() {\r\n        return this.top;\r\n    }\r\n\r\n    set x(value) {\r\n        this.left = value;\r\n    }\r\n\r\n    set y(value) {\r\n        this.top = value;\r\n    }\r\n}\r\n\r\n\r\nexport class RGBA extends Vec4 {\r\n    constructor(r, g, b, a) {\r\n        if(typeof r === 'object') {\r\n            super(r);\r\n        } else {\r\n            super(r, g, b, a);\r\n        }\r\n    }\r\n\r\n    toString() {\r\n        return `rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`;\r\n    }\r\n\r\n    static parseRGBAColorStringArgs(value) {\r\n        value = value.trim().split(/\\s+/);\r\n\r\n        let r = value[0],\r\n            g = value[1],\r\n            b = value[2],\r\n            a = value[3];\r\n\r\n        if(r) {\r\n            if(regPercentage.test(r)) {\r\n                r = (parseFloat(r) / 100) * 255;\r\n            } else {\r\n                r = parseInt(r, 10);\r\n            }\r\n        }\r\n\r\n        if(g) {\r\n            if(regPercentage.test(g)) {\r\n                g = (parseFloat(g) / 100) * 255;\r\n            } else {\r\n                g = parseInt(g, 10);\r\n            }\r\n        }\r\n\r\n        if(b) {\r\n            if(regPercentage.test(b)) {\r\n                b = (parseFloat(b) / 100) * 255;\r\n            } else {\r\n                b = parseInt(b, 10);\r\n            }\r\n        }\r\n\r\n        if(a) {\r\n            if(regPercentage.test(a)) {\r\n                a = (parseFloat(a) / 100);\r\n            } else {\r\n                a = parseFloat(a);\r\n            }\r\n        }\r\n\r\n        a = a || 1.0;\r\n\r\n        return new RGBA(r, g, b, a);\r\n    }\r\n\r\n    static parseHexColorStringArg(value) {\r\n        value = value.trim().substring(1);\r\n\r\n        let r, g, b, a = 1.0;\r\n\r\n        if(value.length === 3) {\r\n            r = value[0];\r\n            g = value[1];\r\n            b = value[2];\r\n\r\n            r = parseInt(r+r, 16);\r\n            g = parseInt(g+g, 16);\r\n            b = parseInt(b+b, 16);\r\n        } else if(value.length === 6) {\r\n            r = value.substr(0, 2);\r\n            g = value.substr(2, 2);\r\n            b = value.substr(4, 2);\r\n\r\n            r = parseInt(r, 16);\r\n            g = parseInt(g, 16);\r\n            b = parseInt(b, 16);\r\n        } else if(value.length === 8) {\r\n            r = value.substr(0, 2);\r\n            g = value.substr(2, 2);\r\n            b = value.substr(4, 2);\r\n            a = value.substr(6, 2);\r\n\r\n            r = parseInt(r, 16);\r\n            g = parseInt(g, 16);\r\n            b = parseInt(b, 16);\r\n            a = parseInt(a, 16) / 255;\r\n        }\r\n\r\n        return new RGBA(r, g, b, a);\r\n    }\r\n}\r\n","/**\r\n * @interface\r\n * @abstract\r\n */\r\nexport default class FormWidgetBase {\r\n    constructor(element) {\r\n        this.element = null;\r\n\r\n        if(typeof element === 'string') {\r\n            this.element = document.querySelector(element);\r\n        } else if(element) {\r\n            this.element = element;\r\n        }\r\n    }\r\n\r\n    appendTo(selector) {\r\n        if(typeof selector === 'string') {\r\n            document.querySelector(selector).appendChild(this.element);\r\n        } else if(selector.appendChild) {\r\n            selector.appendChild(this.element);\r\n        } else if(selector.append) {\r\n            selector.append(this.element);\r\n        }\r\n    }\r\n\r\n    remove() {\r\n        this.element.parentElement.removeChild(this.element);\r\n    }\r\n\r\n    /**\r\n     * Returns the current raw value without any cleaning, typecasting, or validation.\r\n     * @abstract\r\n     */\r\n    getValue() {\r\n\r\n    }\r\n\r\n    /**\r\n     * Sets the widgets raw value.\r\n     *\r\n     * @abstract\r\n     * @param value {*}\r\n     */\r\n    setValue(value) {\r\n\r\n    }\r\n\r\n    /**\r\n     * Sets the name of the widget.\r\n     *\r\n     * @abstract\r\n     * @param name {String}\r\n     */\r\n    setName(name) {\r\n\r\n    }\r\n\r\n    /**\r\n     * Returns the name of the widget.\r\n     * @abstract\r\n     * @returns {String}\r\n     */\r\n    getName() {\r\n\r\n    }\r\n\r\n    get id() {\r\n        return this.element.id;\r\n    }\r\n\r\n    set id(id) {\r\n        this.element.id = id;\r\n    }\r\n\r\n    get classList() {\r\n        return this.element.classList;\r\n    }\r\n\r\n    set classList(value) {\r\n        this.element.classList = value;\r\n    }\r\n\r\n    get dataset() {\r\n        return this.element.dataset;\r\n    }\r\n\r\n    set dataset(dataset) {\r\n        this.element.dataset = dataset;\r\n    }\r\n\r\n    get name() {\r\n        return this.getName();\r\n    }\r\n\r\n    set name(value) {\r\n        this.setName(value);\r\n    }\r\n\r\n    get value() {\r\n        return this.getValue();\r\n    }\r\n\r\n    set value(value) {\r\n        this.setValue(value);\r\n    }\r\n}\r\n","import {emptyElement} from \"../core/utility\";\r\nimport FormWidgetBase from \"./FormWidgetBase\";\r\nimport InputWidget from \"./InputWidget\";\r\n\r\n\r\nexport class MultiHiddenInputWidget extends FormWidgetBase {\r\n    constructor(container=null) {\r\n        let element = container || document.createElement('span');\r\n        super(element);\r\n        this.element.style.display = \"none\";\r\n        this._name = \"\";\r\n        this.inputs = [];\r\n        this._value = [];\r\n    }\r\n\r\n    render() {\r\n        let value = this.value;\r\n\r\n        emptyElement(this.element);\r\n\r\n        if(!Array.isArray(value)) {\r\n            value = [value];\r\n        }\r\n\r\n        let fragment = document.createDocumentFragment();\r\n\r\n        for(let v of value) {\r\n            let input = document.createElement('input');\r\n            input.type = \"hidden\";\r\n            input.value = v + \"\";\r\n            if(this.name) input.name = this.name;\r\n            fragment.appendChild(input);\r\n        }\r\n\r\n        this.element.appendChild(fragment);\r\n    }\r\n\r\n    getValue() {\r\n        if(this._value.length === 1) {\r\n            return this._value[0];\r\n        } else {\r\n            return this._value;\r\n        }\r\n    }\r\n\r\n    setValue(value) {\r\n        if(!Array.isArray(value)) {\r\n            value = [value];\r\n        }\r\n\r\n        this._value = value.map(item => item+'');\r\n        this.render();\r\n    }\r\n\r\n    getName() {\r\n        return this._name;\r\n    }\r\n\r\n    setName(name) {\r\n        this._name = name;\r\n\r\n        for(let input of this.element.querySelectorAll('input')) {\r\n            input.name = name;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport default class HiddenInputWidget extends InputWidget {\r\n    constructor(input=null) {\r\n        super(input);\r\n        this.type = 'hidden';\r\n    }\r\n}\r\n","import {emptyElement} from \"../core/utility\";\r\nimport FormWidgetBase from \"./FormWidgetBase\";\r\n\r\n\r\nexport default class InputWidget extends FormWidgetBase {\r\n    constructor(input=null) {\r\n        if(!input) {\r\n            input = document.createElement('input');\r\n        }\r\n\r\n        super(input);\r\n        this.input = input;\r\n    }\r\n\r\n    getValue() {\r\n        return this.input.value;\r\n    }\r\n\r\n    setValue(value) {\r\n        this.input.value = value;\r\n    }\r\n\r\n    getName() {\r\n        return this.input.name;\r\n    }\r\n\r\n    setName(name) {\r\n        this.input.name = name;\r\n    }\r\n\r\n    get type() {\r\n        return this.input.type;\r\n    }\r\n\r\n    set type(type) {\r\n        this.input.type = type;\r\n    }\r\n\r\n    get placeholder() {\r\n        return this.input.placeholder;\r\n    }\r\n\r\n    set placeholder(value) {\r\n        this.input.placeholder = value;\r\n    }\r\n}\r\n","import FormWidgetBase from \"./FormWidgetBase\";\r\n\r\n\r\nexport default class SelectInputWidget extends FormWidgetBase {\r\n    constructor(select, multiple=null, name=null, hidden=null) {\r\n        if(typeof select === 'string') {\r\n            select = document.querySelector(select);\r\n        }\r\n\r\n        super(select);\r\n\r\n        if(name !== null) {\r\n            this.element.name = name;\r\n        }\r\n\r\n        if(multiple !== null) {\r\n            this.element.multiple = multiple;\r\n        }\r\n\r\n        if(hidden !== null) {\r\n            this.isHidden = hidden;\r\n        }\r\n    }\r\n\r\n    get isHidden() {\r\n        return this.element.style.display === 'none';\r\n    }\r\n\r\n    set isHidden(value) {\r\n        if(this.isHidden !== value) {\r\n            if(value) {\r\n                this.element.style.display = \"none\";\r\n            } else {\r\n                this.element.style.display = \"\";\r\n            }\r\n        }\r\n    }\r\n\r\n    appendTo(selector) {\r\n        if(typeof selector === 'string') {\r\n            document.querySelector(selector).appendChild(this.element);\r\n        } else if(selector.appendChild) {\r\n            selector.appendChild(this.element);\r\n        } else if(selector.append) {\r\n            selector.append(this.element);\r\n        }\r\n    }\r\n\r\n    getValue() {\r\n        let r = [];\r\n\r\n        for(let option of this.element.querySelectorAll(\"option\")) {\r\n            if(option.selected) {\r\n                r.push(option.value);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    setValue(values) {\r\n        if(!Array.isArray(values)) {\r\n            values = [values];\r\n        }\r\n\r\n        let options = [];\r\n\r\n        for(let option of this.element.querySelectorAll(\"option\")) {\r\n            options.push({\r\n                element: option,\r\n                value: option.value,\r\n                selected: false\r\n            });\r\n        }\r\n\r\n        for(let value of values) {\r\n            value += \"\";\r\n            let found = false;\r\n\r\n            for(let option of options) {\r\n                if(option.value === value && !option.selected) {\r\n                    option.selected = true;\r\n                    found = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if(!found) {\r\n                throw new Error(`Unknown value: ${value}`);\r\n            }\r\n        }\r\n\r\n        // Select will set its value back to selected if there is no currently selected elements.\r\n        // To fix this select the elements first, then deselect.\r\n        for(let option of options) {\r\n            if(option.selected) {\r\n                option.element.selected = true;\r\n            }\r\n        }\r\n\r\n        for(let option of options) {\r\n            if(!option.selected) {\r\n                option.element.selected = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    clearSelected() {\r\n        let options = this.element.querySelectorAll(\"option\");\r\n\r\n        for(let option of options) {\r\n            option.selected = false;\r\n        }\r\n    }\r\n\r\n    getName() {\r\n        return this.element.name;\r\n    }\r\n\r\n    setName(name) {\r\n        this.element.name = name;\r\n    }\r\n}\r\n","export SelectInputWidget from \"./SelectInputWidget\";\r\nexport HiddenInputWidget, {MultiHiddenInputWidget} from \"./HiddenInputWidget\";\r\nexport FormWidgetBase from \"./FormWidgetBase\";\r\nexport InputWidget from \"./InputWidget\";\r\n","import MenuItem from \"./MenuItem\";\r\nimport AutoLoader from \"autoloader\";\r\nimport * as positioners from \"./positioners\";\r\n\r\n\r\nexport default class DropDown extends MenuItem {\r\n    constructor({toggle=\"both\", closeOnSelect=true, closeOnBlur=true, ...options}) {\r\n        super({toggle, closeOnSelect, closeOnBlur, ...options});\r\n        this.positioner = positioners.DROPDOWN;\r\n        this.init();\r\n    }\r\n}\r\n\r\n\r\nAutoLoader.register('dropdown', (element) => DropDown.FromHTML(element));\r\n","import MenuNode from \"./MenuNode\";\r\nimport MenuItem from \"./MenuItem\";\r\nimport {modulo} from \"core/utility\";\r\nimport {parseHTML} from \"core/utility\";\r\nimport {inherit} from './decorators';\r\nimport AutoLoader from \"autoloader\";\r\nimport {Attribute, AttributeSchema, Integer, Bool, CompoundType} from \"../core/serialize\";\r\n\r\n\r\nconst INT_OR_BOOL_TYPE = new Attribute(new CompoundType(Bool, Integer), Attribute.DROP, Attribute.DROP),\r\n    BOOL_TYPE = new Attribute(Bool, Attribute.DROP, Attribute.DROP);\r\n\r\n\r\nexport const MENU_ATTRIBUTE_SCHEMA = new AttributeSchema({\r\n    closeOnBlur: INT_OR_BOOL_TYPE,\r\n    timeout: INT_OR_BOOL_TYPE,\r\n    autoActivate: INT_OR_BOOL_TYPE,\r\n    openOnHover: INT_OR_BOOL_TYPE,\r\n    closeOnSelect: INT_OR_BOOL_TYPE,\r\n    delay: INT_OR_BOOL_TYPE,\r\n    toggle: BOOL_TYPE,\r\n    visible: BOOL_TYPE\r\n});\r\n\r\n\r\nfunction _isNavigableChild(item) {\r\n    return item.isNavigable;\r\n}\r\n\r\n\r\nfunction _findFirstNavigableChild(children) {\r\n    return children.find(_isNavigableChild);\r\n}\r\n\r\n\r\nfunction _findAllNavigableChildren(children) {\r\n    return children.filter(_isNavigableChild);\r\n}\r\n\r\n\r\n/**\r\n * @abstract\r\n */\r\nexport class AbstractMenu extends MenuNode {\r\n    @inherit positioner;\r\n\r\n    constructor({\r\n            closeOnBlur=false, timeout=false, autoActivate=false, openOnHover=false, toggle=false,\r\n            closeOnSelect=true, delay=false, positioner=\"inherit\", direction=\"vertical\", SubMenuClass=null,\r\n            MenuItemClass=null}={}) {\r\n        super();\r\n\r\n        this.closeOnBlur = closeOnBlur; // both sub-item and menu\r\n        this.timeout = timeout; // both sub-item and menu\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.autoActivate = autoActivate; // sub-item property\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.openOnHover = openOnHover; // sub-item property\r\n        this.toggle = toggle;\r\n        this.closeOnSelect = closeOnSelect; // both sub-item and menu.\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.delay = delay; // sub-item property\r\n        this.positioner = positioner;\r\n        this.direction = direction;\r\n\r\n        this.SubMenuClass = SubMenuClass;\r\n        this.MenuItemClass = MenuItemClass;\r\n    }\r\n\r\n    registerTopics() {\r\n        if(this._isTopicInit) return;\r\n        super.registerTopics();\r\n\r\n        // On child is activate\r\n        // deactivate siblings if multiple is false.\r\n        this.on('menuitem.activate', (target) => {\r\n            if(target.parent === this) {\r\n                if (!this.isActive) {\r\n                    this.activate();\r\n                }\r\n\r\n                for(let child of this.children) {\r\n                    if(child !== target && child.isActive) {\r\n                        child.deactivate();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        this.on('menuitem.deactivate', (target) => {\r\n            if(target.parent === this) {\r\n                if (this.isActive && !this.activeChild) {\r\n                    this.deactivate();\r\n                }\r\n            }\r\n        });\r\n\r\n        this.on('event.click', (event) => this.onClick(event));\r\n        this.on('event.mouseover', (event) => this.onMouseOver(event));\r\n        this.on('event.mouseout', (event) => this.onMouseOut(event));\r\n        this.on('menuitem.select', (event) => this.onSelect(event));\r\n    }\r\n\r\n    activate() {\r\n        if(!this.isActive) {\r\n            let parent = this.parent;\r\n\r\n            // Set isActivate flag and add active classes.\r\n            this.isActive = true;\r\n\r\n            // Register document click handler\r\n            if(this.closeOnBlur && !this._captureDocumentClick) {\r\n                this._captureDocumentClick = {\r\n                    target: document,\r\n\r\n                    onDocumentClick: (event) => {\r\n                        if(!this.element.contains(event.target)) {\r\n                            this.deactivate();\r\n                        }\r\n                    }\r\n                };\r\n\r\n                this._captureDocumentClick.target.addEventListener('click', this._captureDocumentClick.onDocumentClick);\r\n            }\r\n\r\n            // Notify parent that submenu activated.\r\n            if(parent) {\r\n                if(!parent.isActive) parent.activate();\r\n                parent.publish('submenu.activate', this);\r\n            }\r\n\r\n            this.publish('menu.activate');\r\n\r\n            // Dispatch dom events.\r\n            this.element.dispatchEvent(new CustomEvent('menu.activate', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    deactivate() {\r\n        if(this.isActive) {\r\n            // Set flag and remove active classes.\r\n            this.isActive = false;\r\n\r\n            // Clear any active child items.\r\n            this.clearActiveChild();\r\n\r\n            // Remove document click handler that tracks user clicks outside of menu tree.\r\n            if(this._captureDocumentClick) {\r\n                this._captureDocumentClick.target.removeEventListener('click', this._captureDocumentClick.onDocumentClick);\r\n                this._captureDocumentClick = null;\r\n            }\r\n\r\n            // clear timers\r\n            this.clearTimer('timeout');\r\n\r\n            for(let child of this.children) {\r\n                child.clearTimer('activateItem');\r\n            }\r\n\r\n            // Notify parent that submenu deactivated.\r\n            let parent = this.parent;\r\n            if(parent) {\r\n                parent.publish('submenu.deactivate', this);\r\n            }\r\n\r\n            this.publish('menu.deactivate');\r\n\r\n            // Dispatch dom events.\r\n            this.element.dispatchEvent(new CustomEvent('menu.deactivate', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    show() {\r\n        if(!this.isVisible) {\r\n            this.isVisible = true;\r\n\r\n            if(this.parent) this.parent.publish('submenu.show', this);\r\n            this.publish('menu.show', this);\r\n\r\n            this.element.dispatchEvent(new CustomEvent('menu.show', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    hide() {\r\n        if(this.isVisible) {\r\n            this.isVisible = false;\r\n\r\n            if(this.parent) this.parent.publish('submenu.hide', this);\r\n            this.publish('menu.hide', this);\r\n\r\n            this.element.dispatchEvent(new CustomEvent('menu.hide', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    position() {\r\n        let positioner = this.positioner;\r\n\r\n        if(positioner) {\r\n            positioner.call(this, this);\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Tree methods.\r\n\r\n    createItems(data) {\r\n        for(let {submenu, ...args} of data) {\r\n            let item = new this.MenuItemClass(args);\r\n\r\n            if(submenu) {\r\n                let _submenu = new this.SubMenuClass(submenu);\r\n                item.attachSubMenu(_submenu);\r\n            }\r\n\r\n            this.append(item);\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    addItem(text, action=null) {\r\n        let item = new this.MenuItemClass({text, action});\r\n        this.append(item);\r\n        return this;\r\n    }\r\n\r\n    removeItem(item) {\r\n        let index = this._children.indexOf(item);\r\n        if(index !== -1) {\r\n            this._children.splice(index, 1);\r\n            if(item.element.parentElement) item.element.parentElement.removeChild(item.element);\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    hasItem(item) {\r\n        return this._children.indexOf(item) !== -1;\r\n    }\r\n\r\n    append(item) {\r\n        let body = this.getMenuBody();\r\n\r\n        body = body[body.length - 1];\r\n\r\n        if(item.nodeType) {\r\n            body.appendChild(item);\r\n            return this;\r\n        }\r\n\r\n        if(item.parent) {\r\n            item.parent.removeItem(item);\r\n        }\r\n\r\n        item.appendTo(body);\r\n\r\n        if(item.isMenuItem && item.isMenuItem()) {\r\n            item._parent = this;\r\n            this._children.push(item);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    get activeChild() {\r\n        for(let item of this.children) {\r\n            if(item.isActive) {\r\n                return item;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get activeIndex() {\r\n        let children = this.children;\r\n\r\n        for(let i = 0, l = children.length; i < l; i++) {\r\n            if(children[i].isActive) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n    get firstChild() {\r\n        return this.children[0];\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get lastChild() {\r\n        return this.children[this.children.length-1];\r\n    }\r\n\r\n    get firstEnabledChild() {\r\n        let children = this.children;\r\n\r\n        for(let i = 0, l = children.length; i < l; i++) {\r\n            if(!children[i].isDisabled) {\r\n                return children[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get lastEnabledChild() {\r\n        let children = this.children;\r\n\r\n        for(let i = children.length-1, l = 0; i >= l; i--) {\r\n            if(!children[i].isDisabled) {\r\n                return children[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    clearActiveChild() {\r\n        for(let child of this.children) {\r\n            if(child.isActive) {\r\n                child.deactivate();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns list of all menu bodies for the menu.\r\n     *\r\n     * Menu bodies are where item are appended when using function like addItem or append.  They will be added to the\r\n     * last menu body in the menu.\r\n     *\r\n     * @returns {NodeListOf<HTMLElementTagNameMap[string]> | NodeListOf<Element> | NodeListOf<SVGElementTagNameMap[string]> | HTMLElement[]}\r\n     */\r\n    getMenuBody() {\r\n        let bodies = Array.prototype.slice.call(this.element.querySelectorAll(':scope > .menu__body'));\r\n\r\n        if(!bodies.length) {\r\n            return [this.element];\r\n        } else {\r\n            // noinspection JSValidateTypes\r\n            return bodies;\r\n        }\r\n    }\r\n\r\n    isMenu() {\r\n        return true;\r\n    }\r\n\r\n    setParent(parent) {\r\n        parent.attachSubMenu(this);\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Event Handlers\r\n\r\n    onMouseOver() {\r\n        this.clearTimer('timeout');\r\n    }\r\n\r\n    onMouseOut(event) {\r\n        if(!this.element.contains(event.originalEvent.relatedTarget)) {\r\n            if(this.isActive && typeof this.timeout === 'number' && this.timeout >= 0) {\r\n                this.startTimer('timeout', () => {\r\n                    this.deactivate();\r\n                }, this.timeout);\r\n            }\r\n        }\r\n    }\r\n\r\n    onClick(event) {\r\n        if(event.target === this) {\r\n            if(this.isActive && this.toggle) {\r\n                this.deactivate();\r\n            } else if(!this.isActive) {\r\n                this.activate();\r\n            }\r\n\r\n            this.dispatchTopic('menu.click', event);\r\n        }\r\n    }\r\n\r\n    onSelect() {\r\n        if(this.closeOnSelect && this.isActive) {\r\n            this.deactivate();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handles navigating the selection to an item during keyboard navigation.\r\n     * @param item\r\n     * @param showSubMenu\r\n     * @private\r\n     */\r\n    _navigateToItem(item, showSubMenu=false) {\r\n        if(!item) return;\r\n\r\n        let parent = item.parent;\r\n\r\n        if(!parent.isVisible) parent.show();\r\n        if(!parent.isActive) parent.activate();\r\n        if(!item.isActive) item.activate(false);\r\n        if(showSubMenu && item.hasSubMenu() && !item.submenu.isVisible) item.showSubMenu();\r\n    }\r\n\r\n    /**\r\n     * Handles keyboard navigation.\r\n     * @param event\r\n     * @param allowTargetKeys\r\n     * @param _depth\r\n     * @returns {boolean|boolean|*}\r\n     * @private\r\n     */\r\n    _navigate(event, allowTargetKeys=true, _depth=0) {\r\n        let key = event.key,\r\n            ARROW_BACK = 'ArrowUp',\r\n            ARROW_FORWARD = 'ArrowDown',\r\n            ARROW_NEXT = 'ArrowRight',\r\n            ARROW_PREVIOUS = 'ArrowLeft',\r\n            arrowKeys = ['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'],\r\n            arrowKeyPressed = arrowKeys.indexOf(key) !== -1;\r\n\r\n        if(this.direction === 'vertical') {\r\n            ARROW_BACK = 'ArrowLeft';\r\n            ARROW_FORWARD = 'ArrowRight';\r\n            ARROW_NEXT = 'ArrowDown';\r\n            ARROW_PREVIOUS = 'ArrowUp';\r\n        }\r\n\r\n        if(arrowKeyPressed) {\r\n            if(!this.isVisible) {\r\n                this.show();\r\n                event.preventDefault();\r\n                return true;\r\n            }\r\n\r\n            let children = _findAllNavigableChildren(this.children),\r\n                index = children.indexOf(this.activeChild),\r\n                child = children[index];\r\n\r\n            if(key === ARROW_PREVIOUS) {\r\n                if(index === -1) {\r\n                    // When their is no active item, activate the last item.\r\n                    this._navigateToItem(children[children.length-1], this.isRoot);\r\n                } else {\r\n                    this._navigateToItem(children[modulo(index-1, children.length)], this.isRoot);\r\n                }\r\n\r\n                event.preventDefault();\r\n                return true;\r\n            } else if(key === ARROW_NEXT) {\r\n                if(index === -1) {\r\n                    this._navigateToItem(children[0], this.isRoot);\r\n                } else {\r\n                    this._navigateToItem(children[modulo(index+1, children.length)], this.isRoot);\r\n                }\r\n\r\n                event.preventDefault();\r\n                return true;\r\n            } else if(key === ARROW_FORWARD) {\r\n                if(child && child.hasSubMenu() && (!child.submenu.isVisible || !child.submenu.activeChild)) {\r\n                    let ret = false;\r\n\r\n                    if(!child.submenu.isVisible) {\r\n                        ret = true;\r\n                        child.showSubMenu();\r\n                    }\r\n\r\n                    let firstChild = _findFirstNavigableChild(child.submenu.children);\r\n\r\n                    if(firstChild) {\r\n                        ret = true;\r\n                        this._navigateToItem(firstChild, false);\r\n                    }\r\n\r\n                    if(ret) {\r\n                        event.preventDefault();\r\n                        return true;\r\n                    }\r\n                } else if(!child) {\r\n                    let firstChild = _findFirstNavigableChild(this.children);\r\n\r\n                    if(firstChild) {\r\n                        this._navigateToItem(firstChild, this.isRoot);\r\n\r\n                        if(firstChild.hasSubMenu() && firstChild.submenu.isVisible) {\r\n                            let firstSubMenuChild = _findFirstNavigableChild(firstChild.submenu.children);\r\n\r\n                            if(firstSubMenuChild) {\r\n                                this._navigateToItem(firstSubMenuChild, false);\r\n                            }\r\n                        }\r\n\r\n                        event.preventDefault();\r\n                        return true;\r\n                    }\r\n                } else if(!this.isRoot) {\r\n                    return this.parent._navigate(event, allowTargetKeys, _depth+1);\r\n                }\r\n            } else if(key === ARROW_BACK) {\r\n                if(!this.isRoot) {\r\n                    if (this.activeChild && this.activeChild.hasSubMenu() && this.activeChild.submenu.isVisible) {\r\n                        this.activeChild.hideSubMenu();\r\n                        event.preventDefault();\r\n                        return true;\r\n                    } else {\r\n                        return this.parent._navigate(event, allowTargetKeys, _depth + 1);\r\n                    }\r\n                } else if(_depth === 0) {\r\n                    if(child && child.submenu) {\r\n                        return child._navigate(event, allowTargetKeys, 0);\r\n                    } else if(!child) {\r\n                        let firstChild = _findFirstNavigableChild(this.children);\r\n\r\n                        if(firstChild) {\r\n                            return firstChild._navigate(event, allowTargetKeys, 0);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } else if(key === \"Enter\") {\r\n            // The menu is not visible at this point make it visible and return.\r\n            if(!this.isVisible) {\r\n                this.show();\r\n                event.preventDefault();\r\n\r\n                if(!this.activeChild) {\r\n                    let childToActivate = _findFirstNavigableChild(this.children);\r\n                    if(childToActivate) this.firstEnabledChild.activate();\r\n                }\r\n\r\n                return true;\r\n            }\r\n\r\n            if(this.activeChild) {\r\n                if(this.activeChild.hasSubMenu()) {\r\n                    let ret = false;\r\n\r\n                    if(!this.activeChild.submenu.isVisible) {\r\n                        this.activeChild.showSubMenu();\r\n                        event.preventDefault();\r\n                        ret = true;\r\n                    }\r\n\r\n                    if(!this.activeChild.submenu.activeChild) {\r\n                        let childToActivate = _findFirstNavigableChild(this.activeChild.submenu.children);\r\n\r\n                        if(childToActivate) {\r\n                            childToActivate.activate(false);\r\n                            event.preventDefault();\r\n                            ret = true;\r\n                        }\r\n                    }\r\n\r\n                    if(ret) return true;\r\n                } else {\r\n                    this.activeChild.select();\r\n                    event.preventDefault();\r\n                    return true;\r\n                }\r\n            } else {\r\n                let firstChild = _findFirstNavigableChild(this.children);\r\n\r\n                if(firstChild) {\r\n                    firstChild.activate();\r\n\r\n                    if(firstChild.hasSubMenu()) {\r\n                        firstChild.showSubMenu();\r\n\r\n                        if(!firstChild.submenu.activeChild) {\r\n                            let targetChild = _findFirstNavigableChild(firstChild.submenu.children);\r\n\r\n                            if(targetChild) targetChild.activate(false);\r\n                        }\r\n                    }\r\n\r\n                    event.preventDefault();\r\n                    return true;\r\n                }\r\n            }\r\n        } else if(allowTargetKeys) {\r\n            let children = _findAllNavigableChildren(this.children);\r\n\r\n            for(let child of children) {\r\n                if(child.targetKey === key) {\r\n                    event.preventDefault();\r\n\r\n                    if(child.hasSubMenu()) {\r\n                        if(!child.isActive) {\r\n                            child.activate();\r\n                            child.showSubMenu();\r\n                        } else if(!child.submenu.isVisible) {\r\n                            child.showSubMenu();\r\n                        }\r\n                    } else {\r\n                        child.select();\r\n                    }\r\n\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    static getAttributes(element) {\r\n        return {\r\n            ...super.getAttributes(element),\r\n            ...MENU_ATTRIBUTE_SCHEMA.deserialize(element.dataset)\r\n        };\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * A component for rendering nestable list of selectable items.\r\n */\r\nexport default class Menu extends AbstractMenu {\r\n    /**\r\n     *\r\n     * @param target {String|HTMLElement}\r\n     * @param closeOnBlur {Boolean|Number}\r\n     * @param timeout {Boolean|Number}\r\n     * @param autoActivate {Boolean|Number}\r\n     * @param openOnHover {Boolean|Number}\r\n     * @param toggle {boolean}\r\n     * @param closeOnSelect {Boolean}\r\n     * @param delay {Boolean|Number}\r\n     * @param id {String}\r\n     * @param children {Array}\r\n     * @param context\r\n     */\r\n    constructor({target=null, closeOnBlur=false, timeout=false, autoActivate=true, openOnHover=true,\r\n                    toggle=false, closeOnSelect=true, delay=0, children=null, MenuClass=Menu, MenuItemClass=MenuItem,\r\n                    ...context}={}) {\r\n        super({\r\n            closeOnBlur, timeout, autoActivate, open, toggle, closeOnSelect, delay, positioner: 'inherit',\r\n            direction: 'vertical', SubMenuClass: MenuClass, MenuItemClass: MenuItemClass, openOnHover\r\n        });\r\n\r\n        this.events = null;\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render(context);\r\n        }\r\n\r\n        this.registerTopics();\r\n        this.parseDOM();\r\n        this.init();\r\n\r\n        if(children) {\r\n            this.createItems(children);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Renders the domElement of the widget.\r\n     *\r\n     * @param arrow\r\n     * @returns {HTMLElement|Element}\r\n     */\r\n    render({arrow=false}={}) {\r\n        let html = `\r\n            <div class=\"menu\">\r\n                ${arrow ? `<div class=\"menu__arrow\"></div>` : \"\"}\r\n                <div class=\"menu__body\"></div>\r\n            </div>\r\n        `;\r\n\r\n        let fragment = parseHTML(html);\r\n        return fragment.children[0];\r\n    }\r\n}\r\n\r\n\r\nAutoLoader.register('menu', (element) => {\r\n    return Menu.FromHTML(element);\r\n});\r\n","import Menu, {AbstractMenu} from \"./Menu\";\r\nimport MenuItem from './MenuItem';\r\nimport AutoLoader from \"autoloader\";\r\nimport * as positioners from \"./positioners\";\r\n\r\n\r\nexport default class MenuBar extends AbstractMenu {\r\n    constructor({target=null, closeOnBlur=true, timeout=false, autoActivate=false, multiple=false, openOnHover=true,\r\n                    toggle=true, closeOnSelect=true, delay=false, enableKeyboardNavigation=true, ...context}={}) {\r\n\r\n        class SubMenuClass extends Menu {\r\n            constructor(args={}) {\r\n                super({\r\n                    delay,\r\n                    SubMenuClass: SubMenuClass,\r\n                    MenuItemClass: MenuItemClass,\r\n                    ...args\r\n                });\r\n            }\r\n        }\r\n\r\n        class MenuItemClass extends MenuItem {\r\n            constructor(args={}) {\r\n                super({\r\n                    MenuItemClass: MenuItemClass,\r\n                    SubMenuClass: SubMenuClass,\r\n                    ...args\r\n                })\r\n            }\r\n        }\r\n\r\n        super({\r\n            closeOnBlur, timeout, autoActivate, openOnHover, toggle, closeOnSelect, delay,\r\n            positioner: positioners.DROPDOWN,\r\n            direction: 'horizontal',\r\n            SubMenuClass: SubMenuClass,\r\n            MenuItemClass: MenuItemClass\r\n        });\r\n\r\n        this.positioner = positioners.DROPDOWN;\r\n        this.direction = 'horizontal';\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render(context);\r\n        }\r\n\r\n        this.isVisible = true;\r\n\r\n        this.registerTopics();\r\n        this.parseDOM();\r\n        this.init();\r\n\r\n        this.initKeyboardNavigation();\r\n    }\r\n\r\n    render(context) {\r\n        let element = document.createElement('div');\r\n\r\n        element.className = \"menubar\";\r\n\r\n        return element;\r\n    }\r\n\r\n    getMenuBody() {\r\n        return [this.element];\r\n    }\r\n}\r\n\r\n\r\nAutoLoader.register('menubar', (element) => MenuBar.FromHTML(element));\r\n","import MenuNode from \"./MenuNode\";\r\nimport {inherit} from \"./decorators\";\r\nimport Menu from './Menu';\r\nimport {parseHTML} from \"../core/utility\";\r\nimport {AttributeSchema, Attribute, CompoundType, Bool, Integer, Str} from \"../core/serialize\";\r\n\r\n\r\nconst INT_OR_BOOL_TYPE = new Attribute(new CompoundType(Bool, Integer), Attribute.DROP, Attribute.DROP),\r\n    BOOL_TYPE = new Attribute(Bool, Attribute.DROP, Attribute.DROP),\r\n    STRING_TYPE = new Attribute(Str, Attribute.DROP, Attribute.DROP);\r\n\r\n\r\nexport const MENU_ITEM_ATTRIBUTE_SCHEMA = new AttributeSchema({\r\n    closeOnBlur: INT_OR_BOOL_TYPE,\r\n    timeout: INT_OR_BOOL_TYPE,\r\n    autoActivate: INT_OR_BOOL_TYPE,\r\n    openOnHover: INT_OR_BOOL_TYPE,\r\n    closeOnSelect: BOOL_TYPE,\r\n    delay: INT_OR_BOOL_TYPE,\r\n    positioner: STRING_TYPE,\r\n    toggle: BOOL_TYPE\r\n});\r\n\r\n\r\n/**\r\n * @abstract\r\n */\r\nexport class AbstractMenuItem extends MenuNode {\r\n    @inherit toggle;\r\n    @inherit autoActivate;\r\n    @inherit openOnHover;\r\n    @inherit delay = false;\r\n    @inherit positioner;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        /**\r\n         * During keyboard navigation, specifies the key that the user the click to target the menuitem directly.\r\n         * @type {null|String}\r\n         */\r\n        this.targetKey = null;\r\n\r\n        /**\r\n         * Controls how click behavior works.  on is for toggle on only when clicked, off is for toggle off only, both\r\n         * will toggle both on and off and none will cause the item to not be toggleable.\r\n         * @type {string}\r\n         */\r\n        this.toggle = true;\r\n\r\n        /**\r\n         * Controls if the menuitem will activating when the user mouses over it when it's parent is unactive or if the menuitem has no parent.\r\n         * When the parent is active, openOnHover is used instead.\r\n         * @type {string|Number|Boolean}\r\n         */\r\n        this.autoActivate = false;\r\n\r\n        /**\r\n         * Overrides autoActivate when the items parent menu is active.  If null autoActivate is still used.\r\n         * See autoActivate for more details.\r\n         * @type {string}\r\n         */\r\n        this.openOnHover = false;\r\n\r\n        /**\r\n         * Adds adds a delay between a menuitem activating and the menuitem displaying it's submenu.\r\n         * @type {string|Number|Boolean}\r\n         */\r\n        this.delay = false;\r\n\r\n        /**\r\n         * If true the item will close when a descendent menuitem is selected.\r\n         * @type {boolean}\r\n         */\r\n        this.closeOnSelect = false;\r\n\r\n        /**\r\n         * If true the menuitem will close when the user clicks the page outside of the item.\r\n         * @type {boolean}\r\n         */\r\n        this.closeOnBlur = false;\r\n\r\n        /**\r\n         * Controls the amount of time after the user leaves the menuitem that it will remain open.  Time is given in milliseconds.\r\n         * Negative values or false will cause the menuitem to never timeout.  True is interpreted as 0 milliseconds.\r\n         * @type {boolean|Number}\r\n         */\r\n        this.timeout = false;\r\n\r\n        /**\r\n         * A function that is used to position the menuitem's submenu.\r\n         * @type {null|Function}\r\n         */\r\n        this.positioner = \"inherit\";\r\n\r\n        /**\r\n         * If true the menuitem will attempt to deactivate any descending menu-items when the user hover over the direct item.\r\n         * @type {boolean}\r\n         */\r\n        this.clearSubItemsOnHover = true;\r\n\r\n        /**\r\n         * If true the menuitem will deactivate when the user leaves it if it doesn't have a submenu that it needs to keep open.\r\n         * @type {boolean}\r\n         */\r\n        this.autoDeactivateItems = true;\r\n    }\r\n\r\n    registerTopics() {\r\n        if(!this._isTopicInit) {\r\n            super.registerTopics();\r\n            this.on('event.click', (event) => this.onClick(event));\r\n            this.on('event.mouseover', (event) => this.onMouseOver(event));\r\n            this.on('event.mouseout', (event) => this.onMouseOut(event));\r\n            this.on('menuitem.select', (event) => this.onSelect(event));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Activates the item.\r\n     *\r\n     * @param show {boolean|number} - The number of milliseconds after the item activates that the submenu will display.\r\n     */\r\n    activate(show=true) {\r\n        if(this.isActive) return;\r\n        this.isActive = true;\r\n\r\n        this.clearTimer('activateItem');\r\n\r\n        if(this.submenu) {\r\n            if(show === true) {\r\n                this.showSubMenu();\r\n            } else if(typeof show === 'number' && show >= 0) {\r\n                this.startTimer('showTimer', () => {\r\n                    this.showSubMenu();\r\n                }, show);\r\n            }\r\n        }\r\n\r\n        // Register document click handler\r\n        if(this.closeOnBlur && !this._captureDocumentClick) {\r\n            this._captureDocumentClick = {\r\n                target: document,\r\n\r\n                onDocumentClick: (event) => {\r\n                    if(!this.contains(event.target)) {\r\n                        this.deactivate();\r\n                    }\r\n                }\r\n            };\r\n\r\n            this._captureDocumentClick.target.addEventListener('click', this._captureDocumentClick.onDocumentClick);\r\n        }\r\n\r\n        let parent = this.parent;\r\n        if(parent && !parent.isActive) {\r\n            parent.activate();\r\n        }\r\n\r\n        this.dispatchTopic('menuitem.activate', this);\r\n    }\r\n\r\n    /**\r\n     * Deactivates the item.\r\n     */\r\n    deactivate() {\r\n        if(!this.isActive) return;\r\n        this.isActive = false;\r\n        this.clearTimer('showTimer');\r\n\r\n        this.hideSubMenu();\r\n\r\n        // Remove document click handler that tracks user clicks outside of menu tree.\r\n        if(this._captureDocumentClick) {\r\n            this._captureDocumentClick.target.removeEventListener('click', this._captureDocumentClick.onDocumentClick);\r\n            this._captureDocumentClick = null;\r\n        }\r\n\r\n        this.dispatchTopic('menuitem.deactivate', this);\r\n    }\r\n\r\n    /**\r\n     * Triggers a select item event.\r\n     */\r\n    select() {\r\n        this.publish('select');\r\n        this.dispatchTopic('menuitem.select', {target: this});\r\n        this.element.dispatchEvent(new CustomEvent('menuitem.select', {\r\n            detail: this,\r\n            bubbles: true\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * Returns true if the menu node is a menu item.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isMenuItem() {\r\n        return true;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Action management\r\n\r\n    /**\r\n     * Adds an action that will be called when the user selects the item.\r\n     *\r\n     * @param action {Function|String} - A callback to call when the action occurs.\r\n     * @returns {Function}\r\n     */\r\n    addAction(action) {\r\n        if(typeof action === 'string') {\r\n            let fn = () => {\r\n                window.location = action;\r\n            };\r\n\r\n            this.on('select', fn);\r\n            return fn;\r\n        } else {\r\n            this.on('select', action);\r\n            return action;\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Removes an action.\r\n     * @param action\r\n     */\r\n    removeAction(action) {\r\n        this.off('select', action);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Tests to see if the item has an action.\r\n     * @param action\r\n     * @returns {boolean}\r\n     */\r\n    hasAction(action) {\r\n        return this.hasEvent('select', action);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Removes all actions from the item.\r\n     */\r\n    clearActions() {\r\n        this.off('select');\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Manage submenu\r\n\r\n    showSubMenu() {\r\n        let submenu = this.submenu;\r\n\r\n        if(submenu) {\r\n            submenu.show();\r\n            submenu.position();\r\n        }\r\n    }\r\n\r\n    hideSubMenu() {\r\n        if(this.submenu) {\r\n            this.submenu.deactivate();\r\n            this.submenu.hide();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Attaches a submenu to the menuitem.\r\n     *\r\n     * @param submenu\r\n     */\r\n    attachSubMenu(submenu) {\r\n        if(this.submenu) {\r\n            if(this.submenu === submenu) return;\r\n            throw new Error(\"MenuItem can only have one submenu.\");\r\n        }\r\n\r\n        if(submenu.parent) {\r\n            submenu.parent.detachSubMenu();\r\n        }\r\n\r\n        submenu._parent = this;\r\n        this._children = [submenu];\r\n\r\n        if(!submenu.element.parentElement) {\r\n            submenu.appendTo(this.element);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Detaches the submenu from the item.\r\n     * @param remove {Boolean} If true the submenu will be removed from the dom.\r\n     * @returns {*} The detached submenu.\r\n     */\r\n    detachSubMenu(remove=true) {\r\n        let submenu = this.submenu;\r\n\r\n        if(submenu) {\r\n            this._children = [];\r\n            submenu._parent = null;\r\n            if(remove) submenu.remove();\r\n        }\r\n\r\n        return submenu;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the menu item has a submenu.\r\n     * @returns {boolean}\r\n     */\r\n    hasSubMenu() {\r\n        return !!this.submenu;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the item has a submenu and that submenu is visible.\r\n     * @returns {boolean}\r\n     */\r\n    isSubMenuVisible() {\r\n        return this.hasSubMenu() ? this.submenu.isVisible : false;\r\n    }\r\n\r\n    setParent(parent) {\r\n        this._parent = parent;\r\n        parent._children.push(this);\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Event handlers\r\n\r\n    /**\r\n     * Handles select events.\r\n     */\r\n    onSelect() {\r\n        if(this.closeOnSelect && this.isActive) {\r\n            this.deactivate();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handles click events.\r\n     * @param event\r\n     */\r\n    onClick(event) {\r\n        let isDisabled = this.getDisabled();\r\n\r\n        if(isDisabled) {\r\n            event.originalEvent.preventDefault();\r\n        }\r\n\r\n        if(event.target !== this) return;\r\n\r\n        let isDefaultPrevented = false;\r\n\r\n        this.dispatchTopic('menuitem.click', {\r\n            ...event,\r\n            relatedTarget: event.target,\r\n            target: this,\r\n\r\n            preventDefault() {\r\n                isDefaultPrevented = true;\r\n            },\r\n\r\n            isDefaultPrevented() {\r\n                return isDefaultPrevented;\r\n            }\r\n        });\r\n\r\n        let isActive = this.isActive,\r\n            hasSubMenu = this.hasSubMenu(),\r\n            isSubMenuVisible = this.isSubMenuVisible(),\r\n            toggle = this.toggle;\r\n\r\n        // Recheck in case it was updated by an event.\r\n        isDisabled = this.getDisabled();\r\n\r\n        if(!isDisabled && !isDefaultPrevented) {\r\n            if (isActive && hasSubMenu && !isSubMenuVisible) {\r\n                this.showSubMenu();\r\n            } else if (!isActive) {\r\n                this.activate();\r\n            } else if (isActive && toggle && hasSubMenu) {\r\n                this.deactivate();\r\n            }\r\n\r\n            if (isActive && !hasSubMenu) {\r\n                this.select();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handles on mouse over events.\r\n     * @param event\r\n     */\r\n    onMouseOver(event) {\r\n        this.clearTimer('timeout');\r\n\r\n        if(event.target === this) {\r\n            // When the mouse moves on an item clear any active items in it's submenu.\r\n            if (this.submenu && this.clearSubItemsOnHover && this.submenu.clearActiveChild) {\r\n                this.submenu.clearActiveChild();\r\n            }\r\n\r\n            if(this.element.contains(event.originalEvent.relatedTarget)) return;\r\n\r\n            let activate = this.parent && this.parent.isActive && this.openOnHover !== null ? this.openOnHover : this.autoActivate;\r\n\r\n            if (this.parent) {\r\n                this.parent.publish('mouse-enter-item', this, event);\r\n            }\r\n\r\n            if (!this.isActive && !this.isDisabled) {\r\n                if (activate === true) {\r\n                    this.activate(typeof this.delay === 'boolean' ? !this.delay : this.delay);\r\n                } else if (typeof activate === 'number' && activate >= 0) {\r\n                    this.startTimer('activateItem', () => {\r\n                        if (!this.isDisabled) {\r\n                            this.activate(typeof this.delay === 'boolean' ? !this.delay : this.delay);\r\n                        }\r\n                    }, activate);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handles on mouse out events.\r\n     *\r\n     * @param event\r\n     */\r\n    onMouseOut(event) {\r\n        if(this.element.contains(event.originalEvent.relatedTarget)) return;\r\n\r\n        this.clearTimer('activateItem');\r\n\r\n        if(this.parent) {\r\n            this.parent.publish('mouse-leave-item', this, event);\r\n        }\r\n\r\n        if(this.autoDeactivateItems && event.target === this && (!this.hasSubMenu() || !this.submenu.isVisible) && this.isActive) {\r\n            this.deactivate();\r\n        }\r\n\r\n        if(this.isActive && typeof this.timeout === 'number' && this.timeout >= 0) {\r\n            this.startTimer('timeout', () => {\r\n                this.deactivate();\r\n            }, this.timeout);\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Getters and Setters\r\n\r\n    get button() {\r\n        if(!this._button) {\r\n            this._button = Array.prototype.slice.call(this.element.children).find(node => node.matches(\"button, a, .btn, [data-role='button']\"));\r\n        }\r\n\r\n        return this._button;\r\n    }\r\n\r\n    get submenu() {\r\n        return this._children[0];\r\n    }\r\n\r\n    /**\r\n     * Property wrapper around attachSubMenu and detachSubMenu methods.\r\n     * @param value\r\n     */\r\n    set submenu(value) {\r\n        if(!value) {\r\n            this.detachSubMenu();\r\n        } else {\r\n            this.attachSubMenu(value);\r\n        }\r\n    }\r\n\r\n    get text() {\r\n        return this.button.innerText;\r\n    }\r\n\r\n    set text(value) {\r\n        this.button.innerText = value;\r\n    }\r\n\r\n    _navigate(event, _depth=0) {\r\n        if(_depth === 0 && this.hasSubMenu()) {\r\n            return this.submenu._navigate(event, 0);\r\n        } else if(this.parent) {\r\n            return this.parent._navigate(event, _depth);\r\n        }\r\n    }\r\n\r\n    static getAttributes(element) {\r\n        return {\r\n            ...super.getAttributes(element),\r\n            ...MENU_ITEM_ATTRIBUTE_SCHEMA.deserialize(element.dataset)\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport default class MenuItem extends AbstractMenuItem {\r\n    constructor({target, text, action, href=null, toggle=\"inherit\", autoActivate=\"inherit\", openOnHover=\"inherit\",\r\n                    delay='inherit', closeOnSelect=false, closeOnBlur=false, classes, timeout=false,\r\n                    nodeName=\"div\", positioner=\"inherit\", SubMenuClass=Menu, MenuItemClass=MenuItem, ...context}={}) {\r\n        super();\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render({text, nodeName, href, ...context});\r\n        }\r\n\r\n        if(classes) {\r\n            this.addClass(classes);\r\n        }\r\n\r\n        if(action) this.addAction(action);\r\n\r\n        this.toggle = toggle;\r\n        this.autoActivate = autoActivate;\r\n        this.openOnHover = openOnHover;\r\n        this.delay = delay;\r\n\r\n        this.closeOnSelect = closeOnSelect;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.closeOnBlur = closeOnBlur;\r\n        this.timeout = timeout;\r\n\r\n        this.positioner = positioner;\r\n\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.clearSubItemsOnHover = true;\r\n        this.autoDeactivateItems = true;\r\n\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.MenuItemClass = MenuItemClass;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.SubMenuClass = SubMenuClass;\r\n\r\n        this.element.tabIndex = -1;\r\n\r\n        this.registerTopics();\r\n        this.parseDOM();\r\n    }\r\n\r\n    /**\r\n     * Renders the domElement.\r\n     *\r\n     * @param text {String}\r\n     * @param nodeName\r\n     * @param href\r\n     * @returns {HTMLElement|Element}\r\n     */\r\n    render({text, nodeName=\"div\", href=null}={}) {\r\n        let html = `\r\n            <${nodeName} class=\"menuitem\">\r\n                <a class=\"menuitem__button\" ${href ? `href=\"${href}\"` : \"\"}>${text}</a>\r\n            </${nodeName}>\r\n        `;\r\n\r\n        let fragment = parseHTML(html);\r\n        return fragment.children[0];\r\n    }\r\n}\r\n","import Publisher, {STOP} from \"core/Publisher\";\r\nimport {KeyError} from \"core/errors\";\r\nimport {addClasses, removeClasses} from \"core/utility\";\r\nimport {attachMenuInstance, detachMenuInstance, hasMenuInstance, getMenuInstance, getClosestMenuNodeByElement} from \"./utility\";\r\n\r\n\r\n/**\r\n * The base class for Menu and MenuItem.  Provides the utilities that are necessary to manage and transverse the menu tree\r\n * and propagate events throughout it.\r\n * @extends {Publisher}\r\n */\r\nexport default class MenuNode extends Publisher {\r\n    constructor() {\r\n        super();\r\n        this._parent = null;\r\n        this._children = [];\r\n        this._props = {};\r\n        this._eventListeners = {};\r\n        this._keyboardNavigationEnabled = false;\r\n        this._timers = {};\r\n        /**\r\n         * @type {undefined|null|HTMLElement}\r\n         * @private\r\n         */\r\n        this._element = undefined;\r\n\r\n        this.nodeType = null;\r\n        this.isController = false;\r\n        this.closeOnSelect = false;\r\n\r\n        this.SubMenuClass = null;\r\n        this.MenuItemClass = null;\r\n    }\r\n\r\n    /**\r\n     * Initializes the event listeners for the menu tree.  Click, mouse-over and mouse-out are bound.  Events are\r\n     * delegated to their child nodes as needed.  If an event is received where the node is the direct controller of\r\n     * the event will be ignored.\r\n     */\r\n    init() {\r\n        let handleEvent = (event) => {\r\n            let target = this.getTargetNode(event.target),\r\n                wrappedEvent = {\r\n                    target,\r\n                    originalEvent: event\r\n                };\r\n\r\n            if(target.getEventDelegator() === this) {\r\n                target.dispatchTopic(`event.${event.type}`, wrappedEvent);\r\n            }\r\n        };\r\n\r\n        this.addEventListener('mousedown', handleEvent);\r\n        this.addEventListener('mouseover', handleEvent);\r\n        this.addEventListener('mouseout', handleEvent);\r\n        this.addEventListener('click', handleEvent);\r\n        this.addEventListener('keydown', handleEvent);\r\n\r\n        this.isController = true;\r\n\r\n        this.publish('init', this);\r\n    }\r\n\r\n    initKeyboardNavigation() {\r\n        if(!this._keyboardNavigationEnabled) {\r\n            this._keyboardNavigationEnabled = true;\r\n            this.on('event.keydown', (topic) => this._rootKeyDown(topic));\r\n        }\r\n    }\r\n\r\n    registerTopics() {\r\n        if (this._isTopicInit) return;\r\n        this._isTopicInit = true;\r\n    }\r\n\r\n    /**\r\n     * Unbinds all event listeners.\r\n     */\r\n    destroy() {\r\n        this.clearAllRegisteredEvents();\r\n\r\n        this.isController = false;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.__keyboardNavigationEnabled = false;\r\n        this.element = null;\r\n\r\n        this.publish('destroy', this);\r\n\r\n    }\r\n\r\n    /**\r\n     * Renders the component.\r\n     *\r\n     * @param context {Object} Dictionary of values that may be used to render the component during templating.\r\n     * @abstract\r\n     */\r\n    render(context) {\r\n\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Tree transversal and manipulation functions.\r\n\r\n    /**\r\n     * Reference to the nodes parent or null if it is the root node of the tree.\r\n     *\r\n     * @returns {null|MenuNode}\r\n     */\r\n    get parent() {\r\n        return this._parent || null;\r\n    }\r\n\r\n    /**\r\n     * Reference to the root node of the tree.\r\n     *\r\n     * @returns {MenuNode}\r\n     */\r\n    get root() {\r\n        let r = this,\r\n            o = this;\r\n\r\n        while(o) {\r\n            o = o.parent;\r\n\r\n            if(o) {\r\n                r = o;\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Reference to the first ancestor node in the menu tree who is a menu.  Returns null if it does not exist.\r\n     *\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get parentMenu() {\r\n        let parent = this.parent;\r\n        // noinspection JSUnresolvedVariable,JSUnresolvedFunction\r\n        return parent ? parent.closest(node => node.isMenu()) : null;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Reference to the first ancestor node in the menu tree who is an item. Returns null if it does not exist.\r\n     *\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get parentItem() {\r\n        let parent = this.parent;\r\n        // noinspection JSUnresolvedVariable,JSUnresolvedFunction\r\n        return parent ? parent.closest(node => node.isMenuItem()) : null;\r\n    }\r\n\r\n    /**\r\n     * Reference to the next sibling node in the menu tree.\r\n     *\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get nextSibling() {\r\n        return this.getOffsetSibling(1);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Reference to the previous sibling node in the menu tree.\r\n     *\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get previousSibling() {\r\n        return this.getOffsetSibling(-1);\r\n    }\r\n\r\n    /**\r\n     * A list of all children for the node.\r\n     *\r\n     * @returns {[]}\r\n     */\r\n    get children() {\r\n        return this._children.slice(0);\r\n    }\r\n\r\n    get isRoot() {\r\n        return this.root === this;\r\n    }\r\n\r\n    get enabledChildren() {\r\n        return this.children.filter(item => !item.isDisabled);\r\n    }\r\n\r\n    /**\r\n     * Returns the target active item in the tree.\r\n     * @returns {*|{isActive}|null}\r\n     */\r\n    get activeItem() {\r\n        let activeItem = null;\r\n\r\n        if(this.isActive) {\r\n            for(let child of this.children) {\r\n                if(child.isActive) {\r\n                    if(child.isMenuItem && child.isMenuItem()) {\r\n                        activeItem = child.activeItem || child;\r\n                    } else {\r\n                        activeItem = child.activeItem || activeItem;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return activeItem;\r\n    }\r\n\r\n    /**\r\n     * Return the sibling offset from the current node.\r\n     *\r\n     * @param offset\r\n     * @returns {null|MenuNode}\r\n     */\r\n    getOffsetSibling(offset=1) {\r\n        let parent = this.parent;\r\n\r\n        if(parent) {\r\n            let children = parent.children,\r\n                i = children ? children.indexOf(this) : -1;\r\n\r\n            if(i >= 0) {\r\n                i += offset;\r\n\r\n                if(i >= 0) {\r\n                    return children[i];\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Returns the closest MenuNode up the tree that matches the provided test function.\r\n     *\r\n     * @param fn {function(node)}\r\n     * @returns {MenuNode|null}\r\n     */\r\n    closest(fn) {\r\n        let o = this;\r\n\r\n        while(o) {\r\n            if(fn.call(this, o)) return o;\r\n            o = o.parent;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the provided node is a descendant of the current node.\r\n     *\r\n     * @param node\r\n     * @returns {boolean}\r\n     */\r\n    contains(node) {\r\n        if(node.nodeType) {\r\n            node = getClosestMenuNodeByElement(node);\r\n            return node ? this.contains(node) : false;\r\n        }\r\n\r\n        while(node) {\r\n            if(node === this) {\r\n                return true;\r\n            }\r\n\r\n            node = node.parent;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Checks to see if the element is contained within the menu node.  Has to check every child manually since\r\n     * it's not guaranteed that children are descendants of their parent menu nodes in the dom tree.  Probably a very\r\n     * costly method, shouldn't be overused.\r\n     *\r\n     * @param element\r\n     * @returns {boolean}\r\n     */\r\n    containsElement(element) {\r\n        if(this.element.contains(element)) {\r\n            return true;\r\n        }\r\n\r\n        for(let child of this.children) {\r\n            if(child.containsElement(element)) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Yields all descendants.\r\n     *\r\n     * @returns {IterableIterator<MenuNode>}\r\n     */\r\n    *getDescendants() {\r\n        for(let child of this.children) {\r\n            yield child;\r\n\r\n            for(let grandchild of child.getDescendants()) {\r\n                yield grandchild;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the closest menu node instance bound to an element for the target HTMLElement in the current menu tree.\r\n     *\r\n     * @param target {HTMLElement}\r\n     * @returns {null|MenuNode}\r\n     */\r\n    getTargetNode(target) {\r\n        let o = target;\r\n\r\n        while(o) {\r\n            let instance = getMenuInstance(o);\r\n\r\n            if(instance) {\r\n                return instance;\r\n            }\r\n\r\n            if(o === this.element) {\r\n                break;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Returns the target item for the given HTMLElement in the current menu tree.\r\n     *\r\n     * @param target\r\n     * @returns {null}\r\n     */\r\n    getTargetItem(target) {\r\n        let o = target;\r\n\r\n        while(o) {\r\n            let instance = getMenuInstance(o);\r\n\r\n            if(instance && instance.isMenuItem()) {\r\n                return instance;\r\n            }\r\n\r\n            if(o === this.element) {\r\n                break;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Returns the target menu for the given HTMLElement in the current menu tree.\r\n     *\r\n     * @param target\r\n     * @returns {null}\r\n     */\r\n    getTargetMenu(target) {\r\n        let o = target;\r\n\r\n        while(o) {\r\n            let instance = getMenuInstance(o);\r\n\r\n            if(instance && instance.isMenu()) {\r\n                return instance;\r\n            }\r\n\r\n            if(o === this.element) {\r\n                break;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Widget functions\r\n    /**\r\n     * Returns true if the current node is visible.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get isVisible() {\r\n        return !this.element.classList.contains('hidden');\r\n    }\r\n\r\n    /**\r\n     * Sets the visible state of the node.\r\n     *\r\n     * @param value\r\n     */\r\n    set isVisible(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this.isVisible) {\r\n            if(value) {\r\n                this.element.classList.remove('hidden');\r\n            } else {\r\n                this.element.classList.add('hidden');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns true if the current node is disabled.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get isDisabled() {\r\n        return this.element.classList.contains('disabled');\r\n    }\r\n\r\n    /**\r\n     * Sets the disabled state for the current node.\r\n     *\r\n     * @param value\r\n     */\r\n    set isDisabled(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this.isDisabled) {\r\n            if(value) {\r\n                this.element.classList.add('disabled');\r\n            } else {\r\n                this.element.classList.remove('disabled');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Alias for isDisabled getter.\r\n     * @returns {boolean}\r\n     */\r\n    get disabled() {\r\n        return this.isDisabled;\r\n    }\r\n\r\n    /**\r\n     * Alias for isDisabled setter.\r\n     * @param value\r\n     */\r\n    set disabled(value) {\r\n        this.isDisabled = value;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Returns true if the nodes element is defined.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    hasElement() {\r\n        return !!this._element;\r\n    }\r\n\r\n    /**\r\n     * Gets the root HTMLElement of the node.\r\n     *\r\n     * @returns {HTMLElement}\r\n     */\r\n    get element() {\r\n        if(this._element === undefined) {\r\n            this.element = this.render({});\r\n        }\r\n\r\n        return this._element;\r\n    }\r\n\r\n    /**\r\n     * Sets the root HTMLElement of the node.\r\n     *\r\n     * @param element\r\n     */\r\n    set element(element) {\r\n        if(typeof element === 'string') {\r\n            element = document.querySelector(element);\r\n        } else if(typeof element === 'function') {\r\n            element = element.call(this);\r\n        }\r\n\r\n        if(this._element === element) return;\r\n\r\n        if(hasMenuInstance(element)) {\r\n            throw new Error(\"Element is already bound to menu controller\");\r\n        }\r\n\r\n        if(this._element) {\r\n            this.clearAllRegisteredEvents();\r\n            detachMenuInstance(this._element);\r\n            this._element = undefined;\r\n        }\r\n\r\n        attachMenuInstance(element, this);\r\n        this._element = element;\r\n        this._registerAllEvents();\r\n    }\r\n\r\n    /**\r\n     * Appends the component to the target selector.\r\n     *\r\n     * @param selector {string|HTMLElement|{append}}\r\n     */\r\n    appendTo(selector) {\r\n        if(typeof selector === 'string') {\r\n            document.querySelector(selector).appendChild(this.element);\r\n        } else if(selector.appendChild) {\r\n            selector.appendChild(this.element);\r\n        } else if(selector.append) {\r\n            selector.append(this.element);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes the component from the dom.\r\n     *\r\n     * @returns {MenuNode}\r\n     */\r\n    remove() {\r\n        if(this.element.parentElement) {\r\n            this.element.parentElement.removeChild(this.element);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    get id() {\r\n        return this.element.id;\r\n    }\r\n\r\n    set id(id) {\r\n        if(this.element) this.element.id = id;\r\n    }\r\n\r\n    get classList() {\r\n        return this.element.classList;\r\n    }\r\n\r\n    set classList(value) {\r\n        this.element.classList = value;\r\n    }\r\n\r\n    get dataset() {\r\n        return this.element.dataset;\r\n    }\r\n\r\n    set dataset(value) {\r\n        this.element.dataset = value;\r\n    }\r\n\r\n    get style() {\r\n        return this.element.style;\r\n    }\r\n\r\n    set style(style) {\r\n        this.element.style = style;\r\n    }\r\n\r\n    addClass(classes) {\r\n        return addClasses(this.element, classes);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    removeClass(classes) {\r\n        return removeClasses(this.element, classes);\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Menu state functions\r\n\r\n    /**\r\n     * True if the node is active.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get isActive() {\r\n        return this.element.classList.contains('active');\r\n    }\r\n\r\n    /**\r\n     * Sets the isActive state for the node.\r\n     *\r\n     * Will toggle the active class on the root element as needed.\r\n     *\r\n     * @param value\r\n     */\r\n    set isActive(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this.isActive) {\r\n            if(value) {\r\n                this.element.classList.add('active');\r\n            } else {\r\n                this.element.classList.remove('active');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns true if the current node is disabled or if any ancestor node is disabled.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    getDisabled() {\r\n        let o = this;\r\n\r\n        while(o) {\r\n            if(o.isDisabled) {\r\n                return true;\r\n            }\r\n\r\n            o = o.parent;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the node is a menu item.  Should be overridden by subclasses that are menu item like.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isMenuItem() {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the node is a menu.  Method should be defined by any object that should be treated like a menu.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isMenu() {\r\n        return false;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Timer, topic and event functions\r\n\r\n    /**\r\n     * Creates a timer with the given name.  Only one timer with that name can be active per object.\r\n     * If another timer with the same name is created the previous one will be cleared if `clear` is true.\r\n     * Otherwise if `clear` is false a KeyError with be thrown.  The callback function for the timer is called\r\n     * with the current object as it's `this` and the timer object as it's only parameter following the pattern\r\n     *\r\n     * this::fn(timer);\r\n     *\r\n     * @param name {String} The name of the timer.\r\n     * @param fn {function(timer)} Function to call.\r\n     * @param time {Number} The time to wait.\r\n     * @param interval If true setInterval will be used instead of setTimeout\r\n     * @param clear If true an previous timers of the same name will be canceled before creating a new one.  Otherwise a KeyError will be thrown.\r\n     * @returns {{status, id, cancel, type}}\r\n     */\r\n    startTimer(name, fn, time, interval=false, clear=true) {\r\n        if(clear && this._timers[name]) {\r\n            this._timers[name].cancel();\r\n        } else if(this._timers[name]) {\r\n            throw new KeyError(\"Timer already exists.\");\r\n        }\r\n\r\n        let timer = this._timers[name] = {\r\n            status: 'running',\r\n            id: null,\r\n            cancel: null,\r\n            type: null,\r\n        };\r\n\r\n        if(interval) {\r\n            let id = timer.id = setInterval((timer) => {\r\n                fn.call(this, timer);\r\n            }, time, timer);\r\n\r\n            timer.type = 'interval';\r\n\r\n            timer.cancel = () => {\r\n                if(this._timers[name] === timer) {\r\n                    clearInterval(id);\r\n                    delete this._timers[name];\r\n                    timer.status = 'canceled';\r\n                }\r\n            };\r\n        } else {\r\n            let id = timer.id = setTimeout((timer) => {\r\n                delete this._timers[name];\r\n                timer.status = 'complete';\r\n                fn.call(this, timer);\r\n            }, time, timer);\r\n\r\n            timer.type = 'timeout';\r\n\r\n            timer.cancel = () => {\r\n                if(this._timers[name] === timer) {\r\n                    clearTimeout(id);\r\n                    delete this._timers[name];\r\n                    timer.status = 'canceled';\r\n                }\r\n            };\r\n        }\r\n\r\n        return timer;\r\n    }\r\n\r\n    /**\r\n     * Clears the timer with the given name.\r\n     *\r\n     * @param name\r\n     * @returns {boolean} True if a timer was canceled. False if not timer exists.\r\n     */\r\n    clearTimer(name) {\r\n        if(this._timers[name]) {\r\n            this._timers[name].cancel();\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Returns the timer object if it exists.\r\n     *\r\n     * @param name\r\n     * @returns {*}\r\n     */\r\n    getTimer(name) {\r\n        return this._timers[name];\r\n    }\r\n\r\n    /**\r\n     * Returns the MenuNode that is responsible for delegating the events.\r\n     *\r\n     * @returns {null|{isController}|*}\r\n     */\r\n    getEventDelegator() {\r\n        let o = this.element;\r\n\r\n        while(o) {\r\n            let instance = getMenuInstance(o);\r\n\r\n            if(instance && instance.isController) {\r\n                return instance;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Publishes the topic to itself and bubbles up the menu tree.\r\n     *\r\n     * @param topic\r\n     * @param args\r\n     */\r\n    dispatchTopic(topic, ...args) {\r\n        let o = this;\r\n\r\n        while(o) {\r\n            if(o.publish(topic, ...args) === STOP) {\r\n                return STOP;\r\n            }\r\n\r\n            o = o.parent;\r\n        }\r\n    }\r\n\r\n    clearAllRegisteredEvents() {\r\n        if(this.element) {\r\n            for(let key of Object.keys(this._eventListeners)) {\r\n                for(let listener of this._eventListeners[key]) {\r\n                    this.element.removeEventListener(key, listener.callback, listener.bubble);\r\n                }\r\n            }\r\n        }\r\n\r\n        this._eventListeners = {};\r\n    }\r\n\r\n    _registerAllEvents() {\r\n        for(let key of Object.keys(this._eventListeners)) {\r\n            for(let listener of this._eventListeners[key]) {\r\n                this.element.addEventListener(key, listener.callback, listener.bubble);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * A wrapper function around calling this.element.addEventListener.  Will register a listener on the element.\r\n     * This function keeps a record of the event listeners that are attached to the element.  If the element\r\n     * hasn't been rendered yet and this function is called attaching the element will be delayed until element is set.\r\n     *\r\n     * @param name\r\n     * @param callback\r\n     * @param bubble\r\n     */\r\n    addEventListener(name, callback, bubble=false) {\r\n        if(!this._eventListeners[name]) {\r\n            this._eventListeners[name] = [];\r\n        }\r\n\r\n        let listener = {callback, bubble};\r\n        this._eventListeners[name].push(listener);\r\n\r\n        if(this.element) {\r\n            this.element.addEventListener(name, callback, bubble);\r\n        }\r\n    }\r\n\r\n    removeEventListener(name, callback, bubble=false) {\r\n        if(this._eventListeners[name]) {\r\n            for(let i = 0, l = this._eventListeners[name].length; i < l; i++) {\r\n                let listener = this._eventListeners[name][i];\r\n\r\n                if(listener.callback === callback && listener.bubble === bubble) {\r\n                    this._eventListeners.splice(i, 1);\r\n\r\n                    if(!this._eventListeners[name].length) {\r\n                        delete this._eventListeners[name];\r\n                    }\r\n\r\n                    return listener;\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    hasEventListener(name, callback, bubble=false) {\r\n        if(this._eventListeners[name]) {\r\n            for(let listener of this._eventListeners[name]) {\r\n                if(listener.callback === callback && listener.bubble === bubble) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    _rootKeyDown(topic) {\r\n        if(this.isRoot) {\r\n            let event = topic.originalEvent;\r\n\r\n            if(event.key === \"Escape\") {\r\n                this.deactivate();\r\n                // noinspection JSUnresolvedFunction\r\n                document.activeElement.blur();\r\n                return;\r\n            }\r\n\r\n            let activeItem = this.activeItem,\r\n                target = activeItem ? activeItem.parentMenu : this;\r\n\r\n            target._navigate(event);\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Tree parsing functions.\r\n\r\n    /**\r\n     * Parses the dom and initializes any menu or menuitem elements that are found.\r\n     */\r\n    parseDOM() {\r\n        if(this._children.length) {\r\n            for(let child of this._children) {\r\n                child.invalidateTree();\r\n            }\r\n        }\r\n\r\n        let walk = (node) => {\r\n            for(let child of node.children) {\r\n                if(hasMenuInstance(child)) {\r\n                    let instance = getMenuInstance(child);\r\n                    instance.setParent(this);\r\n                } else {\r\n                    let hasMenuItemAttribute = child.hasAttribute('data-menuitem'),\r\n                        hasMenuAttribute = child.hasAttribute('data-menu');\r\n\r\n                    if(hasMenuAttribute && hasMenuItemAttribute) {\r\n                        throw new Error(\"Element cannot be both a menuitem and a menu.\");\r\n                    } else if(hasMenuAttribute) {\r\n                        let menu = this.SubMenuClass.FromHTML(child);\r\n                        menu.setParent(this);\r\n                    } else if(hasMenuItemAttribute) {\r\n                        let item = this.MenuItemClass.FromHTML(child);\r\n                        item.setParent(this);\r\n                    } else {\r\n                        walk(child);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        walk(this.element);\r\n    }\r\n\r\n    /**\r\n     * Invalidates all parent and child references.\r\n     */\r\n    invalidateTree() {\r\n        this._parent = null;\r\n\r\n        for(let child of this.children) {\r\n            child.invalidateTree();\r\n        }\r\n\r\n        this._children = [];\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Static functions\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Returns the bound menu controller for the provided node.\r\n     *\r\n     * @static\r\n     * @param element {HTMLElement}\r\n     */\r\n    static getInstance(element) {\r\n        return getMenuInstance(element);\r\n    }\r\n\r\n    static getAttributes(element) {\r\n        return {};\r\n    }\r\n\r\n    /**\r\n     * Constructs a menu node element for an HTMLElement.\r\n     * @param element {HTMLElement|string}\r\n     * @returns {MenuNode}\r\n     * @constructor\r\n     */\r\n    static FromHTML(element) {\r\n        if(typeof element === 'string') {\r\n            element = document.querySelector(element);\r\n        }\r\n\r\n        let config = this.getAttributes(element);\r\n\r\n        // let parameters = Attribute.deserialize(element.dataset, this.__attributes__);\r\n        //\r\n        // parameters.target = element;\r\n\r\n        return new this({\r\n            target: element,\r\n            ...config\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Used to determine if an item is navigable during keyboard navigation.\r\n     * @returns {boolean}\r\n     * @private\r\n     */\r\n    get isNavigable() {\r\n        return !this.isDisabled && this.isVisible;\r\n    }\r\n}\r\n","import MenuItem, {AbstractMenuItem} from \"./MenuItem\";\r\nimport Menu, {AbstractMenu} from \"./Menu\";\r\nimport AutoLoader from \"autoloader\";\r\nimport * as positioners from \"./positioners\";\r\nimport {getMenuInstance, getClosestMenuByElement} from \"./utility\";\r\nimport {parseHTML, parseBoolean} from \"core/utility\";\r\nimport {inherit} from \"./decorators\";\r\nimport Attribute, {DROP, TRUE} from \"core/attributes\";\r\nimport {SelectInputWidget, HiddenInputWidget, MultiHiddenInputWidget} from \"../forms/\";\r\nimport ItemFilter from \"../ui/ItemFilter\";\r\n\r\n\r\n/**\r\n * The class SelectOption is used to construct an item contained in SelectMenu object.\r\n */\r\nexport class SelectOption extends AbstractMenuItem {\r\n    constructor({target, text, value=null}={}) {\r\n        super();\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render({text});\r\n        }\r\n\r\n        this.textNode = this.element.querySelector('[data-text], button, a');\r\n        if(!this.textNode) this.textNode = this.element;\r\n\r\n        this.element.setAttribute('aria-role', 'option');\r\n\r\n        this.toggle = \"inherit\";\r\n        this.autoActivate = true;\r\n        this.openOnHover = true;\r\n        this.delay = 0;\r\n        this.closeOnSelect = false;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.closeOnBlur = false;\r\n        this.timeout = false;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.clearSubItemsOnHover = true;\r\n\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.MenuItemClass = null;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.SubMenuClass = null;\r\n\r\n        this.autoDeactivateItems = \"auto\";\r\n\r\n        this.element.classList.add(\"option\");\r\n\r\n        this.registerTopics();\r\n        this.parseDOM();\r\n\r\n        if(value !== null && value !== undefined) {\r\n            this.value = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates the dom elements for the SelectOption.\r\n     * @param text\r\n     * @returns {Element}\r\n     */\r\n    render({text}) {\r\n        let html = `<div data-role=\"menuitem\" class=\"menuitem\">\r\n            <span class=\"checkmark\"><i class=\"fas fa-check\"></i></span>\r\n            <a data-text>${text}</a>\r\n        </div>`,\r\n            fragment = parseHTML(html);\r\n\r\n        return fragment.children[0];\r\n    }\r\n\r\n    /**\r\n     * Selects the options and publishes a [option.select] topic.\r\n     *\r\n     * @param topicData\r\n     */\r\n    select(topicData={}) {\r\n        super.select();\r\n\r\n        if(this.isSelected) return;\r\n\r\n        this.isSelected = true;\r\n\r\n        if(!this.isActive) {\r\n            this.activate();\r\n        }\r\n\r\n        this.dispatchTopic('option.select', {target: this, menu: this, ...topicData});\r\n    }\r\n\r\n    /**\r\n     * Deselect the SelectOption if it is selected and publishes an [option.deselect] topic.\r\n     * @param topicData\r\n     */\r\n    deselect(topicData={}) {\r\n        if(!this.isSelected) return;\r\n        this.isSelected = false;\r\n        if(this.isActive) this.deactivate();\r\n        this.dispatchTopic('option.deselect', {target: this, menu: this, ...topicData});\r\n    }\r\n\r\n    onClick(event) {\r\n        let isDisabled = this.getDisabled();\r\n\r\n        if(isDisabled) {\r\n            event.originalEvent.preventDefault();\r\n            return;\r\n        }\r\n\r\n        if(event.target !== this) {\r\n            return;\r\n        }\r\n\r\n        // Implements an event preventDefault like interface for the topic\r\n        // so that other handlers can prevent the default action why the topic\r\n        // bubble up the menu tree.\r\n\r\n        let isDefaultPrevented = false;\r\n\r\n        // Notify every parent node that an item was clicked.\r\n        this.dispatchTopic('menuitem.click', {\r\n            ...event,\r\n            target: this,\r\n            relatedTarget: event.target,\r\n\r\n            preventDefault() {\r\n                isDefaultPrevented = true;\r\n            },\r\n\r\n            isDefaultPrevented() {\r\n                return isDefaultPrevented;\r\n            }\r\n        });\r\n\r\n        let toggle = this.toggle,\r\n            isSelected = this.isSelected;\r\n\r\n        isDisabled = this.getDisabled();\r\n\r\n        // If the default action wasn't prevented either select or deselect the item.\r\n        if(!isDefaultPrevented && !isDisabled) {\r\n            if (isSelected) {\r\n                if (toggle === true || (toggle === 'ctrl' && event.originalEvent.ctrlKey)) {\r\n                    this.deselect();\r\n                }\r\n            } else {\r\n                this.select();\r\n            }\r\n        }\r\n    }\r\n\r\n    isSelectMenu() {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the option is selected.\r\n     * @returns {boolean}\r\n     */\r\n    get isSelected() {\r\n        return this.element.classList.contains('selected');\r\n    }\r\n\r\n    /**\r\n     * Sets the options selected state to true or false.\r\n     * @param value\r\n     */\r\n    set isSelected(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this.isSelected) {\r\n            if(value) {\r\n                this.element.classList.add('selected');\r\n            } else {\r\n                this.element.classList.remove('selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get isFiltered() {\r\n        return this.classList.contains('filtered');\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    set isFiltered(value) {\r\n        if(value) {\r\n            this.classList.add('filtered');\r\n            this.isVisible = false;\r\n        } else {\r\n            this.classList.remove('filtered');\r\n            this.isVisible = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the options value.\r\n     * @returns {string}\r\n     */\r\n    get value() {\r\n        return this.element.dataset.value;\r\n    }\r\n\r\n    /**\r\n     * Sets the options value.\r\n     * @param value\r\n     */\r\n    set value(value) {\r\n        this.element.dataset.value = value;\r\n    }\r\n\r\n    /**\r\n     * Return the options inner html.\r\n     * @returns {*}\r\n     */\r\n    get text() {\r\n        return this.textNode.innerText.trim();\r\n    }\r\n\r\n    /**\r\n     * Sets the options inner html.\r\n     * @param value\r\n     */\r\n    set text(value) {\r\n        this.textNode.innerText = (value+\"\").trim();\r\n    }\r\n\r\n    /**\r\n     * Returns the options parent select-menu or null.\r\n     * @returns {null|{isSelect}|MenuNode}\r\n     */\r\n    get parentSelect() {\r\n        let o = this.parent;\r\n\r\n        while(o) {\r\n            if(o.isSelect && o.isSelect()) {\r\n                return o;\r\n            }\r\n\r\n            o = o.parent;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    get autoDeactivateItems() {\r\n        if(this._props.autoDeactivateItems === 'auto') {\r\n            let parent = this.parentSelect;\r\n            return !!(parent && parent.multiSelect);\r\n        } else {\r\n            return this._props.autoDeactivateItems;\r\n        }\r\n    }\r\n\r\n    set autoDeactivateItems(value) {\r\n        this._props.autoDeactivateItems = value;\r\n    }\r\n\r\n    get isNavigable() {\r\n        return !this.isDisabled && this.isVisible && !this.isFiltered;\r\n    }\r\n}\r\n\r\n\r\n// noinspection JSUnusedGlobalSymbols\r\nexport const FILTERS = {\r\n    startsWith(value) {\r\n        return function(item) {\r\n            return item.text.indexOf(value) !== 0;\r\n        }\r\n    },\r\n\r\n    istartsWith(value) {\r\n        return function(item) {\r\n            return item.text.toLowerCase().indexOf(value.toLowerCase()) !== 0;\r\n        }\r\n    },\r\n\r\n    contains(value) {\r\n        return function(item) {\r\n            return item.text.indexOf(value) !== -1;\r\n        }\r\n    },\r\n\r\n    icontains(value) {\r\n        return function(item) {\r\n            return item.text.toLowerCase().indexOf(value.toLowerCase()) !== -1;\r\n        }\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Creates a menu that contains SelectOptions.\r\n */\r\nexport class SelectMenu extends AbstractMenu {\r\n    @inherit multiSelect;\r\n\r\n    constructor({\r\n                target, filter=null, placeholder=\"No Items Found\", filterDelay=500,\r\n                filterPlaceholderText=\"Search\", toggle=false, enableShiftSelect=true, enableCtrlToggle=true, clearOldSelection=false, ...context\r\n    }={}) {\r\n        super();\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.MenuItemClass = SelectOption;\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render(context);\r\n        }\r\n\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.closeOnBlur = false;\r\n        this.timeout = false;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.autoActivate = true;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.openOnHover = false;\r\n        this.multiSelect = \"inherit\";\r\n        this.closeOnSelect = false;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.delay = 0;\r\n        this.positioner = \"inherit\";\r\n\r\n        this.enableShiftSelect = enableShiftSelect;\r\n        this.enableCtrlToggle = enableCtrlToggle;\r\n        this.clearOldSelection = clearOldSelection;\r\n\r\n        this.element.classList.add('select-menu');\r\n\r\n        this.placeholder = document.createElement('div');\r\n        this.placeholder.classList.add('placeholder');\r\n        this.placeholder.innerHTML = placeholder;\r\n\r\n        this.isVisible = false;\r\n\r\n        this.registerTopics();\r\n        this.parseDOM();\r\n        this.init();\r\n\r\n        if(filter) {\r\n            this.filterDelay = filterDelay;\r\n            this.placeholder = placeholder;\r\n            this._initFilter(filter, filterPlaceholderText);\r\n        }\r\n    }\r\n\r\n    show() {\r\n        if(!this.isVisible) {\r\n            this.clearFilter();\r\n\r\n            if(!this.multiSelect && !this.activeChild) {\r\n                for (let child of this.children) {\r\n                    if (child.isSelected && !child.isActive) {\r\n                        child.activate();\r\n                    }\r\n                }\r\n            }\r\n\r\n            super.show();\r\n        }\r\n    }\r\n\r\n    render({arrow=false}={}) {\r\n        let html = `\r\n            <div class=\"select-menu\">\r\n                <div class=\"select-menu__header\"></div>\r\n                <div class=\"select-menu__body menu__body\"></div>\r\n                <div class=\"select-menu__footer\"></div>\r\n            </div>\r\n        `;\r\n\r\n        let fragment = parseHTML(html);\r\n        return fragment.children[0];\r\n    }\r\n\r\n    registerTopics() {\r\n        super.registerTopics();\r\n\r\n        this.on('option.select', topic => {\r\n            if(!this.multiSelect) {\r\n                for(let item of this.selection) {\r\n                    if(item !== topic.target) {\r\n                        item.deselect();\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.dispatchTopic('selection.change', this);\r\n        });\r\n\r\n        this.on('option.deselect', topic => {\r\n            this.dispatchTopic('selection.change', this);\r\n        });\r\n\r\n        this.on('menuitem.click', topic => {\r\n            if(topic.target.parent !== this) return;\r\n\r\n            let event = topic.originalEvent;\r\n\r\n            if(this._lastClick && event.shiftKey && this.enableShiftSelect) {\r\n                topic.preventDefault();\r\n\r\n                let children = this.children,\r\n                    targetIndex = children.indexOf(topic.target),\r\n                    lastIndex = children.indexOf(this._lastClick);\r\n\r\n                if(targetIndex !== -1 && lastIndex !== -1) {\r\n                    let startIndex = Math.min(targetIndex, lastIndex),\r\n                        endingIndex = Math.max(targetIndex, lastIndex),\r\n                        change = false;\r\n\r\n                    for(let i = 0, l = children.length; i < l; i++) {\r\n                        let child = children[i];\r\n\r\n                        if(i >= startIndex && i <= endingIndex && !child.isDisabled) {\r\n                            if(!child.isSelected) {\r\n                                child.isSelected = true;\r\n                                change = true;\r\n                            }\r\n                        } else if(child.isSelected) {\r\n                            child.isSelected = false;\r\n                            change = true;\r\n                        }\r\n                    }\r\n\r\n                    if(change) {\r\n                        this.dispatchTopic('selection.change', this);\r\n                    }\r\n                }\r\n            } else if(event.ctrlKey && this.enableCtrlToggle) {\r\n                topic.preventDefault();\r\n\r\n                let change = false;\r\n\r\n                if(!topic.target.isSelected && !topic.deselected) {\r\n                    event.target.isSelected = true;\r\n                    change = true\r\n                } else if(topic.target.isSelected && !topic.selected) {\r\n                    event.target.isSelected = false;\r\n                    change = true;\r\n                }\r\n\r\n                this._lastClick = topic.target;\r\n\r\n                if(change) {\r\n                    this.dispatchTopic('selection.change', this);\r\n                }\r\n            } else if(this.clearOldSelection) {\r\n                for(let child of this.children) {\r\n                    if(child !== topic.target && child.isSelected) {\r\n                        child.isSelected = false;\r\n                    }\r\n                }\r\n\r\n                this._lastClick = topic.target;\r\n            } else {\r\n                this._lastClick = topic.target;\r\n            }\r\n        });\r\n    }\r\n\r\n    isSelectMenu() {\r\n        return true;\r\n    }\r\n\r\n    get selection() {\r\n        let r = [];\r\n\r\n        for(let item of this.children) {\r\n            if(item.isSelected) {\r\n                r.push(item);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    get selectedOptions() {\r\n        return this.selection;\r\n    }\r\n\r\n    get options() {\r\n        return this.children;\r\n    }\r\n\r\n    onClick(topic) {\r\n        let event = topic.originalEvent,\r\n            target = topic.target,\r\n            isDisabled = target.getDisabled();\r\n\r\n        super.onClick(topic);\r\n\r\n        if(!isDisabled && target.parent === this && target.isMenuItem && target.isMenuItem() && this.multiSelect && this.shiftSelect) {\r\n            if(event.shiftKey) {\r\n                let lastTarget = this.lastTarget || target,\r\n                    children = this.children,\r\n                    lastIndex = children.indexOf(lastTarget),\r\n                    targetIndex = children.indexOf(target),\r\n                    start = Math.min(lastIndex, targetIndex),\r\n                    end = Math.max(lastIndex, targetIndex);\r\n\r\n                for(let i = 0; i < children.length; i++) {\r\n                    let item = children[i];\r\n\r\n                    if(i >= start && i <= end) {\r\n                        if(!item.isSelected) {\r\n                            item.select();\r\n                        }\r\n                    } else if(item.isSelected) {\r\n                        item.deselect();\r\n                    }\r\n                }\r\n            } else {\r\n                this.lastTarget = target;\r\n            }\r\n        }\r\n    }\r\n\r\n    filter(fn) {\r\n        if(fn === null) {\r\n            return this.clearFilter();\r\n        }\r\n\r\n        this.element.classList.add('items-filtered');\r\n\r\n        for(let option of this.options) {\r\n            option.isFiltered = fn(option);\r\n        }\r\n\r\n        if(this.placeholder) {\r\n            if(this.getFilteredItems().length < this.options.length) {\r\n                if(this.placeholder.parentElement) {\r\n                    this.placeholder.parentElement.removeChild(this.placeholder);\r\n                }\r\n            } else {\r\n                let container = this.element.querySelector('.select-menu__body') || this.element;\r\n                container.appendChild(this.placeholder);\r\n            }\r\n        }\r\n    }\r\n\r\n    clearFilter() {\r\n        for(let option of this.options) {\r\n            option.isFiltered = false;\r\n        }\r\n\r\n        if(this.placeholder && this.placeholder.parentElement && this.getFilteredItems().length < this.options.length) {\r\n            this.placeholder.parentElement.removeChild(this.placeholder);\r\n        }\r\n\r\n        if(this.filterInput) {\r\n            this.filterInput.value = \"\";\r\n        }\r\n\r\n        this.element.classList.remove('items-filtered');\r\n    }\r\n\r\n    getFilteredItems() {\r\n        let r = [];\r\n\r\n        for(let option of this.options) {\r\n            if(option.isFiltered) {\r\n                r.push(option);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    _initFilter(fn, filterPlaceholderText) {\r\n        // let filterInput = this.element.querySelectorAll('[data-filter]');\r\n        let filterInput = Array.prototype.slice.call(document.querySelectorAll('[data-filter]')).find(node => getClosestMenuByElement(node) === this);\r\n\r\n        if(!filterInput) {\r\n            this.filterInput = document.createElement('input');\r\n            this.filterInput.type = 'text';\r\n            this.filterInput.placeholder = filterPlaceholderText || \"\";\r\n\r\n            let filterContainer = document.createElement('div');\r\n            filterContainer.className = \"select-menu__filter\";\r\n            filterContainer.appendChild(this.filterInput);\r\n\r\n            let container = this.element.querySelector(\".select-menu__header\") || this.element;\r\n            container.insertBefore(filterContainer, container.firstChild);\r\n        } else {\r\n            this.filterInput = filterInput;\r\n        }\r\n\r\n        let _timer = null;\r\n\r\n        this.filterInput.addEventListener('keydown', () => {\r\n            if(_timer) {\r\n                clearTimeout(_timer);\r\n                _timer = null;\r\n            }\r\n\r\n            _timer = setTimeout(() => {\r\n                _timer = null;\r\n                this.filter(fn(this.filterInput.value));\r\n            }, this.filterDelay);\r\n        });\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * A component that can be used as an alternative to the built in <select> element.\r\n * @implements FormWidgetBase\r\n */\r\nexport class Select2 extends AbstractMenuItem {\r\n    static __attributes__ = {\r\n        multiSelect: new Attribute(parseBoolean, DROP, TRUE),\r\n        ...AbstractMenuItem.__attributes__\r\n    };\r\n\r\n    constructor({target, multiSelect=false, timeout=false, id=null, classes=null, widget=null, filter=false, placeholder=\"No Items Found\"}={}) {\r\n        super();\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render();\r\n        }\r\n\r\n        if(classes) {\r\n            this.addClass(classes);\r\n        }\r\n\r\n        if(id) {\r\n            this.element.id = id;\r\n        }\r\n\r\n        this.toggle = \"both\";\r\n        this.autoActivate = false;\r\n        this.openOnHover = false;\r\n        this.delay = false;\r\n        this.closeOnSelect = \"auto\";\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.closeOnBlur = true;\r\n        this.timeout = timeout;\r\n        this.multiSelect = multiSelect;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.MenuItemClass = SelectOption;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.SubMenuClass = SelectMenu;\r\n        this.positioner = positioners.DROPDOWN;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.clearSubItemsOnHover = false;\r\n        this.labelToItemMap = new WeakMap();\r\n        this.itemToLabelMap = new WeakMap();\r\n\r\n        this.element.classList.add('select');\r\n        this.element.tabIndex = 0;\r\n\r\n        this.registerTopics();\r\n        this.parseDOM();\r\n\r\n        if(widget) {\r\n            this.widget = widget;\r\n        } else {\r\n            this.widget = new HiddenInputWidget();\r\n            this.widget.appendTo(this.element);\r\n        }\r\n\r\n        if(!this.submenu) {\r\n            let submenu = new SelectMenu();\r\n            submenu.isVisible = false;\r\n            this.attachSubMenu(submenu);\r\n        }\r\n\r\n        this.init();\r\n\r\n        if(filter) {\r\n            if(this.multiSelect) {\r\n                this.filter = new ItemFilter({\r\n                    items: () => {\r\n                        let r = [];\r\n\r\n                        for(let child of this.submenu.children) {\r\n                            r.push(child.element);\r\n                        }\r\n\r\n                        return r;\r\n                    },\r\n                    tabindex: -1\r\n                });\r\n\r\n                let li = document.createElement('li');\r\n                li.className = \"select-filter-container\";\r\n                this.filter.appendTo(li);\r\n                this.filter.wrapper = li;\r\n                this.button.appendChild(li);\r\n            } else {\r\n                this.filter = new ItemFilter({\r\n                    items: () => {\r\n                        let r = [];\r\n\r\n                        for(let child of this.submenu.children) {\r\n                            r.push(child.element);\r\n                        }\r\n\r\n                        return r;\r\n                    },\r\n\r\n                    placeholder: \"Filter\"\r\n                });\r\n\r\n                this.filter.appendTo(this.submenu.element.querySelector('.select-menu__header'));\r\n                this.submenu.element.classList.add('has-filter');\r\n            }\r\n\r\n            this.filter.on('filter-change', (topic) => {\r\n                if(topic.allItemsFiltered) {\r\n                    this.submenu.element.classList.add('all-items-filtered');\r\n                } else {\r\n                    this.submenu.element.classList.remove('all-items-filtered');\r\n                }\r\n            });\r\n\r\n            if(placeholder) {\r\n                let placeholderNode = document.createElement('li');\r\n                placeholderNode.className = \"placeholder\";\r\n                placeholderNode.innerHTML = placeholder;\r\n                let body = this.submenu.getMenuBody();\r\n                body = body[body.length-1];\r\n                body.appendChild(placeholderNode);\r\n            }\r\n\r\n            this.addEventListener('keydown', event => {\r\n                if(this.filter && event.key === 'Backspace') {\r\n                    if(this.filter.isFocused() && this.filter.input.value !== \"\") {\r\n                        return;\r\n                    }\r\n\r\n                    if(!this._isChoiceElement(document.activeElement)) {\r\n                        let choices = this.getLabels();\r\n\r\n                        if(choices.length) {\r\n                            choices[choices.length-1].focus();\r\n                        }\r\n                    } else {\r\n                        this.labelToItemMap.get(document.activeElement).deselect();\r\n                        this.filter.focus();\r\n                    }\r\n                }\r\n            });\r\n\r\n            this.filter.input.addEventListener('focus', () => {\r\n                this.element.classList.add('select-highlight');\r\n            });\r\n\r\n            this.filter.input.addEventListener('blur', event => {\r\n                // noinspection JSCheckFunctionSignatures\r\n                if(!this.element.contains(event.relatedTarget)) {\r\n                    this.element.classList.remove('select-highlight');\r\n                    if(this.isActive) this.deactivate();\r\n                }\r\n            });\r\n        }\r\n\r\n        this.addEventListener('focus', () => {\r\n            if(this.filter) {\r\n                this.filter.focus();\r\n            }\r\n\r\n            this.element.classList.add('select-highlight');\r\n        });\r\n\r\n        this.addEventListener('blur', event => {\r\n            if(!this.element.contains(event.relatedTarget)) {\r\n                if(this.isActive) this.deactivate();\r\n                this.element.classList.remove('select-highlight');\r\n            }\r\n        });\r\n    }\r\n\r\n    activate(show=true) {\r\n        if(!this.isActive) {\r\n            let r = super.activate();\r\n\r\n            if(this.filter) {\r\n                this.filter.clear();\r\n\r\n                if(!this.multiSelect || !this.element.contains(document.activeElement) || !document.activeElement.classList.contains('choice')) {\r\n                    this.filter.focus();\r\n                }\r\n            }\r\n\r\n            return r;\r\n        }\r\n    }\r\n\r\n    deactivate() {\r\n        if(this.isActive) {\r\n            let r = super.deactivate();\r\n\r\n            if(this.filter) {\r\n                this.filter.clear();\r\n                this.filter.blur();\r\n            }\r\n\r\n            return r;\r\n        }\r\n    }\r\n\r\n    isSelect() {\r\n        return true;\r\n    }\r\n\r\n    registerTopics() {\r\n        super.registerTopics();\r\n\r\n        this.on('option.select', () => {\r\n            this.renderLabels();\r\n\r\n            if(this.closeOnSelect === true && this.isActive) {\r\n                this.deactivate();\r\n            }\r\n        });\r\n\r\n        this.on('option.deselect', () => {\r\n            this.renderLabels();\r\n        });\r\n    }\r\n\r\n    renderLabels() {\r\n        let output = this.button,\r\n            fragment = document.createDocumentFragment();\r\n\r\n        for(let item of this.options) {\r\n            if(item.isSelected) {\r\n                let pill = this.itemToLabelMap.get(item);\r\n\r\n                if (!pill) {\r\n                    pill = document.createElement('li');\r\n\r\n                    let exitButton = document.createElement('div'),\r\n                        span = document.createElement('span');\r\n\r\n                    pill.className = \"choice\";\r\n                    exitButton.className = \"exit-button\";\r\n                    span.innerText = item.text;\r\n                    if(this.multiSelect) pill.tabIndex = -1;\r\n\r\n                    pill.appendChild(exitButton);\r\n                    pill.appendChild(span);\r\n                    this.itemToLabelMap.set(item, pill);\r\n                    this.labelToItemMap.set(pill, item);\r\n\r\n                    fragment.appendChild(pill);\r\n                }\r\n            } else {\r\n                let pill = this.itemToLabelMap.get(item);\r\n\r\n                if(pill) {\r\n                    pill.parentElement.removeChild(pill);\r\n                    this.itemToLabelMap.delete(item);\r\n                    this.labelToItemMap.delete(pill);\r\n                }\r\n            }\r\n        }\r\n\r\n        if(this.filter && this.filter.wrapper && this.filter.wrapper.parentElement === output) {\r\n            output.insertBefore(fragment, this.filter.wrapper);\r\n        } else {\r\n            output.appendChild(fragment);\r\n        }\r\n\r\n        if(this.widget) this.widget.setValue(this._getSelectedValues());\r\n    }\r\n\r\n    append(option) {\r\n        this.submenu.append(option);\r\n    }\r\n\r\n    get button() {\r\n        return Array.prototype.find.call(this.element.children, node => node.matches('.selection'));\r\n    }\r\n\r\n    _getSelectedValues() {\r\n        let r = [];\r\n\r\n        for(let item of this.selection) {\r\n            r.push(item.value);\r\n        }\r\n\r\n        if(this.multiSelect) {\r\n            return r;\r\n        } else {\r\n            return r[0];\r\n        }\r\n    }\r\n\r\n    _isChoiceElement(element) {\r\n        for(let option of this.options) {\r\n            if(this.itemToLabelMap.get(option) === element) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    getLabels() {\r\n        return this.button.querySelectorAll('.choice');\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    getValue() {\r\n        return this.widget.getValue();\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    setValue(value) {\r\n        this.widget.setValue(value);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    getName() {\r\n        return this.widget.getName();\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    setName(name) {\r\n        this.widget.setName(name);\r\n    }\r\n\r\n    get selection() {\r\n        return this.submenu.selection;\r\n    }\r\n\r\n    get options() {\r\n        return this.submenu.children;\r\n    }\r\n\r\n    render(context) {\r\n        let html = `\r\n        <article class=\"dropdown select\">\r\n            <ul class=\"selection\"></ul>\r\n        </article>\r\n        `;\r\n\r\n        let fragment = parseHTML(html);\r\n        return fragment.children[0];\r\n    }\r\n\r\n    onClick(topic) {\r\n        let event = topic.originalEvent;\r\n\r\n        // noinspection JSUnresolvedFunction\r\n        if(topic.target === this && event.target.closest('.exit-button')) {\r\n            // noinspection JSUnresolvedFunction\r\n            let li = event.target.closest('li'),\r\n                item = this.labelToItemMap.get(li);\r\n\r\n            item.deselect();\r\n        } else {\r\n            if(this.filter) {\r\n                // noinspection JSCheckFunctionSignatures\r\n                let inFilter = this.filter.element.contains(event.target);\r\n\r\n                if(!this.isActive && inFilter) {\r\n                    this.activate();\r\n                } else if(this.submenu.element.contains(event.target)) {\r\n                    this.filter.focus();\r\n                } else if(!inFilter) {\r\n                    super.onClick(topic);\r\n                }\r\n            } else {\r\n                super.onClick(topic);\r\n            }\r\n        }\r\n    }\r\n\r\n    get multiSelect() {\r\n        return this._props.multiSelect;\r\n    }\r\n\r\n    set multiSelect(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this.multiSelect) {\r\n            this._props.multiSelect = value;\r\n\r\n            if(value) {\r\n                this.element.classList.add('multiple');\r\n            } else {\r\n                this.element.classList.remove('multiple');\r\n            }\r\n        }\r\n    }\r\n\r\n    get closeOnSelect() {\r\n        if(this._props.closeOnSelect === \"auto\") {\r\n            return !this.multiSelect;\r\n        } else {\r\n            return this._props.closeOnSelect;\r\n        }\r\n    }\r\n\r\n    set closeOnSelect(value) {\r\n        this._props.closeOnSelect = value;\r\n    }\r\n\r\n    static FromHTML(element) {\r\n        if(typeof element === 'string') {\r\n            element = document.querySelector(element);\r\n        }\r\n\r\n        if(element.nodeName === \"SELECT\") {\r\n            // noinspection JSUnresolvedVariable\r\n            let select = new Select2({\r\n                multiSelect: element.multiple,\r\n                widget: new SelectInputWidget(element, null, null, true),\r\n                filter: element.dataset.filter ? element.dataset.filter.toLowerCase().trim() === 'true' : false\r\n            });\r\n\r\n            for(let option of element.querySelectorAll('option')) {\r\n                let item = new SelectOption({\r\n                    text: option.innerText.trim(),\r\n                    value: option.value\r\n                });\r\n\r\n                select.append(item);\r\n\r\n                if(option.selected) {\r\n                    item.select();\r\n                }\r\n            }\r\n\r\n            element.replaceWith(select.element);\r\n            select.element.appendChild(select.widget.element);\r\n            return select;\r\n        } else {\r\n            return super.FromHTML(element);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * @implements FormWidgetBase\r\n * @abstract\r\n */\r\nexport class AbstractSelect extends AbstractMenuItem {\r\n    isSelect() {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @abstract\r\n     * @param context\r\n     */\r\n    render(context={}) {\r\n\r\n    }\r\n\r\n    /**\r\n     * Refresh ui\r\n     *\r\n     * @abstract\r\n     * @private\r\n     */\r\n    refreshUI() {\r\n\r\n    }\r\n\r\n    registerTopics() {\r\n        super.registerTopics();\r\n\r\n        this.on('menuitem.click', topic => {\r\n            // Close the select if the user clicks a disabled select item.\r\n            if(this.closeOnSelect && this.isActive) {\r\n                if(topic.target.isDisabled) {\r\n                    topic.preventDefault();\r\n                    this.deactivate();\r\n                }\r\n            }\r\n        });\r\n\r\n        this.on('option.select', () => {\r\n            if(this.closeOnSelect && this.isActive) {\r\n                this.deactivate();\r\n            }\r\n        });\r\n\r\n        this.on('option.deselect', () => {\r\n            if(this.closeOnSelect && this.isActive) {\r\n                this.deactivate();\r\n            }\r\n        });\r\n\r\n        this.on('selection.change', () => {\r\n            this.refreshUI();\r\n            this.submenu.position();\r\n        });\r\n    }\r\n\r\n    append(option) {\r\n        return this.submenu.append(option);\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Properties\r\n\r\n    get options() {\r\n        return this.submenu.options;\r\n    }\r\n\r\n    get selectedOptions() {\r\n        return this.submenu.selectedOptions;\r\n    }\r\n\r\n    getName() {\r\n        return this.widget.name;\r\n    }\r\n\r\n    setName(value) {\r\n        this.widget.name = value;\r\n    }\r\n\r\n    getValue() {\r\n        return this.widget.value;\r\n    }\r\n\r\n    /**\r\n     * Sets the value of the widget and updates the ui without triggering any topics.\r\n     *\r\n     * @abstract\r\n     * @param value\r\n     */\r\n    setValue(value) {\r\n\r\n    }\r\n\r\n    get value() {\r\n        return this.getValue();\r\n    }\r\n\r\n    set value(value) {\r\n        this.setValue(value);\r\n    }\r\n\r\n    get name() {\r\n        return this.getName();\r\n    }\r\n\r\n    set name(value) {\r\n        this.setName(value);\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    //\r\n\r\n    static FromHTML(element) {\r\n        if(typeof element === 'string') {\r\n            element = document.querySelector(element);\r\n        }\r\n\r\n        let instance = new this();\r\n\r\n        for(let child of element.querySelectorAll('li')) {\r\n            let option = new SelectOption({text: child.innerHTML.trim(), value: child.dataset.value || null});\r\n            instance.append(option);\r\n        }\r\n\r\n        element.parentElement.replaceChild(instance.element, element);\r\n\r\n        return instance;\r\n    }\r\n}\r\n\r\n\r\nexport class ComboBox extends AbstractSelect {\r\n    constructor({target=null, timeout=false, submenu=null, widget=null, wait=500, filter=FILTERS.istartsWith}={}) {\r\n        super();\r\n\r\n        if(target) {\r\n            this.element = target;\r\n\r\n            if(this.element.nodeName === 'INPUT') {\r\n                this.textbox = this.element;\r\n            } else {\r\n                this.textbox = this.element.querySelector('[data-text]');\r\n            }\r\n        } else {\r\n            let {element, textbox} = this.render();\r\n            this.element = element;\r\n            this.textbox = textbox;\r\n        }\r\n\r\n        this.toggle = true;\r\n        this.autoActivate = false;\r\n        this.openOnHover = false;\r\n        this.delay = false;\r\n        this.timeout = timeout;\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.closeOnBlur = true;\r\n        this.positioner = positioners.DROPDOWN;\r\n        this.closeOnSelect = true;\r\n        this._label = '';\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.clearSubItemsOnHover = false;\r\n        this.wait = wait;\r\n\r\n        this.SubMenuClass = SelectMenu;\r\n\r\n        this.element.tabIndex = 0;\r\n\r\n        this.parseDOM();\r\n\r\n        if(submenu) {\r\n            if(typeof submenu === 'string') {\r\n                submenu = document.querySelector(submenu);\r\n            }\r\n\r\n            if(!submenu.isSelectMenu || !submenu.isSelectMenu()) {\r\n                submenu = new this.SubMenuClass({target: submenu});\r\n                this.attachSubMenu(submenu);\r\n            }\r\n        } else {\r\n            let submenu = new this.SubMenuClass();\r\n            this.attachSubMenu(submenu);\r\n        }\r\n\r\n        this.submenu.classList.add('combobox__menu');\r\n\r\n        if(!widget) {\r\n            this.widget = new HiddenInputWidget();\r\n            this.widget.appendTo(this.element);\r\n        } else {\r\n            this.widget = widget;\r\n        }\r\n\r\n        this.textbox.addEventListener('blur', event => {\r\n            if(!this.containsElement(event.relatedTarget)) {\r\n                this.textbox.value = this._label;\r\n            }\r\n        });\r\n\r\n        this.initKeyboardNavigation();\r\n        this.registerTopics();\r\n        this.init();\r\n\r\n        this.filter = filter;\r\n    }\r\n\r\n    render(context) {\r\n        let element = `\r\n        <div class=\"combobox\">\r\n            <input type=\"text\" class=\"combobox__input\" data-text />\r\n            <span class=\"combobox__caret\"><i class=\"fas fa-caret-down\"></i></span>\r\n        </div>\r\n        `;\r\n\r\n        element = parseHTML(element).children[0];\r\n        return {\r\n            element: element,\r\n            textbox: element.querySelector('[data-text]')\r\n        };\r\n    }\r\n\r\n    refreshUI() {\r\n        let options = this.selectedOptions,\r\n            labels = options.map(item => item.text);\r\n\r\n        this.value = options.length ? options[0].value || options[0].text || '' : '';\r\n        this._label = labels.join(\", \");\r\n        this.textbox.value = this._label;\r\n    }\r\n\r\n    destroy() {\r\n        super.destroy();\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Private methods\r\n\r\n    _rootKeyDown(topic) {\r\n        if(this.isRoot) {\r\n            let key = topic.originalEvent.key;\r\n\r\n            if(this.hasFilter && (key === 'ArrowLeft' || key === 'ArrowRight')) {\r\n                return;\r\n            }\r\n\r\n            return super._rootKeyDown(topic);\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Properties\r\n\r\n    setValue(value) {\r\n        this.widget.value = value;\r\n    }\r\n\r\n    get placeholder() {\r\n        return this.textbox.placeholder;\r\n    }\r\n\r\n    set placeholder(value) {\r\n        this.textbox.placeholder = value;\r\n    }\r\n\r\n    set filter(method) {\r\n        if(this._destroyFilter) {\r\n            this._destroyFilter();\r\n            this._destroyFilter = null;\r\n        }\r\n\r\n        if(!method) return;\r\n\r\n        this._filterMethod = method;\r\n\r\n        let _timer = null;\r\n\r\n        let applyFilter = () => {\r\n            _timer = null;\r\n            this.submenu.filter(this._filterMethod(this.textbox.value));\r\n\r\n            // Flag if we found a select item.\r\n            let f = false;\r\n\r\n            // Activate the selected items.\r\n            if (!this.multiSelect) {\r\n                for (let option of this.submenu.options) {\r\n                    if (!option.isDisabled && !option.isFiltered && option.isSelected) {\r\n                        option.activate();\r\n                        f = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!f) {\r\n                for (let option of this.submenu.options) {\r\n                    if (!option.isDisabled && !option.isFiltered) {\r\n                        option.activate();\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        let onInput = () => {\r\n            if(_timer) {\r\n                clearTimeout(_timer);\r\n                _timer = null;\r\n            }\r\n\r\n            if(this.wait === false || this.wait < 0) {\r\n                applyFilter();\r\n            } else {\r\n                _timer = setTimeout(applyFilter, this.wait);\r\n            }\r\n        };\r\n\r\n        let onKeyDown = event => {\r\n            // Apply the filter immediately on enter.\r\n            if(event.key === \"Enter\" && _timer) {\r\n                clearTimeout(_timer);\r\n                _timer = null;\r\n                applyFilter();\r\n            }\r\n        };\r\n\r\n        this.textbox.addEventListener('input', onInput);\r\n        this.textbox.addEventListener('keydown', onKeyDown);\r\n\r\n        // Create method to destroy event listener.\r\n        this._destroyFilter = () => {\r\n            this.textbox.removeEventListener('input', onInput);\r\n            this.textbox.removeEventListener('keydown', onKeyDown);\r\n            this.textbox.readOnly = true;\r\n\r\n            this._destroyFilter = null;\r\n        };\r\n    }\r\n\r\n    get filter() {\r\n        return !!this._filterMethod;\r\n    }\r\n\r\n    get hasFilter() {\r\n        return !!this._destroyFilter;\r\n    }\r\n}\r\n\r\n\r\nexport class MultiComboBox extends AbstractSelect {\r\n    constructor({target=null, timeout=false, widget=null, filter=FILTERS.istartsWith, wait=500}={}) {\r\n        super();\r\n\r\n        this.optionToPillMap = new WeakMap();\r\n        this.pilltoOptionMap = new WeakMap();\r\n\r\n        if(target) {\r\n            this.element = target;\r\n            this.textbox = this.element.querySelector('[data-text]');\r\n            this.body = this.element.querySelector('.multi-combo-box__body');\r\n        } else {\r\n            let {element, textbox, body} = this.render();\r\n            this.element = element;\r\n            this.textbox = textbox;\r\n            this.body = body;\r\n        }\r\n\r\n        this.toggle = true;\r\n        this.autoActivate = false;\r\n        this.openOnHover = false;\r\n        this.delay = false;\r\n        this.timeout = timeout;\r\n        this.closeOnBlur = true;\r\n        this.positioner = positioners.DROPDOWN;\r\n        this.closeOnSelect = false;\r\n        this.multiSelect = true;\r\n        this.clearSubItemsOnHover = false;\r\n\r\n        this.SubMenuClass = SelectMenu;\r\n\r\n        this.parseDOM();\r\n\r\n        if(!this.submenu) {\r\n            this.submenu = new this.SubMenuClass();\r\n            this.attachSubMenu(this.submenu);\r\n        }\r\n\r\n        this.submenu.multiSelect = true;\r\n        this.submenu.toggle = true;\r\n        this.submenu.enableShiftSelect = true;\r\n\r\n        if(!widget) {\r\n            this.widget = new MultiHiddenInputWidget();\r\n            this.widget.appendTo(this.element);\r\n        } else {\r\n            this.widget = widget;\r\n\r\n            if(!this.widget.element.parentElement) {\r\n                this.widget.appendTo(this.element);\r\n            }\r\n        }\r\n\r\n        this.initKeyboardNavigation();\r\n        this.registerTopics();\r\n        this.init();\r\n\r\n        let _timer = null;\r\n\r\n        let applyFilter = () => {\r\n            _timer = null;\r\n\r\n            this.submenu.filter(filter(this.textbox.value));\r\n\r\n            if(this.submenu.activeItem) this.submenu.activeItem.deactivate();\r\n        };\r\n\r\n        this.textbox.addEventListener('keydown', event => {\r\n            if(!this.isActive) {\r\n                this.activate();\r\n                return;\r\n            }\r\n\r\n            if(event.key === \"Backspace\" && this.textbox.value === \"\") {\r\n                let pills = this.body.querySelectorAll('.multi-combo-box__pill'),\r\n                    pill = pills[pills.length-1],\r\n                    option = pill ? this.pilltoOptionMap.get(pill) : null;\r\n\r\n                if(option) {\r\n                    option.deselect();\r\n                }\r\n            } else if(event.key === 'Enter') {\r\n                if(_timer) {\r\n                    clearTimeout(_timer);\r\n                    _timer = null;\r\n                    applyFilter();\r\n                } else {\r\n                    let activeItem = null,\r\n                        firstItem = null;\r\n\r\n                    // Find both the first none filtered item and the active item.\r\n                    for(let option of this.options) {\r\n                        if(!option.isFiltered && firstItem === null) {\r\n                            firstItem = option;\r\n                        }\r\n\r\n                        if(!option.isFiltered && option.isActive) {\r\n                            activeItem = option;\r\n                        }\r\n                    }\r\n\r\n                    if(!activeItem) {\r\n                        this.textbox.value = \"\";\r\n                        this.submenu.clearFilter();\r\n                        this.submenu.position();\r\n\r\n                        if(firstItem && !firstItem.isSelected) {\r\n                            firstItem.select();\r\n                        }\r\n\r\n                        firstItem.deactivate();\r\n                    } else {\r\n                        if(activeItem.isSelected) {\r\n                            activeItem.deselect();\r\n                            activeItem.activate();\r\n                        } else {\r\n                            activeItem.select();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        this.textbox.addEventListener('input', () => {\r\n            if(_timer) {\r\n                clearTimeout(_timer);\r\n                _timer = null;\r\n            }\r\n\r\n            if(wait === false || wait < 0) {\r\n                applyFilter();\r\n            } else {\r\n                _timer = setTimeout(applyFilter, wait);\r\n            }\r\n        });\r\n    }\r\n\r\n    registerTopics() {\r\n        super.registerTopics();\r\n\r\n        this.on('event.click', topic => {\r\n            let exitButton = topic.originalEvent.target.closest('.pill__exit-button'),\r\n                pill = exitButton ? exitButton.closest('.multi-combo-box__pill') : null,\r\n                option = pill ? this.pilltoOptionMap.get(pill) : null;\r\n\r\n            if(option) {\r\n                option.deselect();\r\n            }\r\n\r\n            this.textbox.focus();\r\n        });\r\n    }\r\n\r\n    render(context) {\r\n        let html = `\r\n            <div class=\"multi-combo-box\">\r\n                <div class=\"multi-combo-box__body\">\r\n                    <input type=\"text\" class=\"multi-combo-box__input\" data-text />\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        let element = parseHTML(html).children[0];\r\n\r\n        return {\r\n            element: element,\r\n            textbox: element.querySelector('[data-text]'),\r\n            body: element.querySelector('.multi-combo-box__body')\r\n        };\r\n    }\r\n\r\n    _buildChoicePill(text) {\r\n        let pill = document.createElement('div');\r\n        pill.className = \"multi-combo-box__pill\";\r\n\r\n        let exitButton = document.createElement('div'),\r\n            textContainer = document.createElement('div');\r\n\r\n        exitButton.className = \"pill__exit-button\";\r\n        exitButton.innerHTML = `<i class=\"far fa-times-circle\"></i>`;\r\n        textContainer.className = \"pill__text\";\r\n        textContainer.innerHTML = text;\r\n\r\n        pill.appendChild(textContainer);\r\n        pill.appendChild(exitButton);\r\n\r\n        return pill;\r\n    }\r\n\r\n    _rootKeyDown(topic) {\r\n        let event = topic.originalEvent,\r\n            key = event.key;\r\n\r\n        if(this.isRoot) {\r\n            if(key === 'ArrowLeft' || key === 'ArrowRight' || key === \"Enter\") {\r\n                return;\r\n            }\r\n\r\n            return super._rootKeyDown(topic);\r\n        }\r\n    }\r\n\r\n    refreshUI() {\r\n        let fragment = document.createDocumentFragment(),\r\n            _new = false,\r\n            values = [];\r\n\r\n        for(let option of this.options) {\r\n            let pill = this.optionToPillMap.get(option);\r\n\r\n            if(option.isSelected) {\r\n                if(!pill) {\r\n                    pill = this._buildChoicePill(option.text);\r\n                    this.pilltoOptionMap.set(pill, option);\r\n                    this.optionToPillMap.set(option, pill);\r\n                    fragment.appendChild(pill);\r\n                    _new = true;\r\n                }\r\n\r\n                values.push(option.value || option.text);\r\n            } else if(pill) {\r\n                if(pill.parentElement) pill.parentElement.removeChild(pill);\r\n                this.optionToPillMap.delete(option);\r\n                this.pilltoOptionMap.delete(pill);\r\n            }\r\n        }\r\n\r\n        if(_new) {\r\n            this.body.insertBefore(fragment, this.textbox);\r\n        }\r\n\r\n        if(this.widget) {\r\n            this.widget.setValue(values);\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Properties\r\n\r\n    setValue(values) {\r\n        let changed = false;\r\n\r\n        for(let option of this.options) {\r\n            let index = values.indexOf(option.value);\r\n            if(index !== -1) {\r\n                if(!option.isSelected && !option.isDisabled) {\r\n                    option.isSelected = true;\r\n                    changed = true;\r\n                }\r\n\r\n                values.splice(index, 1);\r\n            } else {\r\n                if(option.isSelected) {\r\n                    option.isSelected = false;\r\n                    changed = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        this._renderLabel();\r\n    }\r\n}\r\n\r\n\r\nexport class RichSelect extends AbstractSelect {\r\n    constructor({target=null, multiple=false}) {\r\n        super();\r\n\r\n        if(target) {\r\n            this.element = target;\r\n\r\n            if(this.element.nodeName === \"INPUT\") {\r\n                this.textbox = this.element;\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n    }\r\n\r\n    refreshUI() {\r\n\r\n    }\r\n\r\n    setValue(value) {\r\n\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Properties\r\n}\r\n\r\n\r\nAutoLoader.register('select', (element) => RichSelect.FromHTML(element));\r\nAutoLoader.register('combobox', (element) => ComboBox.FromHTML(element));\r\nAutoLoader.register('multi-combobox', (element) => MultiComboBox.FromHTML(element));\r\n","/**\r\n * Decorates a property so that it can take special keywords to inherit it's value up the parent tree.\r\n *\r\n * If it's value is \"inherit\" or \"root\" special actions are taken.\r\n *\r\n * On \"inherit\" the getter will use this.parent[key] as it's value or return undefined.\r\n * On \"root\" the getter will use this.root[key] as it's value or return undefined.\r\n *\r\n * If the value is anything else is behaves like normal.\r\n *\r\n * Usage:\r\n *  @inherit myField = <default value>;\r\n *\r\n * @param target\r\n * @returns {{kind: string, placement: string, descriptor: {set(*): void, enumerable: boolean, get(): (*|*), configurable: boolean}, key: *}|undefined|*}\r\n */\r\nexport function inherit(target) {\r\n    let key = target.key,\r\n        initializer = target.initializer || function() { return undefined };\r\n\r\n    return {\r\n        kind: 'method',\r\n        placement: 'prototype',\r\n        key: target.key,\r\n        descriptor: {\r\n            configurable: true,\r\n            enumerable: false,\r\n\r\n            get() {\r\n                let value = this._props[key];\r\n\r\n                if(value === 'inherit' || value === undefined) {\r\n                    value = this.parent ? this.parent[key] : undefined;\r\n                } else if(value === 'root') {\r\n                    let root = this.root;\r\n                    value = root ? root[key] : undefined;\r\n                } else {\r\n                    return value;\r\n                }\r\n\r\n                if(value === undefined) value = initializer ? initializer() : undefined;\r\n                return value;\r\n            },\r\n\r\n            set(value) {\r\n                this._props[key] = value;\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\n\r\nexport function publishTargetEvent(topic, bubble=false) {\r\n    return function(descriptor) {\r\n        let {value, ...desc} = descriptor.descriptor;\r\n\r\n        function wrapper(event) {\r\n            if(this.getTargetNode(event.target) === this) {\r\n                if(bubble) {\r\n                    this.dispatchTopic(topic, this, event);\r\n                } else {\r\n                    this.publish(topic, this, event);\r\n                }\r\n\r\n                return value.call(this, event);\r\n            }\r\n        }\r\n\r\n        return {\r\n            placement: descriptor.placement,\r\n            key: descriptor.key,\r\n            kind: descriptor.kind,\r\n            descriptor: {\r\n                value: wrapper,\r\n                ...desc\r\n            }\r\n        };\r\n    };\r\n}","import {Rect} from \"core/vectors\";\r\nimport {getClientRect, setElementClientPosition} from \"core/position\";\r\n\r\nconst opposites = {\r\n    left: 'right',\r\n    top: 'bottom',\r\n    right: 'left',\r\n    bottom: 'top',\r\n    center: 'center',\r\n    middle: 'middle'\r\n};\r\n\r\n\r\nfunction getInheritedPosition(menu) {\r\n    if(menu.parent && menu.parent.parent && !menu.parent.parent.isRoot) {\r\n        return menu.element.dataset.position;\r\n    }\r\n}\r\n\r\n\r\nfunction _applyPosition(target, overlay, container) {\r\n    let position = overlay.dataset.position,\r\n        [my, at, method] = position.split(/\\s*;\\s*/),\r\n        overlayRect = Rect.getBoundingClientRect(overlay),\r\n        targetRect = Rect.getBoundingClientRect(target),\r\n        containerRect = container.nodeType ? Rect.getBoundingClientRect(container) : container;\r\n\r\n    my = my.trim();\r\n    at = at.trim();\r\n\r\n    let [myX, myY] = my.split(/\\s+/),\r\n        [atX, atY] = at.split(/\\s+/),\r\n        methodX, methodY;\r\n\r\n    if(method) {\r\n        method = method.trim();\r\n        [methodX, methodY] = method.split(/\\s+/);\r\n    }\r\n\r\n    let pos = overlayRect.position({my: `${myX} ${myY}`, at: `${atX} ${atY}`, of: targetRect, inside: containerRect, collision: null}),\r\n        refresh = false; // flag that determines is position will be refreshed.\r\n\r\n    if(!containerRect.containsX(pos)) {\r\n        myX = opposites[myX];\r\n        atX = opposites[atX];\r\n        if(methodX) methodX = opposites[methodX];\r\n        refresh = true;\r\n    }\r\n\r\n    if(!containerRect.containsY(pos)) {\r\n        myY = opposites[myY];\r\n        atY = opposites[atY];\r\n        if(methodY) methodY = opposites[methodY];\r\n        refresh = true;\r\n    }\r\n\r\n    if(refresh) {\r\n        pos = overlayRect.position({my: `${myX} ${myY}`, at: `${atX} ${atY}`, of: targetRect, inside: containerRect, collision: null});\r\n\r\n        if(methodX && methodY) {\r\n            overlay.dataset.position = `${myX} ${myY}; ${atX} ${atY}; ${methodX} ${methodY};`;\r\n        } else {\r\n            overlay.dataset.position = `${myX} ${myY}; ${atX} ${atY};`;\r\n        }\r\n    }\r\n\r\n    methodX = methodX || 'left';\r\n    methodY = methodY || 'top';\r\n\r\n    setElementClientPosition(overlay, pos, `${methodY}-${methodX}`);\r\n}\r\n\r\n\r\n/**\r\n * Positions first level of menus statically\r\n * Then position second level of menus at the bottom left of the first level.\r\n * Finally positions every other level to the top right of the previous level.\r\n * Menu's can flip if they fall out of bounds of the container.\r\n * By default the container is the client area.\r\n *\r\n * @param container\r\n * @param topLevelPosition\r\n * @param defaultPosition\r\n * @returns {Function}\r\n */\r\nexport function dropdown(container=null, topLevelPosition=\"left top; left bottom; left top;\", defaultPosition=\"left top; right top; left top;\") {\r\n    if(!container) {\r\n        container = getClientRect;\r\n    } else if(typeof container === 'string') {\r\n        let target = document.querySelector(container);\r\n        container = () => Rect.getBoundingClientRect(target);\r\n    } else {\r\n        let target = container;\r\n        container = () => Rect.getBoundingClientRect(target);\r\n    }\r\n\r\n    return function(menu) {\r\n        let parentMenu = menu.parentMenu,\r\n            containerElement = container,\r\n            target = menu.parent;\r\n\r\n        if(typeof containerElement === 'function') {\r\n            containerElement = containerElement(target, menu);\r\n        }\r\n\r\n        if (!parentMenu || parentMenu.isRoot) {\r\n            menu.element.dataset.position = topLevelPosition;\r\n            // flipPositionIfOutOfBounds(menu.element, container, 'xy');\r\n            _applyPosition(target.element, menu.element, containerElement);\r\n        } else {\r\n            menu.element.dataset.position = getInheritedPosition(menu) || defaultPosition;\r\n            // flipPositionIfOutOfBounds(menu.element, container, 'xy');\r\n            _applyPosition(target.element, menu.element, containerElement);\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport const DROPDOWN = dropdown();\r\n// noinspection JSUnusedGlobalSymbols\r\nexport const SIDE_MENU = dropdown(null, \"left top; right top;\", \"left top; right top;\");\r\n","export const MENU_MAP = new WeakMap();\r\n\r\n\r\n/**\r\n * Maps elements to menu node controller instances.\r\n * @param element\r\n * @param instance\r\n */\r\nexport function attachMenuInstance(element, instance) {\r\n    if(instance === null) {\r\n        return detachMenuInstance(element);\r\n    }\r\n\r\n    if(MENU_MAP.get(element)) {\r\n        throw new Error(\"Element is already bound to menu node instance.\");\r\n    }\r\n\r\n    MENU_MAP.set(element, instance);\r\n}\r\n\r\n\r\n/**\r\n * Unmaps menu node controller instance from an element.\r\n * @param element\r\n */\r\nexport function detachMenuInstance(element) {\r\n    MENU_MAP.delete(element);\r\n}\r\n\r\n\r\n/**\r\n * Returns true if the element has a menu controller instance mapped.\r\n * @param element\r\n * @returns {boolean}\r\n */\r\nexport function hasMenuInstance(element) {\r\n    return MENU_MAP.has(element);\r\n}\r\n\r\n\r\n/**\r\n * Retrieves the mapped menu node controller instance for the element.\r\n * @param element\r\n * @returns {null|MenuNode|*}\r\n */\r\nexport function getMenuInstance(element) {\r\n    return MENU_MAP.get(element);\r\n}\r\n\r\n\r\n/**\r\n * Finds the closest menu node controller for the element in the DOM tree.\r\n * @param element\r\n * @returns {null|*}\r\n */\r\nexport function getClosestMenuNodeByElement(element) {\r\n    while(element) {\r\n        let instance = getMenuInstance(element);\r\n\r\n        if(instance) {\r\n            return instance;\r\n        }\r\n\r\n        element = element.parentElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\n// noinspection JSUnusedGlobalSymbols\r\n/**\r\n * Finds the closest menuitem controller for the element in the DOM tree.\r\n * @param element\r\n * @returns {null|*}\r\n */\r\nexport function getClosestMenuItemByElement(element) {\r\n    while(element) {\r\n        let instance = getMenuInstance(element);\r\n\r\n        if(instance && instance.isMenuItem()) {\r\n            return instance;\r\n        }\r\n\r\n        element = element.parentElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\n/**\r\n * Finds the closest menu node controller for the element in the DOM tree\r\n * @param element\r\n * @returns {null|*}\r\n */\r\nexport function getClosestMenuByElement(element) {\r\n    while(element) {\r\n        let instance = getMenuInstance(element);\r\n\r\n        if(instance && instance.isMenu()) {\r\n            return instance;\r\n        }\r\n\r\n        element = element.parentElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n","import Publisher from \"../core/Publisher\";\r\nimport {selectElement, addClasses, removeClasses} from \"../core/utility.js\";\r\n\r\n/**\r\n * Compares if the item innerText matches the value with case insensitive matching.\r\n * @param item\r\n * @param value\r\n * @returns {boolean}\r\n */\r\nexport function innerTextCompare(item, value) {\r\n    value = value.trim().toLowerCase();\r\n\r\n    // If value is empty clear the filter.\r\n    if(!value) {\r\n        return true;\r\n    }\r\n\r\n    return item.innerText.toLowerCase().indexOf(value) !== -1;\r\n}\r\n\r\n/**\r\n * A component that filters items in a container by an the input value of the text field.\r\n */\r\nexport default class ItemFilter extends Publisher {\r\n    constructor({element, target, items=\".filter-item\", compareFunction=innerTextCompare, onHide=\"hidden\", onShow=null, delay=500, placeholder=\"\", tabindex=0}={}) {\r\n        super();\r\n\r\n        if(element) {\r\n            this.element = selectElement(element);\r\n            this.input = this.element.querySelector('input[type=\"text\"], [data-filter-input]');\r\n        } else {\r\n            this.element = document.createElement('div');\r\n            this.input = document.createElement(\"input\");\r\n            this.input.placeholder = placeholder;\r\n            this.element.appendChild(this.input);\r\n            this.input.classList.add(\"item-filter__input\");\r\n            this.input.tabIndex = tabindex;\r\n        }\r\n\r\n        this.target = target;\r\n        this.items = items;\r\n        this.compareFunction = compareFunction;\r\n        this.onHide = onHide;\r\n        this.onShow = onShow;\r\n        this.delay = delay;\r\n\r\n        this.element.classList.add(\"item-filter\");\r\n\r\n        let timer;\r\n\r\n        this.element.addEventListener('input', event => {\r\n            if(timer) {\r\n                clearTimeout(timer);\r\n                timer = null;\r\n            }\r\n\r\n            setTimeout(() => {\r\n                let value = this.input.value,\r\n                    allItemsHidden = true;\r\n\r\n                for(let item of this.getFilterItems()) {\r\n                    if(this.compareFunction(item, value)) {\r\n                        this._showItem(item);\r\n                        allItemsHidden = false;\r\n                    } else {\r\n                        this._hideItem(item);\r\n                    }\r\n                }\r\n\r\n                this.publish('filter-change', {\r\n                    filter: this,\r\n                    allItemsFiltered: allItemsHidden\r\n                });\r\n            }, this.delay);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Shows the item.\r\n     * @param item\r\n     * @private\r\n     */\r\n    _showItem(item) {\r\n        if(typeof this.onHide === 'string') {\r\n            removeClasses(item, this.onHide);\r\n        }\r\n\r\n        if(this.onShow) {\r\n            if(typeof this.onShow === 'function') {\r\n                this.onShow(item);\r\n            } else if(typeof this.onShow === 'string') {\r\n                addClasses(item, this.onShow);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Hides the item.\r\n     * @param item\r\n     * @private\r\n     */\r\n    _hideItem(item) {\r\n        if(typeof this.onShow === 'string') {\r\n            removeClasses(item, this.onShow);\r\n        }\r\n\r\n        if(this.onHide) {\r\n            if(typeof this.onHide === 'function') {\r\n                this.onHide(item);\r\n            } else if(typeof this.onHide === 'string') {\r\n                addClasses(item, this.onHide);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns a list of the filterable items.\r\n     * @returns {NodeListOf<HTMLElementTagNameMap[string]> | NodeListOf<Element> | NodeListOf<SVGElementTagNameMap[string]>}\r\n     */\r\n    getFilterItems() {\r\n        let target,\r\n            items;\r\n\r\n        if(typeof this.target === 'function') {\r\n            target = this.target();\r\n        } else if(typeof this.target === 'string') {\r\n            target = document.querySelector(this.target);\r\n        } else {\r\n            target = this.target;\r\n        }\r\n\r\n        if(typeof this.items === 'function') {\r\n            items = this.items(target);\r\n        } else {\r\n            items = target.querySelectorAll(this.items);\r\n        }\r\n\r\n        return items;\r\n    }\r\n\r\n    clear() {\r\n        this.input.value = \"\";\r\n\r\n        for(let item of this.getFilterItems()) {\r\n            this._showItem(item);\r\n        }\r\n\r\n        this.publish('filter-change', {\r\n            filter: this,\r\n            allItemsFiltered: false\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Appends the widget to the element.\r\n     * @param element\r\n     */\r\n    appendTo(element) {\r\n        if(typeof element === 'string') {\r\n            document.querySelector(element).appendChild(this.element);\r\n        } else if(element.appendChild) {\r\n            element.appendChild(this.element);\r\n        } else if(element.append) {\r\n            element.append(this.element);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes the widget from the dom.\r\n     * @returns {Element|Document|DocumentFragment|HTMLDivElement}\r\n     */\r\n    remove() {\r\n        return this.element.parentElement.removeChild(this.element);\r\n    }\r\n\r\n    focus() {\r\n        this.input.focus();\r\n    }\r\n\r\n    blur() {\r\n        this.input.blur();\r\n    }\r\n\r\n    isFocused() {\r\n        return document.activeElement === this.input;\r\n    }\r\n}\r\n"],"sourceRoot":""}