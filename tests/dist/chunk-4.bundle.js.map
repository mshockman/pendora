{"version":3,"sources":["webpack://pendora/./src/core/ui/Overlay.js"],"names":["symbolShow","Symbol","symbolHide","getXIntersectAmount","rect1","rect2","left","Math","max","right","min","getYIntersectAmount","top","bottom","DEFAULT_PLACEMENTS","my","at","of","arrow","Overlay","element","target","container","sticky","fit","showFX","showDuration","hideFX","hideDuration","timeout","removeOnHide","visibleClassName","hiddenClassName","document","querySelector","undefined","addClass","removeClass","removeFrom","appendTo","name","options","placement","key","method","push","Object","freeze","addPlacement","mode","length","targetRect","containerRect","startingIndex","currentPos","currentIntersectAmount","currentPlacement","Rect","getBoundingClientRect","getRootContainingClientRect","i","index","position","getPlacement","clampSpace","pos","newIntersectAmount","subBoundingBox","getSubBoundingBox","arrowOffset","arrowRect","dataset","getCleanBoundingClientRect","setPlacement","unionBox","union","subtract","add","width","height","clamp","contains","getDistanceBetweenRects","fitY","fitX","setElementClientPosition","publish","immediate","clearTimeOut","parentElement","body","appendChild","cancel","result","Animation","complete","visible","state","startingState","hidden","showing","onFrame","animate","duration","clearTimeout","startTimeoutTimer","hiding","TypeError","setTimeout","hide","isTimingOut","slice","value","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAGO,IAAMA,UAAU,GAAGC,MAAM,CAAC,MAAD,CAAzB;AAAA,IACHC,UAAU,GAAGD,MAAM,CAAC,MAAD,CADhB;;AAIP,SAASE,mBAAT,CAA6BC,KAA7B,EAAoCC,KAApC,EAA2C;AACvC,MAAIC,IAAI,GAAGC,IAAI,CAACC,GAAL,CAASJ,KAAK,CAACE,IAAf,EAAqBD,KAAK,CAACC,IAA3B,CAAX;AAAA,MACIG,KAAK,GAAGF,IAAI,CAACG,GAAL,CAASN,KAAK,CAACK,KAAf,EAAsBJ,KAAK,CAACI,KAA5B,CADZ;AAGA,SAAOH,IAAI,GAAGG,KAAP,GAAe,CAAf,GAAmBA,KAAK,GAAGH,IAAlC;AACH;;AAGD,SAASK,mBAAT,CAA6BP,KAA7B,EAAoCC,KAApC,EAA2C;AACvC,MAAIO,GAAG,GAAGL,IAAI,CAACC,GAAL,CAASJ,KAAK,CAACQ,GAAf,EAAoBP,KAAK,CAACO,GAA1B,CAAV;AAAA,MACIC,MAAM,GAAGN,IAAI,CAACG,GAAL,CAASN,KAAK,CAACS,MAAf,EAAuBR,KAAK,CAACQ,MAA7B,CADb;AAGA,SAAOD,GAAG,GAAGC,MAAN,GAAe,CAAf,GAAmBA,MAAM,GAAGD,GAAnC;AACH;;AAGD,IAAME,kBAAkB,GAAG;AACvBF,KAAG,EAAE;AACDG,MAAE,EAAE,QADH;AAEDC,MAAE,EAAE,KAFH;AAGDC,MAAE,EAAE,YAHH;AAIDC,SAAK,EAAE;AAJN,GADkB;AAQvBL,QAAM,EAAE;AACJE,MAAE,EAAE,KADA;AAEJC,MAAE,EAAE,QAFA;AAGJC,MAAE,EAAE,eAHA;AAIJC,SAAK,EAAE;AAJH,GARe;AAevBT,OAAK,EAAE;AACHM,MAAE,EAAE,MADD;AAEHC,MAAE,EAAE,OAFD;AAGHC,MAAE,EAAE,cAHD;AAIHC,SAAK,EAAE;AAJJ,GAfgB;AAsBvBZ,MAAI,EAAE;AACFS,MAAE,EAAE,OADF;AAEFC,MAAE,EAAE,MAFF;AAGFC,MAAE,EAAE,aAHF;AAIFC,SAAK,EAAE;AAJL;AAtBiB,CAA3B;;IA+BqBC,O;;;;;AAwBjB,mBAAYC,OAAZ,EAAiO;AAAA;;AAAA,mFAAJ,EAAI;AAAA,2BAA3MC,MAA2M;AAAA,QAA3MA,MAA2M,4BAApM,IAAoM;AAAA,8BAA9LC,SAA8L;AAAA,QAA9LA,SAA8L,+BAApL,IAAoL;AAAA,2BAA9KC,MAA8K;AAAA,QAA9KA,MAA8K,4BAAvK,IAAuK;AAAA,wBAAjKC,GAAiK;AAAA,QAAjKA,GAAiK,yBAA7J,IAA6J;AAAA,2BAAvJC,MAAuJ;AAAA,QAAvJA,MAAuJ,4BAAhJ,IAAgJ;AAAA,iCAA1IC,YAA0I;AAAA,QAA1IA,YAA0I,kCAA7H,IAA6H;AAAA,2BAAvHC,MAAuH;AAAA,QAAvHA,MAAuH,4BAAhH,IAAgH;AAAA,iCAA1GC,YAA0G;AAAA,QAA1GA,YAA0G,kCAA7F,IAA6F;AAAA,4BAAvFC,OAAuF;AAAA,QAAvFA,OAAuF,6BAA/E,IAA+E;AAAA,iCAAzEC,YAAyE;AAAA,QAAzEA,YAAyE,kCAA5D,KAA4D;AAAA,qCAArDC,gBAAqD;AAAA,QAArDA,gBAAqD,sCAApC,IAAoC;AAAA,oCAA9BC,eAA8B;AAAA,QAA9BA,eAA8B,qCAAd,QAAc;;AAAA;;AAC7N,iFAAMZ,OAAN;;AAD6N;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAG7N,QAAG,OAAOC,MAAP,KAAkB,QAArB,EAA+B;AAC3BA,YAAM,GAAGY,QAAQ,CAACC,aAAT,CAAuBb,MAAvB,CAAT;AACH;;AAED,QAAG,OAAOC,SAAP,KAAqB,QAAxB,EAAkC;AAC9BA,eAAS,GAAGW,QAAQ,CAACC,aAAT,CAAuBZ,SAAvB,CAAZ;AACH;;AAED,UAAKC,MAAL,GAAcA,MAAd;AACA,UAAKC,GAAL,GAAWA,GAAX;AACA,UAAKK,OAAL,GAAeA,OAAf;AACA,UAAKC,YAAL,GAAoBA,YAApB;;AAEA,wEAAqB,CAArB,EAhB6N,CAgBrM;;;AACxB,sEAAmB,EAAnB;;AACA,iEAAcR,SAAd;;AACA,iEAAc,IAAd;;AAEA,4EAAyBS,gBAAzB;;AACA,2EAAwBC,eAAxB;;AAEA,iEAAcG,SAAd;;AAEA,QAAG,OAAOV,MAAP,KAAkB,UAArB,EAAiC;AAC7BA,YAAM,GAAG,IAAIA,MAAJ,EAAT;AACH;;AACD,QAAG,OAAOE,MAAP,KAAkB,UAArB,EAAiC;AAC7BA,YAAM,GAAG,IAAIA,MAAJ,EAAT;AACH;;AAED,8DAAW,IAAX;;AACA,kEAAeF,MAAf;;AACA,wEAAqBC,YAArB;;AACA,kEAAeC,MAAf;;AACA,wEAAoBC,YAApB;;AAEA,UAAKP,MAAL,GAAcA,MAAd;AACA,UAAKC,SAAL,GAAiBA,SAAjB;AAxC6N;AAyChO,G,CAED;;;;SACCpB,U;0BAAYkB,O,EAAS;AAClB,gCAAG,IAAH,qBAA0B;AACtB,aAAKgB,QAAL,uBAAc,IAAd;AACH;;AAED,gCAAG,IAAH,sBAA2B;AACvB,aAAKC,WAAL,uBAAiB,IAAjB;AACH;AACJ,K,CAED;;;SACCrC,U;0BAAYoB,O,EAAS;AAClB,gCAAG,IAAH,qBAA0B;AACtB,aAAKiB,WAAL,uBAAiB,IAAjB;AACH;;AAED,gCAAG,IAAH,sBAA2B;AACvB,aAAKD,QAAL,uBAAc,IAAd;AACH;AACJ;;;6BAEQlB,K,EAAO;AACZ,gCAAG,IAAH,WAAgB;AACZ,4CAAYoB,UAAZ;;AACA,4CAAc,IAAd;AACH;;AAED,0CAAcpB,KAAd;;AACA,0CAAYqB,QAAZ,CAAqB,KAAKnB,OAA1B;AACH;;;iCAEYoB,I,EAAyB;AAAA,UAAnBC,OAAmB,uEAAXN,SAAW;;AAClC,UAAG,CAACM,OAAJ,EAAa;AACTA,eAAO,GAAG3B,kBAAkB,CAAC0B,IAAD,CAA5B;AACH;;AAED,UAAIE,SAAS,GAAG;AAACF,YAAI,EAAJA;AAAD,OAAhB;;AAEA,8BAAe,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,OAAnB,EAA4B,QAA5B,EAAsC,WAAtC,EAAmD,QAAnD,CAAf,0BAA6E;AAAzE,YAAIG,GAAG,WAAP;;AACA,YAAGF,OAAO,CAACE,GAAD,CAAP,KAAiBR,SAApB,EAA+B;AAC3BO,mBAAS,CAACC,GAAD,CAAT,GAAiBF,OAAO,CAACE,GAAD,CAAxB;AACH;AACJ;;AAEDD,eAAS,CAACE,MAAV,GAAmBF,SAAS,CAACE,MAAV,IAAoB,UAAvC;;AAEA,+CAAiBC,IAAjB,CAAsBC,MAAM,CAACC,MAAP,CAAcL,SAAd,CAAtB;AACH;;;iCAEYF,I,EAAyB;AAAA,UAAnBC,OAAmB,uEAAXN,SAAW;;AAClC,UAAG,CAACM,OAAJ,EAAa;AACTA,eAAO,GAAG3B,kBAAkB,CAAC0B,IAAD,CAA5B;AACH;;AAED,+CAAmB,EAAnB;;AACA,WAAKQ,YAAL,CAAkBR,IAAlB,EAAwBC,OAAxB;AACH;;;+BAEwB;AAAA,UAAhBQ,IAAgB,uEAAX,SAAW;;AACrB,UAAG,CAAC,yCAAiBC,MAArB,EAA6B;AACzB;AACH;;AAED,UAAIC,UAAJ;AAAA,UACIC,aADJ;AAAA,UAEIC,aAAa,GAAG,CAFpB;AAAA,UAGIC,UAAU,GAAG,IAHjB;AAAA,UAIIC,sBAAsB,GAAG,CAJ7B;AAAA,UAKIC,gBALJ;;AAOA,UAAG,OAAO,KAAKnC,MAAZ,KAAuB,UAA1B,EAAsC;AAClC8B,kBAAU,GAAG,IAAIM,qDAAJ,CAAS,KAAKpC,MAAL,EAAT,CAAb;AACH,OAFD,MAEO,IAAG,KAAKA,MAAR,EAAgB;AACnB8B,kBAAU,GAAGM,qDAAI,CAACC,qBAAL,CAA2B,KAAKrC,MAAhC,CAAb;AACH,OAFM,MAEA;AACH8B,kBAAU,GAAGM,qDAAI,CAACE,2BAAL,EAAb;AACH;;AAED,UAAG,OAAO,KAAKrC,SAAZ,KAA0B,UAA7B,EAAyC;AACrC8B,qBAAa,GAAG,KAAK9B,SAAL,EAAhB;AACH,OAFD,MAEO,IAAG,KAAKA,SAAR,EAAmB;AACtB8B,qBAAa,GAAGK,qDAAI,CAACC,qBAAL,CAA2B,KAAKpC,SAAhC,CAAhB;AACH,OAFM,MAEA;AACH8B,qBAAa,GAAG,IAAhB;AACH,OA1BoB,CA4BrB;;;AACA,UAAG,KAAK7B,MAAR,EAAgB;AACZ8B,qBAAa,yBAAG,IAAH,gBAAb;AACH,OA/BoB,CAiCrB;;;AACA,WAAI,IAAIO,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,yCAAiBV,MAApC,EAA4CU,CAAC,EAA7C,EAAiD;AAC7C,YAAIC,KAAK,GAAG,CAACR,aAAa,GAAGO,CAAjB,IAAsB,yCAAiBV,MAAnD;AAAA,YACIY,QAAQ,GAAG,KAAKC,YAAL,CAAkBF,KAAlB,CADf;AAAA,YAEIG,UAAU,GAAGb,UAFjB;AAAA,YAGIc,GAAG,SAHP;AAAA,YAIIC,kBAAkB,SAJtB;AAAA,YAKIC,cAAc,GAAGL,QAAQ,CAAC7C,EAAT,GAAcmD,0EAAiB,CAACjB,UAAD,EAAaW,QAAQ,CAAC7C,EAAtB,CAA/B,GAA2DkC,UALhF;AAAA,YAMIkB,WAAW,GAAG,IAAIZ,qDAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CANlB;AAAA,YAOIa,SAAS,SAPb;;AASA,aAAKlD,OAAL,CAAamD,OAAb,CAAqB7B,SAArB,GAAiCoB,QAAQ,CAACtB,IAA1C;;AAEA,YAAGS,IAAI,KAAK,SAAZ,EAAuB;AACnBgB,aAAG,GAAGR,qDAAI,CAACC,qBAAL,CAA2B,KAAKtC,OAAhC,CAAN;AACH,SAFD,MAEO;AACH6C,aAAG,GAAGR,qDAAI,CAACe,0BAAL,CAAgC,KAAKpD,OAArC,CAAN;AACH;;AAED,YAAG,uCAAe0C,QAAQ,CAAC5C,KAA3B,EAAkC;AAC9B,8CAAYuD,YAAZ,CAAyBX,QAAQ,CAAC5C,KAAlC;;AACAoD,mBAAS,GAAG,oCAAYZ,qBAAZ,EAAZ;AACA,cAAIgB,QAAQ,GAAGT,GAAG,CAACU,KAAJ,CAAUL,SAAV,CAAf;AACAD,qBAAW,GAAGJ,GAAG,CAACW,QAAJ,CAAaF,QAAb,CAAd;AACAT,aAAG,GAAGS,QAAN;AACH;;AAEDV,kBAAU,GAAGb,UAAU,CAAC0B,GAAX,CAAe,IAAIpB,qDAAJ,CACxB,CAACQ,GAAG,CAACa,KADmB,EAExB,CAACb,GAAG,CAACc,MAFmB,EAGxB,CAHwB,EAIxB,CAJwB,CAAf,CAAb;;AAOA,YAAGT,SAAH,EAAc;AACV,cAAG,oCAAY5B,SAAZ,KAA0B,KAA1B,IAAmC,oCAAYA,SAAZ,KAA0B,QAAhE,EAA0E;AACtEsB,sBAAU,GAAGA,UAAU,CAACa,GAAX,CAAe,IAAIpB,qDAAJ,CACxBa,SAAS,CAACQ,KADc,EAExB,CAFwB,EAGxB,CAACR,SAAS,CAACQ,KAHa,EAIxB,CAJwB,CAAf,CAAb;AAMH,WAPD,MAOO;AACHd,sBAAU,GAAGA,UAAU,CAACa,GAAX,CAAe,IAAIpB,qDAAJ,CACxB,CADwB,EAExBa,SAAS,CAACS,MAFc,EAGxB,CAHwB,EAIxB,CAACT,SAAS,CAACS,MAJa,CAAf,CAAb;AAMH;AACJ;;AAEDd,WAAG,GAAGA,GAAG,CAACH,QAAJ,CAAa;AACf/C,YAAE,EAAE+C,QAAQ,CAAC/C,EADE;AAEfC,YAAE,EAAE8C,QAAQ,CAAC9C,EAFE;AAGfC,YAAE,EAAEkC;AAHW,SAAb,CAAN;;AAMA,YAAGC,aAAH,EAAkB;AACda,aAAG,GAAGA,GAAG,CAACzC,GAAJ,CAAQ4B,aAAR,CAAN;AACH;;AAED,YAAGU,QAAQ,CAAC7C,EAAZ,EAAgB;AACZ+C,oBAAU,GAAGI,0EAAiB,CAACJ,UAAD,EAAaF,QAAQ,CAAC7C,EAAtB,CAA9B;AACH;;AAEDgD,WAAG,GAAGA,GAAG,CAACe,KAAJ,CAAUhB,UAAV,CAAN;AAEAE,0BAAkB,GAAG/D,mBAAmB,CAACgE,cAAD,EAAiBf,aAAjB,CAAnB,GAAqDzC,mBAAmB,CAACwD,cAAD,EAAiBf,aAAjB,CAA7F,CAnE6C,CAqE7C;;AACA,YAAG,CAACE,UAAD,IAAgBF,aAAa,IAAIA,aAAa,CAAC6B,QAAd,CAAuBhB,GAAvB,CAAjC,IAAkEC,kBAAkB,GAAGX,sBAArB,IAA+C2B,gFAAuB,CAACjB,GAAD,EAAMb,aAAN,CAAvB,IAA+C8B,gFAAuB,CAAC5B,UAAD,EAAaF,aAAb,CAA1L,EAAwN;AACpN,cAAGA,aAAH,EAAkB;AACd,gBAAG,KAAK5B,GAAL,KAAa,IAAb,IAAqB,KAAKA,GAAL,KAAa,IAArC,EAA2C;AACvCyC,iBAAG,GAAGA,GAAG,CAACzC,GAAJ,CAAQ4B,aAAR,CAAN;AACH,aAFD,MAEO,IAAG,KAAK5B,GAAL,KAAa,GAAhB,EAAqB;AACxByC,iBAAG,GAAGA,GAAG,CAACkB,IAAJ,CAAS/B,aAAT,CAAN;AACH,aAFM,MAEA,IAAG,KAAK5B,GAAL,KAAa,GAAhB,EAAqB;AACxByC,iBAAG,GAAGA,GAAG,CAACmB,IAAJ,CAAShC,aAAT,CAAN;AACH;AACJ;;AAEDE,oBAAU,GAAGW,GAAG,CAACY,GAAJ,CAAQR,WAAR,CAAb;AACAd,gCAAsB,GAAGW,kBAAzB;AACAV,0BAAgB,GAAGM,QAAnB;;AAEA,qDAAqBD,KAArB;;AAEA,cAAG,CAACT,aAAD,IAAkBA,aAAa,CAAC6B,QAAd,CAAuBhB,GAAvB,CAArB,EAAkD;AAC9C;AACH;AACJ;AACJ,OA7HoB,CA+HrB;;;AACA,WAAK7C,OAAL,CAAamD,OAAb,CAAqB7B,SAArB,GAAiCc,gBAAgB,CAAChB,IAAlD;AAEA6C,uFAAwB,CAAC,KAAKjE,OAAN,EAAekC,UAAf,EAA2BE,gBAAgB,CAACZ,MAAjB,IAA2B,UAAtD,CAAxB;;AAEA,gCAAG,IAAH,WAAgB;AACZ,4CAAY6B,YAAZ,CAAyBjB,gBAAgB,CAACtC,KAA1C;AACH,OAtIoB,CAwIrB;;;AACA,WAAKoE,OAAL,CAAa,gBAAb,EAA+B;AAC3BjE,cAAM,EAAE,IADmB;AAE3BmB,YAAI,EAAE,gBAFqB;AAG3BsB,gBAAQ,EAAER,UAHiB;AAI3BZ,iBAAS,EAAEc,gBAJgB;AAK3BK,aAAK,wBAAE,IAAF;AALsB,OAA/B;AAQA,aAAOP,UAAP;AACH;;;iCAEYO,K,EAAO;AAChB,aAAO,yCAAiBA,KAAjB,CAAP;AACH;;;;;;;;;;;;;;;;;;AAEU0B,yB,2DAAU,K;AACjB,qBAAKC,YAAL;AAEA,qBAAKF,OAAL,CAAa,cAAb,EAA6B,IAA7B;;AAEA,oBAAG,CAAC,KAAKlE,OAAL,CAAaqE,aAAjB,EAAgC;AAC5BxD,0BAAQ,CAACyD,IAAT,CAAcC,WAAd,CAA0B,KAAKvE,OAA/B;AACH;;qBAIEmE,S;;;;;2CACI,I;;;;;;uBACO,iCAASK,MAAT,E;;;AAGV,qBAAK5F,UAAL,EAAiB,KAAKoB,OAAtB;;AAEA,0CAAG,IAAH,YAAiB;AACb,+DAAkB,KAAKA,OAAvB,EAAgC,CAAhC;AACH;;AAED,qBAAK0C,QAAL,CAAc,SAAd;AAEA+B,sBAAM,GAAGC,qDAAS,CAACC,QAAnB;;AACA,oDAAc5E,OAAO,CAAC6E,OAAtB;;AACA,qBAAKV,OAAL,CAAa,iBAAb,EAAgC,IAAhC;;;;;sBACM,KAAKW,KAAL,KAAe9E,OAAO,CAAC6E,O;;;;;2CAC1B,I;;;;;;uBACO,iCAASJ,MAAT,E;;;AAGNM,6B,GAAgB,KAAKD,K;AAEzB,qBAAKjG,UAAL,EAAiB,KAAKoB,OAAtB;AACA,qBAAK0C,QAAL,CAAc,SAAd;;sBAEGoC,aAAa,KAAK/E,OAAO,CAACgF,MAA1B,0BAAoC,IAApC,U;;;;;;uBACO,6CAAkB,KAAK/E,OAAvB,EAAgC,CAAhC,C;;;AAGV,qBAAK0C,QAAL,CAAc,SAAd;;AAEA,oDAAc3C,OAAO,CAACiF,OAAtB;;AACA,qBAAKd,OAAL,CAAa,iBAAb,EAAgC,IAAhC;;AAEIe,uB,GAAU,SAAVA,OAAU,GAAM;AAChB,wBAAI,CAACvC,QAAL,CAAc,SAAd;AACH,iB;;AAED,0CAAG,IAAH,YAAiB;AACb,mDAAW,qCAAawC,OAAb,CAAqB,KAAKlF,OAA1B,EAAmC;AAACmF,4BAAQ,wBAAE,IAAF,gBAAT;AAA+BF,2BAAO,EAAPA;AAA/B,mBAAnC,CAAX;AACH;;AAED,qBAAKvC,QAAL,CAAc,SAAd;;2CAEG,I;;;;;;6CACgB,I;;;AAAf+B,sB;;AACA,iDAAW,IAAX;;;;;;AAEAA,sBAAM,GAAGC,qDAAS,CAACC,QAAnB;;;AAGJ,oBAAGF,MAAM,KAAKC,qDAAS,CAACC,QAAxB,EAAkC;AAC9B,sDAAc5E,OAAO,CAAC6E,OAAtB;;AACA,uBAAKV,OAAL,CAAa,iBAAb,EAAgC,IAAhC;AACH;;;;;;AAEDO,sBAAM,GAAGC,qDAAS,CAACC,QAAnB;;;AAGJ,oBAAGF,MAAM,KAAKC,qDAAS,CAACC,QAAxB,EAAkC;AAC9B,4CAAI,IAAJ,WAAiB;AACbS,gCAAY,uBAAC,IAAD,UAAZ;;AACA,wDAAc,IAAd;AACH;;AAED,sBAAI,OAAO,KAAK3E,OAAZ,KAAwB,QAAxB,IAAoC,KAAKA,OAAL,IAAgB,CAAxD,EAA2D;AACvD,yBAAK4E,iBAAL,CAAuB,KAAK5E,OAA5B;AACH;AACJ;;iDAEMgE,M;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGAN,yB,8DAAU,K;AACjB,qBAAKC,YAAL;AAEA,qBAAKF,OAAL,CAAa,cAAb,EAA6B,IAA7B;;qBAEGC,S;;;;;2CACI,I;;;;;;uBACO,iCAASK,MAAT,E;;;AAGV,0CAAG,IAAH,YAAiB;AACb,+DAAkB,KAAKxE,OAAvB,EAAgC,CAAhC;AACH;;AAED,qBAAKlB,UAAL,EAAiB,KAAKkB,OAAtB;;AACA,oDAAcD,OAAO,CAACgF,MAAtB;;AACA,qBAAKb,OAAL,CAAa,gBAAb,EAA+B,IAA/B;;AAEA,oBAAG,KAAKxD,YAAR,EAAsB;AAClB,uBAAKQ,UAAL;AACH;;kDAEMwD,qDAAS,CAACC,Q;;;sBAChB,KAAKE,KAAL,KAAe9E,OAAO,CAACgF,M;;;;;2CACrB,I;;;;;;uBACO,iCAASP,MAAT,E;;;AAKNS,uB,GAAU,SAAVA,OAAU,GAAM;AAChB,wBAAI,CAACvC,QAAL,CAAc,SAAd;AACH,iB;;AAED,0CAAG,IAAH,YAAiB;AACb,mDAAW,qCAAawC,OAAb,CAAqB,KAAKlF,OAA1B,EAAmC;AAACmF,4BAAQ,wBAAE,IAAF,gBAAT;AAA+BF,2BAAO,EAAPA;AAA/B,mBAAnC,CAAX;AACH;;AAED,oDAAclF,OAAO,CAACuF,MAAtB;;AACA,qBAAKpB,OAAL,CAAa,gBAAb,EAA+B,IAA/B;;2CAEG,I;;;;;;6CACgB,I;;;AAAfO,sB;;;;;AAEAA,sBAAM,GAAGC,qDAAS,CAACC,QAAnB;;;AAGJ,oBAAGF,MAAM,KAAKC,qDAAS,CAACC,QAAxB,EAAkC;AAC9B,uBAAK7F,UAAL,EAAiB,KAAKkB,OAAtB;;AACA,sDAAcD,OAAO,CAACgF,MAAtB;;AAEA,sBAAG,KAAKrE,YAAR,EAAsB;AAClB,yBAAKQ,UAAL;AACH;;AAED,uBAAKgD,OAAL,CAAa,gBAAb,EAA+B,IAA/B;AACH;;kDAEMO,M;;;kDAEAC,qDAAS,CAACC,Q;;;;;;;;;;;;;;;;;;wCAIO;AAAA;;AAAA,UAAdlE,OAAc,uEAAN,IAAM;;AAC5B,UAAGA,OAAO,KAAK,IAAf,EAAqB;AACjBA,eAAO,GAAG,KAAKA,OAAf;AACH;;AAED,UAAG,OAAOA,OAAP,KAAmB,QAAnB,IAA+BA,OAAO,GAAG,CAA5C,EAA+C;AAC3C,cAAM,IAAI8E,SAAJ,CAAc,qCAAd,CAAN;AACH;;AAED,WAAKnB,YAAL;;AAEA,0CAAcoB,UAAU,CAAC,YAAM;AAC3B,cAAI,CAACC,IAAL;;AACA,cAAI,CAACvB,OAAL,CAAa,iBAAb,EAAgC,MAAhC;AACH,OAHuB,EAGrB,KAAKzD,OAHgB,CAAxB;AAIH;;;mCAEc;AACX,UAAG,KAAKiF,WAAL,EAAH,EAAuB;AACnBN,oBAAY,uBAAC,IAAD,UAAZ;;AACA,4CAAc,IAAd;;AACA,eAAO,IAAP;AACH;;AAED,aAAO,KAAP;AACH;;;kCAEa;AACV,aAAO,CAAC,uBAAC,IAAD,SAAR;AACH;;;;;;;;;;;2CAGM,I;;;;;;uBACO,iCAASZ,MAAT,E;;;;;;;;;;;;;;;QAId;;;;wBACiB;AACb,aAAO,yCAAiBmB,KAAjB,CAAuB,CAAvB,CAAP;AACH;;;wBAEY;AACT,mCAAO,IAAP;AACH,K;sBAMU1F,M,EAAQ;AACf,UAAG,OAAO2F,KAAP,KAAiB,QAApB,EAA8B;AAC1B,6CAAe/E,QAAQ,CAACC,aAAT,CAAuBb,MAAvB,CAAf;AACH,OAFD,MAEO;AACH,6CAAeA,MAAM,IAAI,IAAzB;AACH;AACJ;;;wBAVe;AACZ,mCAAO,IAAP;AACH,K;sBAUaC,S,EAAW;AACrB,UAAG,OAAOA,SAAP,KAAqB,QAAxB,EAAkC;AAC9B,gDAAkBW,QAAQ,CAACC,aAAT,CAAuBZ,SAAvB,CAAlB;AACH,OAFD,MAEO;AACH,gDAAkBA,SAAS,IAAI,IAA/B;AACH;AACJ;;;wBAEQ;AACL,mCAAO,IAAP;AACH;;;wBAEW;AACR,mCAAO,IAAP;AACH;;;;EAnfgC2F,kD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;gBAAhB9F,O,YACD,Q;;gBADCA,O,aAEA,S;;gBAFAA,O,YAGD,Q;;gBAHCA,O,aAIA,S","file":"chunk-4.bundle.js","sourcesContent":["import Rect from \"../vectors/Rect\";\r\nimport {getDistanceBetweenRects, getSubBoundingBox, setElementClientPosition} from \"core/ui/position\";\r\nimport Component from \"../Component\";\r\nimport Animation from \"../fx/Animation\";\r\n\r\n\r\nexport const symbolShow = Symbol(\"show\"),\r\n    symbolHide = Symbol(\"hide\");\r\n\r\n\r\nfunction getXIntersectAmount(rect1, rect2) {\r\n    let left = Math.max(rect1.left, rect2.left),\r\n        right = Math.min(rect1.right, rect2.right);\r\n\r\n    return left > right ? 0 : right - left;\r\n}\r\n\r\n\r\nfunction getYIntersectAmount(rect1, rect2) {\r\n    let top = Math.max(rect1.top, rect2.top),\r\n        bottom = Math.min(rect1.bottom, rect2.bottom);\r\n\r\n    return top > bottom ? 0 : bottom - top;\r\n}\r\n\r\n\r\nconst DEFAULT_PLACEMENTS = {\r\n    top: {\r\n        my: \"bottom\",\r\n        at: \"top\",\r\n        of: \"border-top\",\r\n        arrow: \"bottom\"\r\n    },\r\n\r\n    bottom: {\r\n        my: \"top\",\r\n        at: \"bottom\",\r\n        of: \"border-bottom\",\r\n        arrow: \"top\"\r\n    },\r\n\r\n    right: {\r\n        my: \"left\",\r\n        at: \"right\",\r\n        of: \"border-right\",\r\n        arrow: \"left\"\r\n    },\r\n\r\n    left: {\r\n        my: \"right\",\r\n        at: \"left\",\r\n        of: \"border-left\",\r\n        arrow: \"right\"\r\n    }\r\n};\r\n\r\n\r\nexport default class Overlay extends Component {\r\n    static hiding = \"Hiding\";\r\n    static showing = \"Showing\";\r\n    static hidden = \"Hidden\";\r\n    static visible = \"Visible\";\r\n\r\n    #currentIndex;\r\n    #placements;\r\n    #container;\r\n    #target;\r\n    #arrow;\r\n    #state;\r\n\r\n    #showFX;\r\n    #showDuration;\r\n    #hideFX;\r\n    #hideDuration;\r\n    #fx;\r\n\r\n    #visibleClassName;\r\n    #hiddenClassName;\r\n\r\n    #timer;\r\n\r\n    constructor(element, {target=null, container=null, sticky=true, fit=null, showFX=null, showDuration=null, hideFX=null, hideDuration=null, timeout=null, removeOnHide=false, visibleClassName=null, hiddenClassName=\"hidden\"}={}) {\r\n        super(element);\r\n\r\n        if(typeof target === 'string') {\r\n            target = document.querySelector(target);\r\n        }\r\n\r\n        if(typeof container === 'string') {\r\n            container = document.querySelector(container);\r\n        }\r\n\r\n        this.sticky = sticky;\r\n        this.fit = fit;\r\n        this.timeout = timeout;\r\n        this.removeOnHide = removeOnHide;\r\n\r\n        this.#currentIndex = 0; // The index of the current placement.\r\n        this.#placements = [];\r\n        this.#arrow = container;\r\n        this.#timer = null;\r\n\r\n        this.#visibleClassName = visibleClassName;\r\n        this.#hiddenClassName = hiddenClassName;\r\n\r\n        this.#state = undefined;\r\n\r\n        if(typeof showFX === 'function') {\r\n            showFX = new showFX();\r\n        }\r\n        if(typeof hideFX === 'function') {\r\n            hideFX = new hideFX();\r\n        }\r\n\r\n        this.#fx = null;\r\n        this.#showFX = showFX;\r\n        this.#showDuration = showDuration;\r\n        this.#hideFX = hideFX;\r\n        this.#hideDuration= hideDuration;\r\n\r\n        this.target = target;\r\n        this.container = container;\r\n    }\r\n\r\n    // noinspection JSUnusedLocalSymbols\r\n    [symbolHide](element) {\r\n        if(this.#hiddenClassName) {\r\n            this.addClass(this.#hiddenClassName);\r\n        }\r\n\r\n        if(this.#visibleClassName) {\r\n            this.removeClass(this.#visibleClassName);\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedLocalSymbols\r\n    [symbolShow](element) {\r\n        if(this.#hiddenClassName) {\r\n            this.removeClass(this.#hiddenClassName);\r\n        }\r\n\r\n        if(this.#visibleClassName) {\r\n            this.addClass(this.#visibleClassName);\r\n        }\r\n    }\r\n\r\n    setArrow(arrow) {\r\n        if(this.#arrow) {\r\n            this.#arrow.removeFrom();\r\n            this.#arrow = null;\r\n        }\r\n\r\n        this.#arrow = arrow;\r\n        this.#arrow.appendTo(this.element);\r\n    }\r\n\r\n    addPlacement(name, options=undefined) {\r\n        if(!options) {\r\n            options = DEFAULT_PLACEMENTS[name];\r\n        }\r\n\r\n        let placement = {name};\r\n\r\n        for(let key of ['my', 'at', 'of', 'arrow', 'offset', 'collision', 'method']) {\r\n            if(options[key] !== undefined) {\r\n                placement[key] = options[key];\r\n            }\r\n        }\r\n\r\n        placement.method = placement.method || 'top-left';\r\n\r\n        this.#placements.push(Object.freeze(placement));\r\n    }\r\n\r\n    setPlacement(name, options=undefined) {\r\n        if(!options) {\r\n            options = DEFAULT_PLACEMENTS[name];\r\n        }\r\n\r\n        this.#placements = [];\r\n        this.addPlacement(name, options);\r\n    }\r\n\r\n    position(mode=\"current\") {\r\n        if(!this.#placements.length) {\r\n            return;\r\n        }\r\n\r\n        let targetRect,\r\n            containerRect,\r\n            startingIndex = 0,\r\n            currentPos = null,\r\n            currentIntersectAmount = 0,\r\n            currentPlacement;\r\n\r\n        if(typeof this.target === 'function') {\r\n            targetRect = new Rect(this.target());\r\n        } else if(this.target) {\r\n            targetRect = Rect.getBoundingClientRect(this.target);\r\n        } else {\r\n            targetRect = Rect.getRootContainingClientRect();\r\n        }\r\n\r\n        if(typeof this.container === 'function') {\r\n            containerRect = this.container();\r\n        } else if(this.container) {\r\n            containerRect = Rect.getBoundingClientRect(this.container);\r\n        } else {\r\n            containerRect = null;\r\n        }\r\n\r\n        // If sticky start searching from the last position instead of starting from the begining.\r\n        if(this.sticky) {\r\n            startingIndex = this.#currentIndex;\r\n        }\r\n\r\n        // Find the best position.\r\n        for(let i = 0; i < this.#placements.length; i++) {\r\n            let index = (startingIndex + i) % this.#placements.length,\r\n                position = this.getPlacement(index),\r\n                clampSpace = targetRect,\r\n                pos,\r\n                newIntersectAmount,\r\n                subBoundingBox = position.of ? getSubBoundingBox(targetRect, position.of) : targetRect,\r\n                arrowOffset = new Rect(0, 0, 0, 0),\r\n                arrowRect;\r\n\r\n            this.element.dataset.placement = position.name;\r\n\r\n            if(mode === \"current\") {\r\n                pos = Rect.getBoundingClientRect(this.element);\r\n            } else {\r\n                pos = Rect.getCleanBoundingClientRect(this.element);\r\n            }\r\n\r\n            if(this.#arrow && position.arrow) {\r\n                this.#arrow.setPlacement(position.arrow);\r\n                arrowRect = this.#arrow.getBoundingClientRect();\r\n                let unionBox = pos.union(arrowRect);\r\n                arrowOffset = pos.subtract(unionBox);\r\n                pos = unionBox;\r\n            }\r\n\r\n            clampSpace = targetRect.add(new Rect(\r\n                -pos.width,\r\n                -pos.height,\r\n                0,\r\n                0\r\n            ));\r\n\r\n            if(arrowRect) {\r\n                if(this.#arrow.placement === \"top\" || this.#arrow.placement === \"bottom\") {\r\n                    clampSpace = clampSpace.add(new Rect(\r\n                        arrowRect.width,\r\n                        0,\r\n                        -arrowRect.width,\r\n                        0\r\n                    ));\r\n                } else {\r\n                    clampSpace = clampSpace.add(new Rect(\r\n                        0,\r\n                        arrowRect.height,\r\n                        0,\r\n                        -arrowRect.height\r\n                    ));\r\n                }\r\n            }\r\n\r\n            pos = pos.position({\r\n                my: position.my,\r\n                at: position.at,\r\n                of: targetRect\r\n            });\r\n\r\n            if(containerRect) {\r\n                pos = pos.fit(containerRect);\r\n            }\r\n\r\n            if(position.of) {\r\n                clampSpace = getSubBoundingBox(clampSpace, position.of);\r\n            }\r\n\r\n            pos = pos.clamp(clampSpace);\r\n\r\n            newIntersectAmount = getXIntersectAmount(subBoundingBox, containerRect) + getYIntersectAmount(subBoundingBox, containerRect);\r\n\r\n            // noinspection JSCheckFunctionSignatures\r\n            if(!currentPos || (containerRect && containerRect.contains(pos)) || (newIntersectAmount > currentIntersectAmount && getDistanceBetweenRects(pos, containerRect) <= getDistanceBetweenRects(currentPos, containerRect))) {\r\n                if(containerRect) {\r\n                    if(this.fit === true || this.fit === \"xy\") {\r\n                        pos = pos.fit(containerRect);\r\n                    } else if(this.fit === \"y\") {\r\n                        pos = pos.fitY(containerRect);\r\n                    } else if(this.fit === \"x\") {\r\n                        pos = pos.fitX(containerRect);\r\n                    }\r\n                }\r\n\r\n                currentPos = pos.add(arrowOffset);\r\n                currentIntersectAmount = newIntersectAmount;\r\n                currentPlacement = position;\r\n\r\n                this.#currentIndex = index;\r\n\r\n                if(!containerRect || containerRect.contains(pos)) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Apply the best position.\r\n        this.element.dataset.placement = currentPlacement.name;\r\n\r\n        setElementClientPosition(this.element, currentPos, currentPlacement.method || \"top-left\");\r\n\r\n        if(this.#arrow) {\r\n            this.#arrow.setPlacement(currentPlacement.arrow);\r\n        }\r\n\r\n        // Publish topics.\r\n        this.publish(\"overlay.render\", {\r\n            target: this,\r\n            name: 'overlay.render',\r\n            position: currentPos,\r\n            placement: currentPlacement,\r\n            index: this.#currentIndex\r\n        });\r\n\r\n        return currentPos;\r\n    }\r\n\r\n    getPlacement(index) {\r\n        return this.#placements[index];\r\n    }\r\n\r\n    async show(immediate=false) {\r\n        this.clearTimeOut();\r\n\r\n        this.publish(\"overlay.show\", this);\r\n\r\n        if(!this.element.parentElement) {\r\n            document.body.appendChild(this.element);\r\n        }\r\n\r\n        let result;\r\n\r\n        if(immediate) {\r\n            if(this.#fx) {\r\n                await this.#fx.cancel();\r\n            }\r\n\r\n            this[symbolShow](this.element);\r\n\r\n            if(this.#showFX) {\r\n                this.#showFX.goto(this.element, 1);\r\n            }\r\n\r\n            this.position(\"current\");\r\n\r\n            result = Animation.complete;\r\n            this.#state = Overlay.visible;\r\n            this.publish(\"overlay.visible\", this);\r\n        } else if(this.state !== Overlay.visible) {\r\n            if(this.#fx) {\r\n                await this.#fx.cancel();\r\n            }\r\n\r\n            let startingState = this.state;\r\n\r\n            this[symbolShow](this.element);\r\n            this.position(\"current\");\r\n\r\n            if(startingState === Overlay.hidden && this.#hideFX) {\r\n                await this.#hideFX.goto(this.element, 1);\r\n            }\r\n\r\n            this.position(\"current\");\r\n\r\n            this.#state = Overlay.showing;\r\n            this.publish(\"overlay.showing\", this);\r\n\r\n            let onFrame = () => {\r\n                this.position(\"current\");\r\n            };\r\n\r\n            if(this.#showFX) {\r\n                this.#fx = this.#showFX.animate(this.element, {duration: this.#showDuration, onFrame});\r\n            }\r\n\r\n            this.position(\"current\");\r\n\r\n            if(this.#fx) {\r\n                result = await this.#fx;\r\n                this.#fx = null;\r\n            } else {\r\n                result = Animation.complete;\r\n            }\r\n\r\n            if(result === Animation.complete) {\r\n                this.#state = Overlay.visible;\r\n                this.publish(\"overlay.visible\", this);\r\n            }\r\n        } else {\r\n            result = Animation.complete;\r\n        }\r\n\r\n        if(result === Animation.complete) {\r\n            if (this.#timer) {\r\n                clearTimeout(this.#timer);\r\n                this.#timer = null;\r\n            }\r\n\r\n            if (typeof this.timeout === 'number' && this.timeout >= 0) {\r\n                this.startTimeoutTimer(this.timeout);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    async hide(immediate=false) {\r\n        this.clearTimeOut();\r\n\r\n        this.publish(\"overlay.hide\", this);\r\n\r\n        if(immediate) {\r\n            if(this.#fx) {\r\n                await this.#fx.cancel();\r\n            }\r\n\r\n            if(this.#hideFX) {\r\n                this.#hideFX.goto(this.element, 1);\r\n            }\r\n\r\n            this[symbolHide](this.element);\r\n            this.#state = Overlay.hidden;\r\n            this.publish(\"overlay.hidden\", this);\r\n\r\n            if(this.removeOnHide) {\r\n                this.removeFrom();\r\n            }\r\n\r\n            return Animation.complete;\r\n        } if(this.state !== Overlay.hidden) {\r\n            if(this.#fx) {\r\n                await this.#fx.cancel();\r\n            }\r\n\r\n            let result;\r\n\r\n            let onFrame = () => {\r\n                this.position(\"current\");\r\n            };\r\n\r\n            if(this.#hideFX) {\r\n                this.#fx = this.#hideFX.animate(this.element, {duration: this.#hideDuration, onFrame});\r\n            }\r\n\r\n            this.#state = Overlay.hiding;\r\n            this.publish(\"overlay.hiding\", this);\r\n\r\n            if(this.#fx) {\r\n                result = await this.#fx;\r\n            } else {\r\n                result = Animation.complete;\r\n            }\r\n\r\n            if(result === Animation.complete) {\r\n                this[symbolHide](this.element);\r\n                this.#state = Overlay.hidden;\r\n\r\n                if(this.removeOnHide) {\r\n                    this.removeFrom();\r\n                }\r\n\r\n                this.publish(\"overlay.hidden\", this);\r\n            }\r\n\r\n            return result;\r\n        } else {\r\n            return Animation.complete;\r\n        }\r\n    }\r\n\r\n    startTimeoutTimer(timeout=null) {\r\n        if(timeout === null) {\r\n            timeout = this.timeout;\r\n        }\r\n\r\n        if(typeof timeout !== \"number\" || timeout < 0) {\r\n            throw new TypeError(\"Timeout must be a positive integer.\");\r\n        }\r\n\r\n        this.clearTimeOut();\r\n\r\n        this.#timer = setTimeout(() => {\r\n            this.hide();\r\n            this.publish(\"overlay.timeout\", this);\r\n        }, this.timeout);\r\n    }\r\n\r\n    clearTimeOut() {\r\n        if(this.isTimingOut()) {\r\n            clearTimeout(this.#timer);\r\n            this.#timer = null;\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    isTimingOut() {\r\n        return !!this.#timer;\r\n    }\r\n\r\n    async clearFX() {\r\n        if(this.#fx) {\r\n            await this.#fx.cancel();\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get placements() {\r\n        return this.#placements.slice(0);\r\n    }\r\n\r\n    get target() {\r\n        return this.#target;\r\n    }\r\n\r\n    get container() {\r\n        return this.#container;\r\n    }\r\n\r\n    set target(target) {\r\n        if(typeof value === 'string') {\r\n            this.#target = document.querySelector(target);\r\n        } else {\r\n            this.#target = target || null;\r\n        }\r\n    }\r\n\r\n    set container(container) {\r\n        if(typeof container === 'string') {\r\n            this.#container = document.querySelector(container);\r\n        } else {\r\n            this.#container = container || null;\r\n        }\r\n    }\r\n\r\n    get fx() {\r\n        return this.#fx;\r\n    }\r\n\r\n    get state() {\r\n        return this.#state;\r\n    }\r\n}\r\n"],"sourceRoot":""}