{"version":3,"sources":["webpack://pendora/./src/core/fx/Animation.js","webpack://pendora/./src/core/fx/FX.js","webpack://pendora/./src/core/fx/easing.js","webpack://pendora/./src/core/fx/frame.js","webpack://pendora/./src/core/fx/types.js","webpack://pendora/./src/core/ui/Overlay.js","webpack://pendora/./src/core/ui/position.js","webpack://pendora/./src/core/vectors/RGBA.js","webpack://pendora/./src/core/vectors/Vec3.js","webpack://pendora/./src/core/vectors/index.js"],"names":["Animation","duration","frames","applyFrame","defaultApplyFrame","bubbleFrameEvent","finishFrame","element","easing","onStart","onFrame","onPause","onCancel","onEnd","onComplete","FX","animation","fx","EASING","linear","position","autoPlay","init","call","destroy","play","animate","complete","config","defaults","_options","Object","assign","canceled","paused","pending","error","playing","regNumberWithUnit","regColor","regFunction","TYPE_FUNCTIONS","hex","RGBA","parseHexColorStringArg","rgb","parseRGBAColorStringArgs","rgba","DeadFXError","ExtendableError","assertFXAlive","status","doPromiseAction","onAction","value","resolveOrReject","_prepareValue","trim","m","exec","NumberWithUnit","parseFloat","_getFrames","r","keyframeIndex","hasOwnProperty","frame","property","Symbol","toStringTag","selectElement","undefined","key","pos","freeze","push","properties","sort","a","b","startPosition","startValue","endPosition","endValue","getFrameFX","options","p","delta","subtract","add","scalar","tick","performance","now","frameFN","timestamp","dispatchEvent","CustomEvent","bubbles","detail","window","requestAnimationFrame","_complete","cancelAnimationFrame","_triggerEndEvent","completeAnimation","_cancel","getFrame","onResolve","state","onReject","Promise","resolve","reject","onFinally","then","slice","style","toString","unit","TypeError","Error","symbolShow","symbolHide","getXIntersectAmount","rect1","rect2","left","Math","max","right","min","getYIntersectAmount","top","bottom","DEFAULT_PLACEMENTS","my","at","of","arrow","Overlay","target","container","sticky","fit","showFX","showDuration","hideFX","hideDuration","timeout","removeOnHide","visibleClassName","hiddenClassName","document","querySelector","addClass","removeClass","removeFrom","appendTo","name","placement","method","addPlacement","mode","length","targetRect","containerRect","startingIndex","currentPos","currentIntersectAmount","currentPlacement","Rect","getBoundingClientRect","getRootContainingClientRect","i","index","getPlacement","clampSpace","newIntersectAmount","subBoundingBox","getSubBoundingBox","arrowOffset","arrowRect","dataset","getCleanBoundingClientRect","setPlacement","unionBox","union","width","height","clamp","contains","getDistanceBetweenRects","fitY","fitX","setElementClientPosition","publish","immediate","clearTimeOut","parentElement","body","appendChild","cancel","result","visible","startingState","hidden","showing","clearTimeout","startTimeoutTimer","hiding","setTimeout","hide","isTimingOut","Component","regMatrix","getOffsetElement","o","getComputedStyle","getClientRect","getBoundingOffsetRect","offsetParent","offsetRect","rect","getBoundingDocumentRect","pageXOffset","pageYOffset","getTranslation","transform","Vec3","data","split","setTranslation","x","y","z","getCssPosition","Vec2","parseInt","setCssPosition","positionType","box","deltaX","deltaY","current","console","log","cssPosition","clientRectToDocumentSpace","fromRect","documentRectToClientSpace","snapToGrid","gridSize","roundingFunction","round","Number","isNaN","convertDomRectToObject","domRect","getPointOnElement","referenceElement","point","offset","constrain","Array","isArray","vec1","vec2","isXOverlapping","isYOverlapping","abs","x1","y1","x2","y2","sqrt","pow","getElementOffset","setElementOffset","coords","nodeType","regPercentage","g","test","substring","substr","Vec4","vec3"],"mappings":"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","file":"chunk-1.bundle.js","sourcesContent":["import {EASING} from \"./easing\";\nimport FX from \"./FX\";\nimport {defaultApplyFrame} from \"./frame\";\n\n\nexport default class Animation {\n    static defaultApplyFrame = defaultApplyFrame;\n\n    static complete = FX.complete;\n    static canceled = FX.canceled;\n    static paused = FX.paused;\n    static pending = FX.pending;\n    static error = FX.error;\n    static playing = FX.playing;\n\n    /**\n     *\n     * @param duration\n     * @param frames {{}|function(Element element, Animation animation):{}}\n     * @param applyFrame - The function that takes a frame and applies it to the element.\n     * @param bubbleFrameEvent\n     * @param finishFrame\n     */\n    constructor({duration=null, frames, applyFrame = defaultApplyFrame, bubbleFrameEvent = false, finishFrame = null}) {\n        this.frames = frames;\n        this.applyFrame = applyFrame || Animation.defaultApplyFrame;\n        this.bubbleFrameEvent = bubbleFrameEvent;\n        this.finishFrame = finishFrame;\n        this.duration = duration;\n    }\n\n    /**\n     * Creates an fx object.\n     *\n     * @param element\n     * @param frames\n     * @param duration\n     * @param applyFrame\n     * @param easing\n     * @param onStart\n     * @param onFrame\n     * @param onPause\n     * @param onCancel\n     * @param onEnd\n     * @param onComplete\n     * @param bubbleFrameEvent\n     * @param finishFrame\n     * @returns {FX}\n     */\n    init({element, frames, duration, applyFrame, easing, onStart, onFrame, onPause, onCancel, onEnd, onComplete, bubbleFrameEvent, finishFrame}) {\n        return new FX(element, frames, duration, {\n            applyFrame,\n            easing,\n            animation: this,\n            onStart,\n            onFrame,\n            onPause,\n            onCancel,\n            onEnd,\n            onComplete,\n            bubbleFrameEvent,\n            finishFrame,\n        });\n    }\n\n    /**\n     * Ran after the fx completes.\n     * @param fx\n     */\n    destroy(fx) {\n\n    }\n\n    /**\n     * Animates the given element.  Returns the FX object that can be used to control the animation.\n     *\n     * @param element {HTMLElement|Element} The element to animate.\n     * @param duration {Number} The duration of the animation in milliseconds.\n     * @param easing {function(Number)} An easing function that controls the rate of change for the animation.  If null linear animation is used.\n     * @param onStart {function(FX)} A callback function that is called right before the animation starts playing.\n     * @param onFrame {function(FX, frame)} A callback that is called per frame.\n     * @param onPause {function(FX)} A callback that is called when the FX pauses.\n     * @param onCancel {function(FX)} A callback that is called when the FX cancels.\n     * @param onEnd {function(FX)} A callback that is called when the animation ends.  Whether by completing, pausing, or canceling.  See Fx.status to determine what happened.\n     * @param onComplete {function(FX)} A callback that is called when the animation complete successfully.\n     * @param position\n     * @param autoPlay\n     * @returns {FX}\n     */\n    animate(element, {duration=null, easing = EASING.linear, onStart = null, onFrame = null, onPause = null, onCancel = null, onEnd = null, onComplete = null, position=0, autoPlay=true} = {}) {\n        if(duration === null) {\n            duration = this.duration;\n        }\n\n        let fx = this.init({\n            element: element,\n            frames: this.frames,\n            duration,\n            applyFrame: this.applyFrame,\n            easing,\n            animation: this,\n            onStart,\n            onFrame,\n            onPause,\n            onCancel,\n            onEnd: (fx) => {\n                if(onEnd) onEnd.call(fx, fx);\n                this.destroy(fx);\n            },\n            onComplete,\n            bubbleFrameEvent: this.bubbleFrameEvent,\n            finishFrame: this.finishFrame\n        });\n\n        if(position) {\n            fx.goto(position);\n        }\n\n        if(autoPlay) {\n            fx.play();\n        }\n        return fx;\n    }\n\n    goto(element, position) {\n        this.animate(element, {autoPlay: false, position: position});\n        return Animation.complete;\n    }\n\n    /**\n     * Creates a function that calls the animate method with the bound parameters.\n     * Parameters can be overridden in the created function when called.\n     * Method has the same signature as the animate method.\n     *\n     * Usage:\n     * let animation = new Animation(...),\n     *     fx = animation.bind(null, 2000);\n     *\n     * fx(element) // Animation the element over 2000 milliseconds.\n     *\n     * @param element\n     * @param config\n     * @returns {function(HTMLElement element, Number duration, Object config): FX}\n     */\n    bind(element = null, config = null) {\n        let defaults = {\n            element,\n            config\n        };\n\n        return (element = defaults, config=null) => {\n            element = element === defaults ? element.defaults : element;\n\n            let _options = {};\n            if (defaults.config) Object.assign(_options, defaults.config);\n            if (config) Object.assign(_options, config);\n\n            return this.animate(element, _options);\n        };\n    }\n}\n","import {ExtendableError} from \"../errors\";\nimport {selectElement} from \"../utility\";\nimport {RGBA} from \"../vectors\";\nimport {NumberWithUnit} from \"./types\";\nimport {EASING} from \"./easing\";\nimport {defaultApplyFrame} from \"./frame\";\n\n\nconst regNumberWithUnit = /^(\\d+\\.?\\d*)([a-z]+|%)$/i,\n    regColor = /^(?:#([a-f0-9]{3})|#([a-f0-9]{6})|#([a-f0-9]{8}))$/i,\n    regFunction = /^([a-z_][a-z_0-9]*)\\((.+?)\\)$/i;\n\n\nconst TYPE_FUNCTIONS = {\n    hex: RGBA.parseHexColorStringArg,\n    rgb: RGBA.parseRGBAColorStringArgs,\n    rgba: RGBA.parseRGBAColorStringArgs\n};\n\n\nexport class DeadFXError extends ExtendableError {}\n\n\nfunction assertFXAlive(fx) {\n    if (fx.status === FX.complete || fx.status === FX.error || fx.status === FX.complete) {\n        throw new DeadFXError(\"FX object is dead.\");\n    }\n}\n\n\nfunction doPromiseAction(onAction, value, resolveOrReject) {\n    if (typeof onAction === 'function') {\n        value = onAction(value);\n    }\n\n    resolveOrReject(value);\n}\n\n\nfunction _prepareValue(value) {\n    if (typeof value === 'string') {\n        value = value.trim();\n\n        let m = regNumberWithUnit.exec(value);\n\n        if (m) {\n            return new NumberWithUnit(parseFloat(m[1]), m[2]);\n        }\n\n        m = regColor.exec(value);\n\n        if (m) {\n            return TYPE_FUNCTIONS.hex(m[0]);\n        }\n\n        m = regFunction.exec(value);\n\n        if (m) {\n            return TYPE_FUNCTIONS[m[1]](m[2]);\n        }\n    }\n\n    return value;\n}\n\n\nfunction _getFrames(fx, element, frames) {\n    let r = {};\n\n    if (typeof frames === 'function') {\n        frames = frames.call(fx, element, fx);\n    }\n\n    for (let keyframeIndex in frames) {\n        if (!frames.hasOwnProperty(keyframeIndex)) continue;\n\n        let frame = frames[keyframeIndex];\n        r[keyframeIndex] = {};\n\n        for (let property in frame) {\n            if (!frame.hasOwnProperty(property)) continue;\n            r[keyframeIndex][property] = _prepareValue(frame[property]);\n        }\n    }\n\n    return r;\n}\n\n\n/**\n * @implements Promise\n */\nexport default class FX {\n    static pending = \"Pending\";\n    static complete = \"Complete\";\n    static error = \"Error\";\n    static paused = \"Paused\";\n    static canceled = \"Canceled\";\n    static playing = \"Playing\";\n\n    #element;\n    #chained;\n    #frames;\n    #internalValue;\n\n    #animation;\n\n    #frameId;\n    #status;\n    #position;\n\n    #finishFrame;\n    #applyFrame;\n    #easing;\n    #duration;\n\n    [Symbol.toStringTag] = \"[Object FX]\";\n\n    constructor(element, frames, duration, {applyFrame = defaultApplyFrame, animation = null, easing = EASING.linear, onComplete = null, onCancel = null, onFrame = null, onStart = null, onEnd = null, bubbleFrameEvent = false, finishFrame = null, init = null} = {}) {\n        this.#frames = [];\n        this.#chained = [];\n        this.#element = selectElement(element);\n        this.#internalValue = undefined;\n\n        this.onComplete = onComplete;\n        this.onCancel = onCancel;\n        this.onFrame = onFrame;\n        this.onStart = onStart;\n        this.onEnd = onEnd;\n        this.bubbleFrameEvent = bubbleFrameEvent;\n\n        this.#animation = animation;\n        this.#finishFrame = finishFrame;\n        this.#applyFrame = applyFrame;\n        this.#easing = easing;\n        this.#frameId = null;\n        this.#status = FX.pending;\n\n        this.#duration = duration;\n        this.#position = 0;\n\n        if (init) {\n            init.call(this, this);\n        }\n\n        // Prepare frames\n        frames = _getFrames(this, this.#element, frames);\n\n        for (let key in frames) {\n            if (frames.hasOwnProperty(key)) {\n                let frame = frames[key],\n                    pos = parseFloat(key) / 100;\n\n                if (typeof frame === 'function') {\n                    frame = frame.call(this, this.#element);\n                }\n\n                frame = Object.freeze(Object.assign({}, frame));\n\n                this.#frames.push(Object.freeze({\n                    position: pos,\n                    properties: frame\n                }));\n            }\n        }\n\n        this.#frames.sort((a, b) => a.position - b.pos);\n    }\n\n    get animation() {\n        return this.#animation;\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    get easing() {\n        return this.#easing;\n    }\n\n    get status() {\n        return this.#status;\n    }\n\n    get position() {\n        return this.#position;\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    get duration() {\n        return this.#duration;\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    get frames() {\n        return this.#frames.slice();\n    }\n\n    get element() {\n        return this.#element;\n    }\n\n    // set position(value) {\n    //     if (typeof value === 'string') {\n    //         value = (parseFloat(value) / 100) * this.#duration;\n    //     }\n    //\n    //     this.#position = Math.max(0.0, Math.min(this.#duration, value));\n    // }\n\n    get state() {\n        if (this.status === FX.complete || this.status === FX.canceled) {\n            return \"Fulfilled\";\n        } else if (this.status === FX.error) {\n            return \"Rejected\";\n        } else {\n            return \"Pending\";\n        }\n    }\n\n    /**\n     * Returns the frame options at the given position.\n     * @param position\n     */\n    getFrameFX(position) {\n        // position can either be a percentage string (aka 50%) or the time in milliseconds into the animation\n        // which will be converted into a percentage.\n        if (typeof position === 'string') {\n            position = parseFloat(position) / 100;\n        }\n\n        // At this point position should be a value between 0.0 and 1.0.\n        // Easing functions specify that rate of change in the properties.\n        // It takes the position and maps it to another value between 0.0f and 1.0f.\n        // By default linear easing is used.\n        if (this.#easing) {\n            position = this.#easing(position);\n        }\n\n        let r = {};\n\n        for (let frame of this.#frames) {\n            for (let key in frame.properties) {\n                if (frame.properties.hasOwnProperty(key)) {\n                    let value = frame.properties[key];\n\n                    if (!r[key]) {\n                        r[key] = {startPosition: null, startValue: null, endPosition: null, endValue: null};\n                    }\n\n                    if (frame.position <= position) {\n                        r[key].startPosition = frame.position;\n                        r[key].startValue = value;\n                    } else if (frame.position > position && r[key].endPosition === null) {\n                        r[key].endPosition = frame.position;\n                        r[key].endValue = value;\n                    }\n                }\n            }\n        }\n\n        return r;\n    }\n\n    /**\n     * Returns the final frame at the given position.  All options at this point should be parsed and there final values\n     * should be available.\n     *\n     * @param position\n     */\n    getFrame(position) {\n        let frame = this.getFrameFX(position),\n            r = {};\n\n        if (typeof position === 'string') {\n            position = parseFloat(position) / 100;\n        }\n\n        // Takes the frame config options and calculates the final values.\n        for (let property in frame) {\n            if (frame.hasOwnProperty(property)) {\n                let options = frame[property];\n\n                if ((options.endPosition === null || options.endPosition <= position) && options.startValue !== null) {\n                    r[property] = options.startValue;\n                } else if (options.startValue !== null) {\n                    if (typeof options.startValue === 'object') {\n                        let p = (position - options.startPosition) / (options.endPosition - options.startPosition),\n                            delta = options.endValue.subtract(options.startValue);\n\n                        r[property] = options.startValue.add(delta.scalar(p));\n                    } else if (typeof options.startValue === 'number') {\n                        let duration = (options.endPosition - options.startPosition),\n                            p = (position - options.startPosition) / duration,\n                            delta = options.endValue - options.startValue;\n\n                        r[property] = options.startValue + (delta * p);\n                    } else {\n                        r[property] = options.startValue;\n                    }\n                }\n            }\n        }\n\n        // User provided hook that can perform the final touch ups on the frame.\n        if (this.#finishFrame) {\n            r = this.#finishFrame(this, frame);\n        }\n\n        return r;\n    }\n\n    play() {\n        assertFXAlive(this);\n\n        if (this.#frameId === null) {\n            this.goto(this.#position);\n\n            let tick = performance.now();\n\n            let frameFN = () => {\n                let timestamp = performance.now(),\n                    delta = timestamp - tick,\n                    position = this.#position + (delta / this.duration);\n\n                tick = timestamp;\n                let frame = this.goto(position);\n                this.#status = FX.playing;\n\n                if (this.onFrame) this.onFrame.call(this, this, frame);\n\n                this.#element.dispatchEvent(new CustomEvent('animation.frame', {\n                    bubbles: this.bubbleFrameEvent,\n                    detail: this\n                }));\n\n                if (this.#position < 1) {\n                    this.#frameId = window.requestAnimationFrame(frameFN);\n                } else {\n                    this._complete(FX.complete, FX.complete);\n                    this.#frameId = null;\n                }\n            };\n\n            if (this.onStart) {\n                this.onStart.call(this, this);\n            }\n\n            this.#element.dispatchEvent(new CustomEvent('animation.start', {\n                bubbles: true,\n                detail: this\n            }));\n\n            this.#frameId = window.requestAnimationFrame(frameFN);\n        }\n\n        return this;\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    /**\n     * Pauses the animation.  Does not resolve it.\n     * @returns {FX}\n     */\n    pause() {\n        if (this.#frameId) {\n            window.cancelAnimationFrame(this.#frameId);\n            this.#frameId = null;\n            this.#status = FX.paused;\n\n            this.#element.dispatchEvent(new CustomEvent('animation.paused', {\n                bubbles: true,\n                detail: this\n            }));\n        }\n\n        return this;\n    }\n\n    _cancel(complete = false, status = FX.canceled) {\n        if (this.#frameId) {\n            window.cancelAnimationFrame(this.#frameId);\n            this.#frameId = null;\n\n            if (complete) {\n                this.goto(1);\n                this._complete(status, status);\n            } else {\n                this.#status = status;\n                this.#internalValue = status;\n            }\n\n            if (this.onCancel) this.onCancel.call(this, this);\n\n            this.#element.dispatchEvent(new CustomEvent('animation.canceled', {\n                bubbles: true,\n                detail: this\n            }));\n\n            this._triggerEndEvent();\n        }\n\n        return this;\n    }\n\n    /**\n     * Cancel the animation with the canceled state.   optionally sets the animation to it's final frame if\n     * completeAnimation is true.\n     *\n     * @param completeAnimation\n     * @returns {FX}\n     */\n    cancel(completeAnimation = false) {\n        return this._cancel(completeAnimation, FX.canceled);\n    }\n\n    /**\n     * Completes the animation immediately and sets is status to complete.\n     * @returns {FX}\n     */\n    complete() {\n        return this._cancel(true, FX.complete);\n    }\n\n    goto(position) {\n        assertFXAlive(this);\n\n        if (typeof position === 'string') {\n            position = parseFloat(position) / 100;\n        }\n\n        this.#position = position;\n        return this.applyFrame(this.position);\n    }\n\n    applyFrame(position) {\n        let frame = this.getFrame(position);\n        this.#applyFrame.call(this, this, frame);\n        return frame;\n    }\n\n    _triggerEndEvent() {\n        if (this.onEnd) this.onEnd.call(this, this);\n\n        this.#element.dispatchEvent(new CustomEvent('animation.end', {\n            bubbles: true,\n            detail: this\n        }));\n\n        for (let {onResolve} of this.#chained) {\n            if (onResolve) onResolve(this.#internalValue);\n        }\n        this.#chained = [];\n    }\n\n    _complete(value, status = FX.complete) {\n        if (this.state !== \"Pending\") {\n            return;\n        }\n\n        this.#status = status;\n        this.#internalValue = value;\n\n        if (this.onComplete) this.onComplete.call(this, this);\n\n        this.#element.dispatchEvent(new CustomEvent('animation.complete', {\n            bubbles: true,\n            detail: this\n        }));\n\n        this._triggerEndEvent();\n    }\n\n    then(onResolve, onReject) {\n        if (this.state === \"Pending\") {\n            return new Promise((resolve, reject) => {\n                // noinspection JSUnusedGlobalSymbols\n                this.#chained.push({\n                    onResolve: (value) => {\n                        doPromiseAction(onResolve, value, resolve);\n                    },\n\n                    onReject: (value) => {\n                        doPromiseAction(onReject, value, reject);\n                    }\n                });\n            });\n        } else if (this.state === 'Fulfilled' && typeof onResolve === 'function') {\n            return new Promise((resolve) => {\n                doPromiseAction(onResolve, this.#internalValue, resolve);\n            });\n        } else if (this.state === 'Rejected' && typeof onReject === 'function') {\n            return new Promise((resolve, reject) => {\n                doPromiseAction(onReject, this.#internalValue, reject);\n            });\n        }\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    finally(onFinally) {\n        onFinally = (value) => {\n            if (typeof onFinally === 'function') {\n                onFinally();\n            }\n\n            return value;\n        };\n\n        return this.then(onFinally, onFinally);\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    catch(onReject) {\n        return this.then(undefined, onReject);\n    }\n}\n","/**\n *\n * @param p\n * @returns {*}\n */\nexport function linear(p) {\n    return p;\n}\n\n\n// noinspection JSUnusedGlobalSymbols\nexport const EASING = {\n    linear: linear\n};\n","export function defaultApplyFrame(fx, frame) {\n    for (let key in frame) {\n        if (frame.hasOwnProperty(key)) {\n            fx.element.style[key] = frame[key].toString();\n        }\n    }\n}\n","export class NumberWithUnit {\n    constructor(value, unit) {\n        this.value = value;\n        this.unit = unit;\n    }\n\n    add(value) {\n        if (typeof value !== \"number\") {\n            if (!(value instanceof NumberWithUnit)) {\n                throw new TypeError(\"Cannot perform action on invalid type.\");\n            }\n\n            if (this.unit !== value.unit) {\n                throw new Error(\"Mismatched units\");\n            }\n\n            value = value.value;\n        }\n\n\n        return new NumberWithUnit(this.value + value, this.unit);\n    }\n\n    subtract(value) {\n        if (typeof value !== \"number\") {\n            if (!(value instanceof NumberWithUnit)) {\n                throw new TypeError(\"Cannot perform action on invalid type.\");\n            }\n\n            if (this.unit !== value.unit) {\n                throw new Error(\"Mismatched units\");\n            }\n\n            value = value.value;\n        }\n\n        return new NumberWithUnit(this.value - value, this.unit);\n    }\n\n    scalar(value) {\n        if (typeof value !== \"number\") {\n            if (!(value instanceof NumberWithUnit)) {\n                throw new TypeError(\"Cannot perform action on invalid type.\");\n            }\n\n            if (this.unit !== value.unit) {\n                throw new Error(\"Mismatched units\");\n            }\n\n            value = value.value;\n        }\n\n        return new NumberWithUnit(this.value * value, this.unit);\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    divide(value) {\n        if (typeof value !== \"number\") {\n            if (!(value instanceof NumberWithUnit)) {\n                throw new TypeError(\"Cannot perform action on invalid type.\");\n            }\n\n            if (this.unit !== value.unit) {\n                throw new Error(\"Mismatched units\");\n            }\n\n            value = value.value;\n        }\n\n        return new NumberWithUnit(this.value / value, this.unit);\n    }\n\n    toString() {\n        return `${this.value}${this.unit}`;\n    }\n}\n","import Rect from \"../vectors/Rect\";\nimport {getDistanceBetweenRects, getSubBoundingBox, setElementClientPosition} from \"core/ui/position\";\nimport Component from \"../Component\";\nimport Animation from \"../fx/Animation\";\n\n\nexport const symbolShow = Symbol(\"show\"),\n    symbolHide = Symbol(\"hide\");\n\n\nfunction getXIntersectAmount(rect1, rect2) {\n    let left = Math.max(rect1.left, rect2.left),\n        right = Math.min(rect1.right, rect2.right);\n\n    return left > right ? 0 : right - left;\n}\n\n\nfunction getYIntersectAmount(rect1, rect2) {\n    let top = Math.max(rect1.top, rect2.top),\n        bottom = Math.min(rect1.bottom, rect2.bottom);\n\n    return top > bottom ? 0 : bottom - top;\n}\n\n\nconst DEFAULT_PLACEMENTS = {\n    top: {\n        my: \"bottom\",\n        at: \"top\",\n        of: \"border-top\",\n        arrow: \"bottom\"\n    },\n\n    bottom: {\n        my: \"top\",\n        at: \"bottom\",\n        of: \"border-bottom\",\n        arrow: \"top\"\n    },\n\n    right: {\n        my: \"left\",\n        at: \"right\",\n        of: \"border-right\",\n        arrow: \"left\"\n    },\n\n    left: {\n        my: \"right\",\n        at: \"left\",\n        of: \"border-left\",\n        arrow: \"right\"\n    }\n};\n\n\nexport default class Overlay extends Component {\n    static hiding = \"Hiding\";\n    static showing = \"Showing\";\n    static hidden = \"Hidden\";\n    static visible = \"Visible\";\n\n    #currentIndex;\n    #placements;\n    #container;\n    #target;\n    #arrow;\n    #state;\n\n    #showFX;\n    #showDuration;\n    #hideFX;\n    #hideDuration;\n    #fx;\n\n    #visibleClassName;\n    #hiddenClassName;\n\n    #timer;\n\n    constructor(element, {target=null, container=null, sticky=true, fit=null, showFX=null, showDuration=null, hideFX=null, hideDuration=null, timeout=null, removeOnHide=false, visibleClassName=null, hiddenClassName=\"hidden\"}={}) {\n        super(element);\n\n        if(typeof target === 'string') {\n            target = document.querySelector(target);\n        }\n\n        if(typeof container === 'string') {\n            container = document.querySelector(container);\n        }\n\n        this.sticky = sticky;\n        this.fit = fit;\n        this.timeout = timeout;\n        this.removeOnHide = removeOnHide;\n\n        this.#currentIndex = 0; // The index of the current placement.\n        this.#placements = [];\n        this.#arrow = container;\n        this.#timer = null;\n\n        this.#visibleClassName = visibleClassName;\n        this.#hiddenClassName = hiddenClassName;\n\n        this.#state = undefined;\n\n        if(typeof showFX === 'function') {\n            showFX = new showFX();\n        }\n        if(typeof hideFX === 'function') {\n            hideFX = new hideFX();\n        }\n\n        this.#fx = null;\n        this.#showFX = showFX;\n        this.#showDuration = showDuration;\n        this.#hideFX = hideFX;\n        this.#hideDuration= hideDuration;\n\n        this.target = target;\n        this.container = container;\n    }\n\n    // noinspection JSUnusedLocalSymbols\n    [symbolHide](element) {\n        if(this.#hiddenClassName) {\n            this.addClass(this.#hiddenClassName);\n        }\n\n        if(this.#visibleClassName) {\n            this.removeClass(this.#visibleClassName);\n        }\n    }\n\n    // noinspection JSUnusedLocalSymbols\n    [symbolShow](element) {\n        if(this.#hiddenClassName) {\n            this.removeClass(this.#hiddenClassName);\n        }\n\n        if(this.#visibleClassName) {\n            this.addClass(this.#visibleClassName);\n        }\n    }\n\n    setArrow(arrow) {\n        if(this.#arrow) {\n            this.#arrow.removeFrom();\n            this.#arrow = null;\n        }\n\n        this.#arrow = arrow;\n        this.#arrow.appendTo(this.element);\n    }\n\n    addPlacement(name, options=undefined) {\n        if(!options) {\n            options = DEFAULT_PLACEMENTS[name];\n        }\n\n        let placement = {name};\n\n        for(let key of ['my', 'at', 'of', 'arrow', 'offset', 'collision', 'method']) {\n            if(options[key] !== undefined) {\n                placement[key] = options[key];\n            }\n        }\n\n        placement.method = placement.method || 'top-left';\n\n        this.#placements.push(Object.freeze(placement));\n    }\n\n    setPlacement(name, options=undefined) {\n        if(!options) {\n            options = DEFAULT_PLACEMENTS[name];\n        }\n\n        this.#placements = [];\n        this.addPlacement(name, options);\n    }\n\n    position(mode=\"current\") {\n        if(!this.#placements.length) {\n            return;\n        }\n\n        let targetRect,\n            containerRect,\n            startingIndex = 0,\n            currentPos = null,\n            currentIntersectAmount = 0,\n            currentPlacement;\n\n        if(typeof this.target === 'function') {\n            targetRect = new Rect(this.target());\n        } else if(this.target) {\n            targetRect = Rect.getBoundingClientRect(this.target);\n        } else {\n            targetRect = Rect.getRootContainingClientRect();\n        }\n\n        if(typeof this.container === 'function') {\n            containerRect = this.container();\n        } else if(this.container) {\n            containerRect = Rect.getBoundingClientRect(this.container);\n        } else {\n            containerRect = null;\n        }\n\n        // If sticky start searching from the last position instead of starting from the begining.\n        if(this.sticky) {\n            startingIndex = this.#currentIndex;\n        }\n\n        // Find the best position.\n        for(let i = 0; i < this.#placements.length; i++) {\n            let index = (startingIndex + i) % this.#placements.length,\n                position = this.getPlacement(index),\n                clampSpace = targetRect,\n                pos,\n                newIntersectAmount,\n                subBoundingBox = position.of ? getSubBoundingBox(targetRect, position.of) : targetRect,\n                arrowOffset = new Rect(0, 0, 0, 0),\n                arrowRect;\n\n            this.element.dataset.placement = position.name;\n\n            if(mode === \"current\") {\n                pos = Rect.getBoundingClientRect(this.element);\n            } else {\n                pos = Rect.getCleanBoundingClientRect(this.element);\n            }\n\n            if(this.#arrow && position.arrow) {\n                this.#arrow.setPlacement(position.arrow);\n                arrowRect = this.#arrow.getBoundingClientRect();\n                let unionBox = pos.union(arrowRect);\n                arrowOffset = pos.subtract(unionBox);\n                pos = unionBox;\n            }\n\n            clampSpace = targetRect.add(new Rect(\n                -pos.width,\n                -pos.height,\n                0,\n                0\n            ));\n\n            if(arrowRect) {\n                if(this.#arrow.placement === \"top\" || this.#arrow.placement === \"bottom\") {\n                    clampSpace = clampSpace.add(new Rect(\n                        arrowRect.width,\n                        0,\n                        -arrowRect.width,\n                        0\n                    ));\n                } else {\n                    clampSpace = clampSpace.add(new Rect(\n                        0,\n                        arrowRect.height,\n                        0,\n                        -arrowRect.height\n                    ));\n                }\n            }\n\n            pos = pos.position({\n                my: position.my,\n                at: position.at,\n                of: targetRect\n            });\n\n            if(containerRect) {\n                pos = pos.fit(containerRect);\n            }\n\n            if(position.of) {\n                clampSpace = getSubBoundingBox(clampSpace, position.of);\n            }\n\n            pos = pos.clamp(clampSpace);\n\n            newIntersectAmount = getXIntersectAmount(subBoundingBox, containerRect) + getYIntersectAmount(subBoundingBox, containerRect);\n\n            // noinspection JSCheckFunctionSignatures\n            if(!currentPos || (containerRect && containerRect.contains(pos)) || (newIntersectAmount > currentIntersectAmount && getDistanceBetweenRects(pos, containerRect) <= getDistanceBetweenRects(currentPos, containerRect))) {\n                if(containerRect) {\n                    if(this.fit === true || this.fit === \"xy\") {\n                        pos = pos.fit(containerRect);\n                    } else if(this.fit === \"y\") {\n                        pos = pos.fitY(containerRect);\n                    } else if(this.fit === \"x\") {\n                        pos = pos.fitX(containerRect);\n                    }\n                }\n\n                currentPos = pos.add(arrowOffset);\n                currentIntersectAmount = newIntersectAmount;\n                currentPlacement = position;\n\n                this.#currentIndex = index;\n\n                if(!containerRect || containerRect.contains(pos)) {\n                    break;\n                }\n            }\n        }\n\n        // Apply the best position.\n        this.element.dataset.placement = currentPlacement.name;\n\n        setElementClientPosition(this.element, currentPos, currentPlacement.method || \"top-left\");\n\n        if(this.#arrow) {\n            this.#arrow.setPlacement(currentPlacement.arrow);\n        }\n\n        // Publish topics.\n        this.publish(\"overlay.render\", {\n            target: this,\n            name: 'overlay.render',\n            position: currentPos,\n            placement: currentPlacement,\n            index: this.#currentIndex\n        });\n\n        return currentPos;\n    }\n\n    getPlacement(index) {\n        return this.#placements[index];\n    }\n\n    async show(immediate=false) {\n        this.clearTimeOut();\n\n        this.publish(\"overlay.show\", this);\n\n        if(!this.element.parentElement) {\n            document.body.appendChild(this.element);\n        }\n\n        let result;\n\n        if(immediate) {\n            if(this.#fx) {\n                await this.#fx.cancel();\n            }\n\n            this[symbolShow](this.element);\n\n            if(this.#showFX) {\n                this.#showFX.goto(this.element, 1);\n            }\n\n            this.position(\"current\");\n\n            result = Animation.complete;\n            this.#state = Overlay.visible;\n            this.publish(\"overlay.visible\", this);\n        } else if(this.state !== Overlay.visible) {\n            if(this.#fx) {\n                await this.#fx.cancel();\n            }\n\n            let startingState = this.state;\n\n            this[symbolShow](this.element);\n            this.position(\"current\");\n\n            if(startingState === Overlay.hidden && this.#hideFX) {\n                await this.#hideFX.goto(this.element, 1);\n            }\n\n            this.position(\"current\");\n\n            this.#state = Overlay.showing;\n            this.publish(\"overlay.showing\", this);\n\n            let onFrame = () => {\n                this.position(\"current\");\n            };\n\n            if(this.#showFX) {\n                this.#fx = this.#showFX.animate(this.element, {duration: this.#showDuration, onFrame});\n            }\n\n            this.position(\"current\");\n\n            if(this.#fx) {\n                result = await this.#fx;\n                this.#fx = null;\n            } else {\n                result = Animation.complete;\n            }\n\n            if(result === Animation.complete) {\n                this.#state = Overlay.visible;\n                this.publish(\"overlay.visible\", this);\n            }\n        } else {\n            result = Animation.complete;\n        }\n\n        if(result === Animation.complete) {\n            if (this.#timer) {\n                clearTimeout(this.#timer);\n                this.#timer = null;\n            }\n\n            if (typeof this.timeout === 'number' && this.timeout >= 0) {\n                this.startTimeoutTimer(this.timeout);\n            }\n        }\n\n        return result;\n    }\n\n    async hide(immediate=false) {\n        this.clearTimeOut();\n\n        this.publish(\"overlay.hide\", this);\n\n        if(immediate) {\n            if(this.#fx) {\n                await this.#fx.cancel();\n            }\n\n            if(this.#hideFX) {\n                this.#hideFX.goto(this.element, 1);\n            }\n\n            this[symbolHide](this.element);\n            this.#state = Overlay.hidden;\n            this.publish(\"overlay.hidden\", this);\n\n            if(this.removeOnHide) {\n                this.removeFrom();\n            }\n\n            return Animation.complete;\n        } if(this.state !== Overlay.hidden) {\n            if(this.#fx) {\n                await this.#fx.cancel();\n            }\n\n            let result;\n\n            let onFrame = () => {\n                this.position(\"current\");\n            };\n\n            if(this.#hideFX) {\n                this.#fx = this.#hideFX.animate(this.element, {duration: this.#hideDuration, onFrame});\n            }\n\n            this.#state = Overlay.hiding;\n            this.publish(\"overlay.hiding\", this);\n\n            if(this.#fx) {\n                result = await this.#fx;\n            } else {\n                result = Animation.complete;\n            }\n\n            if(result === Animation.complete) {\n                this[symbolHide](this.element);\n                this.#state = Overlay.hidden;\n\n                if(this.removeOnHide) {\n                    this.removeFrom();\n                }\n\n                this.publish(\"overlay.hidden\", this);\n            }\n\n            return result;\n        } else {\n            return Animation.complete;\n        }\n    }\n\n    startTimeoutTimer(timeout=null) {\n        if(timeout === null) {\n            timeout = this.timeout;\n        }\n\n        if(typeof timeout !== \"number\" || timeout < 0) {\n            throw new TypeError(\"Timeout must be a positive integer.\");\n        }\n\n        this.clearTimeOut();\n\n        this.#timer = setTimeout(() => {\n            this.hide();\n            this.publish(\"overlay.timeout\", this);\n        }, this.timeout);\n    }\n\n    clearTimeOut() {\n        if(this.isTimingOut()) {\n            clearTimeout(this.#timer);\n            this.#timer = null;\n            return true;\n        }\n\n        return false;\n    }\n\n    isTimingOut() {\n        return !!this.#timer;\n    }\n\n    async clearFX() {\n        if(this.#fx) {\n            await this.#fx.cancel();\n        }\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    get placements() {\n        return this.#placements.slice(0);\n    }\n\n    get target() {\n        return this.#target;\n    }\n\n    get container() {\n        return this.#container;\n    }\n\n    set target(target) {\n        if(typeof value === 'string') {\n            this.#target = document.querySelector(target);\n        } else {\n            this.#target = target || null;\n        }\n    }\n\n    set container(container) {\n        if(typeof container === 'string') {\n            this.#container = document.querySelector(container);\n        } else {\n            this.#container = container || null;\n        }\n    }\n\n    get fx() {\n        return this.#fx;\n    }\n\n    get state() {\n        return this.#state;\n    }\n}\n","import {Rect, Vec2, Vec3} from \"../vectors\";\nimport {clamp} from \"../utility\";\n\n\nconst regMatrix = /matrix(3d)?\\(([^)]+)\\)/;\n\n\n/**\n * Returns the elements offset parent.\n *\n * @param element\n * @returns {HTMLElement}\n */\nexport function getOffsetElement(element) {\n    let o = element.parentElement;\n\n    while(o) {\n        let position = getComputedStyle(o).position;\n        if(position !== 'static') return o;\n        o = o.parentElement;\n    }\n}\n\n\n/**\n * Returns the rectangle of the client area.\n *\n * @returns {Rect}\n */\nexport function getClientRect() {\n    return Rect.getClientRect();\n}\n\n\n/**\n * Returns a bounding rect who's positions are relative to the provided offsetParent.\n * If offsetParent is null then the targets natural offsetParent is used as returned by the getOffsetElement function.\n * @param element\n * @param offsetParent\n * @returns {{top: number, left: number, bottom: number, width: number, right: number, height: number}}\n */\nexport function getBoundingOffsetRect(element, offsetParent=null) {\n    let offsetRect, rect;\n\n    if(!offsetParent) offsetParent = getOffsetElement(element);\n\n    // no offset parent.  Position relative to the client.\n    if(!offsetParent) {\n        offsetRect = Rect.getRootContainingClientRect();\n    } else {\n        offsetRect = Rect.getBoundingClientRect(offsetParent);\n    }\n\n    rect = element.getBoundingClientRect();\n\n    return new Rect(\n        rect.left - offsetRect.left,\n        rect.top - offsetRect.top,\n        offsetRect.right - rect.right,\n        offsetRect.bottom - rect.bottom\n    );\n}\n\n\n/**\n * Returns a bounding rect who's positions are relative to the document.\n * @param element\n * @returns {{top: number, left: number, bottom: number, width: number, x: number, y: number, right: number, height: number}}\n */\nexport function getBoundingDocumentRect(element) {\n    let rect = element.getBoundingClientRect();\n\n    return new Rect(\n        rect.left + window.pageXOffset,\n        rect.top + window.pageYOffset,\n        rect.right + window.pageXOffset,\n        rect.bottom + window.pageYOffset\n    );\n}\n\n\n/**\n * Returns the css translation from the transformation matrix applied to the element.\n *\n * @param element\n * @returns {Vec3}\n */\nexport function getTranslation(element) {\n    let transform = getComputedStyle(element).transform,\n        m = regMatrix.exec(transform);\n\n    if(!m) {\n        return new Vec3(\n            0,\n            0,\n            0\n        );\n    }\n\n    let data = m[2].split(/\\s*,\\s*/);\n\n    if(m[1]) {\n        return new Vec3(\n            parseFloat(data[12]),\n            parseFloat(data[13]),\n            parseFloat(data[14])\n        );\n    } else {\n        return new Vec3(\n            parseFloat(data[4]),\n            parseFloat(data[5]),\n            0\n        );\n    }\n}\n\n\n/**\n * Sets the element's transformation matrix to 2d translate with the specified left and top properties.\n *\n * @param element\n * @param x\n * @param y\n * @param z\n */\nexport function setTranslation(element, {x, y, z=null}) {\n    if(z !== null) {\n        element.style.transform = `translate3d(${x}px, ${y}px, ${z}px)`;\n    } else {\n        element.style.transform = `translate(${x}px, ${y}px)`;\n    }\n}\n\n\n/**\n * Gets the elements left and top style properties as numbers.\n *\n * @param element\n * @returns {Vec2}\n */\nexport function getCssPosition(element) {\n    let style = getComputedStyle(element);\n\n    return new Vec2(\n        parseInt(style.left, 10),\n        parseInt(style.top, 10)\n    );\n}\n\n\n/**\n * Sets the left and top style properties of an element.  If the element is positioned statically it will be changed to\n * relative.\n *\n * @param element\n * @param left\n * @param top\n */\nexport function setCssPosition(element, {left=null, top=null}) {\n    let style = getComputedStyle(element);\n\n    if(style.position === 'static') {\n        style.position = 'relative';\n    }\n\n    if(left !== null && left !== undefined) {\n        element.style.left = `${left}px`;\n    }\n\n    if(top !== null && top !== undefined) {\n        element.style.top = `${top}px`;\n    }\n}\n\n\n/**\n * Sets the elements position relative to the client window.  The `method` parameter controls how the elements position\n * is modified.  The options are 'top-left', 'top-right', 'bottom-left', 'bottom-right', 'translate', and 'translate3d'.\n *\n * top-left, top-right, bottom-left and bottom-right set the css left, top, right, and bottom properties of the element.\n * translate and translate3d position the element by setting the transform property.\n *\n * @param element {HTMLElement}\n * @param position {{x, y}|{left, top, right, bottom}|Array|Vec2}\n * @param method {'top-left'|'top-right'|'bottom-left'|'bottom-right'|'translate'|'translate3d'}\n */\nexport function setElementClientPosition(element, position, method='top-left') {\n    position = new Rect(position);\n\n    if(method === 'top-left' || method === 'top-right' || method === 'bottom-left' || method === 'bottom-right') {\n        let style = getComputedStyle(element);\n\n        let positionType = style.position, box, deltaX, deltaY, current;\n\n        // position can't be static for this operation.  Switch to relative.\n        if(positionType === 'static') {\n            element.style.position = 'relative';\n            positionType = \"relative\";\n        }\n\n        style = getComputedStyle(element);\n        box = Rect.getBoundingClientRect(element);\n\n        current = {\n            left: parseInt(style.left, 10) || 0,\n            right: parseInt(style.right, 10) || 0,\n            top: parseInt(style.top, 10) || 0,\n            bottom: parseInt(style.bottom, 10) || 0\n        };\n\n        if(method === 'top-left') {\n            deltaX = position.left - box.left;\n            deltaY = position.top - box.top;\n\n            element.style.left = (current.left + deltaX) + 'px';\n            element.style.top = (current.top + deltaY) + 'px';\n            element.style.right = '';\n            element.style.bottom = '';\n        } else if(method === 'top-right') {\n            deltaX = position.right - box.right;\n            deltaY = position.top - box.top;\n\n            element.style.right = (current.right - deltaX) + 'px';\n            element.style.top = (current.top + deltaY) + 'px';\n            element.style.left = '';\n            element.style.bottom = '';\n        } else if(method === 'bottom-left') {\n            deltaX = position.left - box.left;\n            deltaY = position.bottom - box.bottom;\n\n            console.log({\n                right: (current.left + deltaX) + 'px',\n                bottom: (current.bottom - deltaY) + 'px'\n            });\n\n            element.style.left = (current.left + deltaX) + 'px';\n            element.style.bottom = (current.bottom - deltaY) + 'px';\n            element.style.right = '';\n            element.style.top = '';\n        } else { // bottom-right\n            deltaX = position.right - box.right;\n            deltaY = position.bottom - box.bottom;\n\n            element.style.right = (current.right - deltaX) + 'px';\n            element.style.bottom = (current.bottom - deltaY) + 'px';\n            element.style.left = '';\n            element.style.top = '';\n        }\n    } else if(method === 'translate') {\n        let box = Rect.getBoundingClientRect(element),\n            deltaX = position.left - box.left,\n            deltaY = position.top - box.top,\n            cssPosition = getTranslation(element);\n\n        setTranslation(element, {\n            x: cssPosition.x + deltaX,\n            y: cssPosition.y + deltaY\n        });\n    } else if(method === 'translate3d') {\n        let box = Rect.getBoundingClientRect(element),\n            deltaX = position.left - box.left,\n            deltaY = position.top - box.top,\n            cssPosition = getTranslation(element);\n\n        setTranslation(element, {\n            x: cssPosition.x + deltaX,\n            y: cssPosition.y + deltaY,\n            z: cssPosition.z\n        });\n    }\n}\n\n\n/**\n * Transforms the coordinates of a BoundingClientRect like object from client space to document space.\n * @param rect\n */\nexport function clientRectToDocumentSpace(rect) {\n    let r = Rect.fromRect(rect);\n\n    r.left += window.pageXOffset;\n    r.right += window.pageXOffset;\n    if(typeof r.top === 'number') r.top += window.pageYOffset;\n    if(typeof r.bottom === 'number') r.bottom += window.pageYOffset;\n\n    return r;\n}\n\n\n/**\n * Transforms the coordinates of a BoundingClientRect like object from document space to client space.\n * @param rect\n */\nexport function documentRectToClientSpace(rect) {\n    let r = Rect.fromRect(rect);\n\n    r.left -= window.pageXOffset;\n    r.right -= window.pageXOffset;\n    if(typeof r.top === 'number') r.top -= window.pageYOffset;\n    if(typeof r.bottom === 'number') r.bottom -= window.pageYOffset;\n\n    return r;\n}\n\n\n/**\n * Snaps the value to the specified grid using the provided rounding function.\n * @param value\n * @param gridSize\n * @param roundingFunction\n * @returns {number|*}\n */\nexport function snapToGrid(value, gridSize, roundingFunction=Math.round) {\n    if(gridSize !== null && gridSize !== undefined && !Number.isNaN(gridSize)) {\n        return roundingFunction(value / gridSize) * gridSize;\n    }\n\n    return value;\n}\n\n\n/**\n * Deprecated in favor of calling Rect.fromRect() class method.\n *\n * @deprecated\n * @param domRect\n * @returns {Rect}\n */\nexport function convertDomRectToObject(domRect) {\n    return Rect.fromRect(domRect);\n}\n\n\n/**\n * Returns the {x, y} point calculated relative to the reference element.\n *\n * @param referenceElement\n * @param point\n * @param offset\n * @param constrain\n * @returns {Vec2}\n */\nexport function getPointOnElement(referenceElement, point, offset=null, constrain=null) {\n    let rect = referenceElement;\n\n    if(rect.getBoundingClientRect) {\n        rect = rect.getBoundingClientRect();\n    }\n\n    if(constrain) {\n        if (typeof constrain === 'string') {\n            constrain = document.querySelector(constrain);\n        }\n\n        if (constrain.getBoundingClientRect) {\n            constrain = Rect.fromRect(constrain.getBoundingClientRect());\n        }\n    }\n\n    // Convert array to {x, y} object.\n    if(Array.isArray(point)) {\n        point = {\n            x: point[0],\n            y: point[1]\n        };\n    } else if(typeof point === 'string') {\n        if(point === 'top-left') {\n            point = {x: 0, y: 0};\n        } else if(point === 'top') {\n            point = {x: '50%', y: 0};\n        } else if(point === 'top-right') {\n            point = {x: '100%', y: 0};\n        } else if(point === 'right') {\n            point = {x: '100%', y: '50%'};\n        } else if(point === 'bottom-right') {\n            point = {x: '100%', y: '100%'};\n        } else if(point === 'bottom') {\n            point = {x: '50%', y: '100%'};\n        } else if(point === 'bottom-left') {\n            point = {x: 0, y: '100%'};\n        } else if(point === 'left') {\n            point = {x: 0, y: '50%'};\n        } else if(point === 'middle') {\n            point = {x: '50%', y: '50%'};\n        } else {\n            throw new Error(`Unknown point option ${point}`);\n        }\n    }\n\n    if(typeof point.x === 'string') {\n        point.x = (rect.right - rect.left) * (parseFloat(point.x) / 100);\n    }\n\n    if(typeof point.y === 'string') {\n        point.y = (rect.bottom - rect.top) * (parseFloat(point.y) / 100);\n    }\n\n    if(constrain) {\n        if(typeof constrain.left === 'string') {\n            constrain.left = (rect.right - rect.left) * (parseFloat(constrain.left) / 100);\n        }\n\n        if(typeof constrain.right === 'string') {\n            constrain.right = (rect.right - rect.left) * (parseFloat(constrain.right) / 100);\n        }\n\n        if(typeof constrain.top === 'string') {\n            constrain.top = (rect.bottom - rect.top) * (parseFloat(constrain.top) / 100);\n        }\n\n        if(typeof constrain.bottom === 'string') {\n            constrain.bottom = (rect.bottom - rect.top) * (parseFloat(constrain.bottom) / 100);\n        }\n\n        point.x = clamp(point.x, constrain.left, constrain.right);\n        point.y = clamp(point.y, constrain.top, constrain.bottom);\n    }\n\n    if(offset) {\n        if(Array.isArray(offset)) {\n            offset = {\n                x: offset[0],\n                y: offset[1]\n            };\n        }\n\n        if(offset.x !== null) {\n            point.x += offset.x;\n        }\n\n        if(offset.y !== null) {\n            point.y += offset.y;\n        }\n    }\n\n    return new Vec2(rect.left + point.x, rect.top + point.y);\n}\n\n\n/**\n * Gets the bounding client rect for a rectangle defined by the position rectangle with left, top, right and bottom\n * properties relative to the element's position.\n *\n * @param element {{getBoundingClientRect}|Element|String|{left, top, right, bottom}}\n * @param position {{left, top, bottom, right}}\n * @return {Rect}\n */\nexport function getSubBoundingBox(element, position) {\n    let rect;\n\n    // Get the bounding client rect of the element.   The user should have passed either a css selector, an object with a\n    // getBoundingClientRect interface.  Or a bounding client rect directly.\n    if(element.getBoundingClientRect) {\n        rect = element.getBoundingClientRect();\n    } else if(typeof element === 'string') {\n        rect = document.querySelector(element).getBoundingClientRect();\n    } else {\n        rect = element;\n    }\n\n    let width = rect.right - rect.left,\n        height = rect.bottom - rect.top;\n\n    // The user can pass a rect with left, top, right and bottom properties.  The value can either be the desired\n    // coordinates relative to the top-left corner of the reference element or a percentage.  Another possibility\n    // is that the user passes one of the keyword properties that coorispond to a specific section of the element.\n    // Map those keywords to their rectangle.\n    if(typeof position === 'string') {\n        if(position === 'border-top') {\n            position = {left: 0, right: '100%', top: 0, bottom: 0};\n        } else if(position === 'border-right') {\n            position = {left: '100%', right: '100%', top: 0, bottom: '100%'};\n        } else if(position === 'border-bottom') {\n            position = {left: 0, right: '100%', top: '100%', bottom: '100%'};\n        } else if(position === 'border-left') {\n            position = {left: 0, top: 0, right: 0, bottom: '100%'};\n        } else if(position === 'top-left') {\n            position = {left: 0, top: 0, right: 0, bottom: 0};\n        } else if(position === 'top') {\n            position = {top: 0, left: '50%', right: '50%', bottom: 0};\n        } else if(position === 'top-right') {\n            position = {top: 0, left: '100%', right: '100%', bottom: 0};\n        } else if(position === 'left') {\n            position = {left: 0, top: '50%', bottom: '50%', right: 0};\n        } else if(position === 'origin') {\n            position = {left: '50%', right: '50%', top: '50%', bottom: '50%'};\n        } else if(position === 'bottom-left') {\n            position = {left: 0, right: 0, top: '100%', bottom: '100%'};\n        } else if(position === 'bottom') {\n            position = {left: '50%', right: '50%', top: '100%', bottom: '100%'};\n        } else if(position === 'bottom-right') {\n            position = {left: '100%', right: '100%', top: '100%', bottom: '100%'};\n        } else if(position === 'right') {\n            position = {left: '100%', right: '100%', top: '50%', bottom: '50%'};\n        }\n    }\n\n    position.left = position.left || 0;\n    position.right = position.right || 0;\n    position.top = position.top || 0;\n    position.bottom = position.bottom || 0;\n\n    // left and right percentages are a percentage of the elements width.\n    // top and bottom percentages are a percentage of the elements height.\n    if(typeof position.left === 'string') {\n        position.left = (parseFloat(position.left) / 100) * width;\n    }\n\n    if(typeof position.right === 'string') {\n        position.right = (parseFloat(position.right) / 100) * width;\n    }\n\n    if(typeof position.bottom === 'string') {\n        position.bottom = (parseFloat(position.bottom) / 100) * height;\n    }\n\n    if(typeof position.top === 'string') {\n        position.top = (parseFloat(position.top) / 100) * height;\n    }\n\n    // Convert to client space.\n    return new Rect(\n        rect.left + position.left,\n        rect.top + position.top,\n        rect.left + position.right,\n        rect.top + position.bottom\n    );\n}\n\n\n/**\n * Returns the distance in between the provided Rect objects.  If the objects are touching or overlapping 0\n * will be returned.\n *\n * @param rect1 {{left, top, right, bottom}}\n * @param rect2 {{left, top, right, bottom}}\n * @returns {Number}\n */\nexport function getDistanceBetweenRects(rect1, rect2) {\n    let vec1 = Rect.fromRect(rect1),\n        vec2 = Rect.fromRect(rect2);\n\n    let isXOverlapping = vec1.isXOverlapping(vec2),\n        isYOverlapping = vec1.isYOverlapping(vec2);\n\n    if(isXOverlapping && isYOverlapping) {\n        // Items are overlapping\n        return 0;\n    } else if(isXOverlapping) {\n        return Math.min(\n            Math.abs(vec1.bottom - vec2.top),\n            Math.abs(vec1.top - vec2.bottom)\n        );\n    } else if(isYOverlapping) {\n        return Math.min(\n            Math.abs(vec1.right - vec2.left),\n            Math.abs(vec1.left - vec2.right)\n        );\n    } else {\n        let x1, y1, x2, y2;\n\n        if(vec1.right <= vec2.left) {\n            x1 = vec1.right;\n            x2 = vec2.left;\n        } else {\n            x1 = vec1.left;\n            x2 = vec2.right;\n        }\n\n        if(vec1.bottom <= vec2.top) {\n            y1 = vec1.bottom;\n            y2 = vec2.top;\n        } else {\n            y1 = vec1.top;\n            y2 = vec2.bottom;\n        }\n\n        // Use distance formula to calculate distance.\n        return Math.round(Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)));\n    }\n}\n\n\n/**\n * Returns the top and left position of an element relative to the document.\n *\n * @param element\n * @return {{top: number, left: number}}\n */\nexport function getElementOffset(element) {\n    let box = element.getBoundingClientRect();\n\n    return {\n        left: box.left + window.pageXOffset,\n        top: box.top + window.pageYOffset\n    };\n}\n\n\n/**\n * Sets an elements position relative to the document.\n *\n * @param element\n * @param coords\n */\nexport function setElementOffset(element, coords) {\n    if (coords.nodeType) {\n        coords = getElementOffset(element);\n    } else if (Array.isArray(coords)) {\n        coords = {\n            left: coords.left,\n            top: coords.top\n        };\n    }\n\n    let offset = element.getBoundingClientRect();\n\n    let style = getComputedStyle(element),\n        left = parseInt(style.left, 10) || 0,\n        top = parseInt(style.top, 10) || 0;\n\n    element.style.left = (left + (coords.left - offset.left)) + 'px';\n    element.style.top = (top + (coords.top - offset.top)) + 'px';\n}\n\n\nexport {Vec2, Vec3, Rect};\n","import Vec4 from './Vec4';\n\nconst regPercentage = /^(\\d+\\.?\\d*)%$/;\n\n\nexport default class RGBA extends Vec4 {\n    constructor(r, g, b, a) {\n        if(typeof r === 'object') {\n            super(r);\n        } else {\n            super(r, g, b, a);\n        }\n    }\n\n    toString() {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`;\n    }\n\n    static parseRGBAColorStringArgs(value) {\n        value = value.trim().split(/\\s+/);\n\n        let r = value[0],\n            g = value[1],\n            b = value[2],\n            a = value[3];\n\n        if(r) {\n            if(regPercentage.test(r)) {\n                r = (parseFloat(r) / 100) * 255;\n            } else {\n                r = parseInt(r, 10);\n            }\n        }\n\n        if(g) {\n            if(regPercentage.test(g)) {\n                g = (parseFloat(g) / 100) * 255;\n            } else {\n                g = parseInt(g, 10);\n            }\n        }\n\n        if(b) {\n            if(regPercentage.test(b)) {\n                b = (parseFloat(b) / 100) * 255;\n            } else {\n                b = parseInt(b, 10);\n            }\n        }\n\n        if(a) {\n            if(regPercentage.test(a)) {\n                a = (parseFloat(a) / 100);\n            } else {\n                a = parseFloat(a);\n            }\n        }\n\n        a = a || 1.0;\n\n        return new RGBA(r, g, b, a);\n    }\n\n    static parseHexColorStringArg(value) {\n        value = value.trim().substring(1);\n\n        let r, g, b, a = 1.0;\n\n        if(value.length === 3) {\n            r = value[0];\n            g = value[1];\n            b = value[2];\n\n            r = parseInt(r+r, 16);\n            g = parseInt(g+g, 16);\n            b = parseInt(b+b, 16);\n        } else if(value.length === 6) {\n            r = value.substr(0, 2);\n            g = value.substr(2, 2);\n            b = value.substr(4, 2);\n\n            r = parseInt(r, 16);\n            g = parseInt(g, 16);\n            b = parseInt(b, 16);\n        } else if(value.length === 8) {\n            r = value.substr(0, 2);\n            g = value.substr(2, 2);\n            b = value.substr(4, 2);\n            a = value.substr(6, 2);\n\n            r = parseInt(r, 16);\n            g = parseInt(g, 16);\n            b = parseInt(b, 16);\n            a = parseInt(a, 16) / 255;\n        }\n\n        return new RGBA(r, g, b, a);\n    }\n}\n","\n\n/**\n * Stores a 3 value vector.\n */\nexport default class Vec3 {\n    constructor(x=0, y=0, z=0) {\n        this[0] = x;\n        this[1] = y;\n        this[2] = z;\n    }\n\n    get x() {\n        return this[0];\n    }\n\n    get y() {\n        return this[1];\n    }\n\n    get z() {\n        return this[2];\n    }\n\n    set x(value) {\n        this[0] = value;\n    }\n\n    set y(value) {\n        this[1] = value;\n    }\n\n    set z(value) {\n        this[2] = value;\n    }\n\n    get r() {\n        return this[0];\n    }\n\n    get g() {\n        return this[1];\n    }\n\n    get b() {\n        return this[2];\n    }\n\n    set r(value) {\n        this[0] = value;\n    }\n\n    set g(value) {\n        this[1] = value;\n    }\n\n    set b(value) {\n        this[2] = value;\n    }\n\n    set(value) {\n        if(typeof value !== 'object') {\n            this[0] = value;\n            this[1] = value;\n            this[2] = value;\n        } else {\n            this[0] = value[0];\n            this[1] = value[1];\n            this[2] = value[2];\n        }\n    }\n\n    add(vec3) {\n        if(typeof vec3 === 'number') {\n            return new Vec3(\n                this[0] + vec3,\n                this[1] + vec3,\n                this[2] + vec3\n            );\n        } else {\n            return new Vec3(\n                this[0] + vec3[0],\n                this[1] + vec3[1],\n                this[2] + vec3[2]\n            );\n        }\n    }\n\n    subtract(vec3) {\n        if(typeof vec3 === 'number') {\n            return new Vec3(\n                this[0] - vec3,\n                this[1] - vec3,\n                this[2] - vec3\n            );\n        } else {\n            return new Vec3(\n                this[0] - vec3[0],\n                this[1] - vec3[1],\n                this[2] - vec3[2]\n            );\n        }\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    scalar(value) {\n        return new Vec3(\n            this[0] * value,\n            this[1] * value,\n            this[2] * value\n        );\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    equals(vec3) {\n        return vec3 === this || (vec3[0] === this[0] && vec3[1] === this[1] && vec3[2] === this[2]);\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    mod(vec3) {\n        if(typeof vec3 === 'number') {\n            return new Vec3(\n                this[0] % vec3,\n                this[1] % vec3,\n                this[2] % vec3\n            );\n        } else {\n            return new Vec3(\n                this[0] % vec3[0],\n                this[1] % vec3[1],\n                this[2] % vec3[2]\n            );\n        }\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    clone() {\n        return new Vec3(this[0], this[1], this[2]);\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    toHex() {\n        let r = Math.round(this.r).toString(16),\n            g = Math.round(this.g).toString(16),\n            b = Math.round(this.b).toString(16);\n\n        if(r.length === 1) {\n            r = '0' + r;\n        }\n\n        if(g.length === 1) {\n            g = '0' + g;\n        }\n\n        if(b.length === 1) {\n            b = '0' + b;\n        }\n\n        return `#${r}${g}${b}`;\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    toRGB() {\n        return `rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`;\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    toTranslate3d() {\n        return `translate3d(${this.x}px, ${this.y}px, ${this.z}px)`;\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    static fromHex(hex) {\n        let m = /^#?([0-9a-f]{3})$/i.exec(hex);\n\n        if(m) {\n            hex = m[1][0] + m[1][0] + m[1][1] + m[1][1] + m[1][2] + m[1][2];\n        } else {\n            m = /^#?([0-9a-f]{6})$/i.exec(hex);\n\n            if(m) {\n                hex = m[1];\n            } else {\n                throw new Error(`Could not parse value ${hex}`);\n            }\n        }\n\n        hex = parseInt(hex, 16);\n\n        // r, g, b\n        return new Vec3(\n            hex & 0xff0000 >> 16,\n            hex & 0x00ff00 >> 8,\n            hex & 0x0000ff\n        );\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    static fromRGB(value) {\n        let m = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/.exec(value);\n\n        if(!m) {\n            throw new Error(`Could not parse rgb value ${value}`);\n        }\n\n        return new Vec3(\n            parseInt(m[1], 10),\n            parseInt(m[2], 10),\n            parseInt(m[3], 10),\n        );\n    }\n}\n","import Rect from \"./Rect\";\nimport Vec2 from \"./Vec2\";\nimport Vec3 from \"./Vec3\";\nimport Vec4 from \"./Vec4\";\nimport RGBA from \"./RGBA\";\nimport {UnitError} from \"../errors\";\n\n\nexport {Rect, Vec2, Vec3, Vec4, RGBA, UnitError};\n"],"sourceRoot":""}