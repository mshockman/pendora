{"version":3,"sources":["webpack://pendora/./src/core/Publisher.js","webpack://pendora/./src/core/ui/position.js"],"names":["TOPICS","Symbol","STOP","Publisher","topic","callback","push","fn","on","off","args","apply","arguments","length","callbacks","i","cb","splice","slice","e","regMatrix","getOffsetElement","element","o","parentElement","position","getComputedStyle","getClientRect","Rect","getBoundingOffsetRect","offsetParent","offsetRect","rect","getRootContainingClientRect","getBoundingClientRect","left","top","right","bottom","getBoundingDocumentRect","window","pageXOffset","pageYOffset","getTranslation","transform","m","exec","Vec3","data","split","parseFloat","setTranslation","x","y","z","style","getCssPosition","Vec2","parseInt","setCssPosition","undefined","setElementClientPosition","method","positionType","box","deltaX","deltaY","current","console","log","cssPosition","clientRectToDocumentSpace","r","fromRect","documentRectToClientSpace","snapToGrid","value","gridSize","roundingFunction","Math","round","Number","isNaN","convertDomRectToObject","domRect","getPointOnElement","referenceElement","point","offset","constrain","document","querySelector","Array","isArray","Error","clamp","getSubBoundingBox","width","height","getDistanceBetweenRects","rect1","rect2","vec1","vec2","isXOverlapping","isYOverlapping","min","abs","x1","y1","x2","y2","sqrt","pow","getElementOffset","setElementOffset","coords","nodeType"],"mappings":"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","file":"chunk-2.bundle.js","sourcesContent":["let TOPICS = Symbol('topics');\r\n\r\n\r\nexport function STOP() {\r\n    throw STOP;\r\n}\r\n\r\n\r\nexport default class Publisher {\r\n    constructor() {\r\n        this[TOPICS] = {};\r\n    }\r\n\r\n    on(topic, callback) {\r\n        if(!this[TOPICS][topic]) this[TOPICS][topic] = [];\r\n        this[TOPICS][topic].push(callback);\r\n        return this;\r\n    }\r\n\r\n    once(topic, fn) {\r\n        let on = (...args) => {\r\n            this.off(topic, fn);\r\n            return fn.apply(this, args);\r\n        };\r\n\r\n        on.fn = fn;\r\n        this.on(topic, fn);\r\n        return this;\r\n    }\r\n\r\n    off(topic, callback) {\r\n        if(arguments.length === 0) {\r\n            // CLear all topics.\r\n            this[TOPICS] = {};\r\n            return this;\r\n        } else if(arguments.length === 1) {\r\n            // Clear single topic.\r\n            this[TOPICS][topic] = [];\r\n            return this;\r\n        }\r\n\r\n        if(!this[TOPICS] || !this[TOPICS][topic] || !this[TOPICS][topic].length) {\r\n            // Topic list was either empty or didn't exist.  No need to remove anything.  Return;\r\n            return this;\r\n        }\r\n\r\n        let callbacks = this[TOPICS][topic];\r\n\r\n        for(let i = 0; i < callback.length; i++) {\r\n            let cb = callbacks[i];\r\n            if(cb === callback || cb.fn === callback) {\r\n                callbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(callbacks.length === 0) {\r\n            delete this[TOPICS][topic];\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    hasEvent(topic, callback) {\r\n        if(arguments.length === 1) {\r\n            return !!this[TOPICS][topic];\r\n        } else {\r\n            let callbacks = this[TOPICS][topic];\r\n\r\n            for(let i = 0; i < callbacks.length; i++) {\r\n                let cb = callbacks[i];\r\n                if(cb === callback || cb.fn === callback) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    publish(topic, ...args) {\r\n        if(this[TOPICS][topic]) {\r\n            let callbacks = this[TOPICS][topic].slice(0);\r\n\r\n            for(let cb of callbacks) {\r\n                try {\r\n                    cb.apply(this, args);\r\n                } catch (e) {\r\n                    if(e === STOP) {\r\n                        return e;\r\n                    } else {\r\n                        throw e;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n}\r\n","import {Rect, Vec2, Vec3} from \"../vectors\";\r\nimport {clamp} from \"../utility\";\r\n\r\n\r\nconst regMatrix = /matrix(3d)?\\(([^)]+)\\)/;\r\n\r\n\r\n/**\r\n * Returns the elements offset parent.\r\n *\r\n * @param element\r\n * @returns {HTMLElement}\r\n */\r\nexport function getOffsetElement(element) {\r\n    let o = element.parentElement;\r\n\r\n    while(o) {\r\n        let position = getComputedStyle(o).position;\r\n        if(position !== 'static') return o;\r\n        o = o.parentElement;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the rectangle of the client area.\r\n *\r\n * @returns {Rect}\r\n */\r\nexport function getClientRect() {\r\n    return Rect.getClientRect();\r\n}\r\n\r\n\r\n/**\r\n * Returns a bounding rect who's positions are relative to the provided offsetParent.\r\n * If offsetParent is null then the targets natural offsetParent is used as returned by the getOffsetElement function.\r\n * @param element\r\n * @param offsetParent\r\n * @returns {{top: number, left: number, bottom: number, width: number, right: number, height: number}}\r\n */\r\nexport function getBoundingOffsetRect(element, offsetParent=null) {\r\n    let offsetRect, rect;\r\n\r\n    if(!offsetParent) offsetParent = getOffsetElement(element);\r\n\r\n    // no offset parent.  Position relative to the client.\r\n    if(!offsetParent) {\r\n        offsetRect = Rect.getRootContainingClientRect();\r\n    } else {\r\n        offsetRect = Rect.getBoundingClientRect(offsetParent);\r\n    }\r\n\r\n    rect = element.getBoundingClientRect();\r\n\r\n    return new Rect(\r\n        rect.left - offsetRect.left,\r\n        rect.top - offsetRect.top,\r\n        offsetRect.right - rect.right,\r\n        offsetRect.bottom - rect.bottom\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns a bounding rect who's positions are relative to the document.\r\n * @param element\r\n * @returns {{top: number, left: number, bottom: number, width: number, x: number, y: number, right: number, height: number}}\r\n */\r\nexport function getBoundingDocumentRect(element) {\r\n    let rect = element.getBoundingClientRect();\r\n\r\n    return new Rect(\r\n        rect.left + window.pageXOffset,\r\n        rect.top + window.pageYOffset,\r\n        rect.right + window.pageXOffset,\r\n        rect.bottom + window.pageYOffset\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns the css translation from the transformation matrix applied to the element.\r\n *\r\n * @param element\r\n * @returns {Vec3}\r\n */\r\nexport function getTranslation(element) {\r\n    let transform = getComputedStyle(element).transform,\r\n        m = regMatrix.exec(transform);\r\n\r\n    if(!m) {\r\n        return new Vec3(\r\n            0,\r\n            0,\r\n            0\r\n        );\r\n    }\r\n\r\n    let data = m[2].split(/\\s*,\\s*/);\r\n\r\n    if(m[1]) {\r\n        return new Vec3(\r\n            parseFloat(data[12]),\r\n            parseFloat(data[13]),\r\n            parseFloat(data[14])\r\n        );\r\n    } else {\r\n        return new Vec3(\r\n            parseFloat(data[4]),\r\n            parseFloat(data[5]),\r\n            0\r\n        );\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Sets the element's transformation matrix to 2d translate with the specified left and top properties.\r\n *\r\n * @param element\r\n * @param x\r\n * @param y\r\n * @param z\r\n */\r\nexport function setTranslation(element, {x, y, z=null}) {\r\n    if(z !== null) {\r\n        element.style.transform = `translate3d(${x}px, ${y}px, ${z}px)`;\r\n    } else {\r\n        element.style.transform = `translate(${x}px, ${y}px)`;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Gets the elements left and top style properties as numbers.\r\n *\r\n * @param element\r\n * @returns {Vec2}\r\n */\r\nexport function getCssPosition(element) {\r\n    let style = getComputedStyle(element);\r\n\r\n    return new Vec2(\r\n        parseInt(style.left, 10),\r\n        parseInt(style.top, 10)\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Sets the left and top style properties of an element.  If the element is positioned statically it will be changed to\r\n * relative.\r\n *\r\n * @param element\r\n * @param left\r\n * @param top\r\n */\r\nexport function setCssPosition(element, {left=null, top=null}) {\r\n    let style = getComputedStyle(element);\r\n\r\n    if(style.position === 'static') {\r\n        style.position = 'relative';\r\n    }\r\n\r\n    if(left !== null && left !== undefined) {\r\n        element.style.left = `${left}px`;\r\n    }\r\n\r\n    if(top !== null && top !== undefined) {\r\n        element.style.top = `${top}px`;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Sets the elements position relative to the client window.  The `method` parameter controls how the elements position\r\n * is modified.  The options are 'top-left', 'top-right', 'bottom-left', 'bottom-right', 'translate', and 'translate3d'.\r\n *\r\n * top-left, top-right, bottom-left and bottom-right set the css left, top, right, and bottom properties of the element.\r\n * translate and translate3d position the element by setting the transform property.\r\n *\r\n * @param element {HTMLElement}\r\n * @param position {{x, y}|{left, top, right, bottom}|Array|Vec2}\r\n * @param method {'top-left'|'top-right'|'bottom-left'|'bottom-right'|'translate'|'translate3d'}\r\n */\r\nexport function setElementClientPosition(element, position, method='top-left') {\r\n    position = new Rect(position);\r\n\r\n    if(method === 'top-left' || method === 'top-right' || method === 'bottom-left' || method === 'bottom-right') {\r\n        let style = getComputedStyle(element);\r\n\r\n        let positionType = style.position, box, deltaX, deltaY, current;\r\n\r\n        // position can't be static for this operation.  Switch to relative.\r\n        if(positionType === 'static') {\r\n            element.style.position = 'relative';\r\n            positionType = \"relative\";\r\n        }\r\n\r\n        if(positionType === \"relative\") {\r\n            style = getComputedStyle(element);\r\n\r\n            current = {\r\n                left: parseInt(style.left, 10) || 0,\r\n                right: parseInt(style.right, 10) || 0,\r\n                top: parseInt(style.top, 10) || 0,\r\n                bottom: parseInt(style.bottom, 10) || 0\r\n            }\r\n        } else {\r\n            box = Rect.getBoundingClientRect(element);\r\n            current = getBoundingOffsetRect(element);\r\n        }\r\n\r\n        if(method === 'top-left') {\r\n            deltaX = position.left - box.left;\r\n            deltaY = position.top - box.top;\r\n\r\n            element.style.left = (current.left + deltaX) + 'px';\r\n            element.style.top = (current.top + deltaY) + 'px';\r\n            element.style.right = '';\r\n            element.style.bottom = '';\r\n        } else if(method === 'top-right') {\r\n            deltaX = position.right - box.right;\r\n            deltaY = position.top - box.top;\r\n\r\n            element.style.right = (current.right - deltaX) + 'px';\r\n            element.style.top = (current.top + deltaY) + 'px';\r\n            element.style.left = '';\r\n            element.style.bottom = '';\r\n        } else if(method === 'bottom-left') {\r\n            deltaX = position.left - box.left;\r\n            deltaY = position.bottom - box.bottom;\r\n\r\n            console.log({\r\n                right: (current.left + deltaX) + 'px',\r\n                bottom: (current.bottom - deltaY) + 'px'\r\n            });\r\n\r\n            element.style.left = (current.left + deltaX) + 'px';\r\n            element.style.bottom = (current.bottom - deltaY) + 'px';\r\n            element.style.right = '';\r\n            element.style.top = '';\r\n        } else { // bottom-right\r\n            deltaX = position.right - box.right;\r\n            deltaY = position.bottom - box.bottom;\r\n\r\n            element.style.right = (current.right - deltaX) + 'px';\r\n            element.style.bottom = (current.bottom - deltaY) + 'px';\r\n            element.style.left = '';\r\n            element.style.top = '';\r\n        }\r\n    } else if(method === 'translate') {\r\n        let box = Rect.getBoundingClientRect(element),\r\n            deltaX = position.left - box.left,\r\n            deltaY = position.top - box.top,\r\n            cssPosition = getTranslation(element);\r\n\r\n        setTranslation(element, {\r\n            x: cssPosition.x + deltaX,\r\n            y: cssPosition.y + deltaY\r\n        });\r\n    } else if(method === 'translate3d') {\r\n        let box = Rect.getBoundingClientRect(element),\r\n            deltaX = position.left - box.left,\r\n            deltaY = position.top - box.top,\r\n            cssPosition = getTranslation(element);\r\n\r\n        setTranslation(element, {\r\n            x: cssPosition.x + deltaX,\r\n            y: cssPosition.y + deltaY,\r\n            z: cssPosition.z\r\n        });\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Transforms the coordinates of a BoundingClientRect like object from client space to document space.\r\n * @param rect\r\n */\r\nexport function clientRectToDocumentSpace(rect) {\r\n    let r = Rect.fromRect(rect);\r\n\r\n    r.left += window.pageXOffset;\r\n    r.right += window.pageXOffset;\r\n    if(typeof r.top === 'number') r.top += window.pageYOffset;\r\n    if(typeof r.bottom === 'number') r.bottom += window.pageYOffset;\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Transforms the coordinates of a BoundingClientRect like object from document space to client space.\r\n * @param rect\r\n */\r\nexport function documentRectToClientSpace(rect) {\r\n    let r = Rect.fromRect(rect);\r\n\r\n    r.left -= window.pageXOffset;\r\n    r.right -= window.pageXOffset;\r\n    if(typeof r.top === 'number') r.top -= window.pageYOffset;\r\n    if(typeof r.bottom === 'number') r.bottom -= window.pageYOffset;\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Snaps the value to the specified grid using the provided rounding function.\r\n * @param value\r\n * @param gridSize\r\n * @param roundingFunction\r\n * @returns {number|*}\r\n */\r\nexport function snapToGrid(value, gridSize, roundingFunction=Math.round) {\r\n    if(gridSize !== null && gridSize !== undefined && !Number.isNaN(gridSize)) {\r\n        return roundingFunction(value / gridSize) * gridSize;\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Deprecated in favor of calling Rect.fromRect() class method.\r\n *\r\n * @deprecated\r\n * @param domRect\r\n * @returns {Rect}\r\n */\r\nexport function convertDomRectToObject(domRect) {\r\n    return Rect.fromRect(domRect);\r\n}\r\n\r\n\r\n/**\r\n * Returns the {x, y} point calculated relative to the reference element.\r\n *\r\n * @param referenceElement\r\n * @param point\r\n * @param offset\r\n * @param constrain\r\n * @returns {Vec2}\r\n */\r\nexport function getPointOnElement(referenceElement, point, offset=null, constrain=null) {\r\n    let rect = referenceElement;\r\n\r\n    if(rect.getBoundingClientRect) {\r\n        rect = rect.getBoundingClientRect();\r\n    }\r\n\r\n    if(constrain) {\r\n        if (typeof constrain === 'string') {\r\n            constrain = document.querySelector(constrain);\r\n        }\r\n\r\n        if (constrain.getBoundingClientRect) {\r\n            constrain = Rect.fromRect(constrain.getBoundingClientRect());\r\n        }\r\n    }\r\n\r\n    // Convert array to {x, y} object.\r\n    if(Array.isArray(point)) {\r\n        point = {\r\n            x: point[0],\r\n            y: point[1]\r\n        };\r\n    } else if(typeof point === 'string') {\r\n        if(point === 'top-left') {\r\n            point = {x: 0, y: 0};\r\n        } else if(point === 'top') {\r\n            point = {x: '50%', y: 0};\r\n        } else if(point === 'top-right') {\r\n            point = {x: '100%', y: 0};\r\n        } else if(point === 'right') {\r\n            point = {x: '100%', y: '50%'};\r\n        } else if(point === 'bottom-right') {\r\n            point = {x: '100%', y: '100%'};\r\n        } else if(point === 'bottom') {\r\n            point = {x: '50%', y: '100%'};\r\n        } else if(point === 'bottom-left') {\r\n            point = {x: 0, y: '100%'};\r\n        } else if(point === 'left') {\r\n            point = {x: 0, y: '50%'};\r\n        } else if(point === 'middle') {\r\n            point = {x: '50%', y: '50%'};\r\n        } else {\r\n            throw new Error(`Unknown point option ${point}`);\r\n        }\r\n    }\r\n\r\n    if(typeof point.x === 'string') {\r\n        point.x = (rect.right - rect.left) * (parseFloat(point.x) / 100);\r\n    }\r\n\r\n    if(typeof point.y === 'string') {\r\n        point.y = (rect.bottom - rect.top) * (parseFloat(point.y) / 100);\r\n    }\r\n\r\n    if(constrain) {\r\n        if(typeof constrain.left === 'string') {\r\n            constrain.left = (rect.right - rect.left) * (parseFloat(constrain.left) / 100);\r\n        }\r\n\r\n        if(typeof constrain.right === 'string') {\r\n            constrain.right = (rect.right - rect.left) * (parseFloat(constrain.right) / 100);\r\n        }\r\n\r\n        if(typeof constrain.top === 'string') {\r\n            constrain.top = (rect.bottom - rect.top) * (parseFloat(constrain.top) / 100);\r\n        }\r\n\r\n        if(typeof constrain.bottom === 'string') {\r\n            constrain.bottom = (rect.bottom - rect.top) * (parseFloat(constrain.bottom) / 100);\r\n        }\r\n\r\n        point.x = clamp(point.x, constrain.left, constrain.right);\r\n        point.y = clamp(point.y, constrain.top, constrain.bottom);\r\n    }\r\n\r\n    if(offset) {\r\n        if(Array.isArray(offset)) {\r\n            offset = {\r\n                x: offset[0],\r\n                y: offset[1]\r\n            };\r\n        }\r\n\r\n        if(offset.x !== null) {\r\n            point.x += offset.x;\r\n        }\r\n\r\n        if(offset.y !== null) {\r\n            point.y += offset.y;\r\n        }\r\n    }\r\n\r\n    return new Vec2(rect.left + point.x, rect.top + point.y);\r\n}\r\n\r\n\r\n/**\r\n * Gets the bounding client rect for a rectangle defined by the position rectangle with left, top, right and bottom\r\n * properties relative to the element's position.\r\n *\r\n * @param element {{getBoundingClientRect}|Element|String|{left, top, right, bottom}}\r\n * @param position {{left, top, bottom, right}}\r\n * @return {Rect}\r\n */\r\nexport function getSubBoundingBox(element, position) {\r\n    let rect;\r\n\r\n    // Get the bounding client rect of the element.   The user should have passed either a css selector, an object with a\r\n    // getBoundingClientRect interface.  Or a bounding client rect directly.\r\n    if(element.getBoundingClientRect) {\r\n        rect = element.getBoundingClientRect();\r\n    } else if(typeof element === 'string') {\r\n        rect = document.querySelector(element).getBoundingClientRect();\r\n    } else {\r\n        rect = element;\r\n    }\r\n\r\n    let width = rect.right - rect.left,\r\n        height = rect.bottom - rect.top;\r\n\r\n    // The user can pass a rect with left, top, right and bottom properties.  The value can either be the desired\r\n    // coordinates relative to the top-left corner of the reference element or a percentage.  Another possibility\r\n    // is that the user passes one of the keyword properties that coorispond to a specific section of the element.\r\n    // Map those keywords to their rectangle.\r\n    if(typeof position === 'string') {\r\n        if(position === 'border-top') {\r\n            position = {left: 0, right: '100%', top: 0, bottom: 0};\r\n        } else if(position === 'border-right') {\r\n            position = {left: '100%', right: '100%', top: 0, bottom: '100%'};\r\n        } else if(position === 'border-bottom') {\r\n            position = {left: 0, right: '100%', top: '100%', bottom: '100%'};\r\n        } else if(position === 'border-left') {\r\n            position = {left: 0, top: 0, right: 0, bottom: '100%'};\r\n        } else if(position === 'top-left') {\r\n            position = {left: 0, top: 0, right: 0, bottom: 0};\r\n        } else if(position === 'top') {\r\n            position = {top: 0, left: '50%', right: '50%', bottom: 0};\r\n        } else if(position === 'top-right') {\r\n            position = {top: 0, left: '100%', right: '100%', bottom: 0};\r\n        } else if(position === 'left') {\r\n            position = {left: 0, top: '50%', bottom: '50%', right: 0};\r\n        } else if(position === 'origin') {\r\n            position = {left: '50%', right: '50%', top: '50%', bottom: '50%'};\r\n        } else if(position === 'bottom-left') {\r\n            position = {left: 0, right: 0, top: '100%', bottom: '100%'};\r\n        } else if(position === 'bottom') {\r\n            position = {left: '50%', right: '50%', top: '100%', bottom: '100%'};\r\n        } else if(position === 'bottom-right') {\r\n            position = {left: '100%', right: '100%', top: '100%', bottom: '100%'};\r\n        } else if(position === 'right') {\r\n            position = {left: '100%', right: '100%', top: '50%', bottom: '50%'};\r\n        }\r\n    }\r\n\r\n    position.left = position.left || 0;\r\n    position.right = position.right || 0;\r\n    position.top = position.top || 0;\r\n    position.bottom = position.bottom || 0;\r\n\r\n    // left and right percentages are a percentage of the elements width.\r\n    // top and bottom percentages are a percentage of the elements height.\r\n    if(typeof position.left === 'string') {\r\n        position.left = (parseFloat(position.left) / 100) * width;\r\n    }\r\n\r\n    if(typeof position.right === 'string') {\r\n        position.right = (parseFloat(position.right) / 100) * width;\r\n    }\r\n\r\n    if(typeof position.bottom === 'string') {\r\n        position.bottom = (parseFloat(position.bottom) / 100) * height;\r\n    }\r\n\r\n    if(typeof position.top === 'string') {\r\n        position.top = (parseFloat(position.top) / 100) * height;\r\n    }\r\n\r\n    // Convert to client space.\r\n    return new Rect(\r\n        rect.left + position.left,\r\n        rect.top + position.top,\r\n        rect.left + position.right,\r\n        rect.top + position.bottom\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns the distance in between the provided Rect objects.  If the objects are touching or overlapping 0\r\n * will be returned.\r\n *\r\n * @param rect1 {{left, top, right, bottom}}\r\n * @param rect2 {{left, top, right, bottom}}\r\n * @returns {Number}\r\n */\r\nexport function getDistanceBetweenRects(rect1, rect2) {\r\n    let vec1 = Rect.fromRect(rect1),\r\n        vec2 = Rect.fromRect(rect2);\r\n\r\n    let isXOverlapping = vec1.isXOverlapping(vec2),\r\n        isYOverlapping = vec1.isYOverlapping(vec2);\r\n\r\n    if(isXOverlapping && isYOverlapping) {\r\n        // Items are overlapping\r\n        return 0;\r\n    } else if(isXOverlapping) {\r\n        return Math.min(\r\n            Math.abs(vec1.bottom - vec2.top),\r\n            Math.abs(vec1.top - vec2.bottom)\r\n        );\r\n    } else if(isYOverlapping) {\r\n        return Math.min(\r\n            Math.abs(vec1.right - vec2.left),\r\n            Math.abs(vec1.left - vec2.right)\r\n        );\r\n    } else {\r\n        let x1, y1, x2, y2;\r\n\r\n        if(vec1.right <= vec2.left) {\r\n            x1 = vec1.right;\r\n            x2 = vec2.left;\r\n        } else {\r\n            x1 = vec1.left;\r\n            x2 = vec2.right;\r\n        }\r\n\r\n        if(vec1.bottom <= vec2.top) {\r\n            y1 = vec1.bottom;\r\n            y2 = vec2.top;\r\n        } else {\r\n            y1 = vec1.top;\r\n            y2 = vec2.bottom;\r\n        }\r\n\r\n        // Use distance formula to calculate distance.\r\n        return Math.round(Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)));\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the top and left position of an element relative to the document.\r\n *\r\n * @param element\r\n * @return {{top: number, left: number}}\r\n */\r\nexport function getElementOffset(element) {\r\n    let box = element.getBoundingClientRect();\r\n\r\n    return {\r\n        left: box.left + window.pageXOffset,\r\n        top: box.top + window.pageYOffset\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Sets an elements position relative to the document.\r\n *\r\n * @param element\r\n * @param coords\r\n */\r\nexport function setElementOffset(element, coords) {\r\n    if (coords.nodeType) {\r\n        coords = getElementOffset(element);\r\n    } else if (Array.isArray(coords)) {\r\n        coords = {\r\n            left: coords.left,\r\n            top: coords.top\r\n        };\r\n    }\r\n\r\n    let offset = element.getBoundingClientRect();\r\n\r\n    let style = getComputedStyle(element),\r\n        left = parseInt(style.left, 10) || 0,\r\n        top = parseInt(style.top, 10) || 0;\r\n\r\n    element.style.left = (left + (coords.left - offset.left)) + 'px';\r\n    element.style.top = (top + (coords.top - offset.top)) + 'px';\r\n}\r\n\r\n\r\nexport {Vec2, Vec3, Rect};\r\n"],"sourceRoot":""}