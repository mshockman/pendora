{"version":3,"sources":["webpack://pendora/./src/core/ui/Arrow.js","webpack://pendora/./src/core/ui/Draggable.js","webpack://pendora/./tests/src/test_overlay2.js"],"names":["Arrow","placement","align","element","document","createElement","className","parent","target","dataset","placementString","split","render","direction","style","left","right","top","bottom","parentRect","Rect","offsetParent","targetRect","pos","position","my","at","of","fitX","fitY","setElementClientPosition","value","Component","reg_percentage_test","cursor","event","rect","x","clientX","y","clientY","buildTestIntersectionFunction","amount","intersection","p","getArea","Draggable","container","axis","exclude","delay","offset","resistance","handle","helper","revert","revertDuration","scrollSpeed","selector","tolerance","setHelperSize","grid","querySelector","WeakMap","onMouseDown","addEventListener","startPosition","window","pageXOffset","pageYOffset","currentPosition","cancelMouseTracking","cancelTimer","closest","contains","Array","isArray","preventDefault","distanceBrokenPromise","Promise","resolve","isDistanceBroken","onMouseMove","calcDistance","removeEventListener","timerPromise","timer","setTimeout","clearTimeout","onMouseUp","all","timerStatus","distanceStatus","startDragging","offsetX","offsetY","startingX","startingY","cache","get","mousePosition","isDragging","fx","set","cancel","scroller","dropTargets","startingClientRect","translate","width","height","pointerEvents","parentElement","appendChild","classList","add","refreshDropTargets","mouseX","mouseY","currentDropTargets","detail","getDropTargets","dropTarget","indexOf","dispatchDropEvent","_moveElementToPosition","_selectElementRect","ScrollHelper","buildScrollHelper","publishDragMoveEvent","remove","accepted","isDefaultPrevented","reverted","publishDragDropEvent","isAccepted","accept","removeChild","_revert","undefined","mousePos","r","testFunction","type","test","parseFloat","droppable","push","droppables","querySelectorAll","length","i","item","splice","slice","Publisher","onFrame","starting","animation","Animation","frames","applyFrame","frame","animate","duration","self","startingRect","moveTo","Math","floor","fit","dragInstance","originalTarget","call","_getScrollParent","o","scrollWidth","clientWidth","scrollHeight","clientHeight","_getScrollRect","nodeName","innerWidth","innerHeight","scrollXSpeed","scrollYSpeed","frameID","timestamp","performance","now","delta","scrollLeft","scrollTop","requestAnimationFrame","cancelAnimationFrame","scrollParentRect","clamp","scrollParent","speed","getScrollSpeed","scrollRect","ScrollArea","scroll","getScroll","clone","opacity","zIndex","nodeType","cloneNode","bubbles","options","name","originalEvent","currentRect","dispatch","publish","eventPackage","draggable","Object","assign","customEvent","CustomEvent","dispatchEvent","OverlayTestPage","overlay","Overlay","arrow","setArrow","addPlacement","on","data"],"mappings":"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","file":"chunk-3.bundle.js","sourcesContent":["import Component from \"../Component\";\r\nimport Rect from \"../vectors/Rect\";\r\nimport {setElementClientPosition} from \"./position\";\r\n\r\n\r\n/**\r\n * A class that creates an arrow that can be placed at the edge of elements that will point towards the target element.\r\n * The arrow will be positioned to be as close to the target why still fitting inside it's parent.\r\n */\r\nexport default class Arrow extends Component {\r\n    /**\r\n     * The starting alignment of the arrow.\r\n     * Can be start, end, or center.\r\n     */\r\n    #align;\r\n\r\n    constructor(placement=\"bottom\", align=\"center\") {\r\n        let element = document.createElement('div');\r\n        element.className = \"arrow\";\r\n\r\n        super(element);\r\n\r\n        this.parent = null;\r\n        this.target = null;\r\n        this.#align = align;\r\n\r\n        this.element.dataset.placement = placement;\r\n    }\r\n\r\n    set align(value) {\r\n        this.#align = value;\r\n        this.render();\r\n    }\r\n\r\n    get align() {\r\n        return this.#align;\r\n    }\r\n\r\n    set placement(value) {\r\n        this.element.dataset.placement = value;\r\n        this.render();\r\n    }\r\n\r\n    get placement() {\r\n        return this.element.dataset.placement;\r\n    }\r\n\r\n    /**\r\n     * Sets the placement and align of the arrow.  Can take a string of placement-align separated by a dash.\r\n     *\r\n     * @param placementString\r\n     */\r\n    setPlacement(placementString) {\r\n        let [placement, align] = placementString.split(\"-\");\r\n\r\n        this.placement = placement;\r\n        this.align = align || \"center\";\r\n\r\n        this.render();\r\n    }\r\n\r\n    render() {\r\n        this.element.dataset.direction = this.direction;\r\n        this.element.style.left = \"\";\r\n        this.element.style.right = \"\";\r\n        this.element.style.top = \"\";\r\n        this.element.style.bottom = \"\";\r\n\r\n        let parentRect = new Rect(this.parent || this.element.offsetParent),\r\n            targetRect = this.target ? new Rect(this.target) : null,\r\n            pos = new Rect(this.element);\r\n\r\n        if(this.placement === \"top\") {\r\n            if(this.align === \"start\") {\r\n                pos = pos.position({my: \"left bottom\", at: \"left top\", of: parentRect});\r\n            } else if(this.align === \"end\") {\r\n                pos = pos.position({my: \"right bottom\", at: \"right top\", of: parentRect});\r\n            } else {\r\n                pos = pos.position({my: \"bottom\", at: \"top\", of: parentRect});\r\n            }\r\n\r\n            if(targetRect) pos = pos.fitX(targetRect);\r\n            pos = pos.fitX(parentRect);\r\n        } else if(this.placement === \"right\") {\r\n            if(this.align === \"start\") {\r\n                pos = pos.position({my: \"left top\", at: \"right top\", of: parentRect});\r\n            } else if(this.align === \"end\") {\r\n                pos = pos.position({my: \"left bottom\", at: \"right bottom\", of: parentRect});\r\n            } else {\r\n                pos = pos.position({my: \"left\", at: \"right\", of: parentRect});\r\n            }\r\n\r\n            if(targetRect) pos = pos.fitY(targetRect);\r\n            pos = pos.fitY(parentRect);\r\n        } else if(this.placement === \"bottom\") {\r\n            if(this.align === \"start\") {\r\n                pos = pos.position({my: \"left top\", at: \"left bottom\", of: parentRect});\r\n            } else if(this.align === \"end\") {\r\n                pos = pos.position({my: \"right top\", at: \"right bottom\", of: parentRect});\r\n            } else {\r\n                pos = pos.position({my: \"top\", at: \"bottom\", of: parentRect});\r\n            }\r\n\r\n            if(targetRect) pos = pos.fitX(targetRect);\r\n            pos = pos.fitX(parentRect);\r\n        } else if(this.placement === \"left\") {\r\n            if(this.align === \"start\") {\r\n                pos = pos.position({my: \"right top\", at: \"left top\", of: parentRect});\r\n            } else if(this.align === \"end\") {\r\n                pos = pos.position({my: \"right bottom\", at: \"left bottom\", of: parentRect});\r\n            } else {\r\n                pos = pos.position({my: \"right\", at: \"left\", of: parentRect});\r\n            }\r\n\r\n            if(targetRect) pos = pos.fitY(targetRect);\r\n            pos = pos.fitY(parentRect);\r\n        }\r\n\r\n        setElementClientPosition(this.element, pos);\r\n    }\r\n}\r\n","import Publisher from \"../Publisher\";\r\nimport {calcDistance, clamp} from \"../utility\";\r\nimport Rect from \"../vectors/Rect\";\r\nimport {getScroll} from \"../utility\";\r\nimport {setElementClientPosition} from \"./position\";\r\nimport Animation from \"../fx/Animation\";\r\n\r\n\r\nconst reg_percentage_test = /\\s*\\d+\\.?\\d*%\\s*/;\r\n\r\n\r\n/**\r\n * Returns the offset position of the mouse relative to the target.\r\n *\r\n * @param target\r\n * @param event\r\n * @returns {{x: number, y: number}}\r\n */\r\nexport function cursor(target, event) {\r\n    let rect = new Rect(target);\r\n\r\n    return {\r\n        x: event.clientX - rect.left,\r\n        y: event.clientY - rect.top\r\n    };\r\n}\r\n\r\n\r\nfunction buildTestIntersectionFunction(amount) {\r\n    return function(element, rect) {\r\n        rect = new Rect(rect);\r\n\r\n        let targetRect = new Rect(element),\r\n            intersection = targetRect.intersection(rect),\r\n            p = intersection ? intersection.getArea() / rect.getArea() : 0;\r\n\r\n        if(amount === 0) {\r\n            return p > 0;\r\n        } else {\r\n            return p >= amount;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport default class Draggable extends Publisher {\r\n    #element;\r\n    #droppables;\r\n    #boundOnMouseDown;\r\n    #itemCache;\r\n\r\n    constructor(element, {container=null, axis='xy', exclude='input, button, .ui-resizeable-handle, .no-drag', delay=0, offset=cursor,\r\n        resistance=0, handle=null, helper=null, revert=false, revertDuration=0,\r\n        scrollSpeed=0, selector=null, tolerance=0.5, setHelperSize=false, grid=null}={}) {\r\n        super();\r\n\r\n        if(typeof element === 'string') {\r\n            this.#element = document.querySelector(element);\r\n        } else {\r\n            this.#element = element;\r\n        }\r\n\r\n        this.#droppables = [];\r\n        this.#itemCache = new WeakMap();\r\n\r\n        this.container = container;\r\n        this.axis = axis;\r\n        this.exclude = exclude;\r\n        this.delay = delay;\r\n        this.offset = offset;\r\n        this.resistance = resistance;\r\n        this.handle = handle;\r\n        this.helper = helper;\r\n        this.revert = revert;\r\n        this.revertDuration = revertDuration;\r\n        this.scrollSpeed = scrollSpeed;\r\n        this.selector = selector;\r\n        this.tolerance = tolerance;\r\n        this.setHelperSize = setHelperSize;\r\n        this.grid = grid;\r\n\r\n        if(typeof this.container === 'string') {\r\n            this.container = document.querySelector(this.container);\r\n        }\r\n\r\n        this.#boundOnMouseDown = event => {\r\n            return this.onMouseDown(event);\r\n        };\r\n\r\n        this.element.addEventListener('mousedown', this.#boundOnMouseDown);\r\n    }\r\n\r\n    /**\r\n     * Starts dragging if the correct elements have been targeted and delay and resistance have been meet.\r\n     *\r\n     * @param event\r\n     * @returns {Promise<void>}\r\n     */\r\n    async onMouseDown(event) {\r\n        let startPosition = {x: event.clientX + window.pageXOffset, y: event.clientY + window.pageYOffset},\r\n            currentPosition = {x: startPosition.x, y: startPosition.y},\r\n            target = this.#element,\r\n            cancelMouseTracking = null,\r\n            cancelTimer = null,\r\n            distanceBrokenPromise,\r\n            timerPromise,\r\n            offset;\r\n\r\n        // Only start dragging if a draggable child of the element is targeted.\r\n        // If selector is null then the entire element is draggable and should be the target.\r\n        if(this.selector) {\r\n            target = event.target.closest(this.selector);\r\n\r\n            if(!target || !this.#element.contains(target)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Only start dragging if the handle was targeted.\r\n        // If handle is null then the entire target is the handle.\r\n        if(this.handle) {\r\n            let handle = event.target.closest(this.handle);\r\n\r\n            if(!handle || !target.contains(handle)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // If any excluded elements are targeted ignore the event.\r\n        if(this.exclude) {\r\n            let exclude = event.target.closest(this.exclude);\r\n\r\n            if(exclude && target.contains(exclude)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Find the offset of the event.\r\n        if(typeof this.offset === 'function') {\r\n            offset = this.offset(target, event);\r\n        } else if(Array.isArray(this.offset)) {\r\n            offset = {\r\n                x: this.offset[0],\r\n                y: this.offset[1]\r\n            };\r\n        } else if(typeof this.offset === 'object') {\r\n            offset = {\r\n                x: this.offset.x,\r\n                y: this.offset.y\r\n            };\r\n        } else {\r\n            offset = {x: 0, y: 0};\r\n        }\r\n\r\n        // Prevent default browser actions.\r\n        event.preventDefault();\r\n\r\n        // At this point we can be sure that a draggable item was\r\n        // targeted by it's handle and no excluded items where clicked.\r\n\r\n        // Creates a promise that both tracks the current mouse coords and resolve\r\n        // when the user passes the given resistance.\r\n        distanceBrokenPromise = new Promise(resolve => {\r\n            let isDistanceBroken = this.resistance <= 0;\r\n\r\n            if(isDistanceBroken) {\r\n                resolve('complete');\r\n            }\r\n\r\n            let onMouseMove = event => {\r\n                currentPosition.x = event.clientX + window.pageXOffset;\r\n                currentPosition.y = event.clientY + window.pageYOffset;\r\n                event.preventDefault();\r\n\r\n                if(!isDistanceBroken && calcDistance(currentPosition.x, currentPosition.y, startPosition.x, startPosition.y) > this.resistance) {\r\n                    resolve('complete');\r\n                    isDistanceBroken = true;\r\n                }\r\n            };\r\n\r\n            // Cancel mouse tracking and resolve the promise to canceled if hasn't already been resolve.\r\n            // This function must be called or their will be a memory leak before onMouseDown completes.\r\n            cancelMouseTracking = () => {\r\n                if(onMouseMove) {\r\n                    document.removeEventListener('mousemove', onMouseMove);\r\n\r\n                    if(!isDistanceBroken) {\r\n                        resolve('canceled');\r\n                    }\r\n\r\n                    onMouseMove = null;\r\n                }\r\n            };\r\n\r\n            document.addEventListener('mousemove', onMouseMove);\r\n        });\r\n\r\n        // Creates a promise that resolve when after the delay time passes or the user cancels the drag by\r\n        // releasing the mouse button.\r\n        timerPromise = new Promise(resolve => {\r\n            let timer = null;\r\n\r\n            if(this.delay >= 0) {\r\n                timer = setTimeout(() => {\r\n                    resolve(\"complete\");\r\n                    timer = null;\r\n                }, this.delay);\r\n            } else {\r\n                resolve('complete');\r\n            }\r\n\r\n            // cancel the timer and resolve it to canceled if it is still active.\r\n            cancelTimer = () => {\r\n                if(timer) {\r\n                    clearTimeout(timer);\r\n                    resolve('canceled');\r\n                }\r\n            };\r\n        });\r\n\r\n        // cancel the timer and mouse tracking if they are still active.\r\n        let onMouseUp = event => {\r\n            event.preventDefault();\r\n            cancelTimer();\r\n            cancelMouseTracking();\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n        };\r\n\r\n        document.addEventListener('mouseup', onMouseUp);\r\n\r\n        // Wait until the delay time and distance have passed or failed.\r\n        let [timerStatus, distanceStatus] = await Promise.all([timerPromise, distanceBrokenPromise]);\r\n\r\n        // Ensure that mouse tracking has been canceled.\r\n        if(cancelMouseTracking) cancelMouseTracking();\r\n\r\n        // At this point both the timer and distance status should have passed or failed.\r\n        // If either failed do nothing.\r\n        if(timerStatus === 'complete' && distanceStatus === 'complete') {\r\n            this.startDragging(target, {\r\n                offsetX: offset.x,\r\n                offsetY: offset.y,\r\n                // Make relative to client.\r\n                startingX: currentPosition.x,\r\n                startingY: currentPosition.y\r\n            });\r\n        }\r\n    }\r\n\r\n    async startDragging(element, pos) {\r\n        let cache = this.#itemCache.get(element),\r\n            mousePosition = {x: pos.startingX, y: pos.startingY};\r\n\r\n        if(!cache) {\r\n            cache = {isDragging: false, fx: null, rect: null, helper: null, element: element};\r\n            this.#itemCache.set(element, cache);\r\n        }\r\n\r\n        if(cache.isDragging) {\r\n            return;\r\n        }\r\n\r\n        cache.isDragging = true;\r\n\r\n        if(cache.fx) {\r\n            await cache.fx.cancel();\r\n            cache.fx = null;\r\n        }\r\n\r\n        let target = element,\r\n            container = this.container,\r\n            scroller = null,\r\n            dropTargets = [],\r\n            startPosition = new Rect(element),\r\n            startingClientRect = startPosition;\r\n\r\n        startPosition = startPosition.translate(\r\n            window.pageXOffset,\r\n            window.pageYOffset\r\n        );\r\n\r\n        if(!cache.rect) {\r\n            cache.rect = startPosition;\r\n        }\r\n\r\n        if(typeof container === 'string') {\r\n            container = document.querySelector(container);\r\n        }\r\n\r\n        if(this.helper) {\r\n            if(typeof this.helper === 'function') {\r\n                target = this.helper(element);\r\n            } else {\r\n                target = this.helper;\r\n            }\r\n\r\n            if(this.setHelperSize) {\r\n                target.style.width = startPosition.width + \"px\";\r\n                target.style.height = startPosition.height + \"px\";\r\n            }\r\n\r\n            target.style.pointerEvents = 'none';\r\n\r\n            if(!target.parentElement && element.parentElement) {\r\n                element.parentElement.appendChild(target);\r\n            }\r\n\r\n            target.classList.add('ui-drag-helper');\r\n\r\n            cache.helper = target;\r\n        }\r\n\r\n        let refreshDropTargets = (rect) => {\r\n            // drag-enter\r\n            let mouseX = mousePosition.x - window.pageXOffset,\r\n                mouseY = mousePosition.y - window.pageYOffset,\r\n                currentDropTargets,\r\n                detail = {clientX: mouseX, clientY: mouseY};\r\n\r\n            if(rect !== null) {\r\n                currentDropTargets = this.getDropTargets(rect, {mouseX, mouseY});\r\n            } else {\r\n                currentDropTargets = [];\r\n            }\r\n\r\n            for(let dropTarget of currentDropTargets) {\r\n                if(dropTargets.indexOf(dropTarget) === -1) {\r\n                    dispatchDropEvent(this, 'drag.enter', element, target, null, rect, true, true, false, detail, dropTarget);\r\n                }\r\n            }\r\n\r\n            for(let dropTarget of dropTargets) {\r\n                if(currentDropTargets.indexOf(dropTarget) === -1) {\r\n                    dispatchDropEvent(this, 'drag.leave', element, target, null, rect, true, true, false, detail, dropTarget);\r\n                }\r\n            }\r\n\r\n            // drag-leave\r\n            dropTargets = currentDropTargets;\r\n        };\r\n\r\n        let onMouseMove = event => {\r\n            event.preventDefault();\r\n            let rect = _moveElementToPosition(this, target, event.clientX, event.clientY, pos.offsetX, pos.offsetY, _selectElementRect(container, this, target, element));\r\n\r\n            mousePosition.x = event.clientX + window.pageXOffset;\r\n            mousePosition.y = event.clientY + window.pageYOffset;\r\n\r\n            if(this.scrollSpeed > 0) {\r\n                if(scroller) {\r\n                    scroller.cancel();\r\n                    scroller = null;\r\n                }\r\n\r\n                scroller = ScrollHelper.buildScrollHelper(element, target, rect, pos, this, event, this.scrollSpeed, container);\r\n            }\r\n\r\n            refreshDropTargets(rect);\r\n\r\n            publishDragMoveEvent(this, element, target, event, rect);\r\n        };\r\n\r\n        let onMouseUp = async event => {\r\n            event.preventDefault();\r\n            document.removeEventListener('mousemove', onMouseMove);\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n            cache.isDragging = false;\r\n            element.classList.remove('ui-dragging');\r\n\r\n            if(scroller) {\r\n                scroller.cancel();\r\n                scroller = null;\r\n            }\r\n\r\n            let accepted = false,\r\n                isDefaultPrevented = false,\r\n                reverted = false,\r\n                rect = new Rect(target);\r\n\r\n            publishDragDropEvent(this, element, target, event, rect, false, {\r\n                isDefaultPrevented() {\r\n                    return isDefaultPrevented;\r\n                },\r\n\r\n                isAccepted() {\r\n                    return accepted;\r\n                },\r\n\r\n                accept() {\r\n                    accepted = true;\r\n                },\r\n\r\n                preventDefault() {\r\n                    isDefaultPrevented = true;\r\n                }\r\n            });\r\n\r\n            if(this.revert && !accepted) {\r\n                refreshDropTargets(cache.rect);\r\n                rect = cache.rect;\r\n\r\n                if(!this.revertDuration) {\r\n                    if(target !== element) {\r\n                        target.parentElement.removeChild(target);\r\n                    } else {\r\n                        let pos = startPosition.translate(\r\n                            -window.pageXOffset,\r\n                            -window.pageYOffset\r\n                        );\r\n\r\n                        setElementClientPosition(target, pos, 'translate3d');\r\n                    }\r\n                } else {\r\n                    cache.fx = _revert(target, cache.rect, this.revertDuration);\r\n\r\n                    await cache.fx;\r\n\r\n                    if(target !== element) {\r\n                        target.parentElement.removeChild(target);\r\n                    }\r\n                }\r\n\r\n                reverted = true;\r\n            } else {\r\n                if(target !== element) {\r\n                    target.parentElement.removeChild(target);\r\n                    setElementClientPosition(element, rect, 'translate3d');\r\n                }\r\n            }\r\n\r\n            this.#itemCache.delete(element);\r\n\r\n            dispatchDropEvent(this, 'drag.end', element, target, event, rect, true, true, true, {accepted, reverted}, element);\r\n        };\r\n\r\n        // Set target to starting position.\r\n        if(mousePosition.x !== undefined && mousePosition.y !== undefined) {\r\n            let rect = _moveElementToPosition(this, target, mousePosition.x - window.pageXOffset, mousePosition.y - window.pageYOffset, pos.offsetX, pos.offsetY, _selectElementRect(container, this, target, element));\r\n            refreshDropTargets(rect);\r\n        }\r\n\r\n        document.addEventListener('mousemove', onMouseMove);\r\n        document.addEventListener('mouseup', onMouseUp);\r\n        element.classList.add('ui-dragging');\r\n\r\n        dispatchDropEvent(this, 'drag.start', element, target, null, startingClientRect, true, true, true, null);\r\n    }\r\n\r\n    getDropTargets(rect, mousePos) {\r\n        let r = [];\r\n\r\n        /**\r\n         * @type {number|String|Function|string}\r\n         */\r\n        let testFunction = this.tolerance,\r\n            type = typeof testFunction;\r\n\r\n        if(type === 'string') {\r\n            // noinspection JSCheckFunctionSignatures\r\n            if(reg_percentage_test.test(testFunction)) {\r\n                // noinspection JSCheckFunctionSignatures\r\n                testFunction = buildTestIntersectionFunction(parseFloat(testFunction) / 100);\r\n            }\r\n        } else if(type === 'number') {\r\n            testFunction = buildTestIntersectionFunction(testFunction);\r\n        }\r\n\r\n        for(let droppable of this.#droppables) {\r\n            if(testFunction(droppable, rect, mousePos, this)) {\r\n                r.push(droppable);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    connect(droppables) {\r\n        if(typeof droppables === 'string') {\r\n            droppables = document.querySelectorAll(droppables);\r\n        } else if(typeof droppables.length !== 'number') {\r\n            droppables = [droppables];\r\n        }\r\n\r\n        for(let i = 0; i < droppables.length; i++) {\r\n            let item = droppables[i];\r\n\r\n            if(this.#droppables.indexOf(item) === -1) {\r\n                this.#droppables.push(item);\r\n            }\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    disconnect(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        let i = this.#droppables.indexOf(droppable);\r\n\r\n        if(i !== -1) {\r\n            this.#droppables.splice(i, 1);\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    hasDroppable(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        return this.#droppables.indexOf(droppable) !== -1;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get droppables() {\r\n        return this.#droppables.slice(0);\r\n    }\r\n\r\n    get element() {\r\n        return this.#element;\r\n    }\r\n}\r\n\r\n\r\nfunction _revert(target, position, revertDuration, onFrame=null) {\r\n    let starting = new Rect(target);\r\n\r\n    let animation = new Animation({\r\n        frames: {\r\n            '0%': {\r\n                left: starting.left + window.pageXOffset,\r\n                top: starting.top + window.pageYOffset\r\n            },\r\n\r\n            '100%': {\r\n                left: position.left,\r\n                top: position.top\r\n            }\r\n        },\r\n\r\n        applyFrame(fx, frame) {\r\n            setElementClientPosition(fx.element, {\r\n                left: frame.left - window.pageXOffset,\r\n                top: frame.top - window.pageYOffset\r\n            }, 'translate3d');\r\n\r\n            if(onFrame) onFrame(fx);\r\n        }\r\n    });\r\n\r\n    return animation.animate(target, {duration: revertDuration});\r\n}\r\n\r\n\r\n/**\r\n * Takes a client (x, y) position and some offset coords and move the element to the given position.\r\n *\r\n * @param self\r\n * @param element\r\n * @param x\r\n * @param y\r\n * @param offsetX\r\n * @param offsetY\r\n * @param container\r\n * @private\r\n * @returns {*|Rect}\r\n */\r\nfunction _moveElementToPosition(self, element, x, y, offsetX, offsetY, container) {\r\n    let rect = new Rect(element),\r\n        startingRect = rect;\r\n\r\n    rect = rect.moveTo({left: x, top: y});\r\n\r\n    offsetX = offsetX || 0;\r\n    offsetY = offsetY || 0;\r\n\r\n    rect = rect.translate(-offsetX, -offsetY);\r\n\r\n    if(self.axis === 'y') {\r\n        rect = new Rect(\r\n            startingRect.left,\r\n            rect.top,\r\n            startingRect.right,\r\n            rect.bottom\r\n        );\r\n    } else if(self.axis === 'x') {\r\n        rect = new Rect(\r\n            rect.left,\r\n            startingRect.top,\r\n            rect.right,\r\n            startingRect.bottom\r\n        );\r\n    }\r\n\r\n    if(typeof self.grid === 'number' && self.grid) {\r\n        let left = Math.floor(rect.left / self.grid) * self.grid,\r\n            top = Math.floor(rect.top / self.grid) * self.grid;\r\n\r\n        rect = new Rect(left, top, left + startingRect.width, top + startingRect.height);\r\n    }\r\n\r\n    if(container) {\r\n        container = new Rect(container);\r\n        rect = rect.fit(container);\r\n    }\r\n\r\n    setElementClientPosition(element, rect, 'translate3d');\r\n    return rect;\r\n}\r\n\r\n\r\n// noinspection JSCommentMatchesSignature\r\n/**\r\n * For module use only.  Selects the element either by css selector, if it's a string, or resolve a function.\r\n * If the element is already element is is returned direction.  Returns null if not element is provided.\r\n *\r\n * @param element\r\n * @param dragInstance\r\n * @param target\r\n * @returns {null|*}\r\n * @private\r\n */\r\nfunction _selectElementRect(element, dragInstance, target, originalTarget) {\r\n    if(element) {\r\n        let type = typeof element;\r\n\r\n        if(type === 'function') {\r\n            return new Rect(element.call(dragInstance, target, originalTarget, dragInstance));\r\n        } else if(type === 'string') {\r\n            return new Rect(document.querySelector(element));\r\n        }\r\n\r\n        return new Rect(element);\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\n/**\r\n * Returns the first scrollable parent.\r\n *\r\n * @param element\r\n * @returns {HTMLElement|null}\r\n * @private\r\n */\r\nfunction _getScrollParent(element) {\r\n    let o = element.parentElement;\r\n\r\n    while(o) {\r\n        if (o.scrollWidth > o.clientWidth || o.scrollHeight > o.clientHeight) {\r\n            return o;\r\n        }\r\n\r\n        o = o.parentElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\nfunction _getScrollRect(element) {\r\n    if(element === window || element.nodeName === \"HTML\") {\r\n        return new Rect(0, 0, window.innerWidth, window.innerHeight);\r\n    } else {\r\n        return new Rect(element);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Helper class that is used to control scrolling when the element is dragged outside of bounds.\r\n */\r\nclass ScrollHelper {\r\n    constructor(element, scrollXSpeed=0, scrollYSpeed=0, onFrame=null) {\r\n        this.frameID = null;\r\n        this.element = element;\r\n        this.scrollXSpeed = scrollXSpeed;\r\n        this.scrollYSpeed = scrollYSpeed;\r\n        this.onFrame = onFrame;\r\n        this.timestamp = performance.now();\r\n\r\n        let frame = timestamp => {\r\n            let delta = (timestamp - this.timestamp) / 1000;\r\n\r\n            this.timestamp = timestamp;\r\n\r\n            this.element.scrollLeft += delta * this.scrollXSpeed;\r\n            this.element.scrollTop += delta * this.scrollYSpeed;\r\n\r\n            if(this.onFrame) {\r\n                this.onFrame(this);\r\n            }\r\n\r\n            this.frameID = window.requestAnimationFrame(frame);\r\n        };\r\n\r\n        this.frameID = window.requestAnimationFrame(frame);\r\n    }\r\n\r\n    cancel() {\r\n        if(this.frameID) {\r\n            window.cancelAnimationFrame(this.frameID);\r\n            this.frameID = null;\r\n        }\r\n    }\r\n\r\n    static getScrollSpeed(rect, scrollParentRect) {\r\n        let r = {x: 0, y: 0};\r\n\r\n        if(rect.right > scrollParentRect.right) {\r\n            r.x = clamp((rect.right - scrollParentRect.right) / rect.width, -1, 1);\r\n        } else if(rect.left < scrollParentRect.left) {\r\n            r.x = clamp((rect.left - scrollParentRect.left) / rect.width, -1, 1);\r\n        }\r\n\r\n        if(rect.bottom > scrollParentRect.bottom) {\r\n            r.y = clamp((rect.bottom - scrollParentRect.bottom) / rect.width, -1, 1);\r\n        } else if(rect.top < scrollParentRect.top) {\r\n            r.y = clamp((rect.top - scrollParentRect.top) / rect.width, -1, 1);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static buildScrollHelper(element, target, rect, pos, dragInstance, event, scrollSpeed, container) {\r\n        let scrollParent = _getScrollParent(element);\r\n\r\n        if(scrollParent) {\r\n            let scrollParentRect = _getScrollRect(scrollParent),\r\n                speed = ScrollHelper.getScrollSpeed(rect, scrollParentRect);\r\n\r\n            if(speed.x || speed.y) {\r\n                return new ScrollHelper(scrollParent, speed.x * scrollSpeed, speed.y * scrollSpeed, (scroller) => {\r\n                    let rect = _moveElementToPosition(this, target, event.clientX, event.clientY, pos.offsetX, pos.offsetY, _selectElementRect(container, dragInstance, target, element));\r\n\r\n                    let scrollRect = new Rect(scroller.element);\r\n\r\n                    setElementClientPosition(target, rect, 'translate3d');\r\n\r\n                    if(scrollRect.contains(rect)) {\r\n                        scroller.cancel();\r\n                        scroller = null;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function ScrollArea(selector) {\r\n    return function() {\r\n        let element = selector;\r\n\r\n        if(typeof element === 'string') {\r\n            element = document.querySelector(element);\r\n        }\r\n\r\n        let rect = new Rect(element),\r\n            scroll = getScroll(element);\r\n\r\n        rect.left -= scroll.scrollLeft;\r\n        rect.top -= scroll.scrollTop;\r\n        rect.right = rect.left + element.scrollWidth;\r\n        rect.bottom = rect.top + element.scrollHeight;\r\n\r\n        return rect;\r\n    }\r\n}\r\n\r\n\r\nexport function clone(opacity=null, className=null, zIndex=null) {\r\n    if(typeof opacity === 'object' && opacity.nodeType) {\r\n        return opacity.cloneNode(true);\r\n    }\r\n\r\n    return function(element) {\r\n        let r = element.cloneNode(true);\r\n\r\n        if(opacity !== null) {\r\n            r.style.opacity = opacity;\r\n        }\r\n\r\n        if(className) {\r\n            r.className = className;\r\n        }\r\n\r\n        r.style.position = \"absolute\";\r\n        if(zIndex !== null) r.style.zIndex = zIndex;\r\n\r\n        return r;\r\n    }\r\n}\r\n\r\n\r\nfunction publishDragMoveEvent(self, element, helper, event, rect, bubbles=false, options=null) {\r\n    return dispatchDropEvent(self, 'drag.move', element, helper, event, rect, bubbles, true, true, options);\r\n}\r\n\r\n\r\nfunction publishDragDropEvent(self, element, helper, event, rect, bubbles=true, options=null) {\r\n    return dispatchDropEvent(self, 'drag.drop', element, helper, event, rect, bubbles, true, true, options);\r\n}\r\n\r\n\r\nfunction dispatchDropEvent(self, name, element, helper, originalEvent, currentRect, bubbles=false, dispatch=true, publish=false, detail=null, target=null) {\r\n    let eventPackage = {\r\n        name,\r\n        draggable: self,\r\n        target: helper,\r\n        element,\r\n        item: element, // alias for element\r\n        helper: helper,\r\n        originalEvent: null,\r\n        rect: currentRect\r\n    };\r\n\r\n    if(originalEvent) {\r\n        eventPackage.originalEvent = originalEvent;\r\n        eventPackage.clientX = originalEvent.clientX;\r\n        eventPackage.clientY = originalEvent.clientY;\r\n    }\r\n\r\n    if(!target) {\r\n        target = element;\r\n    }\r\n\r\n    if(detail) {\r\n        Object.assign(eventPackage, detail);\r\n    }\r\n\r\n    if(publish) {\r\n        self.publish(name, eventPackage);\r\n    }\r\n\r\n    if(dispatch) {\r\n        let customEvent = new CustomEvent(name, {\r\n            bubbles,\r\n            detail: eventPackage\r\n        });\r\n\r\n        target.dispatchEvent(customEvent);\r\n    }\r\n}\r\n","import Draggable from \"../../src/core/ui/Draggable\";\r\nimport Overlay from \"../../src/core/ui/Overlay\";\r\nimport Arrow from \"../../src/core/ui/Arrow\";\r\n\r\n\r\nexport default class OverlayTestPage {\r\n    draggable;\r\n    overlay;\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    load() {\r\n        this.draggable = new Draggable('#draggable');\r\n        this.overlay = new Overlay('#overlay1');\r\n        this.arrow = new Arrow();\r\n        // this.overlay.fit = 'xy';\r\n\r\n        this.arrow.parent = this.overlay.element.querySelector('.overlay-body');\r\n        this.arrow.target = this.draggable.element;\r\n\r\n        this.overlay.setArrow(this.arrow);\r\n        this.overlay.target = document.querySelector('#draggable');\r\n        this.overlay.container = document.querySelector('#container');\r\n\r\n        this.overlay.addPlacement('top', {\r\n            my: \"bottom\",\r\n            at: \"top\",\r\n            of: \"border-top\",\r\n            arrow: \"bottom\",\r\n        });\r\n\r\n        this.overlay.addPlacement('right', {\r\n            my: \"left\",\r\n            at: \"right\",\r\n            of: \"border-right\",\r\n            arrow: \"left\"\r\n        });\r\n\r\n        this.overlay.addPlacement('bottom', {\r\n            my: \"top\",\r\n            at: \"bottom\",\r\n            of: \"border-bottom\",\r\n            arrow: \"top\"\r\n        });\r\n\r\n        this.overlay.addPlacement(\"left\", {\r\n            my: \"right\",\r\n            at: \"left\",\r\n            of: \"border-left\",\r\n            arrow: \"right\"\r\n        });\r\n\r\n        this.draggable.on('drag.move', (data) => {\r\n            this.overlay.position();\r\n        });\r\n\r\n        this.overlay.position();\r\n    }\r\n}\r\n"],"sourceRoot":""}