{"version":3,"sources":["webpack://pendora/./src/core/ui/Arrow.js","webpack://pendora/./tests/src/test_overlay2.js"],"names":["Arrow","placement","align","element","document","createElement","className","parent","target","dataset","placementString","split","render","direction","style","left","right","top","bottom","parentRect","Rect","offsetParent","targetRect","pos","position","my","at","of","fitX","fitY","setElementClientPosition","value","Component","OverlayTestPage","draggable","Draggable","overlay","Overlay","arrow","querySelector","setArrow","container","addPlacement","on","data"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAGA;;;;;IAIqBA,K;;;;;AACjB;;;;AAMA,mBAAgD;AAAA;;AAAA,QAApCC,SAAoC,uEAA1B,QAA0B;AAAA,QAAhBC,KAAgB,uEAAV,QAAU;;AAAA;;AAC5C,QAAIC,OAAO,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAd;AACAF,WAAO,CAACG,SAAR,GAAoB,OAApB;AAEA,+EAAMH,OAAN;;AAJ4C;AAAA;AAAA;AAAA;;AAM5C,UAAKI,MAAL,GAAc,IAAd;AACA,UAAKC,MAAL,GAAc,IAAd;;AACA,iEAAcN,KAAd;;AAEA,UAAKC,OAAL,CAAaM,OAAb,CAAqBR,SAArB,GAAiCA,SAAjC;AAV4C;AAW/C;;;;;AAoBD;;;;;iCAKaS,e,EAAiB;AAAA,kCACDA,eAAe,CAACC,KAAhB,CAAsB,GAAtB,CADC;AAAA;AAAA,UACrBV,SADqB;AAAA,UACVC,KADU;;AAG1B,WAAKD,SAAL,GAAiBA,SAAjB;AACA,WAAKC,KAAL,GAAaA,KAAK,IAAI,QAAtB;AAEA,WAAKU,MAAL;AACH;;;6BAEQ;AACL,WAAKT,OAAL,CAAaM,OAAb,CAAqBI,SAArB,GAAiC,KAAKA,SAAtC;AACA,WAAKV,OAAL,CAAaW,KAAb,CAAmBC,IAAnB,GAA0B,EAA1B;AACA,WAAKZ,OAAL,CAAaW,KAAb,CAAmBE,KAAnB,GAA2B,EAA3B;AACA,WAAKb,OAAL,CAAaW,KAAb,CAAmBG,GAAnB,GAAyB,EAAzB;AACA,WAAKd,OAAL,CAAaW,KAAb,CAAmBI,MAAnB,GAA4B,EAA5B;AAEA,UAAIC,UAAU,GAAG,IAAIC,qDAAJ,CAAS,KAAKb,MAAL,IAAe,KAAKJ,OAAL,CAAakB,YAArC,CAAjB;AAAA,UACIC,UAAU,GAAG,KAAKd,MAAL,GAAc,IAAIY,qDAAJ,CAAS,KAAKZ,MAAd,CAAd,GAAsC,IADvD;AAAA,UAEIe,GAAG,GAAG,IAAIH,qDAAJ,CAAS,KAAKjB,OAAd,CAFV;;AAIA,UAAG,KAAKF,SAAL,KAAmB,KAAtB,EAA6B;AACzB,YAAG,KAAKC,KAAL,KAAe,OAAlB,EAA2B;AACvBqB,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,aAAL;AAAoBC,cAAE,EAAE,UAAxB;AAAoCC,cAAE,EAAER;AAAxC,WAAb,CAAN;AACH,SAFD,MAEO,IAAG,KAAKjB,KAAL,KAAe,KAAlB,EAAyB;AAC5BqB,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,cAAL;AAAqBC,cAAE,EAAE,WAAzB;AAAsCC,cAAE,EAAER;AAA1C,WAAb,CAAN;AACH,SAFM,MAEA;AACHI,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,QAAL;AAAeC,cAAE,EAAE,KAAnB;AAA0BC,cAAE,EAAER;AAA9B,WAAb,CAAN;AACH;;AAED,YAAGG,UAAH,EAAeC,GAAG,GAAGA,GAAG,CAACK,IAAJ,CAASN,UAAT,CAAN;AACfC,WAAG,GAAGA,GAAG,CAACK,IAAJ,CAAST,UAAT,CAAN;AACH,OAXD,MAWO,IAAG,KAAKlB,SAAL,KAAmB,OAAtB,EAA+B;AAClC,YAAG,KAAKC,KAAL,KAAe,OAAlB,EAA2B;AACvBqB,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,UAAL;AAAiBC,cAAE,EAAE,WAArB;AAAkCC,cAAE,EAAER;AAAtC,WAAb,CAAN;AACH,SAFD,MAEO,IAAG,KAAKjB,KAAL,KAAe,KAAlB,EAAyB;AAC5BqB,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,aAAL;AAAoBC,cAAE,EAAE,cAAxB;AAAwCC,cAAE,EAAER;AAA5C,WAAb,CAAN;AACH,SAFM,MAEA;AACHI,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,MAAL;AAAaC,cAAE,EAAE,OAAjB;AAA0BC,cAAE,EAAER;AAA9B,WAAb,CAAN;AACH;;AAED,YAAGG,UAAH,EAAeC,GAAG,GAAGA,GAAG,CAACM,IAAJ,CAASP,UAAT,CAAN;AACfC,WAAG,GAAGA,GAAG,CAACM,IAAJ,CAASV,UAAT,CAAN;AACH,OAXM,MAWA,IAAG,KAAKlB,SAAL,KAAmB,QAAtB,EAAgC;AACnC,YAAG,KAAKC,KAAL,KAAe,OAAlB,EAA2B;AACvBqB,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,UAAL;AAAiBC,cAAE,EAAE,aAArB;AAAoCC,cAAE,EAAER;AAAxC,WAAb,CAAN;AACH,SAFD,MAEO,IAAG,KAAKjB,KAAL,KAAe,KAAlB,EAAyB;AAC5BqB,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,WAAL;AAAkBC,cAAE,EAAE,cAAtB;AAAsCC,cAAE,EAAER;AAA1C,WAAb,CAAN;AACH,SAFM,MAEA;AACHI,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,KAAL;AAAYC,cAAE,EAAE,QAAhB;AAA0BC,cAAE,EAAER;AAA9B,WAAb,CAAN;AACH;;AAED,YAAGG,UAAH,EAAeC,GAAG,GAAGA,GAAG,CAACK,IAAJ,CAASN,UAAT,CAAN;AACfC,WAAG,GAAGA,GAAG,CAACK,IAAJ,CAAST,UAAT,CAAN;AACH,OAXM,MAWA,IAAG,KAAKlB,SAAL,KAAmB,MAAtB,EAA8B;AACjC,YAAG,KAAKC,KAAL,KAAe,OAAlB,EAA2B;AACvBqB,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,WAAL;AAAkBC,cAAE,EAAE,UAAtB;AAAkCC,cAAE,EAAER;AAAtC,WAAb,CAAN;AACH,SAFD,MAEO,IAAG,KAAKjB,KAAL,KAAe,KAAlB,EAAyB;AAC5BqB,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,cAAL;AAAqBC,cAAE,EAAE,aAAzB;AAAwCC,cAAE,EAAER;AAA5C,WAAb,CAAN;AACH,SAFM,MAEA;AACHI,aAAG,GAAGA,GAAG,CAACC,QAAJ,CAAa;AAACC,cAAE,EAAE,OAAL;AAAcC,cAAE,EAAE,MAAlB;AAA0BC,cAAE,EAAER;AAA9B,WAAb,CAAN;AACH;;AAED,YAAGG,UAAH,EAAeC,GAAG,GAAGA,GAAG,CAACM,IAAJ,CAASP,UAAT,CAAN;AACfC,WAAG,GAAGA,GAAG,CAACM,IAAJ,CAASV,UAAT,CAAN;AACH;;AAEDW,gFAAwB,CAAC,KAAK3B,OAAN,EAAeoB,GAAf,CAAxB;AACH;;;sBA1FSQ,K,EAAO;AACb,0CAAcA,KAAd;;AACA,WAAKnB,MAAL;AACH,K;wBAEW;AACR,mCAAO,IAAP;AACH;;;sBAEamB,K,EAAO;AACjB,WAAK5B,OAAL,CAAaM,OAAb,CAAqBR,SAArB,GAAiC8B,KAAjC;AACA,WAAKnB,MAAL;AACH,K;wBAEe;AACZ,aAAO,KAAKT,OAAL,CAAaM,OAAb,CAAqBR,SAA5B;AACH;;;;EApC8B+B,kD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACTnC;AACA;AACA;;IAGqBC,e;;;AAIjB,6BAAc;AAAA;;AAAA;;AAAA;AAEb;;;;2BAEM;AAAA;;AACH,WAAKC,SAAL,GAAiB,IAAIC,8DAAJ,CAAc,YAAd,CAAjB;AACA,WAAKC,OAAL,GAAe,IAAIC,4DAAJ,CAAY,WAAZ,CAAf;AACA,WAAKC,KAAL,GAAa,IAAItC,0DAAJ,EAAb,CAHG,CAIH;;AAEA,WAAKsC,KAAL,CAAW/B,MAAX,GAAoB,KAAK6B,OAAL,CAAajC,OAAb,CAAqBoC,aAArB,CAAmC,eAAnC,CAApB;AACA,WAAKD,KAAL,CAAW9B,MAAX,GAAoB,KAAK0B,SAAL,CAAe/B,OAAnC;AAEA,WAAKiC,OAAL,CAAaI,QAAb,CAAsB,KAAKF,KAA3B;AACA,WAAKF,OAAL,CAAa5B,MAAb,GAAsBJ,QAAQ,CAACmC,aAAT,CAAuB,YAAvB,CAAtB;AACA,WAAKH,OAAL,CAAaK,SAAb,GAAyBrC,QAAQ,CAACmC,aAAT,CAAuB,YAAvB,CAAzB;AAEA,WAAKH,OAAL,CAAaM,YAAb,CAA0B,KAA1B,EAAiC;AAC7BjB,UAAE,EAAE,QADyB;AAE7BC,UAAE,EAAE,KAFyB;AAG7BC,UAAE,EAAE,YAHyB;AAI7BW,aAAK,EAAE;AAJsB,OAAjC;AAOA,WAAKF,OAAL,CAAaM,YAAb,CAA0B,OAA1B,EAAmC;AAC/BjB,UAAE,EAAE,MAD2B;AAE/BC,UAAE,EAAE,OAF2B;AAG/BC,UAAE,EAAE,cAH2B;AAI/BW,aAAK,EAAE;AAJwB,OAAnC;AAOA,WAAKF,OAAL,CAAaM,YAAb,CAA0B,QAA1B,EAAoC;AAChCjB,UAAE,EAAE,KAD4B;AAEhCC,UAAE,EAAE,QAF4B;AAGhCC,UAAE,EAAE,eAH4B;AAIhCW,aAAK,EAAE;AAJyB,OAApC;AAOA,WAAKF,OAAL,CAAaM,YAAb,CAA0B,MAA1B,EAAkC;AAC9BjB,UAAE,EAAE,OAD0B;AAE9BC,UAAE,EAAE,MAF0B;AAG9BC,UAAE,EAAE,aAH0B;AAI9BW,aAAK,EAAE;AAJuB,OAAlC;AAOA,WAAKJ,SAAL,CAAeS,EAAf,CAAkB,gBAAlB,EAAoC,UAACC,IAAD,EAAU;AAC1C,aAAI,CAACR,OAAL,CAAaZ,QAAb;AACH,OAFD;AAIA,WAAKY,OAAL,CAAaZ,QAAb;AACH","file":"chunk-16.bundle.js","sourcesContent":["import Component from \"../Component\";\r\nimport Rect from \"../vectors/Rect\";\r\nimport {setElementClientPosition} from \"./position\";\r\n\r\n\r\n/**\r\n * A class that creates an arrow that can be placed at the edge of elements that will point towards the target element.\r\n * The arrow will be positioned to be as close to the target why still fitting inside it's parent.\r\n */\r\nexport default class Arrow extends Component {\r\n    /**\r\n     * The starting alignment of the arrow.\r\n     * Can be start, end, or center.\r\n     */\r\n    #align;\r\n\r\n    constructor(placement=\"bottom\", align=\"center\") {\r\n        let element = document.createElement('div');\r\n        element.className = \"arrow\";\r\n\r\n        super(element);\r\n\r\n        this.parent = null;\r\n        this.target = null;\r\n        this.#align = align;\r\n\r\n        this.element.dataset.placement = placement;\r\n    }\r\n\r\n    set align(value) {\r\n        this.#align = value;\r\n        this.render();\r\n    }\r\n\r\n    get align() {\r\n        return this.#align;\r\n    }\r\n\r\n    set placement(value) {\r\n        this.element.dataset.placement = value;\r\n        this.render();\r\n    }\r\n\r\n    get placement() {\r\n        return this.element.dataset.placement;\r\n    }\r\n\r\n    /**\r\n     * Sets the placement and align of the arrow.  Can take a string of placement-align separated by a dash.\r\n     *\r\n     * @param placementString\r\n     */\r\n    setPlacement(placementString) {\r\n        let [placement, align] = placementString.split(\"-\");\r\n\r\n        this.placement = placement;\r\n        this.align = align || \"center\";\r\n\r\n        this.render();\r\n    }\r\n\r\n    render() {\r\n        this.element.dataset.direction = this.direction;\r\n        this.element.style.left = \"\";\r\n        this.element.style.right = \"\";\r\n        this.element.style.top = \"\";\r\n        this.element.style.bottom = \"\";\r\n\r\n        let parentRect = new Rect(this.parent || this.element.offsetParent),\r\n            targetRect = this.target ? new Rect(this.target) : null,\r\n            pos = new Rect(this.element);\r\n\r\n        if(this.placement === \"top\") {\r\n            if(this.align === \"start\") {\r\n                pos = pos.position({my: \"left bottom\", at: \"left top\", of: parentRect});\r\n            } else if(this.align === \"end\") {\r\n                pos = pos.position({my: \"right bottom\", at: \"right top\", of: parentRect});\r\n            } else {\r\n                pos = pos.position({my: \"bottom\", at: \"top\", of: parentRect});\r\n            }\r\n\r\n            if(targetRect) pos = pos.fitX(targetRect);\r\n            pos = pos.fitX(parentRect);\r\n        } else if(this.placement === \"right\") {\r\n            if(this.align === \"start\") {\r\n                pos = pos.position({my: \"left top\", at: \"right top\", of: parentRect});\r\n            } else if(this.align === \"end\") {\r\n                pos = pos.position({my: \"left bottom\", at: \"right bottom\", of: parentRect});\r\n            } else {\r\n                pos = pos.position({my: \"left\", at: \"right\", of: parentRect});\r\n            }\r\n\r\n            if(targetRect) pos = pos.fitY(targetRect);\r\n            pos = pos.fitY(parentRect);\r\n        } else if(this.placement === \"bottom\") {\r\n            if(this.align === \"start\") {\r\n                pos = pos.position({my: \"left top\", at: \"left bottom\", of: parentRect});\r\n            } else if(this.align === \"end\") {\r\n                pos = pos.position({my: \"right top\", at: \"right bottom\", of: parentRect});\r\n            } else {\r\n                pos = pos.position({my: \"top\", at: \"bottom\", of: parentRect});\r\n            }\r\n\r\n            if(targetRect) pos = pos.fitX(targetRect);\r\n            pos = pos.fitX(parentRect);\r\n        } else if(this.placement === \"left\") {\r\n            if(this.align === \"start\") {\r\n                pos = pos.position({my: \"right top\", at: \"left top\", of: parentRect});\r\n            } else if(this.align === \"end\") {\r\n                pos = pos.position({my: \"right bottom\", at: \"left bottom\", of: parentRect});\r\n            } else {\r\n                pos = pos.position({my: \"right\", at: \"left\", of: parentRect});\r\n            }\r\n\r\n            if(targetRect) pos = pos.fitY(targetRect);\r\n            pos = pos.fitY(parentRect);\r\n        }\r\n\r\n        setElementClientPosition(this.element, pos);\r\n    }\r\n}\r\n","import Draggable from \"../../src/core/ui/Draggable\";\r\nimport Overlay from \"../../src/core/ui/Overlay\";\r\nimport Arrow from \"../../src/core/ui/Arrow\";\r\n\r\n\r\nexport default class OverlayTestPage {\r\n    draggable;\r\n    overlay;\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    load() {\r\n        this.draggable = new Draggable('#draggable');\r\n        this.overlay = new Overlay('#overlay1');\r\n        this.arrow = new Arrow();\r\n        // this.overlay.fit = 'xy';\r\n\r\n        this.arrow.parent = this.overlay.element.querySelector('.overlay-body');\r\n        this.arrow.target = this.draggable.element;\r\n\r\n        this.overlay.setArrow(this.arrow);\r\n        this.overlay.target = document.querySelector('#draggable');\r\n        this.overlay.container = document.querySelector('#container');\r\n\r\n        this.overlay.addPlacement('top', {\r\n            my: \"bottom\",\r\n            at: \"top\",\r\n            of: \"border-top\",\r\n            arrow: \"bottom\",\r\n        });\r\n\r\n        this.overlay.addPlacement('right', {\r\n            my: \"left\",\r\n            at: \"right\",\r\n            of: \"border-right\",\r\n            arrow: \"left\"\r\n        });\r\n\r\n        this.overlay.addPlacement('bottom', {\r\n            my: \"top\",\r\n            at: \"bottom\",\r\n            of: \"border-bottom\",\r\n            arrow: \"top\"\r\n        });\r\n\r\n        this.overlay.addPlacement(\"left\", {\r\n            my: \"right\",\r\n            at: \"left\",\r\n            of: \"border-left\",\r\n            arrow: \"right\"\r\n        });\r\n\r\n        this.draggable.on('draggable.move', (data) => {\r\n            this.overlay.position();\r\n        });\r\n\r\n        this.overlay.position();\r\n    }\r\n}\r\n"],"sourceRoot":""}