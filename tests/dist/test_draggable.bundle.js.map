{"version":3,"sources":["webpack://pendora/webpack/universalModuleDefinition","webpack://pendora/webpack/bootstrap","webpack://pendora/./src/core/Publisher.js","webpack://pendora/./src/core/data.js","webpack://pendora/./src/core/errors.js","webpack://pendora/./src/core/fx/Animation.js","webpack://pendora/./src/core/fx/FX.js","webpack://pendora/./src/core/fx/easing.js","webpack://pendora/./src/core/fx/frame.js","webpack://pendora/./src/core/fx/types.js","webpack://pendora/./src/core/ui/Draggable.js","webpack://pendora/./src/core/ui/Draggable2.js","webpack://pendora/./src/core/ui/Sortable.js","webpack://pendora/./src/core/ui/position.js","webpack://pendora/./src/core/utility/debounce.js","webpack://pendora/./src/core/utility/decorators.js","webpack://pendora/./src/core/utility/dom.js","webpack://pendora/./src/core/utility/index.js","webpack://pendora/./src/core/utility/iter.js","webpack://pendora/./src/core/utility/math.js","webpack://pendora/./src/core/utility/object.js","webpack://pendora/./src/core/vectors/RGBA.js","webpack://pendora/./src/core/vectors/Rect.js","webpack://pendora/./src/core/vectors/Vec2.js","webpack://pendora/./src/core/vectors/Vec3.js","webpack://pendora/./src/core/vectors/Vec4.js","webpack://pendora/./src/core/vectors/index.js","webpack://pendora/./tests/src/test_draggable.js"],"names":["TOPICS","Symbol","STOP","Publisher","topic","callback","push","fn","on","off","args","apply","arguments","length","callbacks","i","cb","splice","slice","e","uuid","prefix","Math","random","replace","Data","expando","owner","cache","acceptData","nodeType","Object","defineProperty","value","configurable","key","prop","undefined","set","get","keys","isEmptyObject","privateCache","ExtendableError","message","name","constructor","Error","captureStackTrace","stack","IndexError","KeyError","ValueError","NotImplemented","ValidationError","node","children","AssertionError","UnitError","assert","condition","Animation","duration","frames","applyFrame","defaultApplyFrame","bubbleFrameEvent","finishFrame","element","easing","onStart","onFrame","onPause","onCancel","onEnd","onComplete","FX","animation","fx","EASING","linear","position","autoPlay","init","call","destroy","play","animate","complete","config","defaults","_options","assign","canceled","paused","pending","error","playing","regNumberWithUnit","regColor","regFunction","TYPE_FUNCTIONS","hex","RGBA","parseHexColorStringArg","rgb","parseRGBAColorStringArgs","rgba","DeadFXError","assertFXAlive","status","doPromiseAction","onAction","resolveOrReject","_prepareValue","trim","m","exec","NumberWithUnit","parseFloat","_getFrames","r","keyframeIndex","hasOwnProperty","frame","property","toStringTag","selectElement","pos","freeze","properties","sort","a","b","startPosition","startValue","endPosition","endValue","getFrameFX","options","p","delta","subtract","add","scalar","tick","performance","now","frameFN","timestamp","dispatchEvent","CustomEvent","bubbles","detail","window","requestAnimationFrame","_complete","cancelAnimationFrame","_triggerEndEvent","completeAnimation","_cancel","getFrame","onResolve","state","onReject","Promise","resolve","reject","onFinally","then","style","toString","unit","TypeError","cursor","clientX","clientY","boundingRect","x","left","y","top","clone","opacity","draggable","helper","cloneNode","_getScrollParent","o","parentElement","scrollWidth","clientWidth","scrollHeight","clientHeight","_translate","target","transform","CONTAINERS","client","height","innerHeight","width","innerWidth","right","bottom","viewport","parent","bb","getBoundingClientRect","scrollLeft","scrollTop","_clampPositionToContainer","rect","container","closest","clamp","TOLERANCE_FUNCTIONS","intersect","droppable","item","origin","Draggable","axis","exclude","delay","offset","disabled","distance","handle","revert","scroll","selector","droppables","tolerance","setHelperSize","grid","document","querySelector","_onMouseDown","onMouseDown","bind","Array","isArray","addDroppables","addEventListener","isDragging","_revertFX","concat","event","contains","data","excluded","preventDefault","doc","startMouseDocumentX","scrollX","startMouseDocumentY","scrollY","mouseDocumentX","mouseDocumentY","startDragging","startDrag","timer","onTimeout","removeEventListener","onMouseUp","clearTimeout","setTimeout","onMouseMove","sqrt","startMouseX","startMouseY","posX","posY","cancel","getDropTargets","startBoundingBox","startBBDocument","clientRectToDocumentSpace","scrollTick","boxSizing","appendChild","startingTranslation","getTranslation","_offset","startingRect","_getPosition","dropData","setElementClientPosition","_getDropData","intersectsBefore","intersectsAfter","_dispatchDroppableEvent","_triggerEvent","details","mouseX","mouseY","originalEvent","lastTick","parentBB","helperBB","isOOB","classList","remove","translation","accepted","accept","isAccepted","startX","removeChild","documentRectToClientSpace","dropped","_intersects","dataset","relatedTarget","startingBoundingClientRect","type","querySelectorAll","indexOf","endingRect","dropBox","eventName","publish","dropElement","customEvent","snapToGrid","reg_percentage_test","Rect","buildTestIntersectionFunction","amount","targetRect","intersection","getArea","Draggable2","resistance","revertDuration","scrollSpeed","WeakMap","pageXOffset","pageYOffset","currentPosition","cancelMouseTracking","cancelTimer","distanceBrokenPromise","isDistanceBroken","calcDistance","timerPromise","all","timerStatus","distanceStatus","offsetX","offsetY","startingX","startingY","mousePosition","scroller","dropTargets","startingClientRect","translate","pointerEvents","refreshDropTargets","currentDropTargets","dropTarget","dispatchDropEvent","_moveElementToPosition","_selectElementRect","ScrollHelper","buildScrollHelper","publishDragMoveEvent","isDefaultPrevented","reverted","publishDragDropEvent","_revert","mousePos","testFunction","test","starting","self","moveTo","floor","fit","dragInstance","originalTarget","_getScrollRect","nodeName","scrollXSpeed","scrollYSpeed","frameID","scrollParentRect","scrollParent","speed","getScrollSpeed","scrollRect","ScrollArea","getScroll","className","zIndex","currentRect","dispatch","eventPackage","placeholder","createElement","box","Sortable","items","layout","dropOnEmpty","accepts","setPlaceholderSize","connect","initEvents","disconnect","hasDroppable","isOver","initialize","onDragMove","onDragComplete","onSortAppend","startBB","insertBefore","matches","prototype","getItems","filter","before","getItemBeforePoint","after","getItemAfterPoint","beforeBB","_refreshPositions","_triggerSortAppendEvent","nextSibling","mx","my","getRelativePosition","current","deltaLeft","deltaTop","regMatrix","getOffsetElement","getComputedStyle","getClientRect","getBoundingOffsetRect","offsetParent","offsetRect","getRootContainingClientRect","getBoundingDocumentRect","Vec3","split","setTranslation","z","getCssPosition","Vec2","parseInt","setCssPosition","method","positionType","deltaX","deltaY","console","log","cssPosition","fromRect","gridSize","roundingFunction","round","Number","isNaN","convertDomRectToObject","domRect","getPointOnElement","referenceElement","point","constrain","getSubBoundingBox","getDistanceBetweenRects","rect1","rect2","vec1","vec2","isXOverlapping","isYOverlapping","min","abs","x1","y1","x2","y2","pow","getElementOffset","setElementOffset","coords","debounce","wait","timeout","later","proto","descriptor","placement","REG_WHITESPACE","parseHTML","html","template","innerHTML","content","fragment","createDocumentFragment","firstChild","createFragment","addClasses","classes","removeClasses","assignAttributes","attributes","setAttribute","context","jquery","emptyElement","isWindow","setScroll","scrollTo","findChild","child","l","filterChildren","variable","setInterval","values","enumerate","chain","object","iterable","iterables","iter","firstValue","any","minValue","maxValue","max","modulo","mod","randomChoice","array","arraysEqual","array1","array2","getOwnProperty","obj","propName","defaultValue","getPropertyByPath","path","parts","part","rangeFindItem","predicate","startingIndex","endingIndex","regPercentage","g","substring","substr","Vec4","regWhitespace","regPositionPart","positionShortHandValues","topleft","topright","bottomleft","bottomright","domElement","_new","anchor","getAnchor","closestX","closestY","at","of","inside","collision","evaluatePositionString","reference","containsX","reflect","getCenterPoint","containsY","fitX","fitY","string","rx","ry","_evaluatePositionStringComponent","direction","restore","documentElement","vec4","vertex","vec3","valueOrVec4","draggableBox1","CLONE","draggableWindow1","draggableBox2","draggableScrollable","sortableGrid","sortableList1","sortableList2","backgroundColor","output","getElementById","innerText"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;QACA;QACA;QACA;;QAEA;QACA;QACA;QACA,QAAQ,oBAAoB;QAC5B;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA,iBAAiB,4BAA4B;QAC7C;QACA;QACA,kBAAkB,2BAA2B;QAC7C;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;;QAEA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;QAEA;QACA;QACA;QACA;QACA,gBAAgB,uBAAuB;QACvC;;;QAGA;QACA;QACA;QACA;;;;;;;;;;;;;;;;;;;;;;ACvJA,IAAIA,MAAM,GAAGC,MAAM,CAAC,QAAD,CAAnB;AAGO,SAASC,IAAT,GAAgB;AACnB,QAAMA,IAAN;AACH;;IAGoBC,S;;;AACjB,uBAAc;AAAA;;AACV,SAAKH,MAAL,IAAe,EAAf;AACH;;;;uBAEEI,K,EAAOC,Q,EAAU;AAChB,UAAG,CAAC,KAAKL,MAAL,EAAaI,KAAb,CAAJ,EAAyB,KAAKJ,MAAL,EAAaI,KAAb,IAAsB,EAAtB;AACzB,WAAKJ,MAAL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","file":"test_draggable.bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pendora\"] = factory();\n\telse\n\t\troot[\"pendora\"] = factory();\n})(window, function() {\nreturn "," \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"test_draggable\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/tests/dist/\";\n\n \tvar jsonpArray = window[\"webpackJsonppendora\"] = window[\"webpackJsonppendora\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1,\"vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","let TOPICS = Symbol('topics');\r\n\r\n\r\nexport function STOP() {\r\n    throw STOP;\r\n}\r\n\r\n\r\nexport default class Publisher {\r\n    constructor() {\r\n        this[TOPICS] = {};\r\n    }\r\n\r\n    on(topic, callback) {\r\n        if(!this[TOPICS][topic]) this[TOPICS][topic] = [];\r\n        this[TOPICS][topic].push(callback);\r\n        return this;\r\n    }\r\n\r\n    once(topic, fn) {\r\n        let on = (...args) => {\r\n            this.off(topic, fn);\r\n            return fn.apply(this, args);\r\n        };\r\n\r\n        on.fn = fn;\r\n        this.on(topic, fn);\r\n        return this;\r\n    }\r\n\r\n    off(topic, callback) {\r\n        if(arguments.length === 0) {\r\n            // CLear all topics.\r\n            this[TOPICS] = {};\r\n            return this;\r\n        } else if(arguments.length === 1) {\r\n            // Clear single topic.\r\n            this[TOPICS][topic] = [];\r\n            return this;\r\n        }\r\n\r\n        if(!this[TOPICS] || !this[TOPICS][topic] || !this[TOPICS][topic].length) {\r\n            // Topic list was either empty or didn't exist.  No need to remove anything.  Return;\r\n            return this;\r\n        }\r\n\r\n        let callbacks = this[TOPICS][topic];\r\n\r\n        for(let i = 0; i < callback.length; i++) {\r\n            let cb = callbacks[i];\r\n            if(cb === callback || cb.fn === callback) {\r\n                callbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(callbacks.length === 0) {\r\n            delete this[TOPICS][topic];\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    hasEvent(topic, callback) {\r\n        if(arguments.length === 1) {\r\n            return !!this[TOPICS][topic];\r\n        } else {\r\n            let callbacks = this[TOPICS][topic];\r\n\r\n            for(let i = 0; i < callbacks.length; i++) {\r\n                let cb = callbacks[i];\r\n                if(cb === callback || cb.fn === callback) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    publish(topic, ...args) {\r\n        if(this[TOPICS][topic]) {\r\n            let callbacks = this[TOPICS][topic].slice(0);\r\n\r\n            for(let cb of callbacks) {\r\n                try {\r\n                    cb.apply(this, args);\r\n                } catch (e) {\r\n                    if(e === STOP) {\r\n                        return e;\r\n                    } else {\r\n                        throw e;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n}\r\n","import {isEmptyObject} from \"./utility\";\r\n\r\n\r\nlet uuid = 1,\r\n    prefix = 'p-' + (''+Math.random()).replace(/\\D/g, '');\r\n\r\n\r\nexport class Data {\r\n    constructor() {\r\n        this.expando = `${prefix}-${uuid++}`;\r\n    }\r\n\r\n    static acceptData(owner) {\r\n        return owner.nodeType === 1 || owner.nodeType === 9 || !(+owner.nodeType);\r\n    }\r\n\r\n    cache(owner) {\r\n        let cache = owner[this.expando];\r\n\r\n        if(!cache) {\r\n            cache = {};\r\n\r\n            if(Data.acceptData(owner)) {\r\n                if(owner.nodeType) {\r\n                    owner[this.expando] = cache;\r\n                } else {\r\n                    Object.defineProperty(owner, this.expando, {\r\n                        value: cache,\r\n                        configurable: true\r\n                    });\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        return cache;\r\n    }\r\n\r\n    set(owner, key, value) {\r\n        let cache = this.cache(owner);\r\n\r\n        if(typeof key === 'object') {\r\n            for(let prop in key) {\r\n                cache[prop] = key[prop];\r\n            }\r\n        } else {\r\n            cache[key] = value;\r\n        }\r\n\r\n        return cache;\r\n    }\r\n\r\n    get(owner, key) {\r\n        if(key === undefined) {\r\n            return this.cache(owner);\r\n        } else {\r\n            let cache = owner[this.expando];\r\n\r\n            if(cache) {\r\n                return cache[key];\r\n            }\r\n        }\r\n    }\r\n\r\n    access(owner, key, value) {\r\n        if(arguments.length === 2) {\r\n            if(typeof key === 'object') {\r\n                return this.set(owner, key);\r\n            } else {\r\n                return this.get(owner, key);\r\n            }\r\n        } else if(arguments.length === 1) {\r\n            return this.cache(owner);\r\n        } else if(arguments.length === 3) {\r\n            return this.set(owner, key, value);\r\n        }\r\n    }\r\n\r\n    remove(owner, ...keys) {\r\n        let cache = owner[this.expando];\r\n\r\n        if(!cache) return;\r\n\r\n        if(arguments.length === 1) {\r\n            if(owner.nodeType) {\r\n                owner[this.expando] = undefined;\r\n            } else {\r\n                delete owner[this.expando];\r\n            }\r\n        } else {\r\n            for(let key of keys) {\r\n                delete cache[key];\r\n            }\r\n        }\r\n    }\r\n\r\n    hasData(owner) {\r\n        let cache = owner[this.expando];\r\n        return cache && !isEmptyObject(cache);\r\n    }\r\n}\r\n\r\n\r\nexport let privateCache = new Data();","\r\nexport class ExtendableError extends Error {\r\n    constructor(message) {\r\n        // noinspection JSCheckFunctionSignatures\r\n        super(message);\r\n        this.name = this.constructor.name;\r\n\r\n        // noinspection JSUnresolvedVariable\r\n        if(typeof Error.captureStackTrace === 'function') {\r\n            // noinspection JSUnresolvedFunction\r\n            Error.captureStackTrace(this, this.constructor);\r\n        } else {\r\n            this.stack = (new Error(message)).stack;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class IndexError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class KeyError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class ValueError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class NotImplemented extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class ValidationError extends ExtendableError {\r\n    constructor(message, node) {\r\n        super(message);\r\n        this.node = node;\r\n        this.children = [];\r\n    }\r\n}\r\n\r\n\r\nexport class AssertionError extends ExtendableError {\r\n    constructor(message) {\r\n        super(message);\r\n    }\r\n}\r\n\r\n\r\nexport class UnitError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\n/**\r\n * Asserts that a condition is true or raises an AssertionError.\r\n * @param condition - condition to check.\r\n * @param message - message on fail.\r\n * @throws AssertionError\r\n */\r\nexport function assert(condition, message) {\r\n    if (!condition) {\r\n        throw new AssertionError(message);\r\n    }\r\n}\r\n","import {EASING} from \"./easing\";\r\nimport FX from \"./FX\";\r\nimport {defaultApplyFrame} from \"./frame\";\r\n\r\n\r\nexport default class Animation {\r\n    static defaultApplyFrame = defaultApplyFrame;\r\n\r\n    static complete = FX.complete;\r\n    static canceled = FX.canceled;\r\n    static paused = FX.paused;\r\n    static pending = FX.pending;\r\n    static error = FX.error;\r\n    static playing = FX.playing;\r\n\r\n    /**\r\n     *\r\n     * @param duration\r\n     * @param frames {{}|function(Element element, Animation animation):{}}\r\n     * @param applyFrame - The function that takes a frame and applies it to the element.\r\n     * @param bubbleFrameEvent\r\n     * @param finishFrame\r\n     */\r\n    constructor({duration=null, frames, applyFrame = defaultApplyFrame, bubbleFrameEvent = false, finishFrame = null}) {\r\n        this.frames = frames;\r\n        this.applyFrame = applyFrame || Animation.defaultApplyFrame;\r\n        this.bubbleFrameEvent = bubbleFrameEvent;\r\n        this.finishFrame = finishFrame;\r\n        this.duration = duration;\r\n    }\r\n\r\n    /**\r\n     * Creates an fx object.\r\n     *\r\n     * @param element\r\n     * @param frames\r\n     * @param duration\r\n     * @param applyFrame\r\n     * @param easing\r\n     * @param onStart\r\n     * @param onFrame\r\n     * @param onPause\r\n     * @param onCancel\r\n     * @param onEnd\r\n     * @param onComplete\r\n     * @param bubbleFrameEvent\r\n     * @param finishFrame\r\n     * @returns {FX}\r\n     */\r\n    init({element, frames, duration, applyFrame, easing, onStart, onFrame, onPause, onCancel, onEnd, onComplete, bubbleFrameEvent, finishFrame}) {\r\n        return new FX(element, frames, duration, {\r\n            applyFrame,\r\n            easing,\r\n            animation: this,\r\n            onStart,\r\n            onFrame,\r\n            onPause,\r\n            onCancel,\r\n            onEnd,\r\n            onComplete,\r\n            bubbleFrameEvent,\r\n            finishFrame,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Ran after the fx completes.\r\n     * @param fx\r\n     */\r\n    destroy(fx) {\r\n\r\n    }\r\n\r\n    /**\r\n     * Animates the given element.  Returns the FX object that can be used to control the animation.\r\n     *\r\n     * @param element {HTMLElement|Element} The element to animate.\r\n     * @param duration {Number} The duration of the animation in milliseconds.\r\n     * @param easing {function(Number)} An easing function that controls the rate of change for the animation.  If null linear animation is used.\r\n     * @param onStart {function(FX)} A callback function that is called right before the animation starts playing.\r\n     * @param onFrame {function(FX, frame)} A callback that is called per frame.\r\n     * @param onPause {function(FX)} A callback that is called when the FX pauses.\r\n     * @param onCancel {function(FX)} A callback that is called when the FX cancels.\r\n     * @param onEnd {function(FX)} A callback that is called when the animation ends.  Whether by completing, pausing, or canceling.  See Fx.status to determine what happened.\r\n     * @param onComplete {function(FX)} A callback that is called when the animation complete successfully.\r\n     * @param position\r\n     * @param autoPlay\r\n     * @returns {FX}\r\n     */\r\n    animate(element, {duration=null, easing = EASING.linear, onStart = null, onFrame = null, onPause = null, onCancel = null, onEnd = null, onComplete = null, position=0, autoPlay=true} = {}) {\r\n        if(duration === null) {\r\n            duration = this.duration;\r\n        }\r\n\r\n        let fx = this.init({\r\n            element: element,\r\n            frames: this.frames,\r\n            duration,\r\n            applyFrame: this.applyFrame,\r\n            easing,\r\n            animation: this,\r\n            onStart,\r\n            onFrame,\r\n            onPause,\r\n            onCancel,\r\n            onEnd: (fx) => {\r\n                if(onEnd) onEnd.call(fx, fx);\r\n                this.destroy(fx);\r\n            },\r\n            onComplete,\r\n            bubbleFrameEvent: this.bubbleFrameEvent,\r\n            finishFrame: this.finishFrame\r\n        });\r\n\r\n        if(position) {\r\n            fx.goto(position);\r\n        }\r\n\r\n        if(autoPlay) {\r\n            fx.play();\r\n        }\r\n        return fx;\r\n    }\r\n\r\n    goto(element, position) {\r\n        this.animate(element, {autoPlay: false, position: position});\r\n        return Animation.complete;\r\n    }\r\n\r\n    /**\r\n     * Creates a function that calls the animate method with the bound parameters.\r\n     * Parameters can be overridden in the created function when called.\r\n     * Method has the same signature as the animate method.\r\n     *\r\n     * Usage:\r\n     * let animation = new Animation(...),\r\n     *     fx = animation.bind(null, 2000);\r\n     *\r\n     * fx(element) // Animation the element over 2000 milliseconds.\r\n     *\r\n     * @param element\r\n     * @param config\r\n     * @returns {function(HTMLElement element, Number duration, Object config): FX}\r\n     */\r\n    bind(element = null, config = null) {\r\n        let defaults = {\r\n            element,\r\n            config\r\n        };\r\n\r\n        return (element = defaults, config=null) => {\r\n            element = element === defaults ? element.defaults : element;\r\n\r\n            let _options = {};\r\n            if (defaults.config) Object.assign(_options, defaults.config);\r\n            if (config) Object.assign(_options, config);\r\n\r\n            return this.animate(element, _options);\r\n        };\r\n    }\r\n}\r\n","import {ExtendableError} from \"../errors\";\r\nimport {selectElement} from \"../utility\";\r\nimport {RGBA} from \"../vectors\";\r\nimport {NumberWithUnit} from \"./types\";\r\nimport {EASING} from \"./easing\";\r\nimport {defaultApplyFrame} from \"./frame\";\r\n\r\n\r\nconst regNumberWithUnit = /^(\\d+\\.?\\d*)([a-z]+|%)$/i,\r\n    regColor = /^(?:#([a-f0-9]{3})|#([a-f0-9]{6})|#([a-f0-9]{8}))$/i,\r\n    regFunction = /^([a-z_][a-z_0-9]*)\\((.+?)\\)$/i;\r\n\r\n\r\nconst TYPE_FUNCTIONS = {\r\n    hex: RGBA.parseHexColorStringArg,\r\n    rgb: RGBA.parseRGBAColorStringArgs,\r\n    rgba: RGBA.parseRGBAColorStringArgs\r\n};\r\n\r\n\r\nexport class DeadFXError extends ExtendableError {}\r\n\r\n\r\nfunction assertFXAlive(fx) {\r\n    if (fx.status === FX.complete || fx.status === FX.error || fx.status === FX.complete) {\r\n        throw new DeadFXError(\"FX object is dead.\");\r\n    }\r\n}\r\n\r\n\r\nfunction doPromiseAction(onAction, value, resolveOrReject) {\r\n    if (typeof onAction === 'function') {\r\n        value = onAction(value);\r\n    }\r\n\r\n    resolveOrReject(value);\r\n}\r\n\r\n\r\nfunction _prepareValue(value) {\r\n    if (typeof value === 'string') {\r\n        value = value.trim();\r\n\r\n        let m = regNumberWithUnit.exec(value);\r\n\r\n        if (m) {\r\n            return new NumberWithUnit(parseFloat(m[1]), m[2]);\r\n        }\r\n\r\n        m = regColor.exec(value);\r\n\r\n        if (m) {\r\n            return TYPE_FUNCTIONS.hex(m[0]);\r\n        }\r\n\r\n        m = regFunction.exec(value);\r\n\r\n        if (m) {\r\n            return TYPE_FUNCTIONS[m[1]](m[2]);\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\nfunction _getFrames(fx, element, frames) {\r\n    let r = {};\r\n\r\n    if (typeof frames === 'function') {\r\n        frames = frames.call(fx, element, fx);\r\n    }\r\n\r\n    for (let keyframeIndex in frames) {\r\n        if (!frames.hasOwnProperty(keyframeIndex)) continue;\r\n\r\n        let frame = frames[keyframeIndex];\r\n        r[keyframeIndex] = {};\r\n\r\n        for (let property in frame) {\r\n            if (!frame.hasOwnProperty(property)) continue;\r\n            r[keyframeIndex][property] = _prepareValue(frame[property]);\r\n        }\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * @implements Promise\r\n */\r\nexport default class FX {\r\n    static pending = \"Pending\";\r\n    static complete = \"Complete\";\r\n    static error = \"Error\";\r\n    static paused = \"Paused\";\r\n    static canceled = \"Canceled\";\r\n    static playing = \"Playing\";\r\n\r\n    #element;\r\n    #chained;\r\n    #frames;\r\n    #internalValue;\r\n\r\n    #animation;\r\n\r\n    #frameId;\r\n    #status;\r\n    #position;\r\n\r\n    #finishFrame;\r\n    #applyFrame;\r\n    #easing;\r\n    #duration;\r\n\r\n    [Symbol.toStringTag] = \"[Object FX]\";\r\n\r\n    constructor(element, frames, duration, {applyFrame = defaultApplyFrame, animation = null, easing = EASING.linear, onComplete = null, onCancel = null, onFrame = null, onStart = null, onEnd = null, bubbleFrameEvent = false, finishFrame = null, init = null} = {}) {\r\n        this.#frames = [];\r\n        this.#chained = [];\r\n        this.#element = selectElement(element);\r\n        this.#internalValue = undefined;\r\n\r\n        this.onComplete = onComplete;\r\n        this.onCancel = onCancel;\r\n        this.onFrame = onFrame;\r\n        this.onStart = onStart;\r\n        this.onEnd = onEnd;\r\n        this.bubbleFrameEvent = bubbleFrameEvent;\r\n\r\n        this.#animation = animation;\r\n        this.#finishFrame = finishFrame;\r\n        this.#applyFrame = applyFrame;\r\n        this.#easing = easing;\r\n        this.#frameId = null;\r\n        this.#status = FX.pending;\r\n\r\n        this.#duration = duration;\r\n        this.#position = 0;\r\n\r\n        if (init) {\r\n            init.call(this, this);\r\n        }\r\n\r\n        // Prepare frames\r\n        frames = _getFrames(this, this.#element, frames);\r\n\r\n        for (let key in frames) {\r\n            if (frames.hasOwnProperty(key)) {\r\n                let frame = frames[key],\r\n                    pos = parseFloat(key) / 100;\r\n\r\n                if (typeof frame === 'function') {\r\n                    frame = frame.call(this, this.#element);\r\n                }\r\n\r\n                frame = Object.freeze(Object.assign({}, frame));\r\n\r\n                this.#frames.push(Object.freeze({\r\n                    position: pos,\r\n                    properties: frame\r\n                }));\r\n            }\r\n        }\r\n\r\n        this.#frames.sort((a, b) => a.position - b.pos);\r\n    }\r\n\r\n    get animation() {\r\n        return this.#animation;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get easing() {\r\n        return this.#easing;\r\n    }\r\n\r\n    get status() {\r\n        return this.#status;\r\n    }\r\n\r\n    get position() {\r\n        return this.#position;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get duration() {\r\n        return this.#duration;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get frames() {\r\n        return this.#frames.slice();\r\n    }\r\n\r\n    get element() {\r\n        return this.#element;\r\n    }\r\n\r\n    // set position(value) {\r\n    //     if (typeof value === 'string') {\r\n    //         value = (parseFloat(value) / 100) * this.#duration;\r\n    //     }\r\n    //\r\n    //     this.#position = Math.max(0.0, Math.min(this.#duration, value));\r\n    // }\r\n\r\n    get state() {\r\n        if (this.status === FX.complete || this.status === FX.canceled) {\r\n            return \"Fulfilled\";\r\n        } else if (this.status === FX.error) {\r\n            return \"Rejected\";\r\n        } else {\r\n            return \"Pending\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the frame options at the given position.\r\n     * @param position\r\n     */\r\n    getFrameFX(position) {\r\n        // position can either be a percentage string (aka 50%) or the time in milliseconds into the animation\r\n        // which will be converted into a percentage.\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        // At this point position should be a value between 0.0 and 1.0.\r\n        // Easing functions specify that rate of change in the properties.\r\n        // It takes the position and maps it to another value between 0.0f and 1.0f.\r\n        // By default linear easing is used.\r\n        if (this.#easing) {\r\n            position = this.#easing(position);\r\n        }\r\n\r\n        let r = {};\r\n\r\n        for (let frame of this.#frames) {\r\n            for (let key in frame.properties) {\r\n                if (frame.properties.hasOwnProperty(key)) {\r\n                    let value = frame.properties[key];\r\n\r\n                    if (!r[key]) {\r\n                        r[key] = {startPosition: null, startValue: null, endPosition: null, endValue: null};\r\n                    }\r\n\r\n                    if (frame.position <= position) {\r\n                        r[key].startPosition = frame.position;\r\n                        r[key].startValue = value;\r\n                    } else if (frame.position > position && r[key].endPosition === null) {\r\n                        r[key].endPosition = frame.position;\r\n                        r[key].endValue = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Returns the final frame at the given position.  All options at this point should be parsed and there final values\r\n     * should be available.\r\n     *\r\n     * @param position\r\n     */\r\n    getFrame(position) {\r\n        let frame = this.getFrameFX(position),\r\n            r = {};\r\n\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        // Takes the frame config options and calculates the final values.\r\n        for (let property in frame) {\r\n            if (frame.hasOwnProperty(property)) {\r\n                let options = frame[property];\r\n\r\n                if ((options.endPosition === null || options.endPosition <= position) && options.startValue !== null) {\r\n                    r[property] = options.startValue;\r\n                } else if (options.startValue !== null) {\r\n                    if (typeof options.startValue === 'object') {\r\n                        let p = (position - options.startPosition) / (options.endPosition - options.startPosition),\r\n                            delta = options.endValue.subtract(options.startValue);\r\n\r\n                        r[property] = options.startValue.add(delta.scalar(p));\r\n                    } else if (typeof options.startValue === 'number') {\r\n                        let duration = (options.endPosition - options.startPosition),\r\n                            p = (position - options.startPosition) / duration,\r\n                            delta = options.endValue - options.startValue;\r\n\r\n                        r[property] = options.startValue + (delta * p);\r\n                    } else {\r\n                        r[property] = options.startValue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // User provided hook that can perform the final touch ups on the frame.\r\n        if (this.#finishFrame) {\r\n            r = this.#finishFrame(this, frame);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    play() {\r\n        assertFXAlive(this);\r\n\r\n        if (this.#frameId === null) {\r\n            this.goto(this.#position);\r\n\r\n            let tick = performance.now();\r\n\r\n            let frameFN = () => {\r\n                let timestamp = performance.now(),\r\n                    delta = timestamp - tick,\r\n                    position = this.#position + (delta / this.duration);\r\n\r\n                tick = timestamp;\r\n                let frame = this.goto(position);\r\n                this.#status = FX.playing;\r\n\r\n                if (this.onFrame) this.onFrame.call(this, this, frame);\r\n\r\n                this.#element.dispatchEvent(new CustomEvent('animation.frame', {\r\n                    bubbles: this.bubbleFrameEvent,\r\n                    detail: this\r\n                }));\r\n\r\n                if (this.#position < 1) {\r\n                    this.#frameId = window.requestAnimationFrame(frameFN);\r\n                } else {\r\n                    this._complete(FX.complete, FX.complete);\r\n                    this.#frameId = null;\r\n                }\r\n            };\r\n\r\n            if (this.onStart) {\r\n                this.onStart.call(this, this);\r\n            }\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.start', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n\r\n            this.#frameId = window.requestAnimationFrame(frameFN);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Pauses the animation.  Does not resolve it.\r\n     * @returns {FX}\r\n     */\r\n    pause() {\r\n        if (this.#frameId) {\r\n            window.cancelAnimationFrame(this.#frameId);\r\n            this.#frameId = null;\r\n            this.#status = FX.paused;\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.paused', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    _cancel(complete = false, status = FX.canceled) {\r\n        if (this.#frameId) {\r\n            window.cancelAnimationFrame(this.#frameId);\r\n            this.#frameId = null;\r\n\r\n            if (complete) {\r\n                this.goto(1);\r\n                this._complete(status, status);\r\n            } else {\r\n                this.#status = status;\r\n                this.#internalValue = status;\r\n            }\r\n\r\n            if (this.onCancel) this.onCancel.call(this, this);\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.canceled', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n\r\n            this._triggerEndEvent();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Cancel the animation with the canceled state.   optionally sets the animation to it's final frame if\r\n     * completeAnimation is true.\r\n     *\r\n     * @param completeAnimation\r\n     * @returns {FX}\r\n     */\r\n    cancel(completeAnimation = false) {\r\n        return this._cancel(completeAnimation, FX.canceled);\r\n    }\r\n\r\n    /**\r\n     * Completes the animation immediately and sets is status to complete.\r\n     * @returns {FX}\r\n     */\r\n    complete() {\r\n        return this._cancel(true, FX.complete);\r\n    }\r\n\r\n    goto(position) {\r\n        assertFXAlive(this);\r\n\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        this.#position = position;\r\n        return this.applyFrame(this.position);\r\n    }\r\n\r\n    applyFrame(position) {\r\n        let frame = this.getFrame(position);\r\n        this.#applyFrame.call(this, this, frame);\r\n        return frame;\r\n    }\r\n\r\n    _triggerEndEvent() {\r\n        if (this.onEnd) this.onEnd.call(this, this);\r\n\r\n        this.#element.dispatchEvent(new CustomEvent('animation.end', {\r\n            bubbles: true,\r\n            detail: this\r\n        }));\r\n\r\n        for (let {onResolve} of this.#chained) {\r\n            if (onResolve) onResolve(this.#internalValue);\r\n        }\r\n        this.#chained = [];\r\n    }\r\n\r\n    _complete(value, status = FX.complete) {\r\n        if (this.state !== \"Pending\") {\r\n            return;\r\n        }\r\n\r\n        this.#status = status;\r\n        this.#internalValue = value;\r\n\r\n        if (this.onComplete) this.onComplete.call(this, this);\r\n\r\n        this.#element.dispatchEvent(new CustomEvent('animation.complete', {\r\n            bubbles: true,\r\n            detail: this\r\n        }));\r\n\r\n        this._triggerEndEvent();\r\n    }\r\n\r\n    then(onResolve, onReject) {\r\n        if (this.state === \"Pending\") {\r\n            return new Promise((resolve, reject) => {\r\n                // noinspection JSUnusedGlobalSymbols\r\n                this.#chained.push({\r\n                    onResolve: (value) => {\r\n                        doPromiseAction(onResolve, value, resolve);\r\n                    },\r\n\r\n                    onReject: (value) => {\r\n                        doPromiseAction(onReject, value, reject);\r\n                    }\r\n                });\r\n            });\r\n        } else if (this.state === 'Fulfilled' && typeof onResolve === 'function') {\r\n            return new Promise((resolve) => {\r\n                doPromiseAction(onResolve, this.#internalValue, resolve);\r\n            });\r\n        } else if (this.state === 'Rejected' && typeof onReject === 'function') {\r\n            return new Promise((resolve, reject) => {\r\n                doPromiseAction(onReject, this.#internalValue, reject);\r\n            });\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    finally(onFinally) {\r\n        onFinally = (value) => {\r\n            if (typeof onFinally === 'function') {\r\n                onFinally();\r\n            }\r\n\r\n            return value;\r\n        };\r\n\r\n        return this.then(onFinally, onFinally);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    catch(onReject) {\r\n        return this.then(undefined, onReject);\r\n    }\r\n}\r\n","/**\r\n *\r\n * @param p\r\n * @returns {*}\r\n */\r\nexport function linear(p) {\r\n    return p;\r\n}\r\n\r\n\r\n// noinspection JSUnusedGlobalSymbols\r\nexport const EASING = {\r\n    linear: linear\r\n};\r\n","export function defaultApplyFrame(fx, frame) {\r\n    for (let key in frame) {\r\n        if (frame.hasOwnProperty(key)) {\r\n            fx.element.style[key] = frame[key].toString();\r\n        }\r\n    }\r\n}\r\n","export class NumberWithUnit {\r\n    constructor(value, unit) {\r\n        this.value = value;\r\n        this.unit = unit;\r\n    }\r\n\r\n    add(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n\r\n        return new NumberWithUnit(this.value + value, this.unit);\r\n    }\r\n\r\n    subtract(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value - value, this.unit);\r\n    }\r\n\r\n    scalar(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value * value, this.unit);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    divide(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value / value, this.unit);\r\n    }\r\n\r\n    toString() {\r\n        return `${this.value}${this.unit}`;\r\n    }\r\n}\r\n","import Publisher from \"../Publisher\";\r\n\r\nimport {privateCache} from \"core/data\";\r\nimport {\r\n    getTranslation,\r\n    setElementClientPosition,\r\n    documentRectToClientSpace,\r\n    clientRectToDocumentSpace,\r\n    snapToGrid\r\n} from \"core/ui/position\";\r\nimport {clamp} from \"../utility/math\";\r\nimport Animation from \"../fx/Animation\";\r\n\r\n\r\n/**\r\n * Draggable option for offset that offsets the position by the cursor.\r\n *\r\n * @param clientX\r\n * @param clientY\r\n * @param boundingRect\r\n * @returns {{x, y}}\r\n */\r\nexport function cursor({clientX, clientY, boundingRect}) {\r\n    return {\r\n        x: boundingRect.left - clientX,\r\n        y: boundingRect.top - clientY\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Draggable option that clones the draggable element for the helper element.\r\n *\r\n * @param opacity\r\n * @returns {function(*): (ActiveX.IXMLDOMNode | Node)}\r\n */\r\nexport function clone(opacity=null) {\r\n    return function(draggable) {\r\n        let helper = draggable.element.cloneNode(true);\r\n\r\n        if(opacity !== null) {\r\n            helper.style.opacity = opacity;\r\n        }\r\n\r\n        return helper;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the first scrollable parent.\r\n *\r\n * @param element\r\n * @returns {HTMLElement|null}\r\n * @private\r\n */\r\nfunction _getScrollParent(element) {\r\n    let o = element.parentElement;\r\n\r\n    while(o) {\r\n        if (o.scrollWidth > o.clientWidth || o.scrollHeight > o.clientHeight) {\r\n            return o;\r\n        }\r\n\r\n        o = o.parentElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\n/**\r\n * Sets the target elements x and y position by setting the translate3d translation matrix.\r\n *\r\n * @param target\r\n * @param x\r\n * @param y\r\n * @private\r\n */\r\nfunction _translate(target, x, y) {\r\n    target.style.transform = `translate3d(${x}px, ${y}px, 0)`;\r\n}\r\n\r\n\r\n// Group of function that can be passed to Draggables container property that will contain a dragged element to within\r\n// the given parameters.  Function should return a rect with {left, top, width, and height} properties relative to the\r\n// client.  Similiar to Element.getBoundingClientRect().\r\nexport const CONTAINERS = {\r\n    /**\r\n     * Constrains to client area.\r\n     * @returns {{top: number, left: number, width: number, height: number}}\r\n     */\r\n    client: function() {\r\n        return {\r\n            left: 0,\r\n            top: 0,\r\n            height: window.innerHeight,\r\n            width: window.innerWidth,\r\n            right: window.innerWidth,\r\n            bottom: window.innerHeight\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Constrains to viewport.\r\n     * @param element\r\n     * @returns {{top: number, left: number, width: number, height: number}}\r\n     */\r\n    viewport: function(element) {\r\n        let parent = _getScrollParent(element),\r\n            bb = parent.getBoundingClientRect();\r\n\r\n        return {\r\n            left: bb.left - parent.scrollLeft,\r\n            top: bb.top - parent.scrollTop,\r\n            width: parent.scrollWidth,\r\n            height: parent.scrollHeight\r\n        };\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Takes a bounding client rect and constrains the left and top position to within the container.  Returns a new rect.\r\n *\r\n * @param rect\r\n * @param container\r\n * @param element\r\n * @param helper\r\n * @returns {{top: *, left: *}}\r\n * @private\r\n */\r\nfunction _clampPositionToContainer(rect, container, element, helper) {\r\n    let bb = helper.getBoundingClientRect();\r\n\r\n    let x = rect.left,\r\n        y = rect.top;\r\n\r\n    if(container) {\r\n        if(typeof container === 'function') {\r\n            container = container(element, helper);\r\n        } else if(container.getBoundingClientRect) {\r\n            container = container.getBoundingClientRect();\r\n        } else {\r\n            container = element.closest(container);\r\n            container = container.getBoundingClientRect();\r\n        }\r\n\r\n        if(container) {\r\n            x = clamp(x, container.left, container.left + container.width - bb.width);\r\n            y = clamp(y, container.top, container.top + container.height - bb.height);\r\n        }\r\n    }\r\n\r\n    return {\r\n        ...rect,\r\n        left: x,\r\n        top: y\r\n    };\r\n}\r\n\r\n\r\n// Group of function that can be passed to the tolerance property of Draggable to control when an item is considered\r\n// intersecting another for drop events.\r\nconst TOLERANCE_FUNCTIONS = {\r\n    intersect: function(droppable, item) {\r\n        let origin = {\r\n            x: item.left + (item.width / 2),\r\n            y: item.top + (item.height / 2)\r\n        };\r\n\r\n        return origin.x >= droppable.left\r\n            && origin.x <= droppable.right\r\n            && origin.y >= droppable.top\r\n            && origin.y <= droppable.bottom;\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Behavior class to add the draggable behavior to an element for group of elements.\r\n */\r\nexport default class Draggable extends Publisher {\r\n    static CLONE = clone;\r\n    // noinspection JSUnusedGlobalSymbols\r\n    static OFFSET_CURSOR = cursor;\r\n\r\n    /**\r\n     * @param element {Element|String} The element to attach the draggable behavior to.\r\n     * @param container {string|CONTAINERS.client|CONTAINERS.viewport|function}\r\n     *  Constrains the draggable into the given area.\r\n     *  `container` can either be a css selector to match a parent element, a Function(element, helper)\r\n     *  that should return a bounding box.  Or an element who's bounding box will be used.\r\n     * @param axis {'x'|'y'|'xy'}\r\n     *  Controls what axis the item is draggable.  x can be dragged horizontally, y vertically, and xy can be freely dragged.\r\n     * @param exclude {String}\r\n     *  Prevents dragging from starting on matching elements.\r\n     * @param delay {Number}\r\n     *  The time in milliseconds after the mouse down event occurs that dragging will begin.\r\n     * @param offset {{x, y}|[x, y]|Function}\r\n     *  By default when an item is dragged is position will be set relative to the drop left corner of the item.\r\n     *  Offset is used to offset the element from the cursor.  You can pass an {x, y} object, an array with [x, y] pair,\r\n     *  or a Function({target, draggable, clientX, clientY, boundingRect}) that will be called that return an {x, y} object.\r\n     * @param disabled {Boolean}\r\n     *  Disables dragging.\r\n     * @param distance {Number}\r\n     *  Adds resistance to drag starting.  The users must move at least `distance` amount of pixels away from the\r\n     *  starting position for drag to start.\r\n     * @param handle {String}\r\n     *  If dragging will only start if the user clicks an element that matches the css selectors.\r\n     * @param helper {Function|Element}\r\n     *  An element to use as a helper for dragging.  Can be a Element or a Function that returns an element.\r\n     * @param revert {Number|Boolean}\r\n     *  Controls if the draggable reverts back to the starting position if no droppable accepts the target.\r\n     * @param scroll {Number}\r\n     *  Controls the speed that the draggable will scroll the scrollParent when the draggable leaves the viewable area.\r\n     * @param selector {String}\r\n     *  Used to delegate dragging to sub items.\r\n     * @param droppables\r\n     *  An array of css selectors or elements that will be used as drop targets for the draggable.\r\n     * @param tolerance {String}\r\n     *  Controls the function that determines if an item intersects a drop target.\r\n     * @param setHelperSize {Boolean}\r\n     *  If true the helpers width and height will be set by javascript to match the original element.\r\n     * @param grid {{x, y} | [x, y] | Number}\r\n     *  Snaps draggable movement to a grid with the given x, y dimensions.\r\n     */\r\n    constructor(element, {container=null, axis='xy', exclude=\"input, button, select, .js-no-drag, textarea\", delay=null, offset=cursor, disabled=false,\r\n        distance=null, handle=null, helper=null, revert=null, scroll=null, selector=null, droppables=null, tolerance='intersect',\r\n        setHelperSize=false, grid=null}={}) {\r\n        super();\r\n\r\n        if(typeof element === 'string') {\r\n            this.element = document.querySelector(element);\r\n        } else {\r\n            this.element = element;\r\n        }\r\n\r\n        this._onMouseDown = this.onMouseDown.bind(this);\r\n        this.disabled = disabled;\r\n        this.helper = helper;\r\n        this.offset = offset;\r\n        this.axis = axis;\r\n        this.delay = delay;\r\n        this.distance = distance;\r\n        this.container = container;\r\n        this.handle = handle;\r\n        this.exclude = exclude;\r\n        this.revert = revert;\r\n        this.selector = selector;\r\n        this.droppables = [];\r\n        this.tolerance = tolerance;\r\n        this.setHelperSize = setHelperSize;\r\n        this.scroll = scroll;\r\n\r\n        if(typeof grid === 'number') {\r\n            this.grid = {\r\n                x: grid,\r\n                y: grid\r\n            };\r\n        } else if(Array.isArray(grid)) {\r\n            this.grid = {\r\n                x: grid[0],\r\n                y: grid[1]\r\n            };\r\n        } else {\r\n            this.grid = grid;\r\n        }\r\n\r\n        if(droppables) {\r\n            this.addDroppables(droppables);\r\n        }\r\n\r\n        this.element.addEventListener('mousedown', this._onMouseDown);\r\n        this.isDragging = false;\r\n\r\n        this._revertFX = null;\r\n    }\r\n\r\n    /**\r\n     * Adds a drop target item.  A `droppable` can be an element, a css selector or an array of those.\r\n     * @param droppables\r\n     */\r\n    addDroppables(droppables) {\r\n        if(Array.isArray(droppables)) {\r\n            this.droppables = this.droppables.concat(droppables);\r\n        } else {\r\n            this.droppables.push(droppables);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Responsible for detecting dragging and starting the drag depending on delay and distance.\r\n     * @param event\r\n     */\r\n    onMouseDown(event) {\r\n        let element = this.element;\r\n\r\n        if(this.selector) {\r\n            element = event.target.closest(this.selector);\r\n\r\n            if(!this.element.contains(element)) {\r\n                element = null;\r\n            }\r\n        }\r\n\r\n        if(!element) return;\r\n\r\n        let data = privateCache.cache(element);\r\n\r\n        if(data.isDragging || this.disabled) {\r\n            return;\r\n        }\r\n\r\n        if(this.handle) {\r\n            let handle = event.target.closest(this.handle);\r\n\r\n            if(!handle || !element.contains(handle)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        if(this.exclude) {\r\n            let excluded = event.target.closest(this.exclude);\r\n\r\n            if(excluded && element.contains(excluded)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        event.preventDefault();\r\n\r\n        let distance = this.distance || 0,\r\n            delay = typeof this.delay === 'number' ? this.delay : -1,\r\n            doc = document,\r\n            startMouseDocumentX = event.clientX + window.scrollX,\r\n            startMouseDocumentY = event.clientY + window.scrollY,\r\n            mouseDocumentX = startMouseDocumentX,\r\n            mouseDocumentY = startMouseDocumentY;\r\n\r\n        // Tests to see that delay and distance was met before dragging.\r\n        let startDragging = () => {\r\n            if(distance === 0 && delay < 0) {\r\n                this.startDrag(element, startMouseDocumentX, startMouseDocumentY, mouseDocumentX, mouseDocumentY);\r\n            }\r\n        };\r\n\r\n        // Delay dragging.\r\n        if(delay >= 0) {\r\n            let timer;\r\n\r\n            let onTimeout = () => {\r\n                delay = -1;\r\n                doc.removeEventListener('mouseup', onMouseUp);\r\n                startDragging();\r\n            };\r\n\r\n            let onMouseUp = () => {\r\n                doc.removeEventListener('mouseup', onMouseUp);\r\n                clearTimeout(timer);\r\n            };\r\n\r\n            doc.addEventListener('mouseup', onMouseUp);\r\n            timer = setTimeout(onTimeout, delay);\r\n        }\r\n\r\n        // Delay by distance.\r\n        if(distance > 0) {\r\n            let onMouseUp = () => {\r\n                doc.removeEventListener('mouseup', onMouseUp);\r\n                doc.removeEventListener('mousemove', onMouseMove);\r\n            };\r\n\r\n            let onMouseMove = (event) => {\r\n                mouseDocumentX = event.clientX + window.scrollX;\r\n                mouseDocumentY = event.clientY + window.scrollY;\r\n\r\n                let delta = Math.sqrt(\r\n                    (mouseDocumentX - startMouseDocumentX)**2 + (mouseDocumentY - startMouseDocumentY)**2\r\n                );\r\n\r\n                if(delta > distance) {\r\n                    distance = 0;\r\n                    doc.removeEventListener('mouseup', onMouseUp);\r\n                    doc.removeEventListener('mousemove', onMouseMove);\r\n                    startDragging();\r\n                }\r\n            };\r\n\r\n            doc.addEventListener('mouseup', onMouseUp);\r\n            doc.addEventListener('mousemove', onMouseMove);\r\n        }\r\n\r\n        startDragging();\r\n    }\r\n\r\n    /**\r\n     * Starts the drag animation at the given x, y origin.\r\n     *\r\n     * @param element\r\n     * @param startMouseX\r\n     * @param startMouseY\r\n     * @param posX\r\n     * @param posY\r\n     */\r\n    startDrag(element, startMouseX, startMouseY, posX, posY) {\r\n        if(this.isDragging) {\r\n            return;\r\n        }\r\n\r\n        this.isDragging = true;\r\n\r\n        // Cancel any animation that are running.\r\n        if(this._revertFX) {\r\n            this._revertFX.cancel();\r\n            this._revertFX = null;\r\n        }\r\n\r\n        let doc = document,\r\n            target,\r\n            droppables = this.getDropTargets(),\r\n            startBoundingBox = element.getBoundingClientRect(),\r\n            startBBDocument = clientRectToDocumentSpace(startBoundingBox),\r\n            helper,\r\n            scrollTick;\r\n\r\n        if(!this.helper || this.helper === 'self') {\r\n            target = element;\r\n        } else if(typeof this.helper === 'function') {\r\n            target = this.helper(this);\r\n            helper = target;\r\n        } else if(this.helper) {\r\n            target = this.helper;\r\n            helper = target;\r\n        }\r\n\r\n        if(helper) {\r\n            if(this.setHelperSize) {\r\n                if(this.setHelperSize === true) {\r\n                    helper.style.width = `${startBoundingBox.width}px`;\r\n                    helper.style.height = `${startBoundingBox.height}px`;\r\n                    helper.style.boxSizing = 'border-box';\r\n                } else if(Array.isArray(this.setHelperSize)) {\r\n                    helper.style.width = `${this.setHelperSize[0]}px`;\r\n                    helper.style.height = `${this.setHelperSize[1]}px`;\r\n                } else {\r\n                    helper.style.width = `${this.setHelperSize.width}px`;\r\n                    helper.style.height = `${this.setHelperSize.height}px`;\r\n                }\r\n            }\r\n        }\r\n\r\n        // If the target doesn't have a parentElement it needs to be added to the page.\r\n        if(!target.parentElement) {\r\n            element.parentElement.appendChild(target);\r\n        }\r\n\r\n        // mouseOffsetX and mouseOffsetY is the mouses offset relative to the top left corner of the element\r\n        // being dragged.\r\n\r\n        // offsetX and offsetY is how much the dragged element is offset from the cursor.\r\n        // By default it is at the top left of the element.\r\n        let startingTranslation = getTranslation(target),\r\n            offset = {x: 0, y: 0};\r\n\r\n        // The offset property controls how much the dragged element is offset from top left corner of the element.\r\n        // By default it is [0, 0] but a function can be or array can be passed to control this behavior.\r\n        if(this.offset) {\r\n            let _offset = this.offset;\r\n\r\n            if(typeof _offset === 'function') {\r\n                offset = this.offset({\r\n                    target: target,\r\n                    draggable: this,\r\n                    clientX: startMouseX - window.scrollX,\r\n                    clientY: startMouseY - window.scrollY,\r\n                    boundingRect: startBoundingBox\r\n                });\r\n            }\r\n        }\r\n\r\n        // Offset should be {x, y} not an array.\r\n        if(Array.isArray(offset)) {\r\n            offset = {\r\n                x: offset[0],\r\n                y: offset[1]\r\n            };\r\n        }\r\n\r\n        let onMouseMove = (event) => {\r\n            event.preventDefault();\r\n\r\n            let startingRect = target.getBoundingClientRect(),\r\n                position = this._getPosition(element, target, event.clientX, event.clientY, offset, this.container),\r\n                dropData;\r\n\r\n            setElementClientPosition(target, position, 'translate3d');\r\n            dropData = this._getDropData(droppables, startingRect, position);\r\n\r\n            for(let droppable of dropData) {\r\n                if(!droppable.intersectsBefore && droppable.intersectsAfter) {\r\n                    this._dispatchDroppableEvent(droppable.target, 'drag-enter', {\r\n                        bubbles: true,\r\n\r\n                        detail: {\r\n                            item: target\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            this._triggerEvent(element, 'drag-move', {\r\n                bubbles: false,\r\n                details: {\r\n                    mouseX: event.clientX + window.scrollX,\r\n                    mouseY: event.clientY + window.scrollY,\r\n                    clientX: event.clientX,\r\n                    clientY: event.clientY,\r\n                    startMouseX,\r\n                    startMouseY,\r\n                    offset,\r\n                    helper: target,\r\n                    originalEvent: event\r\n                },\r\n                topic: 'draggable.move'\r\n            });\r\n\r\n            // Refresh dropData incase something moved.\r\n            dropData = this._getDropData(droppables, startingRect, position);\r\n\r\n            for(let droppable of dropData) {\r\n                if(droppable.intersectsBefore && !droppable.intersectsAfter) {\r\n                    this._dispatchDroppableEvent(droppable.target, 'drag-leave', {\r\n                        bubbles: true,\r\n                        detail: {\r\n                            item: target\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            if(this.scroll && !scrollTick) {\r\n                let parent = _getScrollParent(element);\r\n\r\n                if(parent) {\r\n                    let lastTick = performance.now(),\r\n                        scrollX = parent.scrollLeft,\r\n                        scrollY = parent.scrollTop;\r\n\r\n                    scrollTick = timestamp => {\r\n                        let parentBB = parent.getBoundingClientRect(),\r\n                            helperBB = target.getBoundingClientRect(),\r\n                            x, y,\r\n                            delta = timestamp - lastTick,\r\n                            isOOB = false;\r\n\r\n                        lastTick = timestamp;\r\n\r\n                        if (helperBB.right > parentBB.right) {\r\n                            x = (helperBB.right - parentBB.right) / helperBB.width;\r\n                            isOOB = true;\r\n                            scrollX += delta * x * this.scroll;\r\n                            parent.scrollLeft = scrollX;\r\n                        } else if (helperBB.left < parentBB.left) {\r\n                            x = (parentBB.left - helperBB.left) / helperBB.width;\r\n                            isOOB = true;\r\n                            scrollX -= delta * x * this.scroll;\r\n                            parent.scrollLeft = scrollX;\r\n                        }\r\n\r\n                        if (helperBB.bottom > parentBB.bottom) {\r\n                            y = (helperBB.bottom - parentBB.bottom) / helperBB.height;\r\n                            isOOB = true;\r\n                            scrollY += delta * y * this.scroll;\r\n                            parent.scrollTop = scrollY;\r\n                        } else if (helperBB.top < parentBB.top) {\r\n                            y = (parentBB.top - helperBB.top) / helperBB.height;\r\n                            isOOB = true;\r\n                            scrollY -= delta * y * this.scroll;\r\n                            parent.scrollTop = scrollY;\r\n                        }\r\n\r\n                        helperBB = _clampPositionToContainer(helperBB, this.container, element, target);\r\n                        setElementClientPosition(target, helperBB, 'translate3d');\r\n\r\n                        if (isOOB && this.isDragging) {\r\n                            window.requestAnimationFrame(scrollTick);\r\n                        } else {\r\n                            scrollTick = null;\r\n                        }\r\n                    };\r\n\r\n                    window.requestAnimationFrame(scrollTick);\r\n                }\r\n            }\r\n        };\r\n\r\n        let onMouseUp = (event) => {\r\n            event.preventDefault();\r\n            doc.removeEventListener('mousemove', onMouseMove);\r\n            doc.removeEventListener('mouseup', onMouseUp);\r\n            doc = null;\r\n            this.isDragging = false;\r\n            element.classList.remove('ui-dragging');\r\n\r\n            let startingRect = target.getBoundingClientRect(),\r\n                position = this._getPosition(element, target, event.clientX, event.clientY, offset, this.container),\r\n                translation = getTranslation(target),\r\n                accepted = null;\r\n\r\n            function accept(element) {\r\n                if(!accepted) {\r\n                    accepted = element;\r\n                } else {\r\n                    throw new Error(\"Draggable has already been accepted.\");\r\n                }\r\n            }\r\n\r\n            function isAccepted() {\r\n                return !!accepted;\r\n            }\r\n\r\n            this._triggerEvent(element, 'drag-end', {\r\n                bubbles: true,\r\n\r\n                details: {\r\n                    startX: startMouseX - window.scrollX,\r\n                    startMouseY,\r\n                    offset,\r\n                    clientX: event.clientX,\r\n                    clientY: event.clientY,\r\n\r\n                    originalEvent: event,\r\n                    helper: target,\r\n\r\n                    accept,\r\n                    isAccepted\r\n                },\r\n\r\n                topic: 'draggable.end',\r\n\r\n                accept,\r\n                isAccepted\r\n            });\r\n\r\n            if(!accepted && this.revert === true) {\r\n                _translate(target, startingTranslation.x, startingTranslation.y);\r\n\r\n                if(target !== element && target.parentElement) {\r\n                    target.parentElement.removeChild(target);\r\n                }\r\n\r\n                this._triggerEvent(element, 'drag-complete', {bubbles: true, topic: 'draggable.complete'});\r\n            } else if(!accepted && typeof this.revert === 'number') {\r\n                let animation = new Animation({\r\n                    applyFrame(element, frame) {\r\n                        _translate(element, frame.left, frame.top);\r\n                    },\r\n\r\n                    frames: {\r\n                        '0%': {\r\n                            left: translation.x + (position.left - startingRect.left),\r\n                            top: translation.y + (position.top - startingRect.top)\r\n                        },\r\n\r\n                        '100%': {\r\n                            left: startingTranslation.x,\r\n                            top: startingTranslation.y\r\n                        }\r\n                    }\r\n                });\r\n\r\n                this._revertFX = animation.animate(target, {\r\n                    duration: this.revert,\r\n\r\n                    onEnd() {\r\n                        if(target !== element && target.parentElement) {\r\n                            target.parentElement.removeChild(target);\r\n                        }\r\n                    },\r\n\r\n                    onComplete: () => {\r\n                        this._triggerEvent(element, 'drag-complete', {bubbles: true, topic: 'draggable.complete'});\r\n                    }\r\n                });\r\n            } else {\r\n                if(target !== element && target.parentElement) {\r\n                    target.parentElement.removeChild(target);\r\n                }\r\n\r\n                setElementClientPosition(element, position, 'translate3d');\r\n\r\n                let startingRect = documentRectToClientSpace(startBBDocument),\r\n                    dropped = [];\r\n\r\n                for(let droppable of droppables) {\r\n                    if(this._intersects(element.dataset.tolerance, droppable.getBoundingClientRect(), position)) {\r\n                        this._dispatchDroppableEvent(droppable, 'drop', {\r\n                            bubbles: true,\r\n                            clientX: event.clientX,\r\n                            clientY: event.clientY,\r\n                            relatedTarget: element,\r\n                            detail: {\r\n                                originalEvent: event,\r\n                                startingBoundingClientRect: startingRect,\r\n                                droppable: droppable\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n\r\n                this._triggerEvent(element, 'drag-complete', {\r\n                    topic: 'draggable.complete',\r\n                    details: {\r\n                        dropped\r\n                    },\r\n                    bubbles: true,\r\n                    dropped\r\n                });\r\n            }\r\n        };\r\n\r\n        doc.addEventListener('mousemove', onMouseMove);\r\n        doc.addEventListener('mouseup', onMouseUp);\r\n        element.classList.add('ui-dragging');\r\n\r\n        this._triggerEvent(element, 'drag-start', {\r\n            bubbles: true,\r\n            details: {\r\n                startMouseY,\r\n                startMouseX,\r\n                offset,\r\n                mouseX: posX,\r\n                mouseY: posY,\r\n                clientX: posX - window.scrollX,\r\n                clientY: posY - window.scrollY,\r\n                helper: target\r\n            },\r\n            topic: 'draggable.start'\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets an array of elements of all the drop targets.\r\n     * If the drop target is a string, it queries for those elements.\r\n     *\r\n     * @returns {Array}\r\n     */\r\n    getDropTargets() {\r\n        let r = [];\r\n\r\n        for(let droppable of this.droppables) {\r\n            let type = typeof droppable;\r\n\r\n            if(type === 'string') {\r\n                for(let target of document.querySelectorAll(droppable)) {\r\n                    if(r.indexOf(target) !== -1) continue;\r\n                    r.push(target);\r\n                }\r\n            } else if(type === 'function') {\r\n                droppable = droppable.call(this, this);\r\n                if(r.indexOf(droppable) !== -1) continue;\r\n                r.push(droppable);\r\n            } else {\r\n                if(r.indexOf(droppable) !== -1) continue;\r\n                r.push(droppable);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Takes an array of drop targets and tests to see if the target intersects the start and ending rectangles.\r\n     *\r\n     * Rects are objects that have the left, right, top, bottom, width and height properties defined.\r\n     * Similar to the results received from Element.getBoundingClientRect().\r\n     *\r\n     * @param droppables - Array of elements to tests.\r\n     * @param startingRect - Starting rect.\r\n     * @param endingRect - Ending rect.\r\n     * @returns {Array}\r\n     * @private\r\n     */\r\n    _getDropData(droppables, startingRect, endingRect) {\r\n        let dropData = [];\r\n\r\n        for(let droppable of droppables) {\r\n            // Convert to client space.\r\n            let dropBox = droppable.getBoundingClientRect();\r\n\r\n            let intersectsBefore = this._intersects(droppable.dataset.tolerance, dropBox, startingRect),\r\n                intersectsAfter = this._intersects(droppable.dataset.tolerance, dropBox, endingRect);\r\n\r\n            dropData.push({\r\n                intersectsBefore,\r\n                intersectsAfter,\r\n                target: droppable,\r\n                ...dropBox\r\n            });\r\n        }\r\n\r\n        return dropData;\r\n    }\r\n\r\n    /**\r\n     * Triggers an event on the current item.\r\n     *\r\n     * @param item\r\n     * @param eventName\r\n     * @param details\r\n     * @param bubbles\r\n     * @param topic\r\n     * @param properties\r\n     * @private\r\n     */\r\n    _triggerEvent(item, eventName, {bubbles, details, topic, ...properties}) {\r\n        details = {\r\n            draggable: this,\r\n            item: item,\r\n\r\n            ...details\r\n        };\r\n\r\n        let event = new CustomEvent(eventName, {\r\n            bubbles: bubbles,\r\n            detail: details\r\n        });\r\n\r\n        if(properties) {\r\n            Object.assign(event, properties);\r\n        }\r\n\r\n        item.dispatchEvent(event);\r\n\r\n        if(topic !== false) {\r\n            topic = topic || eventName;\r\n\r\n            this.publish(topic, {\r\n                draggable: this,\r\n                item: this,\r\n\r\n                ...details\r\n            });\r\n        }\r\n    }\r\n\r\n    _dispatchDroppableEvent(dropElement, name, {bubbles=true, detail={}, ...properties}={}) {\r\n        let customEvent = new CustomEvent(name, {\r\n            bubbles,\r\n            detail: {\r\n                dropElement: dropElement,\r\n                draggable: this,\r\n                ...detail\r\n            }\r\n        });\r\n\r\n        // if(topic !== false && droppable.publish) {\r\n        //     topic = topic || name;\r\n        //\r\n        //     droppable.publish(topic, {\r\n        //         target: droppable,\r\n        //         draggable: this,\r\n        //         name: topic,\r\n        //         ...detail\r\n        //     });\r\n        // }\r\n\r\n        Object.assign(customEvent, properties);\r\n\r\n        dropElement.dispatchEvent(customEvent);\r\n    }\r\n\r\n    /**\r\n     * Tests to see if the item intersects the droppable with the given tolerance function.\r\n     *\r\n     * @param tolerance\r\n     * @param droppable\r\n     * @param item\r\n     * @returns {*}\r\n     * @private\r\n     */\r\n    _intersects(tolerance, droppable, item) {\r\n        tolerance = tolerance || this.tolerance;\r\n        return TOLERANCE_FUNCTIONS[tolerance](droppable, item);\r\n    }\r\n\r\n    /**\r\n     * Retrieves the expected bound box of the helper element at the given mouse coordinates.\r\n     *\r\n     * @param element\r\n     * @param helper\r\n     * @param clientX\r\n     * @param clientY\r\n     * @param offset\r\n     * @param container\r\n     * @returns {{top: *, left: *, bottom: *, width: number, right: *, height: number, target: *}}\r\n     */\r\n    _getPosition(element, helper, clientX, clientY, offset, container) {\r\n        let bb = helper.getBoundingClientRect();\r\n\r\n        let left = clientX + offset.x,\r\n            top = clientY + offset.y;\r\n\r\n        if(this.grid) {\r\n            left = snapToGrid(left, this.grid.x);\r\n            top = snapToGrid(top, this.grid.y);\r\n        }\r\n\r\n        let r = {\r\n            left: left,\r\n            top: top,\r\n            width: bb.width,\r\n            height: bb.height,\r\n            right: left + bb.width,\r\n            bottom: top + bb.height,\r\n            target: helper\r\n        };\r\n\r\n        return {...r, ..._clampPositionToContainer(r, container, element, helper)};\r\n    }\r\n}\r\n","import Publisher from \"../Publisher\";\r\nimport {calcDistance, clamp} from \"../utility\";\r\nimport Rect from \"../vectors/Rect\";\r\nimport {getScroll} from \"../utility\";\r\nimport {setElementClientPosition} from \"./position\";\r\nimport Animation from \"../fx/Animation\";\r\n\r\n\r\nconst reg_percentage_test = /\\s*\\d+\\.?\\d*%\\s*/;\r\n\r\n\r\n/**\r\n * Returns the offset position of the mouse relative to the target.\r\n *\r\n * @param target\r\n * @param event\r\n * @returns {{x: number, y: number}}\r\n */\r\nexport function cursor(target, event) {\r\n    let rect = new Rect(target);\r\n\r\n    return {\r\n        x: event.clientX - rect.left,\r\n        y: event.clientY - rect.top\r\n    };\r\n}\r\n\r\n\r\nfunction buildTestIntersectionFunction(amount) {\r\n    return function(element, rect) {\r\n        rect = new Rect(rect);\r\n\r\n        let targetRect = new Rect(element),\r\n            intersection = targetRect.intersection(rect),\r\n            p = intersection ? intersection.getArea() / rect.getArea() : 0;\r\n\r\n        return p > amount;\r\n    }\r\n}\r\n\r\n\r\nexport default class Draggable2 extends Publisher {\r\n    #element;\r\n    #droppables;\r\n    #boundOnMouseDown;\r\n    #itemCache;\r\n\r\n    constructor(element, {container=null, axis='xy', exclude='', delay=0, offset=cursor,\r\n        resistance=0, handle=null, helper=null, revert=false, revertDuration=0,\r\n        scrollSpeed=0, selector=null, tolerance=0.5, setHelperSize=false, grid=null}={}) {\r\n        super();\r\n\r\n        if(typeof element === 'string') {\r\n            this.#element = document.querySelector(element);\r\n        } else {\r\n            this.#element = element;\r\n        }\r\n\r\n        this.#droppables = [];\r\n        this.#itemCache = new WeakMap();\r\n\r\n        this.container = container;\r\n        this.axis = axis;\r\n        this.exclude = exclude;\r\n        this.delay = delay;\r\n        this.offset = offset;\r\n        this.resistance = resistance;\r\n        this.handle = handle;\r\n        this.helper = helper;\r\n        this.revert = revert;\r\n        this.revertDuration = revertDuration;\r\n        this.scrollSpeed = scrollSpeed;\r\n        this.selector = selector;\r\n        this.tolerance = tolerance;\r\n        this.setHelperSize = setHelperSize;\r\n        this.grid = grid;\r\n\r\n        if(typeof this.container === 'string') {\r\n            this.container = document.querySelector(this.container);\r\n        }\r\n\r\n        this.#boundOnMouseDown = event => {\r\n            return this.onMouseDown(event);\r\n        };\r\n\r\n        this.element.addEventListener('mousedown', this.#boundOnMouseDown);\r\n    }\r\n\r\n    /**\r\n     * Starts dragging if the correct elements have been targeted and delay and resistance have been meet.\r\n     *\r\n     * @param event\r\n     * @returns {Promise<void>}\r\n     */\r\n    async onMouseDown(event) {\r\n        let startPosition = {x: event.clientX + window.pageXOffset, y: event.clientY + window.pageYOffset},\r\n            currentPosition = {x: startPosition.x, y: startPosition.y},\r\n            target = this.#element,\r\n            cancelMouseTracking = null,\r\n            cancelTimer = null,\r\n            distanceBrokenPromise,\r\n            timerPromise,\r\n            offset;\r\n\r\n        // Only start dragging if a draggable child of the element is targeted.\r\n        // If selector is null then the entire element is draggable and should be the target.\r\n        if(this.selector) {\r\n            target = event.target.closest(this.selector);\r\n\r\n            if(!target || !this.#element.contains(target)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Only start dragging if the handle was targeted.\r\n        // If handle is null then the entire target is the handle.\r\n        if(this.handle) {\r\n            let handle = event.target.closest(this.handle);\r\n\r\n            if(!handle || !target.contains(handle)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // If any excluded elements are targeted ignore the event.\r\n        if(this.exclude) {\r\n            let exclude = event.target.closest(this.exclude);\r\n\r\n            if(exclude && target.contains(exclude)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Find the offset of the event.\r\n        if(typeof this.offset === 'function') {\r\n            offset = this.offset(target, event);\r\n        } else if(Array.isArray(this.offset)) {\r\n            offset = {\r\n                x: this.offset[0],\r\n                y: this.offset[1]\r\n            };\r\n        } else if(typeof this.offset === 'object') {\r\n            offset = {\r\n                x: this.offset.x,\r\n                y: this.offset.y\r\n            };\r\n        } else {\r\n            offset = {x: 0, y: 0};\r\n        }\r\n\r\n        // Prevent default browser actions.\r\n        event.preventDefault();\r\n\r\n        // At this point we can be sure that a draggable item was\r\n        // targeted by it's handle and no excluded items where clicked.\r\n\r\n        // Creates a promise that both tracks the current mouse coords and resolve\r\n        // when the user passes the given resistance.\r\n        distanceBrokenPromise = new Promise(resolve => {\r\n            let isDistanceBroken = this.resistance <= 0;\r\n\r\n            if(isDistanceBroken) {\r\n                resolve('complete');\r\n            }\r\n\r\n            let onMouseMove = event => {\r\n                currentPosition.x = event.clientX + window.pageXOffset;\r\n                currentPosition.y = event.clientY + window.pageYOffset;\r\n                event.preventDefault();\r\n\r\n                if(!isDistanceBroken && calcDistance(currentPosition.x, currentPosition.y, startPosition.x, startPosition.y) > this.resistance) {\r\n                    resolve('complete');\r\n                    isDistanceBroken = true;\r\n                }\r\n            };\r\n\r\n            // Cancel mouse tracking and resolve the promise to canceled if hasn't already been resolve.\r\n            // This function must be called or their will be a memory leak before onMouseDown completes.\r\n            cancelMouseTracking = () => {\r\n                if(onMouseMove) {\r\n                    document.removeEventListener('mousemove', onMouseMove);\r\n\r\n                    if(!isDistanceBroken) {\r\n                        resolve('canceled');\r\n                    }\r\n\r\n                    onMouseMove = null;\r\n                }\r\n            };\r\n\r\n            document.addEventListener('mousemove', onMouseMove);\r\n        });\r\n\r\n        // Creates a promise that resolve when after the delay time passes or the user cancels the drag by\r\n        // releasing the mouse button.\r\n        timerPromise = new Promise(resolve => {\r\n            let timer = null;\r\n\r\n            if(this.delay >= 0) {\r\n                timer = setTimeout(() => {\r\n                    resolve(\"complete\");\r\n                    timer = null;\r\n                }, this.delay);\r\n            } else {\r\n                resolve('complete');\r\n            }\r\n\r\n            // cancel the timer and resolve it to canceled if it is still active.\r\n            cancelTimer = () => {\r\n                if(timer) {\r\n                    clearTimeout(timer);\r\n                    resolve('canceled');\r\n                }\r\n            };\r\n        });\r\n\r\n        // cancel the timer and mouse tracking if they are still active.\r\n        let onMouseUp = event => {\r\n            event.preventDefault();\r\n            cancelTimer();\r\n            cancelMouseTracking();\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n        };\r\n\r\n        document.addEventListener('mouseup', onMouseUp);\r\n\r\n        // Wait until the delay time and distance have passed or failed.\r\n        let [timerStatus, distanceStatus] = await Promise.all([timerPromise, distanceBrokenPromise]);\r\n\r\n        // Ensure that mouse tracking has been canceled.\r\n        if(cancelMouseTracking) cancelMouseTracking();\r\n\r\n        // At this point both the timer and distance status should have passed or failed.\r\n        // If either failed do nothing.\r\n        if(timerStatus === 'complete' && distanceStatus === 'complete') {\r\n            this.startDragging(target, {\r\n                offsetX: offset.x,\r\n                offsetY: offset.y,\r\n                // Make relative to client.\r\n                startingX: currentPosition.x,\r\n                startingY: currentPosition.y\r\n            });\r\n        }\r\n    }\r\n\r\n    async startDragging(element, pos) {\r\n        let cache = this.#itemCache.get(element),\r\n            mousePosition = {x: pos.startingX, y: pos.startingY};\r\n\r\n        if(!cache) {\r\n            cache = {isDragging: false, fx: null, rect: null, helper: null, element: element};\r\n            this.#itemCache.set(element, cache);\r\n        }\r\n\r\n        if(cache.isDragging) {\r\n            return;\r\n        }\r\n\r\n        cache.isDragging = true;\r\n\r\n        if(cache.fx) {\r\n            await cache.fx.cancel();\r\n            cache.fx = null;\r\n        }\r\n\r\n        let target = element,\r\n            container = this.container,\r\n            scroller = null,\r\n            dropTargets = [],\r\n            startPosition = new Rect(element),\r\n            startingClientRect = startPosition;\r\n\r\n        startPosition = startPosition.translate(\r\n            window.pageXOffset,\r\n            window.pageYOffset\r\n        );\r\n\r\n        if(!cache.rect) {\r\n            cache.rect = startPosition;\r\n        }\r\n\r\n        if(typeof container === 'string') {\r\n            container = document.querySelector(container);\r\n        }\r\n\r\n        if(this.helper) {\r\n            if(typeof this.helper === 'function') {\r\n                target = this.helper(element);\r\n            } else {\r\n                target = this.helper;\r\n            }\r\n\r\n            if(this.setHelperSize) {\r\n                target.style.width = startPosition.width + \"px\";\r\n                target.style.height = startPosition.height + \"px\";\r\n            }\r\n\r\n            target.style.pointerEvents = 'none';\r\n\r\n            if(!target.parentElement && element.parentElement) {\r\n                element.parentElement.appendChild(target);\r\n            }\r\n\r\n            target.classList.add('ui-drag-helper');\r\n\r\n            cache.helper = target;\r\n        }\r\n\r\n        let refreshDropTargets = (rect) => {\r\n            // drag-enter\r\n            let mouseX = mousePosition.x - window.pageXOffset,\r\n                mouseY = mousePosition.y - window.pageYOffset,\r\n                currentDropTargets,\r\n                detail = {clientX: mouseX, clientY: mouseY};\r\n\r\n            if(rect !== null) {\r\n                currentDropTargets = this.getDropTargets(rect, {mouseX, mouseY});\r\n            } else {\r\n                currentDropTargets = [];\r\n            }\r\n\r\n            for(let dropTarget of currentDropTargets) {\r\n                if(dropTargets.indexOf(dropTarget) === -1) {\r\n                    dispatchDropEvent(this, 'drag.enter', element, target, null, rect, true, true, false, detail, dropTarget);\r\n                }\r\n            }\r\n\r\n            for(let dropTarget of dropTargets) {\r\n                if(currentDropTargets.indexOf(dropTarget) === -1) {\r\n                    dispatchDropEvent(this, 'drag.leave', element, target, null, rect, true, true, false, detail, dropTarget);\r\n                }\r\n            }\r\n\r\n            // drag-leave\r\n            dropTargets = currentDropTargets;\r\n        };\r\n\r\n        let onMouseMove = event => {\r\n            event.preventDefault();\r\n            let rect = _moveElementToPosition(this, target, event.clientX, event.clientY, pos.offsetX, pos.offsetY, _selectElementRect(container, this, target, element));\r\n\r\n            mousePosition.x = event.clientX + window.pageXOffset;\r\n            mousePosition.y = event.clientY + window.pageYOffset;\r\n\r\n            if(this.scrollSpeed > 0) {\r\n                if(scroller) {\r\n                    scroller.cancel();\r\n                    scroller = null;\r\n                }\r\n\r\n                scroller = ScrollHelper.buildScrollHelper(element, target, rect, pos, this, event, this.scrollSpeed, container);\r\n            }\r\n\r\n            refreshDropTargets(rect);\r\n\r\n            publishDragMoveEvent(this, element, target, event, rect);\r\n        };\r\n\r\n        let onMouseUp = async event => {\r\n            event.preventDefault();\r\n            document.removeEventListener('mousemove', onMouseMove);\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n            cache.isDragging = false;\r\n            element.classList.remove('ui-dragging');\r\n\r\n            if(scroller) {\r\n                scroller.cancel();\r\n                scroller = null;\r\n            }\r\n\r\n            let accepted = false,\r\n                isDefaultPrevented = false,\r\n                reverted = false,\r\n                rect = new Rect(target);\r\n\r\n            publishDragDropEvent(this, element, target, event, rect, false, {\r\n                isDefaultPrevented() {\r\n                    return isDefaultPrevented;\r\n                },\r\n\r\n                isAccepted() {\r\n                    return accepted;\r\n                },\r\n\r\n                accept() {\r\n                    accepted = true;\r\n                },\r\n\r\n                preventDefault() {\r\n                    isDefaultPrevented = true;\r\n                }\r\n            });\r\n\r\n            if(this.revert && !accepted) {\r\n                refreshDropTargets(cache.rect);\r\n                rect = cache.rect;\r\n\r\n                if(!this.revertDuration) {\r\n                    if(target !== element) {\r\n                        target.parentElement.removeChild(target);\r\n                    } else {\r\n                        let pos = startPosition.translate(\r\n                            -window.pageXOffset,\r\n                            -window.pageYOffset\r\n                        );\r\n\r\n                        setElementClientPosition(target, pos, 'translate3d');\r\n                    }\r\n                } else {\r\n                    cache.fx = _revert(target, cache.rect, this.revertDuration);\r\n\r\n                    await cache.fx;\r\n\r\n                    if(target !== element) {\r\n                        target.parentElement.removeChild(target);\r\n                    }\r\n                }\r\n\r\n                reverted = true;\r\n            } else {\r\n                if(target !== element) {\r\n                    target.parentElement.removeChild(target);\r\n                    setElementClientPosition(element, rect, 'translate3d');\r\n                }\r\n            }\r\n\r\n            this.#itemCache.delete(element);\r\n\r\n            dispatchDropEvent(this, 'drag.end', element, target, event, rect, true, true, true, {accepted, reverted}, element);\r\n        };\r\n\r\n        // Set target to starting position.\r\n        if(mousePosition.x !== undefined && mousePosition.y !== undefined) {\r\n            let rect = _moveElementToPosition(this, target, mousePosition.x - window.pageXOffset, mousePosition.y - window.pageYOffset, pos.offsetX, pos.offsetY, _selectElementRect(container, this, target, element));\r\n            refreshDropTargets(rect);\r\n        }\r\n\r\n        document.addEventListener('mousemove', onMouseMove);\r\n        document.addEventListener('mouseup', onMouseUp);\r\n        element.classList.add('ui-dragging');\r\n\r\n        dispatchDropEvent(this, 'drag.start', element, target, null, startingClientRect, true, true, true, null);\r\n    }\r\n\r\n    getDropTargets(rect, mousePos) {\r\n        let r = [];\r\n\r\n        /**\r\n         * @type {number|String|Function|string}\r\n         */\r\n        let testFunction = this.tolerance,\r\n            type = typeof testFunction;\r\n\r\n        if(type === 'string') {\r\n            // noinspection JSCheckFunctionSignatures\r\n            if(reg_percentage_test.test(testFunction)) {\r\n                // noinspection JSCheckFunctionSignatures\r\n                testFunction = buildTestIntersectionFunction(parseFloat(testFunction) / 100);\r\n            }\r\n        } else if(type === 'number') {\r\n            testFunction = buildTestIntersectionFunction(testFunction);\r\n        }\r\n\r\n        for(let droppable of this.#droppables) {\r\n            if(testFunction(droppable, rect, mousePos, this)) {\r\n                r.push(droppable);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    connect(droppables) {\r\n        if(typeof droppables === 'string') {\r\n            droppables = document.querySelectorAll(droppables);\r\n        } else if(typeof droppables.length !== 'number') {\r\n            droppables = [droppables];\r\n        }\r\n\r\n        for(let i = 0; i < droppables.length; i++) {\r\n            let item = droppables[i];\r\n\r\n            if(this.#droppables.indexOf(item) === -1) {\r\n                this.#droppables.push(item);\r\n            }\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    disconnect(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        let i = this.#droppables.indexOf(droppable);\r\n\r\n        if(i !== -1) {\r\n            this.#droppables.splice(i, 1);\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    hasDroppable(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        return this.#droppables.indexOf(droppable) !== -1;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get droppables() {\r\n        return this.#droppables.slice(0);\r\n    }\r\n\r\n    get element() {\r\n        return this.#element;\r\n    }\r\n}\r\n\r\n\r\nfunction _revert(target, position, revertDuration, onFrame=null) {\r\n    let starting = new Rect(target);\r\n\r\n    let animation = new Animation({\r\n        frames: {\r\n            '0%': {\r\n                left: starting.left + window.pageXOffset,\r\n                top: starting.top + window.pageYOffset\r\n            },\r\n\r\n            '100%': {\r\n                left: position.left,\r\n                top: position.top\r\n            }\r\n        },\r\n\r\n        applyFrame(fx, frame) {\r\n            setElementClientPosition(fx.element, {\r\n                left: frame.left - window.pageXOffset,\r\n                top: frame.top - window.pageYOffset\r\n            }, 'translate3d');\r\n\r\n            if(onFrame) onFrame(fx);\r\n        }\r\n    });\r\n\r\n    return animation.animate(target, {duration: revertDuration});\r\n}\r\n\r\n\r\n/**\r\n * Takes a client (x, y) position and some offset coords and move the element to the given position.\r\n *\r\n * @param self\r\n * @param element\r\n * @param x\r\n * @param y\r\n * @param offsetX\r\n * @param offsetY\r\n * @param container\r\n * @private\r\n * @returns {*|Rect}\r\n */\r\nfunction _moveElementToPosition(self, element, x, y, offsetX, offsetY, container) {\r\n    let rect = new Rect(element),\r\n        startingRect = rect;\r\n\r\n    rect = rect.moveTo({left: x, top: y});\r\n\r\n    offsetX = offsetX || 0;\r\n    offsetY = offsetY || 0;\r\n\r\n    rect = rect.translate(-offsetX, -offsetY);\r\n\r\n    if(self.axis === 'y') {\r\n        rect = new Rect(\r\n            startingRect.left,\r\n            rect.top,\r\n            startingRect.right,\r\n            rect.bottom\r\n        );\r\n    } else if(self.axis === 'x') {\r\n        rect = new Rect(\r\n            rect.left,\r\n            startingRect.top,\r\n            rect.right,\r\n            startingRect.bottom\r\n        );\r\n    }\r\n\r\n    if(typeof self.grid === 'number' && self.grid) {\r\n        let left = Math.floor(rect.left / self.grid) * self.grid,\r\n            top = Math.floor(rect.top / self.grid) * self.grid;\r\n\r\n        rect = new Rect(left, top, left + startingRect.width, top + startingRect.height);\r\n    }\r\n\r\n    if(container) {\r\n        container = new Rect(container);\r\n        rect = rect.fit(container);\r\n    }\r\n\r\n    setElementClientPosition(element, rect, 'translate3d');\r\n    return rect;\r\n}\r\n\r\n\r\n// noinspection JSCommentMatchesSignature\r\n/**\r\n * For module use only.  Selects the element either by css selector, if it's a string, or resolve a function.\r\n * If the element is already element is is returned direction.  Returns null if not element is provided.\r\n *\r\n * @param element\r\n * @param dragInstance\r\n * @param target\r\n * @returns {null|*}\r\n * @private\r\n */\r\nfunction _selectElementRect(element, dragInstance, target, originalTarget) {\r\n    if(element) {\r\n        let type = typeof element;\r\n\r\n        if(type === 'function') {\r\n            return new Rect(element.call(dragInstance, target, originalTarget, dragInstance));\r\n        } else if(type === 'string') {\r\n            return new Rect(document.querySelector(element));\r\n        }\r\n\r\n        return new Rect(element);\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\n/**\r\n * Returns the first scrollable parent.\r\n *\r\n * @param element\r\n * @returns {HTMLElement|null}\r\n * @private\r\n */\r\nfunction _getScrollParent(element) {\r\n    let o = element.parentElement;\r\n\r\n    while(o) {\r\n        if (o.scrollWidth > o.clientWidth || o.scrollHeight > o.clientHeight) {\r\n            return o;\r\n        }\r\n\r\n        o = o.parentElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\nfunction _getScrollRect(element) {\r\n    if(element === window || element.nodeName === \"HTML\") {\r\n        return new Rect(0, 0, window.innerWidth, window.innerHeight);\r\n    } else {\r\n        return new Rect(element);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Helper class that is used to control scrolling when the element is dragged outside of bounds.\r\n */\r\nclass ScrollHelper {\r\n    constructor(element, scrollXSpeed=0, scrollYSpeed=0, onFrame=null) {\r\n        this.frameID = null;\r\n        this.element = element;\r\n        this.scrollXSpeed = scrollXSpeed;\r\n        this.scrollYSpeed = scrollYSpeed;\r\n        this.onFrame = onFrame;\r\n        this.timestamp = performance.now();\r\n\r\n        let frame = timestamp => {\r\n            let delta = (timestamp - this.timestamp) / 1000;\r\n\r\n            this.timestamp = timestamp;\r\n\r\n            this.element.scrollLeft += delta * this.scrollXSpeed;\r\n            this.element.scrollTop += delta * this.scrollYSpeed;\r\n\r\n            if(this.onFrame) {\r\n                this.onFrame(this);\r\n            }\r\n\r\n            this.frameID = window.requestAnimationFrame(frame);\r\n        };\r\n\r\n        this.frameID = window.requestAnimationFrame(frame);\r\n    }\r\n\r\n    cancel() {\r\n        if(this.frameID) {\r\n            window.cancelAnimationFrame(this.frameID);\r\n            this.frameID = null;\r\n        }\r\n    }\r\n\r\n    static getScrollSpeed(rect, scrollParentRect) {\r\n        let r = {x: 0, y: 0};\r\n\r\n        if(rect.right > scrollParentRect.right) {\r\n            r.x = clamp((rect.right - scrollParentRect.right) / rect.width, -1, 1);\r\n        } else if(rect.left < scrollParentRect.left) {\r\n            r.x = clamp((rect.left - scrollParentRect.left) / rect.width, -1, 1);\r\n        }\r\n\r\n        if(rect.bottom > scrollParentRect.bottom) {\r\n            r.y = clamp((rect.bottom - scrollParentRect.bottom) / rect.width, -1, 1);\r\n        } else if(rect.top < scrollParentRect.top) {\r\n            r.y = clamp((rect.top - scrollParentRect.top) / rect.width, -1, 1);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static buildScrollHelper(element, target, rect, pos, dragInstance, event, scrollSpeed, container) {\r\n        let scrollParent = _getScrollParent(element);\r\n\r\n        if(scrollParent) {\r\n            let scrollParentRect = _getScrollRect(scrollParent),\r\n                speed = ScrollHelper.getScrollSpeed(rect, scrollParentRect);\r\n\r\n            if(speed.x || speed.y) {\r\n                return new ScrollHelper(scrollParent, speed.x * scrollSpeed, speed.y * scrollSpeed, (scroller) => {\r\n                    let rect = _moveElementToPosition(this, target, event.clientX, event.clientY, pos.offsetX, pos.offsetY, _selectElementRect(container, dragInstance, target, element));\r\n\r\n                    let scrollRect = new Rect(scroller.element);\r\n\r\n                    setElementClientPosition(target, rect, 'translate3d');\r\n\r\n                    if(scrollRect.contains(rect)) {\r\n                        scroller.cancel();\r\n                        scroller = null;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function ScrollArea(selector) {\r\n    return function() {\r\n        let element = selector;\r\n\r\n        if(typeof element === 'string') {\r\n            element = document.querySelector(element);\r\n        }\r\n\r\n        let rect = new Rect(element),\r\n            scroll = getScroll(element);\r\n\r\n        rect.left -= scroll.scrollLeft;\r\n        rect.top -= scroll.scrollTop;\r\n        rect.right = rect.left + element.scrollWidth;\r\n        rect.bottom = rect.top + element.scrollHeight;\r\n\r\n        return rect;\r\n    }\r\n}\r\n\r\n\r\nexport function clone(opacity=null, className=null, zIndex=null) {\r\n    if(typeof opacity === 'object' && opacity.nodeType) {\r\n        return opacity.cloneNode(true);\r\n    }\r\n\r\n    return function(element) {\r\n        let r = element.cloneNode(true);\r\n\r\n        if(opacity !== null) {\r\n            r.style.opacity = opacity;\r\n        }\r\n\r\n        if(className) {\r\n            r.className = className;\r\n        }\r\n\r\n        r.style.position = \"absolute\";\r\n        if(zIndex !== null) r.style.zIndex = zIndex;\r\n\r\n        return r;\r\n    }\r\n}\r\n\r\n\r\nfunction publishDragMoveEvent(self, element, helper, event, rect, bubbles=false, options=null) {\r\n    return dispatchDropEvent(self, 'drag.move', element, helper, event, rect, bubbles, true, true, options);\r\n}\r\n\r\n\r\nfunction publishDragDropEvent(self, element, helper, event, rect, bubbles=true, options=null) {\r\n    return dispatchDropEvent(self, 'drag.drop', element, helper, event, rect, bubbles, true, true, options);\r\n}\r\n\r\n\r\nfunction dispatchDropEvent(self, name, element, helper, originalEvent, currentRect, bubbles=false, dispatch=true, publish=false, detail=null, target=null) {\r\n    let eventPackage = {\r\n        name,\r\n        draggable: self,\r\n        target: helper,\r\n        element,\r\n        item: element, // alias for element\r\n        helper: helper,\r\n        originalEvent: null,\r\n        rect: currentRect\r\n    };\r\n\r\n    if(originalEvent) {\r\n        eventPackage.originalEvent = originalEvent;\r\n        eventPackage.clientX = originalEvent.clientX;\r\n        eventPackage.clientY = originalEvent.clientY;\r\n    }\r\n\r\n    if(!target) {\r\n        target = element;\r\n    }\r\n\r\n    if(detail) {\r\n        Object.assign(eventPackage, detail);\r\n    }\r\n\r\n    if(publish) {\r\n        self.publish(name, eventPackage);\r\n    }\r\n\r\n    if(dispatch) {\r\n        let customEvent = new CustomEvent(name, {\r\n            bubbles,\r\n            detail: eventPackage\r\n        });\r\n\r\n        target.dispatchEvent(customEvent);\r\n    }\r\n}\r\n","import {getTranslation, setElementClientPosition} from \"core/ui/position\";\r\nimport Draggable2, {cursor} from './Draggable2';\r\n\r\n\r\nexport function placeholder(className, nodeName=null) {\r\n    return function(element) {\r\n        let placeholder = document.createElement(nodeName || element.nodeName),\r\n            box = element.getBoundingClientRect();\r\n\r\n        placeholder.style.boxSizing = \"border-box\";\r\n        box.style.width = `${box.width}px`;\r\n        box.style.height = `${box.height}px`;\r\n\r\n        if(className) {\r\n            placeholder.className = className;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Creates a sortable list of items.\r\n */\r\nexport default class Sortable {\r\n    #draggable;\r\n\r\n    constructor(element, {items=\".ui-sort-item\", placeholder=null, layout='y', dropOnEmpty=true, accepts=null, setPlaceholderSize=false,\r\n        container=null, axis='xy', exclude=null, delay=null, offset=cursor,\r\n        resistance=null, handle=null, helper=null, revert=null, revertDuration, scrollSpeed=null, tolerance=0.5,\r\n        setHelperSize=false, grid=null, droppables=null}={}) {\r\n\r\n        if(typeof element === 'string') {\r\n            this.element = document.querySelector(element);\r\n        } else {\r\n            this.element = element;\r\n        }\r\n\r\n        this.#draggable = new Draggable2(this.element, {container, axis, exclude, delay, offset, resistance, handle, helper, revert, revertDuration, scrollSpeed, selector: items, tolerance, setHelperSize, grid});\r\n\r\n        if(droppables) {\r\n            this.connect(droppables);\r\n        }\r\n\r\n        this.items = items;\r\n        this.layout = layout;\r\n        this.placeholder = placeholder;\r\n        this.dropOnEmpty = dropOnEmpty;\r\n        this.accepts = accepts;\r\n        this.setPlaceholderSize = setPlaceholderSize;\r\n\r\n        this.initEvents();\r\n    }\r\n\r\n    connect(droppables) {\r\n        this.#draggable.connect(droppables);\r\n    }\r\n\r\n    disconnect(droppables) {\r\n        this.#draggable.disconnect(droppables);\r\n    }\r\n\r\n    hasDroppable(droppable) {\r\n        return this.#draggable.hasDroppable(droppable);\r\n    }\r\n\r\n    get droppables() {\r\n        return this.#draggable.droppables;\r\n    }\r\n\r\n    /**\r\n     * Initializes event listeners.\r\n     */\r\n    initEvents() {\r\n        let placeholder,\r\n            isOver = false,\r\n            init = false,\r\n            target;\r\n\r\n        // Attaches temporary events when drag starts.\r\n        let initialize = (event) => {\r\n            init = true;\r\n            target = event.detail.item;\r\n            target.addEventListener('drag.move', onDragMove);\r\n            target.addEventListener('drag.end', onDragComplete);\r\n            target.addEventListener('sort-append', onSortAppend);\r\n            let startBB = target.getBoundingClientRect();\r\n            target.classList.add('ui-sorting');\r\n\r\n            if(!placeholder && this.placeholder) {\r\n                if(typeof this.placeholder === 'string') {\r\n                    placeholder = document.createElement(target.nodeName);\r\n                    placeholder.className = this.placeholder;\r\n                } else if(typeof this.placeholder === 'function') {\r\n                    placeholder = this.placeholder(target, this);\r\n                } else if(this.placeholder === true) {\r\n                    placeholder = document.createElement(target.nodeName);\r\n                } else {\r\n                    placeholder = this.placeholder;\r\n                }\r\n\r\n                placeholder.classList.add('ui-placeholder');\r\n\r\n                if(this.setPlaceholderSize) {\r\n                    if(this.setPlaceholderSize === true) {\r\n                        placeholder.style.width = `${startBB.width}px`;\r\n                        placeholder.style.height = `${startBB.height}px`;\r\n                        placeholder.style.boxSizing = 'border-box';\r\n                    } else if(Array.isArray(this.setPlaceholderSize)) {\r\n                        placeholder.style.width = `${this.setPlaceholderSize[0]}px`;\r\n                        placeholder.style.height = `${this.setPlaceholderSize[1]}px`;\r\n                    } else {\r\n                        placeholder.style.width = `${this.setPlaceholderSize.width}px`;\r\n                        placeholder.style.height = `${this.setPlaceholderSize.height}px`;\r\n                    }\r\n                }\r\n\r\n                if(this.element.contains(target)) {\r\n                    target.parentElement.insertBefore(placeholder, target);\r\n                }\r\n            }\r\n\r\n            setElementClientPosition(target, startBB, 'translate3d');\r\n        };\r\n\r\n        // Cleanup after sorting finishes.\r\n        let destroy = () => {\r\n            if(target) {\r\n                target.removeEventListener('drag.move', onDragMove);\r\n                target.removeEventListener('drag.end', onDragComplete);\r\n                target.removeEventListener('sort-append', onSortAppend);\r\n                init = false;\r\n                isOver = false;\r\n\r\n                if(placeholder && placeholder.parentElement) {\r\n                    placeholder.parentElement.removeChild(placeholder);\r\n                }\r\n\r\n                placeholder = null;\r\n\r\n                target.style.transform = \"\";\r\n                target.classList.remove('ui-sorting');\r\n                target = null;\r\n            }\r\n        };\r\n\r\n        // Ensures that the placeholder is removed if the item gets moves to another sortable.\r\n        let onSortAppend = event => {\r\n            if(event.detail !== this && placeholder && placeholder.parentElement) {\r\n                placeholder.parentElement.removeChild(placeholder);\r\n            }\r\n        };\r\n\r\n        // Moves the item to the correct position on mouse move.\r\n        let onDragMove = (event) => {\r\n            if(!isOver || (this.accepts && !event.detail.item.matches(this.accepts))) {\r\n                return;\r\n            }\r\n\r\n            let target = event.detail.item,\r\n                items = Array.prototype.slice.call(this.getItems()).filter(i => i !== target);\r\n\r\n            let before = this.getItemBeforePoint(event.detail.clientX, event.detail.clientY, items),\r\n                after = this.getItemAfterPoint(event.detail.clientX, event.detail.clientY, items),\r\n                beforeBB = event.detail.helper.getBoundingClientRect(),\r\n                dropOnEmpty = target.dataset.dropOnEmpty !== null && target.dataset.dropOnEmpty !== undefined ? target.dataset.dropOnEmpty === 'true' : this.dropOnEmpty; // Allow overriding on item level.\r\n\r\n            if(!items.length) {\r\n                if(dropOnEmpty) {\r\n                    this.element.appendChild(target);\r\n                    if(placeholder) target.parentElement.insertBefore(placeholder, target);\r\n                    this._refreshPositions(event.detail.helper, beforeBB);\r\n                    this._triggerSortAppendEvent(target);\r\n                }\r\n            } else if(before && before !== target) {\r\n                before.parentElement.insertBefore(target, before.nextSibling);\r\n                if(placeholder) target.parentElement.insertBefore(placeholder, target);\r\n                this._refreshPositions(event.detail.helper, beforeBB);\r\n                this._triggerSortAppendEvent(target);\r\n            } else if(after && after !== target) {\r\n                after.parentElement.insertBefore(target, after);\r\n                if(placeholder) target.parentElement.insertBefore(placeholder, target);\r\n                this._refreshPositions(event.detail.helper, beforeBB);\r\n                this._triggerSortAppendEvent(target);\r\n            }\r\n        };\r\n\r\n        // Cleanup\r\n        let onDragComplete = () => {\r\n            destroy();\r\n        };\r\n\r\n        // Initialize sorting.\r\n        this.element.addEventListener('drag.enter', event => {\r\n            if(this.accepts && !event.detail.item.matches(this.accepts)) {\r\n                return;\r\n            }\r\n\r\n            isOver = true;\r\n\r\n            if(!init) {\r\n                initialize(event);\r\n            }\r\n        });\r\n\r\n        // Mark isOver state false.\r\n        this.element.addEventListener('drag.leave', () => {\r\n            isOver = false;\r\n        });\r\n\r\n        // Initialize sorting that started on another sortable.\r\n        this.element.addEventListener('drag.start', (event) => {\r\n            if(!init) {\r\n                initialize(event);\r\n            }\r\n\r\n            isOver = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Tests to see if the given (x, y) point is before or after the element.  Uses layout to determine if the test\r\n     * is for the x layout, the y layout or the xy layout.\r\n     * @param element\r\n     * @param x\r\n     * @param y\r\n     * @returns {string|null}\r\n     */\r\n    getRelativePosition(element, x, y) {\r\n        let box = element.getBoundingClientRect(),\r\n            mx = box.left + (box.width / 2),\r\n            my = box.top + (box.height / 2);\r\n\r\n        if(this.layout === 'x') {\r\n            return mx < x ? 'after' : 'before';\r\n        } else if(this.layout === 'y') {\r\n            return my < y ? 'after' : 'before';\r\n        } else if(this.layout === 'xy') {\r\n            return (box.bottom < y) || (mx < x && box.bottom >= y && box.top <= y) ? 'after' : 'before';\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Returns the item immediately before the given x, y point.\r\n     * @param x\r\n     * @param y\r\n     * @param items\r\n     * @returns {*}\r\n     */\r\n    getItemBeforePoint(x, y, items) {\r\n        if(!items) items = this.getItems();\r\n\r\n        let r = null;\r\n\r\n        for(let i = 0; i < items.length; i++) {\r\n            let item = items[i];\r\n\r\n            if(this.getRelativePosition(item, x, y) === 'after') {\r\n                r = item;\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(r) {\r\n            let box = r.getBoundingClientRect();\r\n\r\n            if((this.layout === 'x' || this.layout === 'xy') && box.top <= y && box.bottom >= y) {\r\n                return r;\r\n            } else if(this.layout === 'y' && box.left <= x && box.right >= x) {\r\n                return r;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the item immediately after the given (x, y) point.\r\n     * @param x\r\n     * @param y\r\n     * @param items\r\n     * @returns {null|*}\r\n     */\r\n    getItemAfterPoint(x, y, items) {\r\n        if(!items) items = this.getItems();\r\n\r\n        let r = null;\r\n\r\n        for(let i = items.length - 1; i >= 0; i--) {\r\n            let item = items[i];\r\n\r\n            if(this.getRelativePosition(item, x, y) === 'before') {\r\n                r = item;\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(r) {\r\n            let box = r.getBoundingClientRect();\r\n\r\n            if((this.layout === 'x' || this.layout === 'xy') && box.top <= y && box.bottom >= y) {\r\n                return r;\r\n            } else if(this.layout === 'y' && box.left <= x && box.right >= x) {\r\n                return r;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Returns a list of all items for the sortable.\r\n     * @returns {NodeListOf<SVGElementTagNameMap[string]> | NodeListOf<HTMLElementTagNameMap[string]> | NodeListOf<Element>}\r\n     */\r\n    getItems() {\r\n        return this.element.querySelectorAll(this.items);\r\n    }\r\n\r\n    /**\r\n     * helper method that translates the target to the provided client position.\r\n     * @param target {{getBoundingClientRect, style} | Element}\r\n     * @param position {{left[Number], top[Number]}}\r\n     * @private\r\n     */\r\n    _refreshPositions(target, position) {\r\n        let current = target.getBoundingClientRect(),\r\n            deltaLeft = current.left - position.left,\r\n            deltaTop = current.top - position.top,\r\n            translation = getTranslation(target);\r\n\r\n        target.style.transform = `translate3d(${translation.x - deltaLeft}px, ${translation.y - deltaTop}px, 0)`;\r\n    }\r\n\r\n    /**\r\n     * Triggers the default sort-append event on the target.\r\n     * @param target {Element}\r\n     * @private\r\n     */\r\n    _triggerSortAppendEvent(target) {\r\n        let event = new CustomEvent('sort-append', {\r\n            bubbles: false,\r\n            detail: this\r\n        });\r\n\r\n        target.dispatchEvent(event);\r\n    }\r\n}\r\n","import {Rect, Vec2, Vec3} from \"../vectors\";\r\nimport {clamp} from \"../utility\";\r\n\r\n\r\nconst regMatrix = /matrix(3d)?\\(([^)]+)\\)/;\r\n\r\n\r\n/**\r\n * Returns the elements offset parent.\r\n *\r\n * @param element\r\n * @returns {HTMLElement}\r\n */\r\nexport function getOffsetElement(element) {\r\n    let o = element.parentElement;\r\n\r\n    while(o) {\r\n        let position = getComputedStyle(o).position;\r\n        if(position !== 'static') return o;\r\n        o = o.parentElement;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the rectangle of the client area.\r\n *\r\n * @returns {Rect}\r\n */\r\nexport function getClientRect() {\r\n    return Rect.getClientRect();\r\n}\r\n\r\n\r\n/**\r\n * Returns a bounding rect who's positions are relative to the provided offsetParent.\r\n * If offsetParent is null then the targets natural offsetParent is used as returned by the getOffsetElement function.\r\n * @param element\r\n * @param offsetParent\r\n * @returns {{top: number, left: number, bottom: number, width: number, right: number, height: number}}\r\n */\r\nexport function getBoundingOffsetRect(element, offsetParent=null) {\r\n    let offsetRect, rect;\r\n\r\n    if(!offsetParent) offsetParent = getOffsetElement(element);\r\n\r\n    // no offset parent.  Position relative to the client.\r\n    if(!offsetParent) {\r\n        offsetRect = Rect.getRootContainingClientRect();\r\n    } else {\r\n        offsetRect = Rect.getBoundingClientRect(offsetParent);\r\n    }\r\n\r\n    rect = element.getBoundingClientRect();\r\n\r\n    return new Rect(\r\n        rect.left - offsetRect.left,\r\n        rect.top - offsetRect.top,\r\n        offsetRect.right - rect.right,\r\n        offsetRect.bottom - rect.bottom\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns a bounding rect who's positions are relative to the document.\r\n * @param element\r\n * @returns {{top: number, left: number, bottom: number, width: number, x: number, y: number, right: number, height: number}}\r\n */\r\nexport function getBoundingDocumentRect(element) {\r\n    let rect = element.getBoundingClientRect();\r\n\r\n    return new Rect(\r\n        rect.left + window.pageXOffset,\r\n        rect.top + window.pageYOffset,\r\n        rect.right + window.pageXOffset,\r\n        rect.bottom + window.pageYOffset\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns the css translation from the transformation matrix applied to the element.\r\n *\r\n * @param element\r\n * @returns {Vec3}\r\n */\r\nexport function getTranslation(element) {\r\n    let transform = getComputedStyle(element).transform,\r\n        m = regMatrix.exec(transform);\r\n\r\n    if(!m) {\r\n        return new Vec3(\r\n            0,\r\n            0,\r\n            0\r\n        );\r\n    }\r\n\r\n    let data = m[2].split(/\\s*,\\s*/);\r\n\r\n    if(m[1]) {\r\n        return new Vec3(\r\n            parseFloat(data[12]),\r\n            parseFloat(data[13]),\r\n            parseFloat(data[14])\r\n        );\r\n    } else {\r\n        return new Vec3(\r\n            parseFloat(data[4]),\r\n            parseFloat(data[5]),\r\n            0\r\n        );\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Sets the element's transformation matrix to 2d translate with the specified left and top properties.\r\n *\r\n * @param element\r\n * @param x\r\n * @param y\r\n * @param z\r\n */\r\nexport function setTranslation(element, {x, y, z=null}) {\r\n    if(z !== null) {\r\n        element.style.transform = `translate3d(${x}px, ${y}px, ${z}px)`;\r\n    } else {\r\n        element.style.transform = `translate(${x}px, ${y}px)`;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Gets the elements left and top style properties as numbers.\r\n *\r\n * @param element\r\n * @returns {Vec2}\r\n */\r\nexport function getCssPosition(element) {\r\n    let style = getComputedStyle(element);\r\n\r\n    return new Vec2(\r\n        parseInt(style.left, 10),\r\n        parseInt(style.top, 10)\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Sets the left and top style properties of an element.  If the element is positioned statically it will be changed to\r\n * relative.\r\n *\r\n * @param element\r\n * @param left\r\n * @param top\r\n */\r\nexport function setCssPosition(element, {left=null, top=null}) {\r\n    let style = getComputedStyle(element);\r\n\r\n    if(style.position === 'static') {\r\n        style.position = 'relative';\r\n    }\r\n\r\n    if(left !== null && left !== undefined) {\r\n        element.style.left = `${left}px`;\r\n    }\r\n\r\n    if(top !== null && top !== undefined) {\r\n        element.style.top = `${top}px`;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Sets the elements position relative to the client window.  The `method` parameter controls how the elements position\r\n * is modified.  The options are 'top-left', 'top-right', 'bottom-left', 'bottom-right', 'translate', and 'translate3d'.\r\n *\r\n * top-left, top-right, bottom-left and bottom-right set the css left, top, right, and bottom properties of the element.\r\n * translate and translate3d position the element by setting the transform property.\r\n *\r\n * @param element {HTMLElement}\r\n * @param position {{x, y}|{left, top, right, bottom}|Array|Vec2}\r\n * @param method {'top-left'|'top-right'|'bottom-left'|'bottom-right'|'translate'|'translate3d'}\r\n */\r\nexport function setElementClientPosition(element, position, method='top-left') {\r\n    position = new Rect(position);\r\n\r\n    if(method === 'top-left' || method === 'top-right' || method === 'bottom-left' || method === 'bottom-right') {\r\n        let style = getComputedStyle(element);\r\n\r\n        let positionType = style.position, box, deltaX, deltaY, current;\r\n\r\n        // position can't be static for this operation.  Switch to relative.\r\n        if(positionType === 'static') {\r\n            element.style.position = 'relative';\r\n            positionType = \"relative\";\r\n        }\r\n\r\n        if(positionType === \"relative\") {\r\n            style = getComputedStyle(element);\r\n\r\n            current = {\r\n                left: parseInt(style.left, 10) || 0,\r\n                right: parseInt(style.right, 10) || 0,\r\n                top: parseInt(style.top, 10) || 0,\r\n                bottom: parseInt(style.bottom, 10) || 0\r\n            }\r\n        } else {\r\n            box = Rect.getBoundingClientRect(element);\r\n            current = getBoundingOffsetRect(element);\r\n        }\r\n\r\n        if(method === 'top-left') {\r\n            deltaX = position.left - box.left;\r\n            deltaY = position.top - box.top;\r\n\r\n            element.style.left = (current.left + deltaX) + 'px';\r\n            element.style.top = (current.top + deltaY) + 'px';\r\n            element.style.right = '';\r\n            element.style.bottom = '';\r\n        } else if(method === 'top-right') {\r\n            deltaX = position.right - box.right;\r\n            deltaY = position.top - box.top;\r\n\r\n            element.style.right = (current.right - deltaX) + 'px';\r\n            element.style.top = (current.top + deltaY) + 'px';\r\n            element.style.left = '';\r\n            element.style.bottom = '';\r\n        } else if(method === 'bottom-left') {\r\n            deltaX = position.left - box.left;\r\n            deltaY = position.bottom - box.bottom;\r\n\r\n            console.log({\r\n                right: (current.left + deltaX) + 'px',\r\n                bottom: (current.bottom - deltaY) + 'px'\r\n            });\r\n\r\n            element.style.left = (current.left + deltaX) + 'px';\r\n            element.style.bottom = (current.bottom - deltaY) + 'px';\r\n            element.style.right = '';\r\n            element.style.top = '';\r\n        } else { // bottom-right\r\n            deltaX = position.right - box.right;\r\n            deltaY = position.bottom - box.bottom;\r\n\r\n            element.style.right = (current.right - deltaX) + 'px';\r\n            element.style.bottom = (current.bottom - deltaY) + 'px';\r\n            element.style.left = '';\r\n            element.style.top = '';\r\n        }\r\n    } else if(method === 'translate') {\r\n        let box = Rect.getBoundingClientRect(element),\r\n            deltaX = position.left - box.left,\r\n            deltaY = position.top - box.top,\r\n            cssPosition = getTranslation(element);\r\n\r\n        setTranslation(element, {\r\n            x: cssPosition.x + deltaX,\r\n            y: cssPosition.y + deltaY\r\n        });\r\n    } else if(method === 'translate3d') {\r\n        let box = Rect.getBoundingClientRect(element),\r\n            deltaX = position.left - box.left,\r\n            deltaY = position.top - box.top,\r\n            cssPosition = getTranslation(element);\r\n\r\n        setTranslation(element, {\r\n            x: cssPosition.x + deltaX,\r\n            y: cssPosition.y + deltaY,\r\n            z: cssPosition.z\r\n        });\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Transforms the coordinates of a BoundingClientRect like object from client space to document space.\r\n * @param rect\r\n */\r\nexport function clientRectToDocumentSpace(rect) {\r\n    let r = Rect.fromRect(rect);\r\n\r\n    r.left += window.pageXOffset;\r\n    r.right += window.pageXOffset;\r\n    if(typeof r.top === 'number') r.top += window.pageYOffset;\r\n    if(typeof r.bottom === 'number') r.bottom += window.pageYOffset;\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Transforms the coordinates of a BoundingClientRect like object from document space to client space.\r\n * @param rect\r\n */\r\nexport function documentRectToClientSpace(rect) {\r\n    let r = Rect.fromRect(rect);\r\n\r\n    r.left -= window.pageXOffset;\r\n    r.right -= window.pageXOffset;\r\n    if(typeof r.top === 'number') r.top -= window.pageYOffset;\r\n    if(typeof r.bottom === 'number') r.bottom -= window.pageYOffset;\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Snaps the value to the specified grid using the provided rounding function.\r\n * @param value\r\n * @param gridSize\r\n * @param roundingFunction\r\n * @returns {number|*}\r\n */\r\nexport function snapToGrid(value, gridSize, roundingFunction=Math.round) {\r\n    if(gridSize !== null && gridSize !== undefined && !Number.isNaN(gridSize)) {\r\n        return roundingFunction(value / gridSize) * gridSize;\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Deprecated in favor of calling Rect.fromRect() class method.\r\n *\r\n * @deprecated\r\n * @param domRect\r\n * @returns {Rect}\r\n */\r\nexport function convertDomRectToObject(domRect) {\r\n    return Rect.fromRect(domRect);\r\n}\r\n\r\n\r\n/**\r\n * Returns the {x, y} point calculated relative to the reference element.\r\n *\r\n * @param referenceElement\r\n * @param point\r\n * @param offset\r\n * @param constrain\r\n * @returns {Vec2}\r\n */\r\nexport function getPointOnElement(referenceElement, point, offset=null, constrain=null) {\r\n    let rect = referenceElement;\r\n\r\n    if(rect.getBoundingClientRect) {\r\n        rect = rect.getBoundingClientRect();\r\n    }\r\n\r\n    if(constrain) {\r\n        if (typeof constrain === 'string') {\r\n            constrain = document.querySelector(constrain);\r\n        }\r\n\r\n        if (constrain.getBoundingClientRect) {\r\n            constrain = Rect.fromRect(constrain.getBoundingClientRect());\r\n        }\r\n    }\r\n\r\n    // Convert array to {x, y} object.\r\n    if(Array.isArray(point)) {\r\n        point = {\r\n            x: point[0],\r\n            y: point[1]\r\n        };\r\n    } else if(typeof point === 'string') {\r\n        if(point === 'top-left') {\r\n            point = {x: 0, y: 0};\r\n        } else if(point === 'top') {\r\n            point = {x: '50%', y: 0};\r\n        } else if(point === 'top-right') {\r\n            point = {x: '100%', y: 0};\r\n        } else if(point === 'right') {\r\n            point = {x: '100%', y: '50%'};\r\n        } else if(point === 'bottom-right') {\r\n            point = {x: '100%', y: '100%'};\r\n        } else if(point === 'bottom') {\r\n            point = {x: '50%', y: '100%'};\r\n        } else if(point === 'bottom-left') {\r\n            point = {x: 0, y: '100%'};\r\n        } else if(point === 'left') {\r\n            point = {x: 0, y: '50%'};\r\n        } else if(point === 'middle') {\r\n            point = {x: '50%', y: '50%'};\r\n        } else {\r\n            throw new Error(`Unknown point option ${point}`);\r\n        }\r\n    }\r\n\r\n    if(typeof point.x === 'string') {\r\n        point.x = (rect.right - rect.left) * (parseFloat(point.x) / 100);\r\n    }\r\n\r\n    if(typeof point.y === 'string') {\r\n        point.y = (rect.bottom - rect.top) * (parseFloat(point.y) / 100);\r\n    }\r\n\r\n    if(constrain) {\r\n        if(typeof constrain.left === 'string') {\r\n            constrain.left = (rect.right - rect.left) * (parseFloat(constrain.left) / 100);\r\n        }\r\n\r\n        if(typeof constrain.right === 'string') {\r\n            constrain.right = (rect.right - rect.left) * (parseFloat(constrain.right) / 100);\r\n        }\r\n\r\n        if(typeof constrain.top === 'string') {\r\n            constrain.top = (rect.bottom - rect.top) * (parseFloat(constrain.top) / 100);\r\n        }\r\n\r\n        if(typeof constrain.bottom === 'string') {\r\n            constrain.bottom = (rect.bottom - rect.top) * (parseFloat(constrain.bottom) / 100);\r\n        }\r\n\r\n        point.x = clamp(point.x, constrain.left, constrain.right);\r\n        point.y = clamp(point.y, constrain.top, constrain.bottom);\r\n    }\r\n\r\n    if(offset) {\r\n        if(Array.isArray(offset)) {\r\n            offset = {\r\n                x: offset[0],\r\n                y: offset[1]\r\n            };\r\n        }\r\n\r\n        if(offset.x !== null) {\r\n            point.x += offset.x;\r\n        }\r\n\r\n        if(offset.y !== null) {\r\n            point.y += offset.y;\r\n        }\r\n    }\r\n\r\n    return new Vec2(rect.left + point.x, rect.top + point.y);\r\n}\r\n\r\n\r\n/**\r\n * Gets the bounding client rect for a rectangle defined by the position rectangle with left, top, right and bottom\r\n * properties relative to the element's position.\r\n *\r\n * @param element {{getBoundingClientRect}|Element|String|{left, top, right, bottom}}\r\n * @param position {{left, top, bottom, right}}\r\n * @return {Rect}\r\n */\r\nexport function getSubBoundingBox(element, position) {\r\n    let rect;\r\n\r\n    // Get the bounding client rect of the element.   The user should have passed either a css selector, an object with a\r\n    // getBoundingClientRect interface.  Or a bounding client rect directly.\r\n    if(element.getBoundingClientRect) {\r\n        rect = element.getBoundingClientRect();\r\n    } else if(typeof element === 'string') {\r\n        rect = document.querySelector(element).getBoundingClientRect();\r\n    } else {\r\n        rect = element;\r\n    }\r\n\r\n    let width = rect.right - rect.left,\r\n        height = rect.bottom - rect.top;\r\n\r\n    // The user can pass a rect with left, top, right and bottom properties.  The value can either be the desired\r\n    // coordinates relative to the top-left corner of the reference element or a percentage.  Another possibility\r\n    // is that the user passes one of the keyword properties that coorispond to a specific section of the element.\r\n    // Map those keywords to their rectangle.\r\n    if(typeof position === 'string') {\r\n        if(position === 'border-top') {\r\n            position = {left: 0, right: '100%', top: 0, bottom: 0};\r\n        } else if(position === 'border-right') {\r\n            position = {left: '100%', right: '100%', top: 0, bottom: '100%'};\r\n        } else if(position === 'border-bottom') {\r\n            position = {left: 0, right: '100%', top: '100%', bottom: '100%'};\r\n        } else if(position === 'border-left') {\r\n            position = {left: 0, top: 0, right: 0, bottom: '100%'};\r\n        } else if(position === 'top-left') {\r\n            position = {left: 0, top: 0, right: 0, bottom: 0};\r\n        } else if(position === 'top') {\r\n            position = {top: 0, left: '50%', right: '50%', bottom: 0};\r\n        } else if(position === 'top-right') {\r\n            position = {top: 0, left: '100%', right: '100%', bottom: 0};\r\n        } else if(position === 'left') {\r\n            position = {left: 0, top: '50%', bottom: '50%', right: 0};\r\n        } else if(position === 'origin') {\r\n            position = {left: '50%', right: '50%', top: '50%', bottom: '50%'};\r\n        } else if(position === 'bottom-left') {\r\n            position = {left: 0, right: 0, top: '100%', bottom: '100%'};\r\n        } else if(position === 'bottom') {\r\n            position = {left: '50%', right: '50%', top: '100%', bottom: '100%'};\r\n        } else if(position === 'bottom-right') {\r\n            position = {left: '100%', right: '100%', top: '100%', bottom: '100%'};\r\n        } else if(position === 'right') {\r\n            position = {left: '100%', right: '100%', top: '50%', bottom: '50%'};\r\n        }\r\n    }\r\n\r\n    position.left = position.left || 0;\r\n    position.right = position.right || 0;\r\n    position.top = position.top || 0;\r\n    position.bottom = position.bottom || 0;\r\n\r\n    // left and right percentages are a percentage of the elements width.\r\n    // top and bottom percentages are a percentage of the elements height.\r\n    if(typeof position.left === 'string') {\r\n        position.left = (parseFloat(position.left) / 100) * width;\r\n    }\r\n\r\n    if(typeof position.right === 'string') {\r\n        position.right = (parseFloat(position.right) / 100) * width;\r\n    }\r\n\r\n    if(typeof position.bottom === 'string') {\r\n        position.bottom = (parseFloat(position.bottom) / 100) * height;\r\n    }\r\n\r\n    if(typeof position.top === 'string') {\r\n        position.top = (parseFloat(position.top) / 100) * height;\r\n    }\r\n\r\n    // Convert to client space.\r\n    return new Rect(\r\n        rect.left + position.left,\r\n        rect.top + position.top,\r\n        rect.left + position.right,\r\n        rect.top + position.bottom\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * Returns the distance in between the provided Rect objects.  If the objects are touching or overlapping 0\r\n * will be returned.\r\n *\r\n * @param rect1 {{left, top, right, bottom}}\r\n * @param rect2 {{left, top, right, bottom}}\r\n * @returns {Number}\r\n */\r\nexport function getDistanceBetweenRects(rect1, rect2) {\r\n    let vec1 = Rect.fromRect(rect1),\r\n        vec2 = Rect.fromRect(rect2);\r\n\r\n    let isXOverlapping = vec1.isXOverlapping(vec2),\r\n        isYOverlapping = vec1.isYOverlapping(vec2);\r\n\r\n    if(isXOverlapping && isYOverlapping) {\r\n        // Items are overlapping\r\n        return 0;\r\n    } else if(isXOverlapping) {\r\n        return Math.min(\r\n            Math.abs(vec1.bottom - vec2.top),\r\n            Math.abs(vec1.top - vec2.bottom)\r\n        );\r\n    } else if(isYOverlapping) {\r\n        return Math.min(\r\n            Math.abs(vec1.right - vec2.left),\r\n            Math.abs(vec1.left - vec2.right)\r\n        );\r\n    } else {\r\n        let x1, y1, x2, y2;\r\n\r\n        if(vec1.right <= vec2.left) {\r\n            x1 = vec1.right;\r\n            x2 = vec2.left;\r\n        } else {\r\n            x1 = vec1.left;\r\n            x2 = vec2.right;\r\n        }\r\n\r\n        if(vec1.bottom <= vec2.top) {\r\n            y1 = vec1.bottom;\r\n            y2 = vec2.top;\r\n        } else {\r\n            y1 = vec1.top;\r\n            y2 = vec2.bottom;\r\n        }\r\n\r\n        // Use distance formula to calculate distance.\r\n        return Math.round(Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)));\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the top and left position of an element relative to the document.\r\n *\r\n * @param element\r\n * @return {{top: number, left: number}}\r\n */\r\nexport function getElementOffset(element) {\r\n    let box = element.getBoundingClientRect();\r\n\r\n    return {\r\n        left: box.left + window.pageXOffset,\r\n        top: box.top + window.pageYOffset\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Sets an elements position relative to the document.\r\n *\r\n * @param element\r\n * @param coords\r\n */\r\nexport function setElementOffset(element, coords) {\r\n    if (coords.nodeType) {\r\n        coords = getElementOffset(element);\r\n    } else if (Array.isArray(coords)) {\r\n        coords = {\r\n            left: coords.left,\r\n            top: coords.top\r\n        };\r\n    }\r\n\r\n    let offset = element.getBoundingClientRect();\r\n\r\n    let style = getComputedStyle(element),\r\n        left = parseInt(style.left, 10) || 0,\r\n        top = parseInt(style.top, 10) || 0;\r\n\r\n    element.style.left = (left + (coords.left - offset.left)) + 'px';\r\n    element.style.top = (top + (coords.top - offset.top)) + 'px';\r\n}\r\n\r\n\r\nexport {Vec2, Vec3, Rect};\r\n","/**\r\n * Throttles a function to only be executed after a given wait period.  If multiple calls to the debounced function\r\n * are made within that period the waiting period is set.\r\n * @param fn\r\n * @param wait\r\n * @returns {Function}\r\n */\r\nexport function debounce(fn, wait) {\r\n    let timeout;\r\n\r\n    return function() {\r\n        let args = arguments;\r\n\r\n        let later = () => {\r\n            timeout = null;\r\n            fn.apply(this, args);\r\n        };\r\n\r\n        if(timeout) {\r\n            clearTimeout(timeout);\r\n        }\r\n\r\n        timeout = setTimeout(later, wait);\r\n    }\r\n}\r\n","export function proto(descriptor) {\r\n    descriptor.placement = \"prototype\";\r\n    return descriptor;\r\n}\r\n","const REG_WHITESPACE = /\\s+/;\r\n\r\n\r\n/**\r\n * Parses an html string into a document fragment.\r\n *\r\n * @deprecated\r\n * @param html\r\n * @return {DocumentFragment}\r\n */\r\nexport function parseHTML(html) {\r\n    let template = document.createElement('template');\r\n    template.innerHTML = html.trim();\r\n\r\n    if (template.content) {\r\n        return template.content;\r\n    } else {\r\n        // Doesn't support template tag.\r\n        let fragment = document.createDocumentFragment();\r\n        while (template.firstChild) fragment.appendChild(template.firstChild);\r\n        return fragment;\r\n    }\r\n}\r\n\r\nexport function createFragment(html) {\r\n    // noinspection JSDeprecatedSymbols\r\n    return parseHTML(html);\r\n}\r\n\r\n/**\r\n * Adds classes to an element.  Can take a space separated list of classes.\r\n *\r\n * @param element\r\n * @param classes\r\n */\r\nexport function addClasses(element, classes) {\r\n    if (typeof classes === 'string') {\r\n        classes = classes.split(REG_WHITESPACE);\r\n    }\r\n\r\n    element.classList.add(...classes);\r\n}\r\n\r\n/**\r\n * Removes classes to an element.  Can take a space separated list of classes.\r\n *\r\n * @param element\r\n * @param classes\r\n */\r\nexport function removeClasses(element, classes) {\r\n    if (typeof classes === 'string') {\r\n        classes = classes.split(REG_WHITESPACE);\r\n    }\r\n\r\n    element.classList.remove(...classes);\r\n}\r\n\r\n/**\r\n * Assigns attributes in an object to an element.\r\n * @param element\r\n * @param attributes\r\n */\r\nexport function assignAttributes(element, attributes) {\r\n    for (let key in attributes) {\r\n        if (attributes.hasOwnProperty(key)) {\r\n            element.setAttribute(key, attributes[key]);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Matches a single dom element based on the given selector.\r\n * Can take a css selector string, a jquery object, a dom element, a document element or a document fragment.\r\n * If a css selector is passed it will query for the element.\r\n * If a jquery object is passed it will return the first matched element.\r\n * If an element is passed it will return that element.\r\n *\r\n * If a context is provided and the selector was a css selector, the selectors scope will be limited to that element.\r\n * Otherwise the context will be the document.\r\n *\r\n * @param selector\r\n * @param context\r\n * @returns {Element|Document|DocumentFragment}\r\n */\r\nexport function selectElement(selector, context = null) {\r\n    if (!context) {\r\n        context = document;\r\n    } else {\r\n        context = selectElement(context);\r\n    }\r\n\r\n    if (typeof selector === 'string') {\r\n        return context.querySelector(selector);\r\n    } else if (selector.jquery) {\r\n        return selector[0];\r\n    } else if (selector.nodeType === 1 || selector.nodeType === 9 || selector.nodeType === 11) {\r\n        return selector;\r\n    }\r\n}\r\n\r\n/**\r\n * Empties a dom element.\r\n *\r\n * @param element\r\n */\r\nexport function emptyElement(element) {\r\n    while (element.firstChild) element.removeChild(element.firstChild);\r\n}\r\n\r\n/**\r\n * Normalizing accessing scroll position for an element.\r\n *\r\n * Windows and elements have different ways of accessing their scroll left and scroll top values on IE.\r\n * This function normalizes this behavior so getScroll(variable).scrollLeft always works.\r\n * @param element\r\n * @returns {{left, top}}\r\n */\r\nexport function getScroll(element) {\r\n    if (isWindow(element)) {\r\n        return {\r\n            scrollLeft: element.pageXOffset,\r\n            scrollTop: element.pageYOffset\r\n        };\r\n    } else {\r\n        return {\r\n            scrollLeft: element.scrollLeft,\r\n            scrollTop: element.scrollTop\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Normalizes setting a scroll position for an element.\r\n * Windows on ie and elements with overflow scroll have different ways of setting the scroll position.\r\n * This methods normalizes them.\r\n * @param element - The element to scroll\r\n * @param scroll - An object with a left or a top property or both.\r\n */\r\nexport function setScroll(element, scroll) {\r\n    if (element.scrollTo) {\r\n        element.scrollTo(scroll);\r\n    } else {\r\n        element.scrollLeft = scroll.left;\r\n        element.scrollTop = scroll.top;\r\n    }\r\n}\r\n\r\n/**\r\n * Returns first child element that matches the test function.\r\n * @param element - Parent element\r\n * @param fn {Function|String} - Test Function\r\n * @returns {HTMLElement|Element|null}\r\n */\r\nexport function findChild(element, fn) {\r\n    if (typeof fn === 'string') {\r\n        let selector = fn;\r\n        fn = (child) => child.matches(selector);\r\n    }\r\n\r\n    for (let i = 0, l = element.children.length; i < l; i++) {\r\n        let child = element.children[i];\r\n\r\n        if (fn(child)) {\r\n            return child;\r\n        }\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n/**\r\n * Creates a filtered list of element from the children that match the test function.\r\n * @param element - Parent element.\r\n * @param fn - Test function.\r\n * @returns {Array}\r\n */\r\nexport function filterChildren(element, fn) {\r\n    let r = [];\r\n\r\n    for (let i = 0, l = element.children.length; i < l; i++) {\r\n        let child = element.children[i];\r\n\r\n        if (fn(child)) {\r\n            r.push(child);\r\n        }\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Test to see if the variable is a window.\r\n * @param variable\r\n * @returns {boolean}\r\n */\r\nexport function isWindow(variable) {\r\n    return variable && typeof variable === 'object' && setInterval in variable;\r\n}\r\n","import {debounce} from \"./debounce\";\r\nimport {proto} from \"./decorators\";\r\nimport {createFragment, findChild, filterChildren, emptyElement, addClasses, removeClasses, selectElement, assignAttributes, getScroll, isWindow, setScroll} from \"./dom\";\r\nimport {all, any, chain, enumerate, firstValue, items, keys, values} from \"./iter\";\r\nimport {clamp, modulo, calcDistance} from \"./math\";\r\nimport {arraysEqual, getOwnProperty, getPropertyByPath, isEmptyObject, randomChoice, rangeFindItem} from \"./object\";\r\n\r\nexport {\r\n    debounce,\r\n    proto,\r\n    createFragment, findChild, filterChildren, emptyElement, addClasses, removeClasses, selectElement, assignAttributes,\r\n    getScroll, isWindow, setScroll, all, any, chain, enumerate, firstValue, items, keys, values,\r\n    clamp, modulo, calcDistance,\r\n    arraysEqual, getPropertyByPath, getOwnProperty, isEmptyObject, randomChoice, rangeFindItem\r\n};\r\n","\r\n\r\n\r\nexport function *items(object) {\r\n    for(let key in object) {\r\n        if(object.hasOwnProperty(key)) {\r\n            yield [key, object[key]];\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function *keys(object) {\r\n    for(let key in object) {\r\n        if(object.hasOwnProperty(key)) {\r\n            yield key;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function *values(object) {\r\n    for(let key in object) {\r\n        if(object.hasOwnProperty(key)) {\r\n            yield object[key];\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function *enumerate(iterable) {\r\n    let i = 0;\r\n\r\n    for(let value of iterable) {\r\n        yield [i, value];\r\n    }\r\n}\r\n\r\n\r\nexport function *chain(...iterables) {\r\n    for(let iter of iterables) {\r\n        for(let value of iter) {\r\n            yield value;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Takes an iterable and returns the first none null or undefined value.\r\n * @param args\r\n */\r\nexport function firstValue(args) {\r\n    for(let item of args) {\r\n        if(item !== null && item !== undefined) {\r\n            return item;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Takes an iterable and returns true if all of the values are trueish.\r\n * @param iterable\r\n */\r\nexport function all(iterable) {\r\n    for(let item of iterable) {\r\n        if(!item) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n/**\r\n * Takes an iterable and returns true if any of the values are trueish.\r\n * @param iterable\r\n */\r\nexport function any(iterable) {\r\n    for(let item of iterable) {\r\n        if(item) return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n","/**\r\n * Clamps a value between a minimum and maximum values.\r\n * @param value\r\n * @param minValue\r\n * @param maxValue\r\n * @returns {*}\r\n */\r\nexport function clamp(value, minValue = null, maxValue = null) {\r\n    if (minValue !== null) {\r\n        value = Math.max(value, minValue);\r\n    }\r\n\r\n    if (maxValue !== null) {\r\n        value = Math.min(value, maxValue);\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\nexport function modulo(value, mod) {\r\n    return ((value % mod) + mod) % mod;\r\n}\r\n\r\n\r\nexport function calcDistance(x1, y1, x2, y2) {\r\n    return Math.sqrt(\r\n        Math.pow(x2 - x1, 2) + Math.pow(y2 - y2, 2)\r\n    );\r\n}\r\n","/**\r\n * Returns a random value from an array.\r\n * @param array\r\n * @returns {*}\r\n */\r\nexport function randomChoice(array) {\r\n    return array[Math.floor(Math.random() * array.length)];\r\n}\r\n\r\n/**\r\n * Checks to see if 2 arrays are \"equal\".\r\n * @param array1\r\n * @param array2\r\n */\r\nexport function arraysEqual(array1, array2) {\r\n    if (array1 === array2) return true; // The same object.\r\n    if (array1 == null || array2 == null) return false;\r\n    if (array1.length !== array2.length) return false;\r\n\r\n    for (let i = 0, l = array1.length; i < l; i++) {\r\n        if (array1[i] !== array2[i]) return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Tests to see if the object is empty.\r\n *\r\n * @param object\r\n * @return {boolean}\r\n */\r\nexport function isEmptyObject(object) {\r\n    // noinspection LoopStatementThatDoesntLoopJS\r\n    for (let key in object) {\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Returns the object own property or the default value if it does not have that property.\r\n * @param obj\r\n * @param propName\r\n * @param defaultValue\r\n * @returns {*}\r\n */\r\nexport function getOwnProperty(obj, propName, defaultValue = undefined) {\r\n    if (obj.hasOwnProperty(propName)) {\r\n        return obj[propName];\r\n    } else {\r\n        return defaultValue;\r\n    }\r\n}\r\n\r\n/**\r\n * Returns the obj value by following it's property path.  For example getPropertyByPath(a, 'b.c.d') is equivalent to\r\n * a.b.c.d but can be passed in string form.\r\n * @param obj\r\n * @param path\r\n * @returns {*}\r\n */\r\nexport function getPropertyByPath(obj, path) {\r\n    let parts = path.split('.'),\r\n        r = obj;\r\n\r\n    for (let part of parts) {\r\n        r = r[part];\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * rangeFindItem\r\n *\r\n * Searches an array starting at the starting index and heads towards the ending index and returns the first item that\r\n * matches the predicate function.  If no item is found then undefined will be returned.  This function can search an\r\n * array both forwards and backwards.  Just start at a greater point then the ending point and the function will\r\n * handle the rest.\r\n *\r\n * @param array - The array to search\r\n * @param predicate - The matching function.  Should return true if the item is a match.\r\n * @param startingIndex - The index to start from.\r\n * @param endingIndex - The index to end at.  (Will also search this index)\r\n * @returns {*}\r\n */\r\nexport function rangeFindItem(array, predicate, startingIndex=0, endingIndex=null) {\r\n    let i;\r\n\r\n    if(endingIndex === null) {\r\n        endingIndex = array.length-1;\r\n    }\r\n\r\n    i = startingIndex;\r\n\r\n    while(true) {\r\n        let item = array[i];\r\n\r\n        if(predicate(item)) {\r\n            return item;\r\n        }\r\n\r\n        if(startingIndex > endingIndex) {\r\n            if(i <= endingIndex) return;\r\n            i--;\r\n        } else {\r\n            if(i >= endingIndex) return;\r\n            i++;\r\n        }\r\n    }\r\n}\r\n","import Vec4 from './Vec4';\r\n\r\nconst regPercentage = /^(\\d+\\.?\\d*)%$/;\r\n\r\n\r\nexport default class RGBA extends Vec4 {\r\n    constructor(r, g, b, a) {\r\n        if(typeof r === 'object') {\r\n            super(r);\r\n        } else {\r\n            super(r, g, b, a);\r\n        }\r\n    }\r\n\r\n    toString() {\r\n        return `rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`;\r\n    }\r\n\r\n    static parseRGBAColorStringArgs(value) {\r\n        value = value.trim().split(/\\s+/);\r\n\r\n        let r = value[0],\r\n            g = value[1],\r\n            b = value[2],\r\n            a = value[3];\r\n\r\n        if(r) {\r\n            if(regPercentage.test(r)) {\r\n                r = (parseFloat(r) / 100) * 255;\r\n            } else {\r\n                r = parseInt(r, 10);\r\n            }\r\n        }\r\n\r\n        if(g) {\r\n            if(regPercentage.test(g)) {\r\n                g = (parseFloat(g) / 100) * 255;\r\n            } else {\r\n                g = parseInt(g, 10);\r\n            }\r\n        }\r\n\r\n        if(b) {\r\n            if(regPercentage.test(b)) {\r\n                b = (parseFloat(b) / 100) * 255;\r\n            } else {\r\n                b = parseInt(b, 10);\r\n            }\r\n        }\r\n\r\n        if(a) {\r\n            if(regPercentage.test(a)) {\r\n                a = (parseFloat(a) / 100);\r\n            } else {\r\n                a = parseFloat(a);\r\n            }\r\n        }\r\n\r\n        a = a || 1.0;\r\n\r\n        return new RGBA(r, g, b, a);\r\n    }\r\n\r\n    static parseHexColorStringArg(value) {\r\n        value = value.trim().substring(1);\r\n\r\n        let r, g, b, a = 1.0;\r\n\r\n        if(value.length === 3) {\r\n            r = value[0];\r\n            g = value[1];\r\n            b = value[2];\r\n\r\n            r = parseInt(r+r, 16);\r\n            g = parseInt(g+g, 16);\r\n            b = parseInt(b+b, 16);\r\n        } else if(value.length === 6) {\r\n            r = value.substr(0, 2);\r\n            g = value.substr(2, 2);\r\n            b = value.substr(4, 2);\r\n\r\n            r = parseInt(r, 16);\r\n            g = parseInt(g, 16);\r\n            b = parseInt(b, 16);\r\n        } else if(value.length === 8) {\r\n            r = value.substr(0, 2);\r\n            g = value.substr(2, 2);\r\n            b = value.substr(4, 2);\r\n            a = value.substr(6, 2);\r\n\r\n            r = parseInt(r, 16);\r\n            g = parseInt(g, 16);\r\n            b = parseInt(b, 16);\r\n            a = parseInt(a, 16) / 255;\r\n        }\r\n\r\n        return new RGBA(r, g, b, a);\r\n    }\r\n}\r\n","import {ValueError} from \"../errors\";\r\nimport Vec2 from \"./Vec2\";\r\nimport Vec4 from \"./Vec4\";\r\nimport {clamp, calcDistance} from '../utility';\r\nimport {UnitError} from '../errors';\r\n\r\n\r\nconst regWhitespace = /\\s+/,\r\n    regPositionPart = /^([a-zA-Z]*)([+-]?\\d*\\.?\\d*)([a-z%]*)$/; // Parses string like \"left+10px\" into [\"left\", \"+10px\"]\r\n\r\n\r\nconst positionShortHandValues = {\r\n    top: 'center top',\r\n    right: 'right middle',\r\n    bottom: 'center bottom',\r\n    left: 'left middle',\r\n    topleft: 'left top',\r\n    topright: 'right top',\r\n    bottomleft: 'left bottom',\r\n    bottomright: 'right bottom'\r\n};\r\n\r\n\r\nexport default class Rect extends Vec4 {\r\n    constructor(left, top, right, bottom, domElement=null) {\r\n        if(typeof left === 'function') {\r\n            left = left();\r\n        }\r\n\r\n        if(typeof left === 'object') {\r\n            if(left.getBoundingClientRect) {\r\n                domElement = left;\r\n                let bb = domElement.getBoundingClientRect();\r\n                left = bb.left;\r\n                top = bb.top;\r\n                right = bb.right;\r\n                bottom = bb.bottom;\r\n            } else {\r\n                top = left.top;\r\n                right = left.right;\r\n                bottom = left.bottom;\r\n                left = left.left;\r\n            }\r\n        }\r\n\r\n        super(left, top, right, bottom);\r\n\r\n        // noinspection JSUnusedGlobalSymbols\r\n        this.domElement = domElement;\r\n\r\n        if(arguments.length === 1 && left instanceof Rect) {\r\n            Object.assign(this, left);\r\n        }\r\n    }\r\n\r\n    bind(element) {\r\n        return this._new(this.left, this.top, this.right, this.bottom, element);\r\n    }\r\n\r\n    _new(left, top, right, bottom, domElement=undefined) {\r\n        let r = new this.constructor(this);\r\n        r.left = left;\r\n        r.top = top;\r\n        r.right = right;\r\n        r.bottom = bottom;\r\n        if(domElement !== undefined) r.domElement = domElement;\r\n        return r;\r\n    }\r\n\r\n    toPoint() {\r\n        return new Vec2(this[0], this[1]);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    getArea() {\r\n        return this.width * this.height;\r\n    }\r\n\r\n    translate(x, y) {\r\n        if(Array.isArray(x)) {\r\n            [x, y] = x;\r\n        } else if(typeof x === 'object') {\r\n            y = x.y;\r\n            x = x.x;\r\n        }\r\n\r\n        return this._new(\r\n            this[0] + x,\r\n            this[1] + y,\r\n            this[2] + x,\r\n            this[3] + y\r\n        );\r\n    }\r\n\r\n    addMargins({left, top, right, bottom}) {\r\n        return this._new(\r\n            this.left - left,\r\n            this.top - top,\r\n            this.right + right,\r\n            this.bottom + bottom\r\n        );\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    addPadding({left, top, right, bottom}) {\r\n        return this._new(\r\n            this.left + left,\r\n            this.top + top,\r\n            this.right - right,\r\n            this.bottom - bottom\r\n        );\r\n    }\r\n\r\n    moveTo({left, top}) {\r\n        let deltaX = left - this.left,\r\n            deltaY = top - this.top;\r\n\r\n        return this._new(\r\n            this.left + deltaX,\r\n            this.top + deltaY,\r\n            this.right + deltaX,\r\n            this.bottom + deltaY\r\n        );\r\n    }\r\n\r\n    intersection({left, top, right, bottom}) {\r\n        left = Math.max(this.left, left);\r\n        right = Math.min(this.right, right);\r\n        bottom = Math.min(this.bottom, bottom);\r\n        top = Math.max(this.top, top);\r\n\r\n        if(left > right || top > bottom) {\r\n            return null;\r\n        }\r\n\r\n        return this._new(left, top, right, bottom);\r\n    }\r\n\r\n    /**\r\n     * Creates a new rectangle exactly big enough to hold the current rectangle and the provided rectangle.\r\n     * @param left\r\n     * @param top\r\n     * @param right\r\n     * @param bottom\r\n     * @returns {null|Rect}\r\n     */\r\n    union({left, top, right, bottom}) {\r\n        left = Math.min(left, this.left);\r\n        right = Math.max(right, this.right);\r\n        bottom = Math.max(bottom, this.bottom);\r\n        top = Math.min(top, this.top);\r\n\r\n        if(left > right || top > bottom) {\r\n            return null;\r\n        }\r\n\r\n        return this._new(left, top, right, bottom);\r\n    }\r\n\r\n    contains(rect) {\r\n        return this.left <= rect.left && this.right >= rect.right && this.top <= rect.top && this.bottom >= rect.bottom;\r\n    }\r\n\r\n    containsX(rect) {\r\n        return this.left <= rect.left && this.right >= rect.right;\r\n    }\r\n\r\n    containsY(rect) {\r\n        return this.top <= rect.top && this.bottom >= rect.bottom;\r\n    }\r\n\r\n    isXOverlapping(rect) {\r\n        return (rect.left <= this.right && rect.right >= this.left);\r\n    }\r\n\r\n    isYOverlapping(rect) {\r\n        return (rect.top <= this.bottom && rect.bottom >= this.top);\r\n    }\r\n\r\n    isAbove(rect) {\r\n        rect = new Rect(rect);\r\n\r\n        return rect.top > this.bottom;\r\n    }\r\n\r\n    isBelow(rect) {\r\n        rect = new Rect(rect);\r\n\r\n        return rect.bottom < this.top;\r\n    }\r\n\r\n    isLeftOf(rect) {\r\n        rect = new Rect(rect);\r\n\r\n        return rect.left > this.right;\r\n    }\r\n\r\n    isRightOf(rect) {\r\n        rect = new Rect(rect);\r\n\r\n        return rect.right < this.left;\r\n    }\r\n\r\n    isOverlapping(rect) {\r\n        rect = new Rect(rect);\r\n        return this.isXOverlapping(rect) && this.isYOverlapping(rect);\r\n    }\r\n\r\n    /**\r\n     * Attempts to fit the rect inside of the container anchoring from the anchor point.  The anchor point defaults\r\n     * to the top left corner or (0, 0).\r\n     *\r\n     * If possible entire rect should be clamped to the closest position inside of the container.\r\n     * Else position anchor point the closest possible point inside container.\r\n     *\r\n     * @param container\r\n     * @param anchor\r\n     */\r\n    fit(container, anchor=null) {\r\n        anchor = anchor ? this.getAnchor(anchor) : new Vec2(0, 0);\r\n        container = new Rect(container);\r\n        let starting = container;\r\n\r\n        container = container.add(new Rect(\r\n            anchor.left,\r\n            anchor.top,\r\n            -this.width + anchor.left,\r\n            -this.height + anchor.top\r\n        ));\r\n\r\n        container = new Rect(\r\n            clamp(container.left, starting.left, starting.right),\r\n            clamp(container.top, starting.top, starting.bottom),\r\n            clamp(container.right, starting.left, starting.right),\r\n            clamp(container.bottom, starting.top, starting.bottom)\r\n        );\r\n\r\n        let left = clamp(this.left, container.left, container.right) - anchor.left,\r\n            top = clamp(this.top, container.top, container.bottom) - anchor.top,\r\n            width = this.width,\r\n            height = this.height;\r\n\r\n        return this._new(\r\n            left,\r\n            top,\r\n            left + width,\r\n            top + height\r\n        );\r\n    }\r\n\r\n    fitX(container, anchor=null) {\r\n        let pos = this.fit(container, anchor);\r\n        return this._new(pos.left, this.top, pos.right, this.bottom);\r\n    }\r\n\r\n    fitY(container, anchor=null) {\r\n        let pos = this.fit(container, anchor);\r\n        return this._new(this.left, pos.top, this.right, pos.bottom);\r\n    }\r\n\r\n    /**\r\n     * Clamps the anchor point inside the rect.  Anchor point defaults to top left or (0, 0).\r\n     *\r\n     * @param rect\r\n     * @param anchor\r\n     * @returns {Rect}\r\n     */\r\n    clamp(rect, anchor=null) {\r\n        anchor = anchor ? this.getAnchor(anchor) : new Vec2(0, 0);\r\n        rect = new Rect(rect);\r\n\r\n        let width = this.width,\r\n            height = this.height,\r\n            left = clamp(this.left + anchor.left, rect.left, rect.right) - anchor.left,\r\n            top = clamp(this.top + anchor.top, rect.top, rect.bottom) - anchor.top;\r\n\r\n        return this._new(\r\n            left,\r\n            top,\r\n            left + width,\r\n            top + height\r\n        );\r\n    }\r\n\r\n    clampX(rect, anchor=null) {\r\n        let pos = this.clamp(rect, anchor);\r\n        return this._new(pos.left, this.top, pos.right, this.bottom);\r\n    }\r\n\r\n    clampY(rect, anchor=null) {\r\n        let pos = this.clamp(rect, anchor);\r\n        return this._new(this.left, pos.top, this.right, pos.bottom);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Returns the distance between two rects.\r\n     * @param rect\r\n     * @returns {number}\r\n     */\r\n    getDistanceBetween(rect) {\r\n        rect = Rect.fromRect(rect);\r\n\r\n        let isXOverlapping = this.isXOverlapping(rect),\r\n            isYOverlapping = this.isYOverlapping(rect);\r\n\r\n        if(isXOverlapping && isYOverlapping) {\r\n            // Items are overlapping\r\n            return 0;\r\n        } else if(isXOverlapping) {\r\n            return Math.min(\r\n                Math.abs(this.bottom - rect.top),\r\n                Math.abs(this.top - rect.bottom)\r\n            );\r\n        } else if(isYOverlapping) {\r\n            return Math.min(\r\n                Math.abs(this.right - rect.left),\r\n                Math.abs(this.left - rect.right)\r\n            );\r\n        } else {\r\n            let x1, y1, x2, y2;\r\n\r\n            if(this.right <= rect.left) {\r\n                x1 = this.right;\r\n                x2 = rect.left;\r\n            } else {\r\n                x1 = this.left;\r\n                x2 = rect.right;\r\n            }\r\n\r\n            if(this.bottom <= rect.top) {\r\n                y1 = this.bottom;\r\n                y2 = rect.top;\r\n            } else {\r\n                y1 = this.top;\r\n                y2 = rect.bottom;\r\n            }\r\n\r\n            // Use distance formula to calculate distance.\r\n            return Math.round(Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)));\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    getDistanceFromPoint(point) {\r\n        point = new Rect(point.left, point.top, point.left, point.top);\r\n\r\n        let closestX = Math.abs(this.left - point.left) < Math.abs(this.right - point.left) ? this.left : this.right,\r\n            closestY = Math.abs(this.top - point.top) < Math.abs(this.bottom - point.top) ? this.top : this.bottom,\r\n            distance = calcDistance(closestX, closestY, point.left, point.top);\r\n\r\n        return this.contains(point) ? -distance : distance;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    getCenterPoint() {\r\n        return new Vec2(\r\n            this.left + (this.width / 2),\r\n            this.top + (this.height / 2)\r\n        );\r\n    }\r\n\r\n    reflect(point=null, axis='xy') {\r\n        // Reflect around the given point or origin\r\n        point = point ? new Vec2(point) : new Vec2(0, 0);\r\n\r\n        let x = this.left + (this.width / 2) - point.x,\r\n            y = this.top + (this.height / 2) - point.y;\r\n\r\n        if(axis === 'x' || axis === 'xy') {\r\n            x *= -1;\r\n        }\r\n\r\n        if(axis === 'y' || axis === 'xy') {\r\n            y *= -1;\r\n        }\r\n\r\n        x = x - (this.width / 2) + point.x;\r\n        y = y - (this.height / 2) + point.y;\r\n\r\n        return this._new(x, y, x + this.width, y + this.height);\r\n    }\r\n\r\n    position({my, at, of, offset=null, inside=null, collision=null}) {\r\n        // Of should be a Rect object.\r\n        if(of.getBoundingClientRect) {\r\n            of = new Rect(of);\r\n        }\r\n\r\n        // inside should be a Rect object.\r\n        if(inside && inside.getBoundingClientRect) {\r\n            inside = new Rect(inside);\r\n        }\r\n\r\n        // collision can be string with a space separating the x and y values.\r\n        // for example \"fit flipfit\"\r\n        // normalize it to an {x, y} object.\r\n        if(collision && typeof collision === 'string') {\r\n            let parts = collision.trim().split(regWhitespace);\r\n            collision = {\r\n                x: parts[0],\r\n                y: parts[1] || parts[0]\r\n            };\r\n        }\r\n\r\n        let anchor = this.evaluatePositionString(my),\r\n            reference = of.evaluatePositionString(at),\r\n            deltaX = reference.x - anchor.x,\r\n            deltaY = reference.y - anchor.y;\r\n\r\n        let rect = this.translate(deltaX, deltaY);\r\n\r\n        if(offset) {\r\n            rect = this.translate(offset);\r\n        }\r\n\r\n        // If the rect is already inside the container or if not container or collision function where given\r\n        // return immediately, there is not more work to be done.\r\n        if(!collision || !inside || inside.contains(rect)) {\r\n            return rect;\r\n        }\r\n\r\n        if(!inside.containsX(rect) && (collision.x === 'flip' || collision.x === 'flipfit')) {\r\n            rect = rect.reflect(of.getCenterPoint(), 'x');\r\n        }\r\n\r\n        if(!inside.containsY(rect) && (collision.y === 'flip' || collision.y === 'flipfit')) {\r\n            rect = rect.reflect(of.getCenterPoint(), 'y');\r\n        }\r\n\r\n        if(collision.x === 'fit' || collision.x === 'flipfit') {\r\n            rect = rect.fitX(inside);\r\n        }\r\n\r\n        if(collision.y === 'fit' || collision.y === 'flipfit') {\r\n            rect = rect.fitY(inside);\r\n        }\r\n\r\n        return rect;\r\n    }\r\n\r\n    evaluatePositionString(string) {\r\n        if(positionShortHandValues[string]) {\r\n            string = positionShortHandValues[string];\r\n        }\r\n\r\n        let pos = string.trim().split(regWhitespace),\r\n            x = pos[0],\r\n            y = pos[1],\r\n            rx = null,\r\n            ry = null;\r\n\r\n        if(x) {\r\n            rx = this._evaluatePositionStringComponent(x, 'x');\r\n        }\r\n\r\n        if(y) {\r\n            ry = this._evaluatePositionStringComponent(y, 'y');\r\n        }\r\n\r\n        return new Vec2(rx, ry);\r\n    }\r\n\r\n    /**\r\n     * Gets the anchor position relative to the element.  The anchor can be any of the following:\r\n     *\r\n     * A position string.\r\n     * A [x, y, offsetX=0, offsetY=0] array.\r\n     * An object of {left, top, offsetX=0, offsetY=0} properties.\r\n     *\r\n     * @param anchor\r\n     * @returns {Vec2}\r\n     */\r\n    getAnchor(anchor) {\r\n        if(positionShortHandValues[anchor]) {\r\n            anchor = positionShortHandValues[anchor];\r\n        }\r\n\r\n        let x, y, offsetX = 0, offsetY = 0;\r\n\r\n        if(typeof anchor === 'string') {\r\n            [x, y] = anchor.trim().split(regWhitespace);\r\n        } else if(Array.isArray(anchor)) {\r\n            [x, y, offsetX=0, offsetY=0] = anchor;\r\n        } else {\r\n            x = anchor.left;\r\n            y = anchor.top;\r\n            offsetX = anchor.offsetX || 0;\r\n            offsetY = anchor.offsetY || 0;\r\n        }\r\n\r\n        if(typeof x === 'string') {\r\n            x = this._evaluatePositionStringComponent(x, 'x') - this.left;\r\n        }\r\n\r\n        if(typeof y === 'string') {\r\n            y = this._evaluatePositionStringComponent(y, 'y') - this.top;\r\n        }\r\n\r\n        return new Vec2(x + offsetX, y + offsetY);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Takes a anchor point coordient relative the the rect and returns the true coordients.\r\n     * @param anchor\r\n     * @returns {Vec2}\r\n     */\r\n    getPoint(anchor) {\r\n        let point = this.getAnchor(anchor);\r\n        return new Vec2(point.left + this.left, point.top + this.top);\r\n    }\r\n\r\n    /**\r\n     * Evaluates a position string value such as \"left+10px\" into it final position on the rect.\r\n     * @param value - The value to evaluate.\r\n     * @param direction - The direction type.  Should be either \"x\" or \"y\".\r\n     * @returns {number}\r\n     * @private\r\n     */\r\n    _evaluatePositionStringComponent(value, direction) {\r\n        let parts = regPositionPart.exec(value),\r\n            r = 0;\r\n\r\n        if(parts[1]) {\r\n            let p = parts[1];\r\n\r\n            if(direction === 'x') {\r\n                if(p === 'left') {\r\n                    r = this.left;\r\n                } else if(p === 'center' || p === 'middle') {\r\n                    r = this.left + (this.width / 2);\r\n                } else if(p === 'right') {\r\n                    r = this.left + this.width;\r\n                } else {\r\n                    throw new ValueError(`Invalid Option: ${p}`);\r\n                }\r\n            } else {\r\n                if(p === 'top') {\r\n                    r = this.top;\r\n                } else if(p === 'middle' || p === 'center') {\r\n                    r = this.top + (this.height / 2);\r\n                } else if(p === 'bottom') {\r\n                    r = this.top + this.height;\r\n                } else {\r\n                    throw new ValueError(`Invalid Option: ${p}`);\r\n                }\r\n            }\r\n        } else if(direction === 'x') {\r\n            r = this.left;\r\n        } else {\r\n            r = this.top;\r\n        }\r\n\r\n        if(parts[2]) {\r\n            let value = parseFloat(parts[2]),\r\n                type = parts[3] || 'px';\r\n\r\n            if(type === 'px') {\r\n                r += value;\r\n            } else if(type === '%') {\r\n                if(direction === 'x') {\r\n                    r += (value / 100) * this.width;\r\n                } else {\r\n                    r += (value / 100) * this.height;\r\n                }\r\n            } else {\r\n                throw new UnitError(\"Invalid unit: Must be either % or px.\");\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static fromRect({left, top, right, bottom}) {\r\n        return new Rect(left, top, right, bottom);\r\n    }\r\n\r\n    static getBoundingClientRect(element) {\r\n        return new Rect(element);\r\n    }\r\n\r\n    /**\r\n     * Returns the elements Rect without any inline styles applied.\r\n     * @param element\r\n     * @param restore - If true inline style will be restored after measuring.\r\n     * @returns {Rect}\r\n     */\r\n    static getCleanBoundingClientRect(element, restore=true) {\r\n        let state = {},\r\n            keys = [];\r\n\r\n        for(let i = 0; i < element.style.length; i++) {\r\n            keys.push(element.style[i]);\r\n        }\r\n\r\n        for(let key of keys) {\r\n            state[key] = element.style[key];\r\n            element.style[key] = \"\";\r\n        }\r\n\r\n        let r = Rect.getBoundingClientRect(element);\r\n\r\n        if(restore) {\r\n            Object.assign(element.style, state);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static getClientRect() {\r\n        return new Rect(\r\n            0,\r\n            0,\r\n            window.innerWidth,\r\n            window.innerHeight\r\n        );\r\n    }\r\n\r\n    static getRootContainingClientRect() {\r\n        return new Rect(\r\n            -window.scrollX,\r\n            -window.scrollY,\r\n            document.documentElement.clientWidth - window.scrollX,\r\n            document.documentElement.clientHeight - window.scrollY\r\n        );\r\n    }\r\n\r\n    get left() {\r\n        return this[0];\r\n    }\r\n\r\n    get top() {\r\n        return this[1];\r\n    }\r\n\r\n    get right() {\r\n        return this[2];\r\n    }\r\n\r\n    get bottom() {\r\n        return this[3];\r\n    }\r\n\r\n    set left(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set top(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    set right(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    set bottom(value) {\r\n        this[3] = value;\r\n    }\r\n\r\n    get width() {\r\n        return this.right - this.left;\r\n    }\r\n\r\n    get height() {\r\n        return this.bottom - this.top;\r\n    }\r\n\r\n    set width(value) {\r\n        this.right = this.left + value;\r\n    }\r\n\r\n    set height(value) {\r\n        this.bottom = this.top + value;\r\n    }\r\n\r\n    get x() {\r\n        return this.left;\r\n    }\r\n\r\n    get y() {\r\n        return this.top;\r\n    }\r\n\r\n    set x(value) {\r\n        this.left = value;\r\n    }\r\n\r\n    set y(value) {\r\n        this.top = value;\r\n    }\r\n}\r\n","import {clamp} from '../utility';\r\n\r\n\r\n/**\r\n * Stores a 2 value Vector.\r\n */\r\nexport default class Vec2 {\r\n    constructor(x=0, y=0) {\r\n        if(x instanceof Vec2) {\r\n            this[0] = x.x;\r\n            this[1] = x.y;\r\n        } else if(Array.isArray(x)) {\r\n            this[0] = x[0];\r\n            this[1] = x[1];\r\n        } else if(typeof x === 'object') {\r\n            if(x.left !== undefined) {\r\n                this[0] = x.left;\r\n                this[0] = x.top;\r\n            } else {\r\n                this[0] = x.x;\r\n                this[1] = x.y;\r\n            }\r\n        } else {\r\n            this[0] = x;\r\n            this[1] = y;\r\n        }\r\n    }\r\n\r\n    add(vec2) {\r\n        if(typeof vec2 === 'number') {\r\n            return new Vec2(\r\n                this[0] + vec2,\r\n                this[1] + vec2\r\n            );\r\n        } else {\r\n            return new Vec2(\r\n                this[0] + vec2[0],\r\n                this[1] + vec2[1]\r\n            );\r\n        }\r\n    }\r\n\r\n    subtract(vec2) {\r\n        if(typeof vec2 === 'number') {\r\n            return new Vec2(\r\n                this[0] - vec2,\r\n                this[1] - vec2\r\n            );\r\n        } else {\r\n            return new Vec2(\r\n                this[0] - vec2[0],\r\n                this[1] - vec2[1]\r\n            );\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    scalar(value) {\r\n        return new Vec2(this[0] * value, this[1] * value);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    mod(vec2) {\r\n        if(typeof vec2 === 'number') {\r\n            return new Vec2(\r\n                this[0] % vec2,\r\n                this[1] % vec2\r\n            );\r\n        } else {\r\n            return new Vec2(\r\n                this[0] % vec2[0],\r\n                this[1] % vec2[1]\r\n            );\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    equals(vec2) {\r\n        return this === vec2 || (this[0] === vec2[0] && this[1] === vec2[1]);\r\n    }\r\n\r\n    set(value) {\r\n        if(typeof value !== 'object') {\r\n            this[0] = value;\r\n            this[1] = value;\r\n        } else {\r\n            this[0] = value[0];\r\n            this[1] = value[1];\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    clone() {\r\n        return Vec2(this[0], this[1]);\r\n    }\r\n\r\n    get x() {\r\n        return this[0];\r\n    }\r\n\r\n    get y() {\r\n        return this[1];\r\n    }\r\n\r\n    get left() {\r\n        return this[0];\r\n    }\r\n\r\n    get right() {\r\n        return this[0];\r\n    }\r\n\r\n    get top() {\r\n        return this[1];\r\n    }\r\n\r\n    get bottom() {\r\n        return this[1];\r\n    }\r\n\r\n    set x(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set y(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    set left(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set top(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    get width() {\r\n        return this[0];\r\n    }\r\n\r\n    set width(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    get height() {\r\n        return this[1];\r\n    }\r\n\r\n    set height(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    toTranslate() {\r\n        return `translate(${this.x}px, ${this.y}px)`;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    toTranslate3d() {\r\n        return `translate3d(${this.x}px, ${this.y}px, 0)`;\r\n    }\r\n\r\n    clamp(vec4) {\r\n        return new Vec2(\r\n            clamp(this.left, vec4.left, vec4.right),\r\n            clamp(this.top, vec4.top, vec4.bottom)\r\n        );\r\n    }\r\n\r\n    static fromVertex(vertex) {\r\n        if(Array.isArray(vertex)) {\r\n            return new Vec2(vertex[0], vertex[1]);\r\n        } else if(vertex.hasOwnProperty('left')) {\r\n            return new Vec2(vertex.left, vertex.top);\r\n        } else {\r\n            return new Vec2(vertex.x, vertex.y);\r\n        }\r\n    }\r\n}\r\n","\r\n\r\n/**\r\n * Stores a 3 value vector.\r\n */\r\nexport default class Vec3 {\r\n    constructor(x=0, y=0, z=0) {\r\n        this[0] = x;\r\n        this[1] = y;\r\n        this[2] = z;\r\n    }\r\n\r\n    get x() {\r\n        return this[0];\r\n    }\r\n\r\n    get y() {\r\n        return this[1];\r\n    }\r\n\r\n    get z() {\r\n        return this[2];\r\n    }\r\n\r\n    set x(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set y(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    set z(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    get r() {\r\n        return this[0];\r\n    }\r\n\r\n    get g() {\r\n        return this[1];\r\n    }\r\n\r\n    get b() {\r\n        return this[2];\r\n    }\r\n\r\n    set r(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    set g(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    set b(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    set(value) {\r\n        if(typeof value !== 'object') {\r\n            this[0] = value;\r\n            this[1] = value;\r\n            this[2] = value;\r\n        } else {\r\n            this[0] = value[0];\r\n            this[1] = value[1];\r\n            this[2] = value[2];\r\n        }\r\n    }\r\n\r\n    add(vec3) {\r\n        if(typeof vec3 === 'number') {\r\n            return new Vec3(\r\n                this[0] + vec3,\r\n                this[1] + vec3,\r\n                this[2] + vec3\r\n            );\r\n        } else {\r\n            return new Vec3(\r\n                this[0] + vec3[0],\r\n                this[1] + vec3[1],\r\n                this[2] + vec3[2]\r\n            );\r\n        }\r\n    }\r\n\r\n    subtract(vec3) {\r\n        if(typeof vec3 === 'number') {\r\n            return new Vec3(\r\n                this[0] - vec3,\r\n                this[1] - vec3,\r\n                this[2] - vec3\r\n            );\r\n        } else {\r\n            return new Vec3(\r\n                this[0] - vec3[0],\r\n                this[1] - vec3[1],\r\n                this[2] - vec3[2]\r\n            );\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    scalar(value) {\r\n        return new Vec3(\r\n            this[0] * value,\r\n            this[1] * value,\r\n            this[2] * value\r\n        );\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    equals(vec3) {\r\n        return vec3 === this || (vec3[0] === this[0] && vec3[1] === this[1] && vec3[2] === this[2]);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    mod(vec3) {\r\n        if(typeof vec3 === 'number') {\r\n            return new Vec3(\r\n                this[0] % vec3,\r\n                this[1] % vec3,\r\n                this[2] % vec3\r\n            );\r\n        } else {\r\n            return new Vec3(\r\n                this[0] % vec3[0],\r\n                this[1] % vec3[1],\r\n                this[2] % vec3[2]\r\n            );\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    clone() {\r\n        return new Vec3(this[0], this[1], this[2]);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    toHex() {\r\n        let r = Math.round(this.r).toString(16),\r\n            g = Math.round(this.g).toString(16),\r\n            b = Math.round(this.b).toString(16);\r\n\r\n        if(r.length === 1) {\r\n            r = '0' + r;\r\n        }\r\n\r\n        if(g.length === 1) {\r\n            g = '0' + g;\r\n        }\r\n\r\n        if(b.length === 1) {\r\n            b = '0' + b;\r\n        }\r\n\r\n        return `#${r}${g}${b}`;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    toRGB() {\r\n        return `rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    toTranslate3d() {\r\n        return `translate3d(${this.x}px, ${this.y}px, ${this.z}px)`;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    static fromHex(hex) {\r\n        let m = /^#?([0-9a-f]{3})$/i.exec(hex);\r\n\r\n        if(m) {\r\n            hex = m[1][0] + m[1][0] + m[1][1] + m[1][1] + m[1][2] + m[1][2];\r\n        } else {\r\n            m = /^#?([0-9a-f]{6})$/i.exec(hex);\r\n\r\n            if(m) {\r\n                hex = m[1];\r\n            } else {\r\n                throw new Error(`Could not parse value ${hex}`);\r\n            }\r\n        }\r\n\r\n        hex = parseInt(hex, 16);\r\n\r\n        // r, g, b\r\n        return new Vec3(\r\n            hex & 0xff0000 >> 16,\r\n            hex & 0x00ff00 >> 8,\r\n            hex & 0x0000ff\r\n        );\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    static fromRGB(value) {\r\n        let m = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/.exec(value);\r\n\r\n        if(!m) {\r\n            throw new Error(`Could not parse rgb value ${value}`);\r\n        }\r\n\r\n        return new Vec3(\r\n            parseInt(m[1], 10),\r\n            parseInt(m[2], 10),\r\n            parseInt(m[3], 10),\r\n        );\r\n    }\r\n}\r\n","/**\r\n * Class to store a 4 value vector.\r\n * Provides DOMRect interface.\r\n */\r\nexport default class Vec4 {\r\n    /**\r\n     * r, g, b, a\r\n     * left, top, right, bottom\r\n     *\r\n     * @param left\r\n     * @param top\r\n     * @param right\r\n     * @param bottom\r\n     */\r\n    constructor(left, top, right, bottom) {\r\n        this[0] = left;\r\n        this[1] = top;\r\n        this[2] = right;\r\n        this[3] = bottom;\r\n    }\r\n\r\n    get r() {\r\n        return this[0];\r\n    }\r\n\r\n    set r(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    get g() {\r\n        return this[1];\r\n    }\r\n\r\n    set g(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    get b() {\r\n        return this[2];\r\n    }\r\n\r\n    set b(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    get a() {\r\n        return this[3];\r\n    }\r\n\r\n    set a(value) {\r\n        this[3] = value;\r\n    }\r\n\r\n    set(valueOrVec4) {\r\n        if(typeof valueOrVec4 !== 'object') {\r\n            this[0] = valueOrVec4;\r\n            this[1] = valueOrVec4;\r\n            this[2] = valueOrVec4;\r\n            this[3] = valueOrVec4;\r\n        } else {\r\n            this[0] = valueOrVec4[0];\r\n            this[1] = valueOrVec4[1];\r\n            this[2] = valueOrVec4[2];\r\n            this[3] = valueOrVec4[3];\r\n        }\r\n    }\r\n\r\n    add(valueOrVec4) {\r\n        if(typeof valueOrVec4 === 'number') {\r\n            return this._new(\r\n                this[0] + valueOrVec4,\r\n                this[1] + valueOrVec4,\r\n                this[2] + valueOrVec4,\r\n                this[3] + valueOrVec4\r\n            );\r\n        } else {\r\n            return this._new(\r\n                this[0] + valueOrVec4[0],\r\n                this[1] + valueOrVec4[1],\r\n                this[2] + valueOrVec4[2],\r\n                this[3] + valueOrVec4[3]\r\n            );\r\n        }\r\n    }\r\n\r\n    subtract(valueOrVec4) {\r\n        if(typeof valueOrVec4 === 'number') {\r\n            return this._new(\r\n                this[0] - valueOrVec4,\r\n                this[1] - valueOrVec4,\r\n                this[2] - valueOrVec4,\r\n                this[3] - valueOrVec4\r\n            );\r\n        } else {\r\n            return this._new(\r\n                this[0] - valueOrVec4[0],\r\n                this[1] - valueOrVec4[1],\r\n                this[2] - valueOrVec4[2],\r\n                this[3] - valueOrVec4[3]\r\n            );\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    scalar(value) {\r\n        return this._new(\r\n            this[0] * value,\r\n            this[1] * value,\r\n            this[2] * value,\r\n            this[3] * value\r\n        );\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    equals(vec4) {\r\n        return vec4 === this || (vec4[0] === this[0] && vec4[1] === this[1] && vec4[2] === this[2] && vec4[3] === this[3]);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    mod(valueOrVec4) {\r\n        if(typeof valueOrVec4 === 'number') {\r\n            return this._new(\r\n                this[0] % valueOrVec4,\r\n                this[1] % valueOrVec4,\r\n                this[2] % valueOrVec4,\r\n                this[3] % valueOrVec4,\r\n            );\r\n        } else {\r\n            return this._new(\r\n                this[0] % valueOrVec4[0],\r\n                this[1] % valueOrVec4[1],\r\n                this[2] % valueOrVec4[2],\r\n                this[3] % valueOrVec4[3]\r\n            );\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    toRGBA() {\r\n        return `rgba(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)}, ${this.a})`;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    clone() {\r\n        return new this.constructor(this[0], this[1], this[2], this[3]);\r\n    }\r\n\r\n    _new(left, top, right, bottom) {\r\n        return new this.constructor(left, top, right, bottom);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    static fromRGBAObject({r, g, b, a}) {\r\n        return new Vec4(r, g, b, a);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    static fromRGBA(value) {\r\n        let m = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d+\\.?\\d*)\\)$/.exec(value);\r\n\r\n        if(!m) {\r\n            throw new Error(`Could not parse rgba value ${value}`);\r\n        }\r\n\r\n        return new Vec4(\r\n            parseInt(m[1], 10),\r\n            parseInt(m[2], 10),\r\n            parseInt(m[3], 10),\r\n            parseFloat(m[4]),\r\n        );\r\n    }\r\n}\r\n","import Rect from \"./Rect\";\r\nimport Vec2 from \"./Vec2\";\r\nimport Vec3 from \"./Vec3\";\r\nimport Vec4 from \"./Vec4\";\r\nimport RGBA from \"./RGBA\";\r\nimport {UnitError} from \"../errors\";\r\n\r\n\r\nexport {Rect, Vec2, Vec3, Vec4, RGBA, UnitError};\r\n","import Draggable from 'core/ui/Draggable';\r\nimport {CONTAINERS} from 'core/ui/Draggable';\r\nimport Sortable from 'core/ui/Sortable';\r\nimport {privateCache} from \"../../src/core/data\";\r\nimport {getTranslation} from \"core/ui/position\";\r\n\r\nwindow.privateCache = privateCache;\r\n\r\n\r\nwindow.getTranslation = getTranslation;\r\n\r\n\r\nwindow.addEventListener('load', () => {\r\n    window.draggableBox1 = new Draggable(\"#test-draggable1\", {container: CONTAINERS.client, helper: Draggable.CLONE(0.5), revert: 1000});\r\n    window.draggableWindow1 = new Draggable(\"#test-window1\", {container: CONTAINERS.client, handle: '.drag-handle'});\r\n    window.draggableBox2 = new Draggable('#drop-test1-droppable', {droppables: '#drop-zone-test1'});\r\n\r\n    window.draggableScrollable = new Draggable(document.querySelector(\"#scroll-draggable-test\"), {scroll: 1, container: CONTAINERS.viewport});\r\n\r\n    window.sortableGrid = new Sortable(\"#sortable-grid\", {layout: 'xy', setPlaceholderSize: true});\r\n    window.sortableList1 = new Sortable('#drag-list-test', {droppables: '.drop-list', placeholder: true, setPlaceholderSize: true});\r\n    window.sortableList2 = new Sortable('#drag-list-test2', {droppables: '.drop-list', placeholder: true, setPlaceholderSize: true});\r\n\r\n    document.querySelector('#drop-zone-test1').addEventListener('drop', event => {\r\n        event.target.style.backgroundColor = '#00ff00';\r\n    });\r\n});\r\n\r\n\r\nwindow.addEventListener('mousemove', (event) => {\r\n    let output = document.getElementById('mouse-pos-client-output');\r\n    output.innerText = `(${event.clientX}, ${event.clientY})`;\r\n\r\n    output = document.getElementById('document-position-output');\r\n    output.innerText = `(${event.clientX + window.scrollX}, ${event.clientY + window.scrollY})`;\r\n});\r\n"],"sourceRoot":""}