{"version":3,"sources":["webpack://pendora/./jekyll/js/pages/documentation/test_draggable.js","webpack://pendora/./src/core/fx/Animation.js","webpack://pendora/./src/core/fx/FX.js","webpack://pendora/./src/core/fx/easing.js","webpack://pendora/./src/core/fx/frame.js","webpack://pendora/./src/core/fx/types.js","webpack://pendora/./src/core/ui/Draggable.js","webpack://pendora/./src/core/ui/Sortable.js"],"names":["window","privateCache","getTranslation","addEventListener","event","output","document","getElementById","innerText","clientX","clientY","scrollX","scrollY","TestDraggablePage","draggableBox1","Draggable","container","CONTAINERS","client","helper","CLONE","revert","draggableWindow1","handle","draggableBox2","droppables","draggableScrollable","querySelector","scroll","viewport","sortableGrid","Sortable","layout","setPlaceholderSize","sortableList1","placeholder","sortableList2","target","style","backgroundColor","Animation","duration","frames","applyFrame","defaultApplyFrame","bubbleFrameEvent","finishFrame","element","easing","onStart","onFrame","onPause","onCancel","onEnd","onComplete","FX","animation","fx","EASING","linear","position","autoPlay","init","call","destroy","play","animate","complete","config","defaults","_options","Object","assign","canceled","paused","pending","error","playing","regNumberWithUnit","regColor","regFunction","TYPE_FUNCTIONS","hex","RGBA","parseHexColorStringArg","rgb","parseRGBAColorStringArgs","rgba","DeadFXError","ExtendableError","assertFXAlive","status","doPromiseAction","onAction","value","resolveOrReject","_prepareValue","trim","m","exec","NumberWithUnit","parseFloat","_getFrames","r","keyframeIndex","hasOwnProperty","frame","property","Symbol","toStringTag","selectElement","undefined","key","pos","freeze","push","properties","sort","a","b","startPosition","startValue","endPosition","endValue","getFrameFX","options","p","delta","subtract","add","scalar","tick","performance","now","frameFN","timestamp","dispatchEvent","CustomEvent","bubbles","detail","requestAnimationFrame","_complete","cancelAnimationFrame","_triggerEndEvent","completeAnimation","_cancel","getFrame","onResolve","state","onReject","Promise","resolve","reject","onFinally","then","slice","toString","unit","TypeError","Error","cursor","boundingRect","x","left","y","top","clone","opacity","draggable","cloneNode","_getScrollParent","o","parentElement","scrollWidth","clientWidth","scrollHeight","clientHeight","_translate","transform","height","innerHeight","width","innerWidth","right","bottom","parent","bb","getBoundingClientRect","scrollLeft","scrollTop","_clampPositionToContainer","rect","closest","clamp","TOLERANCE_FUNCTIONS","intersect","droppable","item","origin","axis","exclude","delay","offset","disabled","distance","selector","tolerance","setHelperSize","grid","_onMouseDown","onMouseDown","bind","Array","isArray","addDroppables","isDragging","_revertFX","concat","contains","data","cache","excluded","preventDefault","doc","startMouseDocumentX","startMouseDocumentY","mouseDocumentX","mouseDocumentY","startDragging","startDrag","timer","onTimeout","removeEventListener","onMouseUp","clearTimeout","setTimeout","onMouseMove","Math","sqrt","startMouseX","startMouseY","posX","posY","cancel","getDropTargets","startBoundingBox","startBBDocument","clientRectToDocumentSpace","scrollTick","boxSizing","appendChild","startingTranslation","_offset","startingRect","_getPosition","dropData","setElementClientPosition","_getDropData","intersectsBefore","intersectsAfter","_dispatchDroppableEvent","_triggerEvent","details","mouseX","mouseY","originalEvent","topic","lastTick","parentBB","helperBB","isOOB","classList","remove","translation","accepted","accept","isAccepted","startX","removeChild","documentRectToClientSpace","dropped","_intersects","dataset","relatedTarget","startingBoundingClientRect","type","querySelectorAll","indexOf","endingRect","dropBox","eventName","publish","dropElement","name","customEvent","snapToGrid","Publisher","className","nodeName","createElement","box","items","dropOnEmpty","accepts","initEvents","isOver","initialize","onDragMove","onDragComplete","onSortAppend","startBB","insertBefore","matches","prototype","getItems","filter","i","before","getItemBeforePoint","after","getItemAfterPoint","beforeBB","length","_refreshPositions","_triggerSortAppendEvent","nextSibling","mx","my","getRelativePosition","current","deltaLeft","deltaTop"],"mappings":"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","file":"chunk-2.bundle.js","sourcesContent":["import Draggable from 'core/ui/Draggable';\r\nimport {CONTAINERS} from 'core/ui/Draggable';\r\nimport Sortable from 'core/ui/Sortable';\r\nimport {privateCache} from \"core/data.js\";\r\nimport {getTranslation} from \"core/ui/position\";\r\n\r\nwindow.privateCache = privateCache;\r\n\r\n\r\nwindow.getTranslation = getTranslation;\r\n\r\n\r\nwindow.addEventListener('mousemove', (event) => {\r\n    let output = document.getElementById('mouse-pos-client-output');\r\n    output.innerText = `(${event.clientX}, ${event.clientY})`;\r\n\r\n    output = document.getElementById('document-position-output');\r\n    output.innerText = `(${event.clientX + window.scrollX}, ${event.clientY + window.scrollY})`;\r\n});\r\n\r\n\r\nexport default class TestDraggablePage {\r\n    load() {\r\n        window.draggableBox1 = new Draggable(\"#test-draggable1\", {container: CONTAINERS.client, helper: Draggable.CLONE(0.5), revert: 1000});\r\n        window.draggableWindow1 = new Draggable(\"#test-window1\", {container: CONTAINERS.client, handle: '.drag-handle'});\r\n        window.draggableBox2 = new Draggable('#drop-test1-droppable', {droppables: '#drop-zone-test1'});\r\n\r\n        window.draggableScrollable = new Draggable(document.querySelector(\"#scroll-draggable-test\"), {scroll: 1, container: CONTAINERS.viewport});\r\n\r\n        window.sortableGrid = new Sortable(\"#sortable-grid\", {layout: 'xy', setPlaceholderSize: true});\r\n        window.sortableList1 = new Sortable('#drag-list-test', {droppables: '.drop-list', placeholder: true, setPlaceholderSize: true});\r\n        window.sortableList2 = new Sortable('#drag-list-test2', {droppables: '.drop-list', placeholder: true, setPlaceholderSize: true});\r\n\r\n        document.querySelector('#drop-zone-test1').addEventListener('drop', event => {\r\n            event.target.style.backgroundColor = '#00ff00';\r\n        });\r\n    }\r\n}\r\n","import {EASING} from \"./easing\";\r\nimport FX from \"./FX\";\r\nimport {defaultApplyFrame} from \"./frame\";\r\n\r\n\r\nexport default class Animation {\r\n    static defaultApplyFrame = defaultApplyFrame;\r\n\r\n    static complete = FX.complete;\r\n    static canceled = FX.canceled;\r\n    static paused = FX.paused;\r\n    static pending = FX.pending;\r\n    static error = FX.error;\r\n    static playing = FX.playing;\r\n\r\n    /**\r\n     *\r\n     * @param duration\r\n     * @param frames {{}|function(Element element, Animation animation):{}}\r\n     * @param applyFrame - The function that takes a frame and applies it to the element.\r\n     * @param bubbleFrameEvent\r\n     * @param finishFrame\r\n     */\r\n    constructor({duration=null, frames, applyFrame = defaultApplyFrame, bubbleFrameEvent = false, finishFrame = null}) {\r\n        this.frames = frames;\r\n        this.applyFrame = applyFrame || Animation.defaultApplyFrame;\r\n        this.bubbleFrameEvent = bubbleFrameEvent;\r\n        this.finishFrame = finishFrame;\r\n        this.duration = duration;\r\n    }\r\n\r\n    /**\r\n     * Creates an fx object.\r\n     *\r\n     * @param element\r\n     * @param frames\r\n     * @param duration\r\n     * @param applyFrame\r\n     * @param easing\r\n     * @param onStart\r\n     * @param onFrame\r\n     * @param onPause\r\n     * @param onCancel\r\n     * @param onEnd\r\n     * @param onComplete\r\n     * @param bubbleFrameEvent\r\n     * @param finishFrame\r\n     * @returns {FX}\r\n     */\r\n    init({element, frames, duration, applyFrame, easing, onStart, onFrame, onPause, onCancel, onEnd, onComplete, bubbleFrameEvent, finishFrame}) {\r\n        return new FX(element, frames, duration, {\r\n            applyFrame,\r\n            easing,\r\n            animation: this,\r\n            onStart,\r\n            onFrame,\r\n            onPause,\r\n            onCancel,\r\n            onEnd,\r\n            onComplete,\r\n            bubbleFrameEvent,\r\n            finishFrame,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Ran after the fx completes.\r\n     * @param fx\r\n     */\r\n    destroy(fx) {\r\n\r\n    }\r\n\r\n    /**\r\n     * Animates the given element.  Returns the FX object that can be used to control the animation.\r\n     *\r\n     * @param element {HTMLElement|Element} The element to animate.\r\n     * @param duration {Number} The duration of the animation in milliseconds.\r\n     * @param easing {function(Number)} An easing function that controls the rate of change for the animation.  If null linear animation is used.\r\n     * @param onStart {function(FX)} A callback function that is called right before the animation starts playing.\r\n     * @param onFrame {function(FX, frame)} A callback that is called per frame.\r\n     * @param onPause {function(FX)} A callback that is called when the FX pauses.\r\n     * @param onCancel {function(FX)} A callback that is called when the FX cancels.\r\n     * @param onEnd {function(FX)} A callback that is called when the animation ends.  Whether by completing, pausing, or canceling.  See Fx.status to determine what happened.\r\n     * @param onComplete {function(FX)} A callback that is called when the animation complete successfully.\r\n     * @param position\r\n     * @param autoPlay\r\n     * @returns {FX}\r\n     */\r\n    animate(element, {duration=null, easing = EASING.linear, onStart = null, onFrame = null, onPause = null, onCancel = null, onEnd = null, onComplete = null, position=0, autoPlay=true} = {}) {\r\n        if(duration === null) {\r\n            duration = this.duration;\r\n        }\r\n\r\n        let fx = this.init({\r\n            element: element,\r\n            frames: this.frames,\r\n            duration,\r\n            applyFrame: this.applyFrame,\r\n            easing,\r\n            animation: this,\r\n            onStart,\r\n            onFrame,\r\n            onPause,\r\n            onCancel,\r\n            onEnd: (fx) => {\r\n                if(onEnd) onEnd.call(fx, fx);\r\n                this.destroy(fx);\r\n            },\r\n            onComplete,\r\n            bubbleFrameEvent: this.bubbleFrameEvent,\r\n            finishFrame: this.finishFrame\r\n        });\r\n\r\n        if(position) {\r\n            fx.goto(position);\r\n        }\r\n\r\n        if(autoPlay) {\r\n            fx.play();\r\n        }\r\n        return fx;\r\n    }\r\n\r\n    goto(element, position) {\r\n        this.animate(element, {autoPlay: false, position: position});\r\n        return Animation.complete;\r\n    }\r\n\r\n    /**\r\n     * Creates a function that calls the animate method with the bound parameters.\r\n     * Parameters can be overridden in the created function when called.\r\n     * Method has the same signature as the animate method.\r\n     *\r\n     * Usage:\r\n     * let animation = new Animation(...),\r\n     *     fx = animation.bind(null, 2000);\r\n     *\r\n     * fx(element) // Animation the element over 2000 milliseconds.\r\n     *\r\n     * @param element\r\n     * @param config\r\n     * @returns {function(HTMLElement element, Number duration, Object config): FX}\r\n     */\r\n    bind(element = null, config = null) {\r\n        let defaults = {\r\n            element,\r\n            config\r\n        };\r\n\r\n        return (element = defaults, config=null) => {\r\n            element = element === defaults ? element.defaults : element;\r\n\r\n            let _options = {};\r\n            if (defaults.config) Object.assign(_options, defaults.config);\r\n            if (config) Object.assign(_options, config);\r\n\r\n            return this.animate(element, _options);\r\n        };\r\n    }\r\n}\r\n","import {ExtendableError} from \"../errors\";\r\nimport {selectElement} from \"../utility\";\r\nimport {RGBA} from \"../vectors\";\r\nimport {NumberWithUnit} from \"./types\";\r\nimport {EASING} from \"./easing\";\r\nimport {defaultApplyFrame} from \"./frame\";\r\n\r\n\r\nconst regNumberWithUnit = /^(\\d+\\.?\\d*)([a-z]+|%)$/i,\r\n    regColor = /^(?:#([a-f0-9]{3})|#([a-f0-9]{6})|#([a-f0-9]{8}))$/i,\r\n    regFunction = /^([a-z_][a-z_0-9]*)\\((.+?)\\)$/i;\r\n\r\n\r\nconst TYPE_FUNCTIONS = {\r\n    hex: RGBA.parseHexColorStringArg,\r\n    rgb: RGBA.parseRGBAColorStringArgs,\r\n    rgba: RGBA.parseRGBAColorStringArgs\r\n};\r\n\r\n\r\nexport class DeadFXError extends ExtendableError {}\r\n\r\n\r\nfunction assertFXAlive(fx) {\r\n    if (fx.status === FX.complete || fx.status === FX.error || fx.status === FX.complete) {\r\n        throw new DeadFXError(\"FX object is dead.\");\r\n    }\r\n}\r\n\r\n\r\nfunction doPromiseAction(onAction, value, resolveOrReject) {\r\n    if (typeof onAction === 'function') {\r\n        value = onAction(value);\r\n    }\r\n\r\n    resolveOrReject(value);\r\n}\r\n\r\n\r\nfunction _prepareValue(value) {\r\n    if (typeof value === 'string') {\r\n        value = value.trim();\r\n\r\n        let m = regNumberWithUnit.exec(value);\r\n\r\n        if (m) {\r\n            return new NumberWithUnit(parseFloat(m[1]), m[2]);\r\n        }\r\n\r\n        m = regColor.exec(value);\r\n\r\n        if (m) {\r\n            return TYPE_FUNCTIONS.hex(m[0]);\r\n        }\r\n\r\n        m = regFunction.exec(value);\r\n\r\n        if (m) {\r\n            return TYPE_FUNCTIONS[m[1]](m[2]);\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\nfunction _getFrames(fx, element, frames) {\r\n    let r = {};\r\n\r\n    if (typeof frames === 'function') {\r\n        frames = frames.call(fx, element, fx);\r\n    }\r\n\r\n    for (let keyframeIndex in frames) {\r\n        if (!frames.hasOwnProperty(keyframeIndex)) continue;\r\n\r\n        let frame = frames[keyframeIndex];\r\n        r[keyframeIndex] = {};\r\n\r\n        for (let property in frame) {\r\n            if (!frame.hasOwnProperty(property)) continue;\r\n            r[keyframeIndex][property] = _prepareValue(frame[property]);\r\n        }\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * @implements Promise\r\n */\r\nexport default class FX {\r\n    static pending = \"Pending\";\r\n    static complete = \"Complete\";\r\n    static error = \"Error\";\r\n    static paused = \"Paused\";\r\n    static canceled = \"Canceled\";\r\n    static playing = \"Playing\";\r\n\r\n    #element;\r\n    #chained;\r\n    #frames;\r\n    #internalValue;\r\n\r\n    #animation;\r\n\r\n    #frameId;\r\n    #status;\r\n    #position;\r\n\r\n    #finishFrame;\r\n    #applyFrame;\r\n    #easing;\r\n    #duration;\r\n\r\n    [Symbol.toStringTag] = \"[Object FX]\";\r\n\r\n    constructor(element, frames, duration, {applyFrame = defaultApplyFrame, animation = null, easing = EASING.linear, onComplete = null, onCancel = null, onFrame = null, onStart = null, onEnd = null, bubbleFrameEvent = false, finishFrame = null, init = null} = {}) {\r\n        this.#frames = [];\r\n        this.#chained = [];\r\n        this.#element = selectElement(element);\r\n        this.#internalValue = undefined;\r\n\r\n        this.onComplete = onComplete;\r\n        this.onCancel = onCancel;\r\n        this.onFrame = onFrame;\r\n        this.onStart = onStart;\r\n        this.onEnd = onEnd;\r\n        this.bubbleFrameEvent = bubbleFrameEvent;\r\n\r\n        this.#animation = animation;\r\n        this.#finishFrame = finishFrame;\r\n        this.#applyFrame = applyFrame;\r\n        this.#easing = easing;\r\n        this.#frameId = null;\r\n        this.#status = FX.pending;\r\n\r\n        this.#duration = duration;\r\n        this.#position = 0;\r\n\r\n        if (init) {\r\n            init.call(this, this);\r\n        }\r\n\r\n        // Prepare frames\r\n        frames = _getFrames(this, this.#element, frames);\r\n\r\n        for (let key in frames) {\r\n            if (frames.hasOwnProperty(key)) {\r\n                let frame = frames[key],\r\n                    pos = parseFloat(key) / 100;\r\n\r\n                if (typeof frame === 'function') {\r\n                    frame = frame.call(this, this.#element);\r\n                }\r\n\r\n                frame = Object.freeze(Object.assign({}, frame));\r\n\r\n                this.#frames.push(Object.freeze({\r\n                    position: pos,\r\n                    properties: frame\r\n                }));\r\n            }\r\n        }\r\n\r\n        this.#frames.sort((a, b) => a.position - b.pos);\r\n    }\r\n\r\n    get animation() {\r\n        return this.#animation;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get easing() {\r\n        return this.#easing;\r\n    }\r\n\r\n    get status() {\r\n        return this.#status;\r\n    }\r\n\r\n    get position() {\r\n        return this.#position;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get duration() {\r\n        return this.#duration;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get frames() {\r\n        return this.#frames.slice();\r\n    }\r\n\r\n    get element() {\r\n        return this.#element;\r\n    }\r\n\r\n    // set position(value) {\r\n    //     if (typeof value === 'string') {\r\n    //         value = (parseFloat(value) / 100) * this.#duration;\r\n    //     }\r\n    //\r\n    //     this.#position = Math.max(0.0, Math.min(this.#duration, value));\r\n    // }\r\n\r\n    get state() {\r\n        if (this.status === FX.complete || this.status === FX.canceled) {\r\n            return \"Fulfilled\";\r\n        } else if (this.status === FX.error) {\r\n            return \"Rejected\";\r\n        } else {\r\n            return \"Pending\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the frame options at the given position.\r\n     * @param position\r\n     */\r\n    getFrameFX(position) {\r\n        // position can either be a percentage string (aka 50%) or the time in milliseconds into the animation\r\n        // which will be converted into a percentage.\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        // At this point position should be a value between 0.0 and 1.0.\r\n        // Easing functions specify that rate of change in the properties.\r\n        // It takes the position and maps it to another value between 0.0f and 1.0f.\r\n        // By default linear easing is used.\r\n        if (this.#easing) {\r\n            position = this.#easing(position);\r\n        }\r\n\r\n        let r = {};\r\n\r\n        for (let frame of this.#frames) {\r\n            for (let key in frame.properties) {\r\n                if (frame.properties.hasOwnProperty(key)) {\r\n                    let value = frame.properties[key];\r\n\r\n                    if (!r[key]) {\r\n                        r[key] = {startPosition: null, startValue: null, endPosition: null, endValue: null};\r\n                    }\r\n\r\n                    if (frame.position <= position) {\r\n                        r[key].startPosition = frame.position;\r\n                        r[key].startValue = value;\r\n                    } else if (frame.position > position && r[key].endPosition === null) {\r\n                        r[key].endPosition = frame.position;\r\n                        r[key].endValue = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Returns the final frame at the given position.  All options at this point should be parsed and there final values\r\n     * should be available.\r\n     *\r\n     * @param position\r\n     */\r\n    getFrame(position) {\r\n        let frame = this.getFrameFX(position),\r\n            r = {};\r\n\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        // Takes the frame config options and calculates the final values.\r\n        for (let property in frame) {\r\n            if (frame.hasOwnProperty(property)) {\r\n                let options = frame[property];\r\n\r\n                if ((options.endPosition === null || options.endPosition <= position) && options.startValue !== null) {\r\n                    r[property] = options.startValue;\r\n                } else if (options.startValue !== null) {\r\n                    if (typeof options.startValue === 'object') {\r\n                        let p = (position - options.startPosition) / (options.endPosition - options.startPosition),\r\n                            delta = options.endValue.subtract(options.startValue);\r\n\r\n                        r[property] = options.startValue.add(delta.scalar(p));\r\n                    } else if (typeof options.startValue === 'number') {\r\n                        let duration = (options.endPosition - options.startPosition),\r\n                            p = (position - options.startPosition) / duration,\r\n                            delta = options.endValue - options.startValue;\r\n\r\n                        r[property] = options.startValue + (delta * p);\r\n                    } else {\r\n                        r[property] = options.startValue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // User provided hook that can perform the final touch ups on the frame.\r\n        if (this.#finishFrame) {\r\n            r = this.#finishFrame(this, frame);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    play() {\r\n        assertFXAlive(this);\r\n\r\n        if (this.#frameId === null) {\r\n            this.goto(this.#position);\r\n\r\n            let tick = performance.now();\r\n\r\n            let frameFN = () => {\r\n                let timestamp = performance.now(),\r\n                    delta = timestamp - tick,\r\n                    position = this.#position + (delta / this.duration);\r\n\r\n                tick = timestamp;\r\n                let frame = this.goto(position);\r\n                this.#status = FX.playing;\r\n\r\n                if (this.onFrame) this.onFrame.call(this, this, frame);\r\n\r\n                this.#element.dispatchEvent(new CustomEvent('animation.frame', {\r\n                    bubbles: this.bubbleFrameEvent,\r\n                    detail: this\r\n                }));\r\n\r\n                if (this.#position < 1) {\r\n                    this.#frameId = window.requestAnimationFrame(frameFN);\r\n                } else {\r\n                    this._complete(FX.complete, FX.complete);\r\n                    this.#frameId = null;\r\n                }\r\n            };\r\n\r\n            if (this.onStart) {\r\n                this.onStart.call(this, this);\r\n            }\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.start', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n\r\n            this.#frameId = window.requestAnimationFrame(frameFN);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Pauses the animation.  Does not resolve it.\r\n     * @returns {FX}\r\n     */\r\n    pause() {\r\n        if (this.#frameId) {\r\n            window.cancelAnimationFrame(this.#frameId);\r\n            this.#frameId = null;\r\n            this.#status = FX.paused;\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.paused', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    _cancel(complete = false, status = FX.canceled) {\r\n        if (this.#frameId) {\r\n            window.cancelAnimationFrame(this.#frameId);\r\n            this.#frameId = null;\r\n\r\n            if (complete) {\r\n                this.goto(1);\r\n                this._complete(status, status);\r\n            } else {\r\n                this.#status = status;\r\n                this.#internalValue = status;\r\n            }\r\n\r\n            if (this.onCancel) this.onCancel.call(this, this);\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.canceled', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n\r\n            this._triggerEndEvent();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Cancel the animation with the canceled state.   optionally sets the animation to it's final frame if\r\n     * completeAnimation is true.\r\n     *\r\n     * @param completeAnimation\r\n     * @returns {FX}\r\n     */\r\n    cancel(completeAnimation = false) {\r\n        return this._cancel(completeAnimation, FX.canceled);\r\n    }\r\n\r\n    /**\r\n     * Completes the animation immediately and sets is status to complete.\r\n     * @returns {FX}\r\n     */\r\n    complete() {\r\n        return this._cancel(true, FX.complete);\r\n    }\r\n\r\n    goto(position) {\r\n        assertFXAlive(this);\r\n\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        this.#position = position;\r\n        return this.applyFrame(this.position);\r\n    }\r\n\r\n    applyFrame(position) {\r\n        let frame = this.getFrame(position);\r\n        this.#applyFrame.call(this, this, frame);\r\n        return frame;\r\n    }\r\n\r\n    _triggerEndEvent() {\r\n        if (this.onEnd) this.onEnd.call(this, this);\r\n\r\n        this.#element.dispatchEvent(new CustomEvent('animation.end', {\r\n            bubbles: true,\r\n            detail: this\r\n        }));\r\n\r\n        for (let {onResolve} of this.#chained) {\r\n            if (onResolve) onResolve(this.#internalValue);\r\n        }\r\n        this.#chained = [];\r\n    }\r\n\r\n    _complete(value, status = FX.complete) {\r\n        if (this.state !== \"Pending\") {\r\n            return;\r\n        }\r\n\r\n        this.#status = status;\r\n        this.#internalValue = value;\r\n\r\n        if (this.onComplete) this.onComplete.call(this, this);\r\n\r\n        this.#element.dispatchEvent(new CustomEvent('animation.complete', {\r\n            bubbles: true,\r\n            detail: this\r\n        }));\r\n\r\n        this._triggerEndEvent();\r\n    }\r\n\r\n    then(onResolve, onReject) {\r\n        if (this.state === \"Pending\") {\r\n            return new Promise((resolve, reject) => {\r\n                // noinspection JSUnusedGlobalSymbols\r\n                this.#chained.push({\r\n                    onResolve: (value) => {\r\n                        doPromiseAction(onResolve, value, resolve);\r\n                    },\r\n\r\n                    onReject: (value) => {\r\n                        doPromiseAction(onReject, value, reject);\r\n                    }\r\n                });\r\n            });\r\n        } else if (this.state === 'Fulfilled' && typeof onResolve === 'function') {\r\n            return new Promise((resolve) => {\r\n                doPromiseAction(onResolve, this.#internalValue, resolve);\r\n            });\r\n        } else if (this.state === 'Rejected' && typeof onReject === 'function') {\r\n            return new Promise((resolve, reject) => {\r\n                doPromiseAction(onReject, this.#internalValue, reject);\r\n            });\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    finally(onFinally) {\r\n        onFinally = (value) => {\r\n            if (typeof onFinally === 'function') {\r\n                onFinally();\r\n            }\r\n\r\n            return value;\r\n        };\r\n\r\n        return this.then(onFinally, onFinally);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    catch(onReject) {\r\n        return this.then(undefined, onReject);\r\n    }\r\n}\r\n","/**\r\n *\r\n * @param p\r\n * @returns {*}\r\n */\r\nexport function linear(p) {\r\n    return p;\r\n}\r\n\r\n\r\n// noinspection JSUnusedGlobalSymbols\r\nexport const EASING = {\r\n    linear: linear\r\n};\r\n","export function defaultApplyFrame(fx, frame) {\r\n    for (let key in frame) {\r\n        if (frame.hasOwnProperty(key)) {\r\n            fx.element.style[key] = frame[key].toString();\r\n        }\r\n    }\r\n}\r\n","export class NumberWithUnit {\r\n    constructor(value, unit) {\r\n        this.value = value;\r\n        this.unit = unit;\r\n    }\r\n\r\n    add(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n\r\n        return new NumberWithUnit(this.value + value, this.unit);\r\n    }\r\n\r\n    subtract(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value - value, this.unit);\r\n    }\r\n\r\n    scalar(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value * value, this.unit);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    divide(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value / value, this.unit);\r\n    }\r\n\r\n    toString() {\r\n        return `${this.value}${this.unit}`;\r\n    }\r\n}\r\n","import Publisher from \"../Publisher\";\r\n\r\nimport {privateCache} from \"core/data\";\r\nimport {\r\n    getTranslation,\r\n    setElementClientPosition,\r\n    documentRectToClientSpace,\r\n    clientRectToDocumentSpace,\r\n    snapToGrid\r\n} from \"core/ui/position\";\r\nimport {clamp} from \"../utility/math\";\r\nimport Animation from \"../fx/Animation\";\r\n\r\n\r\n/**\r\n * Draggable option for offset that offsets the position by the cursor.\r\n *\r\n * @param clientX\r\n * @param clientY\r\n * @param boundingRect\r\n * @returns {{x, y}}\r\n */\r\nexport function cursor({clientX, clientY, boundingRect}) {\r\n    return {\r\n        x: boundingRect.left - clientX,\r\n        y: boundingRect.top - clientY\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Draggable option that clones the draggable element for the helper element.\r\n *\r\n * @param opacity\r\n * @returns {function(*): (ActiveX.IXMLDOMNode | Node)}\r\n */\r\nexport function clone(opacity=null) {\r\n    return function(draggable) {\r\n        let helper = draggable.element.cloneNode(true);\r\n\r\n        if(opacity !== null) {\r\n            helper.style.opacity = opacity;\r\n        }\r\n\r\n        return helper;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the first scrollable parent.\r\n *\r\n * @param element\r\n * @returns {HTMLElement|null}\r\n * @private\r\n */\r\nfunction _getScrollParent(element) {\r\n    let o = element.parentElement;\r\n\r\n    while(o) {\r\n        if (o.scrollWidth > o.clientWidth || o.scrollHeight > o.clientHeight) {\r\n            return o;\r\n        }\r\n\r\n        o = o.parentElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\n/**\r\n * Sets the target elements x and y position by setting the translate3d translation matrix.\r\n *\r\n * @param target\r\n * @param x\r\n * @param y\r\n * @private\r\n */\r\nfunction _translate(target, x, y) {\r\n    target.style.transform = `translate3d(${x}px, ${y}px, 0)`;\r\n}\r\n\r\n\r\n// Group of function that can be passed to Draggables container property that will contain a dragged element to within\r\n// the given parameters.  Function should return a rect with {left, top, width, and height} properties relative to the\r\n// client.  Similiar to Element.getBoundingClientRect().\r\nexport const CONTAINERS = {\r\n    /**\r\n     * Constrains to client area.\r\n     * @returns {{top: number, left: number, width: number, height: number}}\r\n     */\r\n    client: function() {\r\n        return {\r\n            left: 0,\r\n            top: 0,\r\n            height: window.innerHeight,\r\n            width: window.innerWidth,\r\n            right: window.innerWidth,\r\n            bottom: window.innerHeight\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Constrains to viewport.\r\n     * @param element\r\n     * @returns {{top: number, left: number, width: number, height: number}}\r\n     */\r\n    viewport: function(element) {\r\n        let parent = _getScrollParent(element),\r\n            bb = parent.getBoundingClientRect();\r\n\r\n        return {\r\n            left: bb.left - parent.scrollLeft,\r\n            top: bb.top - parent.scrollTop,\r\n            width: parent.scrollWidth,\r\n            height: parent.scrollHeight\r\n        };\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Takes a bounding client rect and constrains the left and top position to within the container.  Returns a new rect.\r\n *\r\n * @param rect\r\n * @param container\r\n * @param element\r\n * @param helper\r\n * @returns {{top: *, left: *}}\r\n * @private\r\n */\r\nfunction _clampPositionToContainer(rect, container, element, helper) {\r\n    let bb = helper.getBoundingClientRect();\r\n\r\n    let x = rect.left,\r\n        y = rect.top;\r\n\r\n    if(container) {\r\n        if(typeof container === 'function') {\r\n            container = container(element, helper);\r\n        } else if(container.getBoundingClientRect) {\r\n            container = container.getBoundingClientRect();\r\n        } else {\r\n            container = element.closest(container);\r\n            container = container.getBoundingClientRect();\r\n        }\r\n\r\n        if(container) {\r\n            x = clamp(x, container.left, container.left + container.width - bb.width);\r\n            y = clamp(y, container.top, container.top + container.height - bb.height);\r\n        }\r\n    }\r\n\r\n    return {\r\n        ...rect,\r\n        left: x,\r\n        top: y\r\n    };\r\n}\r\n\r\n\r\n// Group of function that can be passed to the tolerance property of Draggable to control when an item is considered\r\n// intersecting another for drop events.\r\nconst TOLERANCE_FUNCTIONS = {\r\n    intersect: function(droppable, item) {\r\n        let origin = {\r\n            x: item.left + (item.width / 2),\r\n            y: item.top + (item.height / 2)\r\n        };\r\n\r\n        return origin.x >= droppable.left\r\n            && origin.x <= droppable.right\r\n            && origin.y >= droppable.top\r\n            && origin.y <= droppable.bottom;\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Behavior class to add the draggable behavior to an element for group of elements.\r\n */\r\nexport default class Draggable extends Publisher {\r\n    static CLONE = clone;\r\n    // noinspection JSUnusedGlobalSymbols\r\n    static OFFSET_CURSOR = cursor;\r\n\r\n    /**\r\n     * @param element {Element|String} The element to attach the draggable behavior to.\r\n     * @param container {string|CONTAINERS.client|CONTAINERS.viewport|function}\r\n     *  Constrains the draggable into the given area.\r\n     *  `container` can either be a css selector to match a parent element, a Function(element, helper)\r\n     *  that should return a bounding box.  Or an element who's bounding box will be used.\r\n     * @param axis {'x'|'y'|'xy'}\r\n     *  Controls what axis the item is draggable.  x can be dragged horizontally, y vertically, and xy can be freely dragged.\r\n     * @param exclude {String}\r\n     *  Prevents dragging from starting on matching elements.\r\n     * @param delay {Number}\r\n     *  The time in milliseconds after the mouse down event occurs that dragging will begin.\r\n     * @param offset {{x, y}|[x, y]|Function}\r\n     *  By default when an item is dragged is position will be set relative to the drop left corner of the item.\r\n     *  Offset is used to offset the element from the cursor.  You can pass an {x, y} object, an array with [x, y] pair,\r\n     *  or a Function({target, draggable, clientX, clientY, boundingRect}) that will be called that return an {x, y} object.\r\n     * @param disabled {Boolean}\r\n     *  Disables dragging.\r\n     * @param distance {Number}\r\n     *  Adds resistance to drag starting.  The users must move at least `distance` amount of pixels away from the\r\n     *  starting position for drag to start.\r\n     * @param handle {String}\r\n     *  If dragging will only start if the user clicks an element that matches the css selectors.\r\n     * @param helper {Function|Element}\r\n     *  An element to use as a helper for dragging.  Can be a Element or a Function that returns an element.\r\n     * @param revert {Number|Boolean}\r\n     *  Controls if the draggable reverts back to the starting position if no droppable accepts the target.\r\n     * @param scroll {Number}\r\n     *  Controls the speed that the draggable will scroll the scrollParent when the draggable leaves the viewable area.\r\n     * @param selector {String}\r\n     *  Used to delegate dragging to sub items.\r\n     * @param droppables\r\n     *  An array of css selectors or elements that will be used as drop targets for the draggable.\r\n     * @param tolerance {String}\r\n     *  Controls the function that determines if an item intersects a drop target.\r\n     * @param setHelperSize {Boolean}\r\n     *  If true the helpers width and height will be set by javascript to match the original element.\r\n     * @param grid {{x, y} | [x, y] | Number}\r\n     *  Snaps draggable movement to a grid with the given x, y dimensions.\r\n     */\r\n    constructor(element, {container=null, axis='xy', exclude=\"input, button, select, .js-no-drag, textarea\", delay=null, offset=cursor, disabled=false,\r\n        distance=null, handle=null, helper=null, revert=null, scroll=null, selector=null, droppables=null, tolerance='intersect',\r\n        setHelperSize=false, grid=null}={}) {\r\n        super();\r\n\r\n        if(typeof element === 'string') {\r\n            this.element = document.querySelector(element);\r\n        } else {\r\n            this.element = element;\r\n        }\r\n\r\n        this._onMouseDown = this.onMouseDown.bind(this);\r\n        this.disabled = disabled;\r\n        this.helper = helper;\r\n        this.offset = offset;\r\n        this.axis = axis;\r\n        this.delay = delay;\r\n        this.distance = distance;\r\n        this.container = container;\r\n        this.handle = handle;\r\n        this.exclude = exclude;\r\n        this.revert = revert;\r\n        this.selector = selector;\r\n        this.droppables = [];\r\n        this.tolerance = tolerance;\r\n        this.setHelperSize = setHelperSize;\r\n        this.scroll = scroll;\r\n\r\n        if(typeof grid === 'number') {\r\n            this.grid = {\r\n                x: grid,\r\n                y: grid\r\n            };\r\n        } else if(Array.isArray(grid)) {\r\n            this.grid = {\r\n                x: grid[0],\r\n                y: grid[1]\r\n            };\r\n        } else {\r\n            this.grid = grid;\r\n        }\r\n\r\n        if(droppables) {\r\n            this.addDroppables(droppables);\r\n        }\r\n\r\n        this.element.addEventListener('mousedown', this._onMouseDown);\r\n        this.isDragging = false;\r\n\r\n        this._revertFX = null;\r\n    }\r\n\r\n    /**\r\n     * Adds a drop target item.  A `droppable` can be an element, a css selector or an array of those.\r\n     * @param droppables\r\n     */\r\n    addDroppables(droppables) {\r\n        if(Array.isArray(droppables)) {\r\n            this.droppables = this.droppables.concat(droppables);\r\n        } else {\r\n            this.droppables.push(droppables);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Responsible for detecting dragging and starting the drag depending on delay and distance.\r\n     * @param event\r\n     */\r\n    onMouseDown(event) {\r\n        let element = this.element;\r\n\r\n        if(this.selector) {\r\n            element = event.target.closest(this.selector);\r\n\r\n            if(!this.element.contains(element)) {\r\n                element = null;\r\n            }\r\n        }\r\n\r\n        if(!element) return;\r\n\r\n        let data = privateCache.cache(element);\r\n\r\n        if(data.isDragging || this.disabled) {\r\n            return;\r\n        }\r\n\r\n        if(this.handle) {\r\n            let handle = event.target.closest(this.handle);\r\n\r\n            if(!handle || !element.contains(handle)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        if(this.exclude) {\r\n            let excluded = event.target.closest(this.exclude);\r\n\r\n            if(excluded && element.contains(excluded)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        event.preventDefault();\r\n\r\n        let distance = this.distance || 0,\r\n            delay = typeof this.delay === 'number' ? this.delay : -1,\r\n            doc = document,\r\n            startMouseDocumentX = event.clientX + window.scrollX,\r\n            startMouseDocumentY = event.clientY + window.scrollY,\r\n            mouseDocumentX = startMouseDocumentX,\r\n            mouseDocumentY = startMouseDocumentY;\r\n\r\n        // Tests to see that delay and distance was met before dragging.\r\n        let startDragging = () => {\r\n            if(distance === 0 && delay < 0) {\r\n                this.startDrag(element, startMouseDocumentX, startMouseDocumentY, mouseDocumentX, mouseDocumentY);\r\n            }\r\n        };\r\n\r\n        // Delay dragging.\r\n        if(delay >= 0) {\r\n            let timer;\r\n\r\n            let onTimeout = () => {\r\n                delay = -1;\r\n                doc.removeEventListener('mouseup', onMouseUp);\r\n                startDragging();\r\n            };\r\n\r\n            let onMouseUp = () => {\r\n                doc.removeEventListener('mouseup', onMouseUp);\r\n                clearTimeout(timer);\r\n            };\r\n\r\n            doc.addEventListener('mouseup', onMouseUp);\r\n            timer = setTimeout(onTimeout, delay);\r\n        }\r\n\r\n        // Delay by distance.\r\n        if(distance > 0) {\r\n            let onMouseUp = () => {\r\n                doc.removeEventListener('mouseup', onMouseUp);\r\n                doc.removeEventListener('mousemove', onMouseMove);\r\n            };\r\n\r\n            let onMouseMove = (event) => {\r\n                mouseDocumentX = event.clientX + window.scrollX;\r\n                mouseDocumentY = event.clientY + window.scrollY;\r\n\r\n                let delta = Math.sqrt(\r\n                    (mouseDocumentX - startMouseDocumentX)**2 + (mouseDocumentY - startMouseDocumentY)**2\r\n                );\r\n\r\n                if(delta > distance) {\r\n                    distance = 0;\r\n                    doc.removeEventListener('mouseup', onMouseUp);\r\n                    doc.removeEventListener('mousemove', onMouseMove);\r\n                    startDragging();\r\n                }\r\n            };\r\n\r\n            doc.addEventListener('mouseup', onMouseUp);\r\n            doc.addEventListener('mousemove', onMouseMove);\r\n        }\r\n\r\n        startDragging();\r\n    }\r\n\r\n    /**\r\n     * Starts the drag animation at the given x, y origin.\r\n     *\r\n     * @param element\r\n     * @param startMouseX\r\n     * @param startMouseY\r\n     * @param posX\r\n     * @param posY\r\n     */\r\n    startDrag(element, startMouseX, startMouseY, posX, posY) {\r\n        if(this.isDragging) {\r\n            return;\r\n        }\r\n\r\n        this.isDragging = true;\r\n\r\n        // Cancel any animation that are running.\r\n        if(this._revertFX) {\r\n            this._revertFX.cancel();\r\n            this._revertFX = null;\r\n        }\r\n\r\n        let doc = document,\r\n            target,\r\n            droppables = this.getDropTargets(),\r\n            startBoundingBox = element.getBoundingClientRect(),\r\n            startBBDocument = clientRectToDocumentSpace(startBoundingBox),\r\n            helper,\r\n            scrollTick;\r\n\r\n        if(!this.helper || this.helper === 'self') {\r\n            target = element;\r\n        } else if(typeof this.helper === 'function') {\r\n            target = this.helper(this);\r\n            helper = target;\r\n        } else if(this.helper) {\r\n            target = this.helper;\r\n            helper = target;\r\n        }\r\n\r\n        if(helper) {\r\n            if(this.setHelperSize) {\r\n                if(this.setHelperSize === true) {\r\n                    helper.style.width = `${startBoundingBox.width}px`;\r\n                    helper.style.height = `${startBoundingBox.height}px`;\r\n                    helper.style.boxSizing = 'border-box';\r\n                } else if(Array.isArray(this.setHelperSize)) {\r\n                    helper.style.width = `${this.setHelperSize[0]}px`;\r\n                    helper.style.height = `${this.setHelperSize[1]}px`;\r\n                } else {\r\n                    helper.style.width = `${this.setHelperSize.width}px`;\r\n                    helper.style.height = `${this.setHelperSize.height}px`;\r\n                }\r\n            }\r\n        }\r\n\r\n        // If the target doesn't have a parentElement it needs to be added to the page.\r\n        if(!target.parentElement) {\r\n            element.parentElement.appendChild(target);\r\n        }\r\n\r\n        // mouseOffsetX and mouseOffsetY is the mouses offset relative to the top left corner of the element\r\n        // being dragged.\r\n\r\n        // offsetX and offsetY is how much the dragged element is offset from the cursor.\r\n        // By default it is at the top left of the element.\r\n        let startingTranslation = getTranslation(target),\r\n            offset = {x: 0, y: 0};\r\n\r\n        // The offset property controls how much the dragged element is offset from top left corner of the element.\r\n        // By default it is [0, 0] but a function can be or array can be passed to control this behavior.\r\n        if(this.offset) {\r\n            let _offset = this.offset;\r\n\r\n            if(typeof _offset === 'function') {\r\n                offset = this.offset({\r\n                    target: target,\r\n                    draggable: this,\r\n                    clientX: startMouseX - window.scrollX,\r\n                    clientY: startMouseY - window.scrollY,\r\n                    boundingRect: startBoundingBox\r\n                });\r\n            }\r\n        }\r\n\r\n        // Offset should be {x, y} not an array.\r\n        if(Array.isArray(offset)) {\r\n            offset = {\r\n                x: offset[0],\r\n                y: offset[1]\r\n            };\r\n        }\r\n\r\n        let onMouseMove = (event) => {\r\n            event.preventDefault();\r\n\r\n            let startingRect = target.getBoundingClientRect(),\r\n                position = this._getPosition(element, target, event.clientX, event.clientY, offset, this.container),\r\n                dropData;\r\n\r\n            setElementClientPosition(target, position, 'translate3d');\r\n            dropData = this._getDropData(droppables, startingRect, position);\r\n\r\n            for(let droppable of dropData) {\r\n                if(!droppable.intersectsBefore && droppable.intersectsAfter) {\r\n                    this._dispatchDroppableEvent(droppable.target, 'drag-enter', {\r\n                        bubbles: true,\r\n\r\n                        detail: {\r\n                            item: target\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            this._triggerEvent(element, 'drag-move', {\r\n                bubbles: false,\r\n                details: {\r\n                    mouseX: event.clientX + window.scrollX,\r\n                    mouseY: event.clientY + window.scrollY,\r\n                    clientX: event.clientX,\r\n                    clientY: event.clientY,\r\n                    startMouseX,\r\n                    startMouseY,\r\n                    offset,\r\n                    helper: target,\r\n                    originalEvent: event\r\n                },\r\n                topic: 'draggable.move'\r\n            });\r\n\r\n            // Refresh dropData incase something moved.\r\n            dropData = this._getDropData(droppables, startingRect, position);\r\n\r\n            for(let droppable of dropData) {\r\n                if(droppable.intersectsBefore && !droppable.intersectsAfter) {\r\n                    this._dispatchDroppableEvent(droppable.target, 'drag-leave', {\r\n                        bubbles: true,\r\n                        detail: {\r\n                            item: target\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            if(this.scroll && !scrollTick) {\r\n                let parent = _getScrollParent(element);\r\n\r\n                if(parent) {\r\n                    let lastTick = performance.now(),\r\n                        scrollX = parent.scrollLeft,\r\n                        scrollY = parent.scrollTop;\r\n\r\n                    scrollTick = timestamp => {\r\n                        let parentBB = parent.getBoundingClientRect(),\r\n                            helperBB = target.getBoundingClientRect(),\r\n                            x, y,\r\n                            delta = timestamp - lastTick,\r\n                            isOOB = false;\r\n\r\n                        lastTick = timestamp;\r\n\r\n                        if (helperBB.right > parentBB.right) {\r\n                            x = (helperBB.right - parentBB.right) / helperBB.width;\r\n                            isOOB = true;\r\n                            scrollX += delta * x * this.scroll;\r\n                            parent.scrollLeft = scrollX;\r\n                        } else if (helperBB.left < parentBB.left) {\r\n                            x = (parentBB.left - helperBB.left) / helperBB.width;\r\n                            isOOB = true;\r\n                            scrollX -= delta * x * this.scroll;\r\n                            parent.scrollLeft = scrollX;\r\n                        }\r\n\r\n                        if (helperBB.bottom > parentBB.bottom) {\r\n                            y = (helperBB.bottom - parentBB.bottom) / helperBB.height;\r\n                            isOOB = true;\r\n                            scrollY += delta * y * this.scroll;\r\n                            parent.scrollTop = scrollY;\r\n                        } else if (helperBB.top < parentBB.top) {\r\n                            y = (parentBB.top - helperBB.top) / helperBB.height;\r\n                            isOOB = true;\r\n                            scrollY -= delta * y * this.scroll;\r\n                            parent.scrollTop = scrollY;\r\n                        }\r\n\r\n                        helperBB = _clampPositionToContainer(helperBB, this.container, element, target);\r\n                        setElementClientPosition(target, helperBB, 'translate3d');\r\n\r\n                        if (isOOB && this.isDragging) {\r\n                            window.requestAnimationFrame(scrollTick);\r\n                        } else {\r\n                            scrollTick = null;\r\n                        }\r\n                    };\r\n\r\n                    window.requestAnimationFrame(scrollTick);\r\n                }\r\n            }\r\n        };\r\n\r\n        let onMouseUp = (event) => {\r\n            event.preventDefault();\r\n            doc.removeEventListener('mousemove', onMouseMove);\r\n            doc.removeEventListener('mouseup', onMouseUp);\r\n            doc = null;\r\n            this.isDragging = false;\r\n            element.classList.remove('ui-dragging');\r\n\r\n            let startingRect = target.getBoundingClientRect(),\r\n                position = this._getPosition(element, target, event.clientX, event.clientY, offset, this.container),\r\n                translation = getTranslation(target),\r\n                accepted = null;\r\n\r\n            function accept(element) {\r\n                if(!accepted) {\r\n                    accepted = element;\r\n                } else {\r\n                    throw new Error(\"Draggable has already been accepted.\");\r\n                }\r\n            }\r\n\r\n            function isAccepted() {\r\n                return !!accepted;\r\n            }\r\n\r\n            this._triggerEvent(element, 'drag-end', {\r\n                bubbles: true,\r\n\r\n                details: {\r\n                    startX: startMouseX - window.scrollX,\r\n                    startMouseY,\r\n                    offset,\r\n                    clientX: event.clientX,\r\n                    clientY: event.clientY,\r\n\r\n                    originalEvent: event,\r\n                    helper: target,\r\n\r\n                    accept,\r\n                    isAccepted\r\n                },\r\n\r\n                topic: 'draggable.end',\r\n\r\n                accept,\r\n                isAccepted\r\n            });\r\n\r\n            if(!accepted && this.revert === true) {\r\n                _translate(target, startingTranslation.x, startingTranslation.y);\r\n\r\n                if(target !== element && target.parentElement) {\r\n                    target.parentElement.removeChild(target);\r\n                }\r\n\r\n                this._triggerEvent(element, 'drag-complete', {bubbles: true, topic: 'draggable.complete'});\r\n            } else if(!accepted && typeof this.revert === 'number') {\r\n                let animation = new Animation({\r\n                    applyFrame(element, frame) {\r\n                        _translate(element, frame.left, frame.top);\r\n                    },\r\n\r\n                    frames: {\r\n                        '0%': {\r\n                            left: translation.x + (position.left - startingRect.left),\r\n                            top: translation.y + (position.top - startingRect.top)\r\n                        },\r\n\r\n                        '100%': {\r\n                            left: startingTranslation.x,\r\n                            top: startingTranslation.y\r\n                        }\r\n                    }\r\n                });\r\n\r\n                this._revertFX = animation.animate(target, {\r\n                    duration: this.revert,\r\n\r\n                    onEnd() {\r\n                        if(target !== element && target.parentElement) {\r\n                            target.parentElement.removeChild(target);\r\n                        }\r\n                    },\r\n\r\n                    onComplete: () => {\r\n                        this._triggerEvent(element, 'drag-complete', {bubbles: true, topic: 'draggable.complete'});\r\n                    }\r\n                });\r\n            } else {\r\n                if(target !== element && target.parentElement) {\r\n                    target.parentElement.removeChild(target);\r\n                }\r\n\r\n                setElementClientPosition(element, position, 'translate3d');\r\n\r\n                let startingRect = documentRectToClientSpace(startBBDocument),\r\n                    dropped = [];\r\n\r\n                for(let droppable of droppables) {\r\n                    if(this._intersects(element.dataset.tolerance, droppable.getBoundingClientRect(), position)) {\r\n                        this._dispatchDroppableEvent(droppable, 'drop', {\r\n                            bubbles: true,\r\n                            clientX: event.clientX,\r\n                            clientY: event.clientY,\r\n                            relatedTarget: element,\r\n                            detail: {\r\n                                originalEvent: event,\r\n                                startingBoundingClientRect: startingRect,\r\n                                droppable: droppable\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n\r\n                this._triggerEvent(element, 'drag-complete', {\r\n                    topic: 'draggable.complete',\r\n                    details: {\r\n                        dropped\r\n                    },\r\n                    bubbles: true,\r\n                    dropped\r\n                });\r\n            }\r\n        };\r\n\r\n        doc.addEventListener('mousemove', onMouseMove);\r\n        doc.addEventListener('mouseup', onMouseUp);\r\n        element.classList.add('ui-dragging');\r\n\r\n        this._triggerEvent(element, 'drag-start', {\r\n            bubbles: true,\r\n            details: {\r\n                startMouseY,\r\n                startMouseX,\r\n                offset,\r\n                mouseX: posX,\r\n                mouseY: posY,\r\n                clientX: posX - window.scrollX,\r\n                clientY: posY - window.scrollY,\r\n                helper: target\r\n            },\r\n            topic: 'draggable.start'\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets an array of elements of all the drop targets.\r\n     * If the drop target is a string, it queries for those elements.\r\n     *\r\n     * @returns {Array}\r\n     */\r\n    getDropTargets() {\r\n        let r = [];\r\n\r\n        for(let droppable of this.droppables) {\r\n            let type = typeof droppable;\r\n\r\n            if(type === 'string') {\r\n                for(let target of document.querySelectorAll(droppable)) {\r\n                    if(r.indexOf(target) !== -1) continue;\r\n                    r.push(target);\r\n                }\r\n            } else if(type === 'function') {\r\n                droppable = droppable.call(this, this);\r\n                if(r.indexOf(droppable) !== -1) continue;\r\n                r.push(droppable);\r\n            } else {\r\n                if(r.indexOf(droppable) !== -1) continue;\r\n                r.push(droppable);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Takes an array of drop targets and tests to see if the target intersects the start and ending rectangles.\r\n     *\r\n     * Rects are objects that have the left, right, top, bottom, width and height properties defined.\r\n     * Similar to the results received from Element.getBoundingClientRect().\r\n     *\r\n     * @param droppables - Array of elements to tests.\r\n     * @param startingRect - Starting rect.\r\n     * @param endingRect - Ending rect.\r\n     * @returns {Array}\r\n     * @private\r\n     */\r\n    _getDropData(droppables, startingRect, endingRect) {\r\n        let dropData = [];\r\n\r\n        for(let droppable of droppables) {\r\n            // Convert to client space.\r\n            let dropBox = droppable.getBoundingClientRect();\r\n\r\n            let intersectsBefore = this._intersects(droppable.dataset.tolerance, dropBox, startingRect),\r\n                intersectsAfter = this._intersects(droppable.dataset.tolerance, dropBox, endingRect);\r\n\r\n            dropData.push({\r\n                intersectsBefore,\r\n                intersectsAfter,\r\n                target: droppable,\r\n                ...dropBox\r\n            });\r\n        }\r\n\r\n        return dropData;\r\n    }\r\n\r\n    /**\r\n     * Triggers an event on the current item.\r\n     *\r\n     * @param item\r\n     * @param eventName\r\n     * @param details\r\n     * @param bubbles\r\n     * @param topic\r\n     * @param properties\r\n     * @private\r\n     */\r\n    _triggerEvent(item, eventName, {bubbles, details, topic, ...properties}) {\r\n        details = {\r\n            draggable: this,\r\n            item: item,\r\n\r\n            ...details\r\n        };\r\n\r\n        let event = new CustomEvent(eventName, {\r\n            bubbles: bubbles,\r\n            detail: details\r\n        });\r\n\r\n        if(properties) {\r\n            Object.assign(event, properties);\r\n        }\r\n\r\n        item.dispatchEvent(event);\r\n\r\n        if(topic !== false) {\r\n            topic = topic || eventName;\r\n\r\n            this.publish(topic, {\r\n                draggable: this,\r\n                item: this,\r\n\r\n                ...details\r\n            });\r\n        }\r\n    }\r\n\r\n    _dispatchDroppableEvent(dropElement, name, {bubbles=true, detail={}, ...properties}={}) {\r\n        let customEvent = new CustomEvent(name, {\r\n            bubbles,\r\n            detail: {\r\n                dropElement: dropElement,\r\n                draggable: this,\r\n                ...detail\r\n            }\r\n        });\r\n\r\n        // if(topic !== false && droppable.publish) {\r\n        //     topic = topic || name;\r\n        //\r\n        //     droppable.publish(topic, {\r\n        //         target: droppable,\r\n        //         draggable: this,\r\n        //         name: topic,\r\n        //         ...detail\r\n        //     });\r\n        // }\r\n\r\n        Object.assign(customEvent, properties);\r\n\r\n        dropElement.dispatchEvent(customEvent);\r\n    }\r\n\r\n    /**\r\n     * Tests to see if the item intersects the droppable with the given tolerance function.\r\n     *\r\n     * @param tolerance\r\n     * @param droppable\r\n     * @param item\r\n     * @returns {*}\r\n     * @private\r\n     */\r\n    _intersects(tolerance, droppable, item) {\r\n        tolerance = tolerance || this.tolerance;\r\n        return TOLERANCE_FUNCTIONS[tolerance](droppable, item);\r\n    }\r\n\r\n    /**\r\n     * Retrieves the expected bound box of the helper element at the given mouse coordinates.\r\n     *\r\n     * @param element\r\n     * @param helper\r\n     * @param clientX\r\n     * @param clientY\r\n     * @param offset\r\n     * @param container\r\n     * @returns {{top: *, left: *, bottom: *, width: number, right: *, height: number, target: *}}\r\n     */\r\n    _getPosition(element, helper, clientX, clientY, offset, container) {\r\n        let bb = helper.getBoundingClientRect();\r\n\r\n        let left = clientX + offset.x,\r\n            top = clientY + offset.y;\r\n\r\n        if(this.grid) {\r\n            left = snapToGrid(left, this.grid.x);\r\n            top = snapToGrid(top, this.grid.y);\r\n        }\r\n\r\n        let r = {\r\n            left: left,\r\n            top: top,\r\n            width: bb.width,\r\n            height: bb.height,\r\n            right: left + bb.width,\r\n            bottom: top + bb.height,\r\n            target: helper\r\n        };\r\n\r\n        return {...r, ..._clampPositionToContainer(r, container, element, helper)};\r\n    }\r\n}\r\n","import {getTranslation, setElementClientPosition} from \"core/ui/position\";\r\nimport Draggable, {cursor} from './Draggable';\r\n\r\n\r\nexport function placeholder(className, nodeName=null) {\r\n    return function(element) {\r\n        let placeholder = document.createElement(nodeName || element.nodeName),\r\n            box = element.getBoundingClientRect();\r\n\r\n        placeholder.style.boxSizing = \"border-box\";\r\n        box.style.width = `${box.width}px`;\r\n        box.style.height = `${box.height}px`;\r\n\r\n        if(className) {\r\n            placeholder.className = className;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Creates a sortable list of items.\r\n */\r\nexport default class Sortable {\r\n    constructor(element, {items=\".ui-sort-item\", placeholder=null, layout='y', dropOnEmpty=true, accepts=null, setPlaceholderSize=false,\r\n        container=null, axis='xy', exclude=null, delay=null, offset=cursor, disabled=false,\r\n        distance=null, handle=null, helper=null, revert=null, scroll=null, droppables=null, tolerance='intersect',\r\n        setHelperSize=false, grid=null}={}) {\r\n\r\n        if(typeof element === 'string') {\r\n            this.element = document.querySelector(element);\r\n        } else {\r\n            this.element = element;\r\n        }\r\n\r\n        this.draggable = new Draggable(this.element, {container, axis, exclude, delay, offset, disabled, distance, handle, helper, revert, scroll, selector: items, droppables, tolerance, setHelperSize, grid});\r\n\r\n        this.items = items;\r\n        this.layout = layout;\r\n        this.placeholder = placeholder;\r\n        this.dropOnEmpty = dropOnEmpty;\r\n        this.accepts = accepts;\r\n        this.setPlaceholderSize = setPlaceholderSize;\r\n\r\n        this.initEvents();\r\n    }\r\n\r\n    /**\r\n     * Initializes event listeners.\r\n     */\r\n    initEvents() {\r\n        let placeholder,\r\n            isOver = false,\r\n            init = false,\r\n            target;\r\n\r\n        // Attaches temporary events when drag starts.\r\n        let initialize = (event) => {\r\n            init = true;\r\n            target = event.detail.item;\r\n            target.addEventListener('drag-move', onDragMove);\r\n            target.addEventListener('drag-complete', onDragComplete);\r\n            target.addEventListener('sort-append', onSortAppend);\r\n            let startBB = target.getBoundingClientRect();\r\n            target.classList.add('ui-sorting');\r\n\r\n            if(!placeholder && this.placeholder) {\r\n                if(typeof this.placeholder === 'string') {\r\n                    placeholder = document.createElement(target.nodeName);\r\n                    placeholder.className = this.placeholder;\r\n                } else if(typeof this.placeholder === 'function') {\r\n                    placeholder = this.placeholder(target, this);\r\n                } else if(this.placeholder === true) {\r\n                    placeholder = document.createElement(target.nodeName);\r\n                } else {\r\n                    placeholder = this.placeholder;\r\n                }\r\n\r\n                placeholder.classList.add('ui-placeholder');\r\n\r\n                if(this.setPlaceholderSize) {\r\n                    if(this.setPlaceholderSize === true) {\r\n                        placeholder.style.width = `${startBB.width}px`;\r\n                        placeholder.style.height = `${startBB.height}px`;\r\n                        placeholder.style.boxSizing = 'border-box';\r\n                    } else if(Array.isArray(this.setPlaceholderSize)) {\r\n                        placeholder.style.width = `${this.setPlaceholderSize[0]}px`;\r\n                        placeholder.style.height = `${this.setPlaceholderSize[1]}px`;\r\n                    } else {\r\n                        placeholder.style.width = `${this.setPlaceholderSize.width}px`;\r\n                        placeholder.style.height = `${this.setPlaceholderSize.height}px`;\r\n                    }\r\n                }\r\n\r\n                if(this.element.contains(target)) {\r\n                    target.parentElement.insertBefore(placeholder, target);\r\n                }\r\n            }\r\n\r\n            setElementClientPosition(target, startBB, 'translate3d');\r\n        };\r\n\r\n        // Cleanup after sorting finishes.\r\n        let destroy = () => {\r\n            if(target) {\r\n                target.removeEventListener('drag-move', onDragMove);\r\n                target.removeEventListener('drag-complete', onDragComplete);\r\n                target.removeEventListener('sort-append', onSortAppend);\r\n                init = false;\r\n                isOver = false;\r\n\r\n                if(placeholder && placeholder.parentElement) {\r\n                    placeholder.parentElement.removeChild(placeholder);\r\n                }\r\n\r\n                placeholder = null;\r\n\r\n                target.style.transform = \"\";\r\n                target.classList.remove('ui-sorting');\r\n                target = null;\r\n            }\r\n        };\r\n\r\n        // Ensures that the placeholder is removed if the item gets moves to another sortable.\r\n        let onSortAppend = event => {\r\n            if(event.detail !== this && placeholder && placeholder.parentElement) {\r\n                placeholder.parentElement.removeChild(placeholder);\r\n            }\r\n        };\r\n\r\n        // Moves the item to the correct position on mouse move.\r\n        let onDragMove = (event) => {\r\n            if(!isOver || (this.accepts && !event.detail.item.matches(this.accepts))) {\r\n                return;\r\n            }\r\n\r\n            let target = event.detail.item,\r\n                items = Array.prototype.slice.call(this.getItems()).filter(i => i !== target);\r\n\r\n            let before = this.getItemBeforePoint(event.detail.clientX, event.detail.clientY, items),\r\n                after = this.getItemAfterPoint(event.detail.clientX, event.detail.clientY, items),\r\n                beforeBB = event.detail.helper.getBoundingClientRect(),\r\n                dropOnEmpty = target.dataset.dropOnEmpty !== null && target.dataset.dropOnEmpty !== undefined ? target.dataset.dropOnEmpty === 'true' : this.dropOnEmpty; // Allow overriding on item level.\r\n\r\n            if(!items.length) {\r\n                if(dropOnEmpty) {\r\n                    this.element.appendChild(target);\r\n                    if(placeholder) target.parentElement.insertBefore(placeholder, target);\r\n                    this._refreshPositions(event.detail.helper, beforeBB);\r\n                    this._triggerSortAppendEvent(target);\r\n                }\r\n            } else if(before && before !== target) {\r\n                before.parentElement.insertBefore(target, before.nextSibling);\r\n                if(placeholder) target.parentElement.insertBefore(placeholder, target);\r\n                this._refreshPositions(event.detail.helper, beforeBB);\r\n                this._triggerSortAppendEvent(target);\r\n            } else if(after && after !== target) {\r\n                after.parentElement.insertBefore(target, after);\r\n                if(placeholder) target.parentElement.insertBefore(placeholder, target);\r\n                this._refreshPositions(event.detail.helper, beforeBB);\r\n                this._triggerSortAppendEvent(target);\r\n            }\r\n        };\r\n\r\n        // Cleanup\r\n        let onDragComplete = () => {\r\n            destroy();\r\n        };\r\n\r\n        // Initialize sorting.\r\n        this.element.addEventListener('drag-enter', event => {\r\n            if(this.accepts && !event.detail.item.matches(this.accepts)) {\r\n                return;\r\n            }\r\n\r\n            isOver = true;\r\n\r\n            if(!init) {\r\n                initialize(event);\r\n            }\r\n        });\r\n\r\n        // Mark isOver state false.\r\n        this.element.addEventListener('drag-leave', () => {\r\n            isOver = false;\r\n        });\r\n\r\n        // Initialize sorting that started on another sortable.\r\n        this.element.addEventListener('drag-start', (event) => {\r\n            if(!init) {\r\n                initialize(event);\r\n            }\r\n\r\n            isOver = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Tests to see if the given (x, y) point is before or after the element.  Uses layout to determine if the test\r\n     * is for the x layout, the y layout or the xy layout.\r\n     * @param element\r\n     * @param x\r\n     * @param y\r\n     * @returns {string|null}\r\n     */\r\n    getRelativePosition(element, x, y) {\r\n        let box = element.getBoundingClientRect(),\r\n            mx = box.left + (box.width / 2),\r\n            my = box.top + (box.height / 2);\r\n\r\n        if(this.layout === 'x') {\r\n            return mx < x ? 'after' : 'before';\r\n        } else if(this.layout === 'y') {\r\n            return my < y ? 'after' : 'before';\r\n        } else if(this.layout === 'xy') {\r\n            return (box.bottom < y) || (mx < x && box.bottom >= y && box.top <= y) ? 'after' : 'before';\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Returns the item immediately before the given x, y point.\r\n     * @param x\r\n     * @param y\r\n     * @param items\r\n     * @returns {*}\r\n     */\r\n    getItemBeforePoint(x, y, items) {\r\n        if(!items) items = this.getItems();\r\n\r\n        let r = null;\r\n\r\n        for(let i = 0; i < items.length; i++) {\r\n            let item = items[i];\r\n\r\n            if(this.getRelativePosition(item, x, y) === 'after') {\r\n                r = item;\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(r) {\r\n            let box = r.getBoundingClientRect();\r\n\r\n            if((this.layout === 'x' || this.layout === 'xy') && box.top <= y && box.bottom >= y) {\r\n                return r;\r\n            } else if(this.layout === 'y' && box.left <= x && box.right >= x) {\r\n                return r;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the item immediately after the given (x, y) point.\r\n     * @param x\r\n     * @param y\r\n     * @param items\r\n     * @returns {null|*}\r\n     */\r\n    getItemAfterPoint(x, y, items) {\r\n        if(!items) items = this.getItems();\r\n\r\n        let r = null;\r\n\r\n        for(let i = items.length - 1; i >= 0; i--) {\r\n            let item = items[i];\r\n\r\n            if(this.getRelativePosition(item, x, y) === 'before') {\r\n                r = item;\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(r) {\r\n            let box = r.getBoundingClientRect();\r\n\r\n            if((this.layout === 'x' || this.layout === 'xy') && box.top <= y && box.bottom >= y) {\r\n                return r;\r\n            } else if(this.layout === 'y' && box.left <= x && box.right >= x) {\r\n                return r;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Returns a list of all items for the sortable.\r\n     * @returns {NodeListOf<SVGElementTagNameMap[string]> | NodeListOf<HTMLElementTagNameMap[string]> | NodeListOf<Element>}\r\n     */\r\n    getItems() {\r\n        return this.element.querySelectorAll(this.items);\r\n    }\r\n\r\n    /**\r\n     * helper method that translates the target to the provided client position.\r\n     * @param target {{getBoundingClientRect, style} | Element}\r\n     * @param position {{left[Number], top[Number]}}\r\n     * @private\r\n     */\r\n    _refreshPositions(target, position) {\r\n        let current = target.getBoundingClientRect(),\r\n            deltaLeft = current.left - position.left,\r\n            deltaTop = current.top - position.top,\r\n            translation = getTranslation(target);\r\n\r\n        target.style.transform = `translate3d(${translation.x - deltaLeft}px, ${translation.y - deltaTop}px, 0)`;\r\n    }\r\n\r\n    /**\r\n     * Triggers the default sort-append event on the target.\r\n     * @param target {Element}\r\n     * @private\r\n     */\r\n    _triggerSortAppendEvent(target) {\r\n        let event = new CustomEvent('sort-append', {\r\n            bubbles: false,\r\n            detail: this\r\n        });\r\n\r\n        target.dispatchEvent(event);\r\n    }\r\n}\r\n"],"sourceRoot":""}