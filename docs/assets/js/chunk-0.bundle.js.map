{"version":3,"sources":["webpack://pendora/./jekyll/js/pages/documentation/test_draggable.js","webpack://pendora/./src/core/fx/Animation.js","webpack://pendora/./src/core/fx/FX.js","webpack://pendora/./src/core/fx/easing.js","webpack://pendora/./src/core/fx/frame.js","webpack://pendora/./src/core/fx/types.js","webpack://pendora/./src/core/ui/Draggable2.js"],"names":["TestDraggablePage","drag1","Draggable2","resistance","delay","scrollSpeed","container","ScrollArea","drag2","helper","clone","revert","revertDuration","drag3","drag4","tolerance","drag5","axis","drag6","drag7","grid","drag8","drag9","selector","drag10","drag11","drag12","drag13","drag14","connectDZ","drag","dz","dz1","document","querySelector","connect","addEventListener","event","classList","add","remove","Animation","duration","frames","applyFrame","defaultApplyFrame","bubbleFrameEvent","finishFrame","element","easing","onStart","onFrame","onPause","onCancel","onEnd","onComplete","FX","animation","fx","EASING","linear","position","autoPlay","init","call","destroy","play","animate","complete","config","defaults","_options","Object","assign","canceled","paused","pending","error","playing","regNumberWithUnit","regColor","regFunction","TYPE_FUNCTIONS","hex","RGBA","parseHexColorStringArg","rgb","parseRGBAColorStringArgs","rgba","DeadFXError","ExtendableError","assertFXAlive","status","doPromiseAction","onAction","value","resolveOrReject","_prepareValue","trim","m","exec","NumberWithUnit","parseFloat","_getFrames","r","keyframeIndex","hasOwnProperty","frame","property","Symbol","toStringTag","selectElement","undefined","key","pos","freeze","push","properties","sort","a","b","startPosition","startValue","endPosition","endValue","getFrameFX","options","p","delta","subtract","scalar","tick","performance","now","frameFN","timestamp","dispatchEvent","CustomEvent","bubbles","detail","window","requestAnimationFrame","_complete","cancelAnimationFrame","_triggerEndEvent","completeAnimation","_cancel","getFrame","onResolve","state","onReject","Promise","resolve","reject","onFinally","then","slice","style","toString","unit","TypeError","Error","reg_percentage_test","cursor","target","rect","Rect","x","clientX","left","y","clientY","top","buildTestIntersectionFunction","amount","targetRect","intersection","getArea","exclude","offset","handle","setHelperSize","WeakMap","onMouseDown","pageXOffset","pageYOffset","currentPosition","cancelMouseTracking","cancelTimer","closest","contains","Array","isArray","preventDefault","distanceBrokenPromise","isDistanceBroken","onMouseMove","calcDistance","removeEventListener","timerPromise","timer","setTimeout","clearTimeout","onMouseUp","all","timerStatus","distanceStatus","startDragging","offsetX","offsetY","startingX","startingY","cache","get","mousePosition","isDragging","set","cancel","scroller","dropTargets","startingClientRect","translate","width","height","pointerEvents","parentElement","appendChild","refreshDropTargets","mouseX","mouseY","currentDropTargets","getDropTargets","dropTarget","indexOf","dispatchDropEvent","_moveElementToPosition","_selectElementRect","ScrollHelper","buildScrollHelper","publishDragMoveEvent","accepted","isDefaultPrevented","reverted","publishDragDropEvent","isAccepted","accept","removeChild","setElementClientPosition","_revert","mousePos","testFunction","type","test","droppable","i","splice","Publisher","_dispatchDropEvent","self","name","customEvent","bubble","draggable","starting","startingRect","moveTo","right","bottom","Math","floor","fit","dragInstance","originalTarget","_getScrollParent","o","scrollWidth","clientWidth","scrollHeight","clientHeight","_getScrollRect","nodeName","innerWidth","innerHeight","scrollXSpeed","scrollYSpeed","frameID","scrollLeft","scrollTop","scrollParentRect","clamp","scrollParent","speed","getScrollSpeed","scrollRect","scroll","getScroll","opacity","className","zIndex","nodeType","cloneNode","originalEvent","currentRect","dispatch","publish","eventPackage"],"mappings":"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","file":"chunk-0.bundle.js","sourcesContent":["import Draggable2, {ScrollArea, clone} from \"core/ui/Draggable2\";\r\n\r\n\r\nexport default class TestDraggablePage {\r\n    load() {\r\n        this.drag1 = new Draggable2(\"#drag-example1\", {resistance: 0, delay: 0, scrollSpeed: 1000, container: ScrollArea('#ez1')});\r\n        this.drag2 = new Draggable2(\"#drag-example2\", {resistance: 0, delay: 0, container: ScrollArea('#ez2'), helper: clone(0.5), revert: true, revertDuration: 1000});\r\n        this.drag3 = new Draggable2(\"#drag-example3\", {resistance: 0, delay: 0, container: ScrollArea('#ez3'), revert: true, revertDuration: 1000});\r\n        this.drag4 = new Draggable2(\"#drag-example4\", {resistance: 0, delay: 0, container: ScrollArea('#ez4'), tolerance: 1});\r\n        this.drag5 = new Draggable2(\"#drag-example5\", {resistance: 0, delay: 0, container: ScrollArea('#ez5'), axis: 'x'});\r\n        this.drag6 = new Draggable2(\"#drag-example6\", {resistance: 0, delay: 0, container: ScrollArea('#ez6'), axis: 'y'});\r\n        this.drag7 = new Draggable2(\"#drag-example7\", {resistance: 0, delay: 0, container: ScrollArea('#ez7'), grid: 50});\r\n        this.drag8 = new Draggable2(\"#drag-example8\", {resistance: 0, delay: 0, container: ScrollArea('#ez8')});\r\n        this.drag9 = new Draggable2(\"#drag-example9\", {resistance: 0, delay: 0, container: ScrollArea('#ez9'), selector: '.drag-item'});\r\n        this.drag10 = new Draggable2(\"#drag-example10\", {resistance: 0, delay: 0, container: ScrollArea('#ez10'), helper: clone(0.5)});\r\n        this.drag11 = new Draggable2(\"#drag-example11\", {resistance: 0, delay: 0, container: ScrollArea('#ez11'), selector: '.drag-item', revert: true, revertDuration: 1000, helper: clone(0.5)});\r\n        this.drag12 = new Draggable2(\"#drag-example12\", {resistance: 0, delay: 500, scrollSpeed: 0, container: ScrollArea('#ez12')});\r\n        this.drag13 = new Draggable2(\"#drag-example13\", {resistance: 200, delay: 0, scrollSpeed: 0, container: ScrollArea('#ez13')});\r\n        this.drag14 = new Draggable2(\"#drag-example14\", {resistance: 0, delay: 0, container: ScrollArea('#ez14'), tolerance: 1, helper: clone(0.5), revertDuration: 1000, revert: true});\r\n\r\n        this.connectDZ(this.drag4, '#dz1');\r\n        this.connectDZ(this.drag14, '#dz14');\r\n    }\r\n\r\n    connectDZ(drag, dz) {\r\n        let dz1 = document.querySelector(dz);\r\n\r\n        drag.connect(dz1);\r\n\r\n        dz1.addEventListener('drag.enter', event => {\r\n            dz1.classList.add('active');\r\n        });\r\n\r\n        dz1.addEventListener('drag.leave', event => {\r\n            dz1.classList.remove('active');\r\n        });\r\n    }\r\n}\r\n","import {EASING} from \"./easing\";\r\nimport FX from \"./FX\";\r\nimport {defaultApplyFrame} from \"./frame\";\r\n\r\n\r\nexport default class Animation {\r\n    static defaultApplyFrame = defaultApplyFrame;\r\n\r\n    static complete = FX.complete;\r\n    static canceled = FX.canceled;\r\n    static paused = FX.paused;\r\n    static pending = FX.pending;\r\n    static error = FX.error;\r\n    static playing = FX.playing;\r\n\r\n    /**\r\n     *\r\n     * @param duration\r\n     * @param frames {{}|function(Element element, Animation animation):{}}\r\n     * @param applyFrame - The function that takes a frame and applies it to the element.\r\n     * @param bubbleFrameEvent\r\n     * @param finishFrame\r\n     */\r\n    constructor({duration=null, frames, applyFrame = defaultApplyFrame, bubbleFrameEvent = false, finishFrame = null}) {\r\n        this.frames = frames;\r\n        this.applyFrame = applyFrame || Animation.defaultApplyFrame;\r\n        this.bubbleFrameEvent = bubbleFrameEvent;\r\n        this.finishFrame = finishFrame;\r\n        this.duration = duration;\r\n    }\r\n\r\n    /**\r\n     * Creates an fx object.\r\n     *\r\n     * @param element\r\n     * @param frames\r\n     * @param duration\r\n     * @param applyFrame\r\n     * @param easing\r\n     * @param onStart\r\n     * @param onFrame\r\n     * @param onPause\r\n     * @param onCancel\r\n     * @param onEnd\r\n     * @param onComplete\r\n     * @param bubbleFrameEvent\r\n     * @param finishFrame\r\n     * @returns {FX}\r\n     */\r\n    init({element, frames, duration, applyFrame, easing, onStart, onFrame, onPause, onCancel, onEnd, onComplete, bubbleFrameEvent, finishFrame}) {\r\n        return new FX(element, frames, duration, {\r\n            applyFrame,\r\n            easing,\r\n            animation: this,\r\n            onStart,\r\n            onFrame,\r\n            onPause,\r\n            onCancel,\r\n            onEnd,\r\n            onComplete,\r\n            bubbleFrameEvent,\r\n            finishFrame,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Ran after the fx completes.\r\n     * @param fx\r\n     */\r\n    destroy(fx) {\r\n\r\n    }\r\n\r\n    /**\r\n     * Animates the given element.  Returns the FX object that can be used to control the animation.\r\n     *\r\n     * @param element {HTMLElement|Element} The element to animate.\r\n     * @param duration {Number} The duration of the animation in milliseconds.\r\n     * @param easing {function(Number)} An easing function that controls the rate of change for the animation.  If null linear animation is used.\r\n     * @param onStart {function(FX)} A callback function that is called right before the animation starts playing.\r\n     * @param onFrame {function(FX, frame)} A callback that is called per frame.\r\n     * @param onPause {function(FX)} A callback that is called when the FX pauses.\r\n     * @param onCancel {function(FX)} A callback that is called when the FX cancels.\r\n     * @param onEnd {function(FX)} A callback that is called when the animation ends.  Whether by completing, pausing, or canceling.  See Fx.status to determine what happened.\r\n     * @param onComplete {function(FX)} A callback that is called when the animation complete successfully.\r\n     * @param position\r\n     * @param autoPlay\r\n     * @returns {FX}\r\n     */\r\n    animate(element, {duration=null, easing = EASING.linear, onStart = null, onFrame = null, onPause = null, onCancel = null, onEnd = null, onComplete = null, position=0, autoPlay=true} = {}) {\r\n        if(duration === null) {\r\n            duration = this.duration;\r\n        }\r\n\r\n        let fx = this.init({\r\n            element: element,\r\n            frames: this.frames,\r\n            duration,\r\n            applyFrame: this.applyFrame,\r\n            easing,\r\n            animation: this,\r\n            onStart,\r\n            onFrame,\r\n            onPause,\r\n            onCancel,\r\n            onEnd: (fx) => {\r\n                if(onEnd) onEnd.call(fx, fx);\r\n                this.destroy(fx);\r\n            },\r\n            onComplete,\r\n            bubbleFrameEvent: this.bubbleFrameEvent,\r\n            finishFrame: this.finishFrame\r\n        });\r\n\r\n        if(position) {\r\n            fx.goto(position);\r\n        }\r\n\r\n        if(autoPlay) {\r\n            fx.play();\r\n        }\r\n        return fx;\r\n    }\r\n\r\n    goto(element, position) {\r\n        this.animate(element, {autoPlay: false, position: position});\r\n        return Animation.complete;\r\n    }\r\n\r\n    /**\r\n     * Creates a function that calls the animate method with the bound parameters.\r\n     * Parameters can be overridden in the created function when called.\r\n     * Method has the same signature as the animate method.\r\n     *\r\n     * Usage:\r\n     * let animation = new Animation(...),\r\n     *     fx = animation.bind(null, 2000);\r\n     *\r\n     * fx(element) // Animation the element over 2000 milliseconds.\r\n     *\r\n     * @param element\r\n     * @param config\r\n     * @returns {function(HTMLElement element, Number duration, Object config): FX}\r\n     */\r\n    bind(element = null, config = null) {\r\n        let defaults = {\r\n            element,\r\n            config\r\n        };\r\n\r\n        return (element = defaults, config=null) => {\r\n            element = element === defaults ? element.defaults : element;\r\n\r\n            let _options = {};\r\n            if (defaults.config) Object.assign(_options, defaults.config);\r\n            if (config) Object.assign(_options, config);\r\n\r\n            return this.animate(element, _options);\r\n        };\r\n    }\r\n}\r\n","import {ExtendableError} from \"../errors\";\r\nimport {selectElement} from \"../utility\";\r\nimport {RGBA} from \"../vectors\";\r\nimport {NumberWithUnit} from \"./types\";\r\nimport {EASING} from \"./easing\";\r\nimport {defaultApplyFrame} from \"./frame\";\r\n\r\n\r\nconst regNumberWithUnit = /^(\\d+\\.?\\d*)([a-z]+|%)$/i,\r\n    regColor = /^(?:#([a-f0-9]{3})|#([a-f0-9]{6})|#([a-f0-9]{8}))$/i,\r\n    regFunction = /^([a-z_][a-z_0-9]*)\\((.+?)\\)$/i;\r\n\r\n\r\nconst TYPE_FUNCTIONS = {\r\n    hex: RGBA.parseHexColorStringArg,\r\n    rgb: RGBA.parseRGBAColorStringArgs,\r\n    rgba: RGBA.parseRGBAColorStringArgs\r\n};\r\n\r\n\r\nexport class DeadFXError extends ExtendableError {}\r\n\r\n\r\nfunction assertFXAlive(fx) {\r\n    if (fx.status === FX.complete || fx.status === FX.error || fx.status === FX.complete) {\r\n        throw new DeadFXError(\"FX object is dead.\");\r\n    }\r\n}\r\n\r\n\r\nfunction doPromiseAction(onAction, value, resolveOrReject) {\r\n    if (typeof onAction === 'function') {\r\n        value = onAction(value);\r\n    }\r\n\r\n    resolveOrReject(value);\r\n}\r\n\r\n\r\nfunction _prepareValue(value) {\r\n    if (typeof value === 'string') {\r\n        value = value.trim();\r\n\r\n        let m = regNumberWithUnit.exec(value);\r\n\r\n        if (m) {\r\n            return new NumberWithUnit(parseFloat(m[1]), m[2]);\r\n        }\r\n\r\n        m = regColor.exec(value);\r\n\r\n        if (m) {\r\n            return TYPE_FUNCTIONS.hex(m[0]);\r\n        }\r\n\r\n        m = regFunction.exec(value);\r\n\r\n        if (m) {\r\n            return TYPE_FUNCTIONS[m[1]](m[2]);\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\nfunction _getFrames(fx, element, frames) {\r\n    let r = {};\r\n\r\n    if (typeof frames === 'function') {\r\n        frames = frames.call(fx, element, fx);\r\n    }\r\n\r\n    for (let keyframeIndex in frames) {\r\n        if (!frames.hasOwnProperty(keyframeIndex)) continue;\r\n\r\n        let frame = frames[keyframeIndex];\r\n        r[keyframeIndex] = {};\r\n\r\n        for (let property in frame) {\r\n            if (!frame.hasOwnProperty(property)) continue;\r\n            r[keyframeIndex][property] = _prepareValue(frame[property]);\r\n        }\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * @implements Promise\r\n */\r\nexport default class FX {\r\n    static pending = \"Pending\";\r\n    static complete = \"Complete\";\r\n    static error = \"Error\";\r\n    static paused = \"Paused\";\r\n    static canceled = \"Canceled\";\r\n    static playing = \"Playing\";\r\n\r\n    #element;\r\n    #chained;\r\n    #frames;\r\n    #internalValue;\r\n\r\n    #animation;\r\n\r\n    #frameId;\r\n    #status;\r\n    #position;\r\n\r\n    #finishFrame;\r\n    #applyFrame;\r\n    #easing;\r\n    #duration;\r\n\r\n    [Symbol.toStringTag] = \"[Object FX]\";\r\n\r\n    constructor(element, frames, duration, {applyFrame = defaultApplyFrame, animation = null, easing = EASING.linear, onComplete = null, onCancel = null, onFrame = null, onStart = null, onEnd = null, bubbleFrameEvent = false, finishFrame = null, init = null} = {}) {\r\n        this.#frames = [];\r\n        this.#chained = [];\r\n        this.#element = selectElement(element);\r\n        this.#internalValue = undefined;\r\n\r\n        this.onComplete = onComplete;\r\n        this.onCancel = onCancel;\r\n        this.onFrame = onFrame;\r\n        this.onStart = onStart;\r\n        this.onEnd = onEnd;\r\n        this.bubbleFrameEvent = bubbleFrameEvent;\r\n\r\n        this.#animation = animation;\r\n        this.#finishFrame = finishFrame;\r\n        this.#applyFrame = applyFrame;\r\n        this.#easing = easing;\r\n        this.#frameId = null;\r\n        this.#status = FX.pending;\r\n\r\n        this.#duration = duration;\r\n        this.#position = 0;\r\n\r\n        if (init) {\r\n            init.call(this, this);\r\n        }\r\n\r\n        // Prepare frames\r\n        frames = _getFrames(this, this.#element, frames);\r\n\r\n        for (let key in frames) {\r\n            if (frames.hasOwnProperty(key)) {\r\n                let frame = frames[key],\r\n                    pos = parseFloat(key) / 100;\r\n\r\n                if (typeof frame === 'function') {\r\n                    frame = frame.call(this, this.#element);\r\n                }\r\n\r\n                frame = Object.freeze(Object.assign({}, frame));\r\n\r\n                this.#frames.push(Object.freeze({\r\n                    position: pos,\r\n                    properties: frame\r\n                }));\r\n            }\r\n        }\r\n\r\n        this.#frames.sort((a, b) => a.position - b.pos);\r\n    }\r\n\r\n    get animation() {\r\n        return this.#animation;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get easing() {\r\n        return this.#easing;\r\n    }\r\n\r\n    get status() {\r\n        return this.#status;\r\n    }\r\n\r\n    get position() {\r\n        return this.#position;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get duration() {\r\n        return this.#duration;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get frames() {\r\n        return this.#frames.slice();\r\n    }\r\n\r\n    get element() {\r\n        return this.#element;\r\n    }\r\n\r\n    // set position(value) {\r\n    //     if (typeof value === 'string') {\r\n    //         value = (parseFloat(value) / 100) * this.#duration;\r\n    //     }\r\n    //\r\n    //     this.#position = Math.max(0.0, Math.min(this.#duration, value));\r\n    // }\r\n\r\n    get state() {\r\n        if (this.status === FX.complete || this.status === FX.canceled) {\r\n            return \"Fulfilled\";\r\n        } else if (this.status === FX.error) {\r\n            return \"Rejected\";\r\n        } else {\r\n            return \"Pending\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the frame options at the given position.\r\n     * @param position\r\n     */\r\n    getFrameFX(position) {\r\n        // position can either be a percentage string (aka 50%) or the time in milliseconds into the animation\r\n        // which will be converted into a percentage.\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        // At this point position should be a value between 0.0 and 1.0.\r\n        // Easing functions specify that rate of change in the properties.\r\n        // It takes the position and maps it to another value between 0.0f and 1.0f.\r\n        // By default linear easing is used.\r\n        if (this.#easing) {\r\n            position = this.#easing(position);\r\n        }\r\n\r\n        let r = {};\r\n\r\n        for (let frame of this.#frames) {\r\n            for (let key in frame.properties) {\r\n                if (frame.properties.hasOwnProperty(key)) {\r\n                    let value = frame.properties[key];\r\n\r\n                    if (!r[key]) {\r\n                        r[key] = {startPosition: null, startValue: null, endPosition: null, endValue: null};\r\n                    }\r\n\r\n                    if (frame.position <= position) {\r\n                        r[key].startPosition = frame.position;\r\n                        r[key].startValue = value;\r\n                    } else if (frame.position > position && r[key].endPosition === null) {\r\n                        r[key].endPosition = frame.position;\r\n                        r[key].endValue = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Returns the final frame at the given position.  All options at this point should be parsed and there final values\r\n     * should be available.\r\n     *\r\n     * @param position\r\n     */\r\n    getFrame(position) {\r\n        let frame = this.getFrameFX(position),\r\n            r = {};\r\n\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        // Takes the frame config options and calculates the final values.\r\n        for (let property in frame) {\r\n            if (frame.hasOwnProperty(property)) {\r\n                let options = frame[property];\r\n\r\n                if ((options.endPosition === null || options.endPosition <= position) && options.startValue !== null) {\r\n                    r[property] = options.startValue;\r\n                } else if (options.startValue !== null) {\r\n                    if (typeof options.startValue === 'object') {\r\n                        let p = (position - options.startPosition) / (options.endPosition - options.startPosition),\r\n                            delta = options.endValue.subtract(options.startValue);\r\n\r\n                        r[property] = options.startValue.add(delta.scalar(p));\r\n                    } else if (typeof options.startValue === 'number') {\r\n                        let duration = (options.endPosition - options.startPosition),\r\n                            p = (position - options.startPosition) / duration,\r\n                            delta = options.endValue - options.startValue;\r\n\r\n                        r[property] = options.startValue + (delta * p);\r\n                    } else {\r\n                        r[property] = options.startValue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // User provided hook that can perform the final touch ups on the frame.\r\n        if (this.#finishFrame) {\r\n            r = this.#finishFrame(this, frame);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    play() {\r\n        assertFXAlive(this);\r\n\r\n        if (this.#frameId === null) {\r\n            this.goto(this.#position);\r\n\r\n            let tick = performance.now();\r\n\r\n            let frameFN = () => {\r\n                let timestamp = performance.now(),\r\n                    delta = timestamp - tick,\r\n                    position = this.#position + (delta / this.duration);\r\n\r\n                tick = timestamp;\r\n                let frame = this.goto(position);\r\n                this.#status = FX.playing;\r\n\r\n                if (this.onFrame) this.onFrame.call(this, this, frame);\r\n\r\n                this.#element.dispatchEvent(new CustomEvent('animation.frame', {\r\n                    bubbles: this.bubbleFrameEvent,\r\n                    detail: this\r\n                }));\r\n\r\n                if (this.#position < 1) {\r\n                    this.#frameId = window.requestAnimationFrame(frameFN);\r\n                } else {\r\n                    this._complete(FX.complete, FX.complete);\r\n                    this.#frameId = null;\r\n                }\r\n            };\r\n\r\n            if (this.onStart) {\r\n                this.onStart.call(this, this);\r\n            }\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.start', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n\r\n            this.#frameId = window.requestAnimationFrame(frameFN);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Pauses the animation.  Does not resolve it.\r\n     * @returns {FX}\r\n     */\r\n    pause() {\r\n        if (this.#frameId) {\r\n            window.cancelAnimationFrame(this.#frameId);\r\n            this.#frameId = null;\r\n            this.#status = FX.paused;\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.paused', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    _cancel(complete = false, status = FX.canceled) {\r\n        if (this.#frameId) {\r\n            window.cancelAnimationFrame(this.#frameId);\r\n            this.#frameId = null;\r\n\r\n            if (complete) {\r\n                this.goto(1);\r\n                this._complete(status, status);\r\n            } else {\r\n                this.#status = status;\r\n                this.#internalValue = status;\r\n            }\r\n\r\n            if (this.onCancel) this.onCancel.call(this, this);\r\n\r\n            this.#element.dispatchEvent(new CustomEvent('animation.canceled', {\r\n                bubbles: true,\r\n                detail: this\r\n            }));\r\n\r\n            this._triggerEndEvent();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Cancel the animation with the canceled state.   optionally sets the animation to it's final frame if\r\n     * completeAnimation is true.\r\n     *\r\n     * @param completeAnimation\r\n     * @returns {FX}\r\n     */\r\n    cancel(completeAnimation = false) {\r\n        return this._cancel(completeAnimation, FX.canceled);\r\n    }\r\n\r\n    /**\r\n     * Completes the animation immediately and sets is status to complete.\r\n     * @returns {FX}\r\n     */\r\n    complete() {\r\n        return this._cancel(true, FX.complete);\r\n    }\r\n\r\n    goto(position) {\r\n        assertFXAlive(this);\r\n\r\n        if (typeof position === 'string') {\r\n            position = parseFloat(position) / 100;\r\n        }\r\n\r\n        this.#position = position;\r\n        return this.applyFrame(this.position);\r\n    }\r\n\r\n    applyFrame(position) {\r\n        let frame = this.getFrame(position);\r\n        this.#applyFrame.call(this, this, frame);\r\n        return frame;\r\n    }\r\n\r\n    _triggerEndEvent() {\r\n        if (this.onEnd) this.onEnd.call(this, this);\r\n\r\n        this.#element.dispatchEvent(new CustomEvent('animation.end', {\r\n            bubbles: true,\r\n            detail: this\r\n        }));\r\n\r\n        for (let {onResolve} of this.#chained) {\r\n            if (onResolve) onResolve(this.#internalValue);\r\n        }\r\n        this.#chained = [];\r\n    }\r\n\r\n    _complete(value, status = FX.complete) {\r\n        if (this.state !== \"Pending\") {\r\n            return;\r\n        }\r\n\r\n        this.#status = status;\r\n        this.#internalValue = value;\r\n\r\n        if (this.onComplete) this.onComplete.call(this, this);\r\n\r\n        this.#element.dispatchEvent(new CustomEvent('animation.complete', {\r\n            bubbles: true,\r\n            detail: this\r\n        }));\r\n\r\n        this._triggerEndEvent();\r\n    }\r\n\r\n    then(onResolve, onReject) {\r\n        if (this.state === \"Pending\") {\r\n            return new Promise((resolve, reject) => {\r\n                // noinspection JSUnusedGlobalSymbols\r\n                this.#chained.push({\r\n                    onResolve: (value) => {\r\n                        doPromiseAction(onResolve, value, resolve);\r\n                    },\r\n\r\n                    onReject: (value) => {\r\n                        doPromiseAction(onReject, value, reject);\r\n                    }\r\n                });\r\n            });\r\n        } else if (this.state === 'Fulfilled' && typeof onResolve === 'function') {\r\n            return new Promise((resolve) => {\r\n                doPromiseAction(onResolve, this.#internalValue, resolve);\r\n            });\r\n        } else if (this.state === 'Rejected' && typeof onReject === 'function') {\r\n            return new Promise((resolve, reject) => {\r\n                doPromiseAction(onReject, this.#internalValue, reject);\r\n            });\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    finally(onFinally) {\r\n        onFinally = (value) => {\r\n            if (typeof onFinally === 'function') {\r\n                onFinally();\r\n            }\r\n\r\n            return value;\r\n        };\r\n\r\n        return this.then(onFinally, onFinally);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    catch(onReject) {\r\n        return this.then(undefined, onReject);\r\n    }\r\n}\r\n","/**\r\n *\r\n * @param p\r\n * @returns {*}\r\n */\r\nexport function linear(p) {\r\n    return p;\r\n}\r\n\r\n\r\n// noinspection JSUnusedGlobalSymbols\r\nexport const EASING = {\r\n    linear: linear\r\n};\r\n","export function defaultApplyFrame(fx, frame) {\r\n    for (let key in frame) {\r\n        if (frame.hasOwnProperty(key)) {\r\n            fx.element.style[key] = frame[key].toString();\r\n        }\r\n    }\r\n}\r\n","export class NumberWithUnit {\r\n    constructor(value, unit) {\r\n        this.value = value;\r\n        this.unit = unit;\r\n    }\r\n\r\n    add(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n\r\n        return new NumberWithUnit(this.value + value, this.unit);\r\n    }\r\n\r\n    subtract(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value - value, this.unit);\r\n    }\r\n\r\n    scalar(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value * value, this.unit);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    divide(value) {\r\n        if (typeof value !== \"number\") {\r\n            if (!(value instanceof NumberWithUnit)) {\r\n                throw new TypeError(\"Cannot perform action on invalid type.\");\r\n            }\r\n\r\n            if (this.unit !== value.unit) {\r\n                throw new Error(\"Mismatched units\");\r\n            }\r\n\r\n            value = value.value;\r\n        }\r\n\r\n        return new NumberWithUnit(this.value / value, this.unit);\r\n    }\r\n\r\n    toString() {\r\n        return `${this.value}${this.unit}`;\r\n    }\r\n}\r\n","import Publisher from \"../Publisher\";\r\nimport {calcDistance, clamp} from \"../utility\";\r\nimport Rect from \"../vectors/Rect\";\r\nimport {getScroll} from \"../utility\";\r\nimport {setElementClientPosition} from \"./position\";\r\nimport Animation from \"../fx/Animation\";\r\n\r\n\r\nconst reg_percentage_test = /\\s*\\d+\\.?\\d*%\\s*/;\r\n\r\n\r\n/**\r\n * Returns the offset position of the mouse relative to the target.\r\n *\r\n * @param target\r\n * @param event\r\n * @returns {{x: number, y: number}}\r\n */\r\nexport function cursor(target, event) {\r\n    let rect = new Rect(target);\r\n\r\n    return {\r\n        x: event.clientX - rect.left,\r\n        y: event.clientY - rect.top\r\n    };\r\n}\r\n\r\n\r\nfunction buildTestIntersectionFunction(amount) {\r\n    return function(element, rect) {\r\n        rect = new Rect(rect);\r\n\r\n        let targetRect = new Rect(element),\r\n            intersection = targetRect.intersection(rect),\r\n            p = intersection ? intersection.getArea() / rect.getArea() : 0;\r\n\r\n        return p >= amount;\r\n    }\r\n}\r\n\r\n\r\nexport default class Draggable2 extends Publisher {\r\n    #element;\r\n    #droppables;\r\n    #boundOnMouseDown;\r\n    #itemCache;\r\n\r\n    constructor(element, {container=null, axis='xy', exclude='', delay=0, offset=cursor,\r\n        resistance=0, handle=null, helper=null, revert=false, revertDuration=0,\r\n        scrollSpeed=0, selector=null, tolerance=1, setHelperSize=false, grid=null}={}) {\r\n        super();\r\n\r\n        if(typeof element === 'string') {\r\n            this.#element = document.querySelector(element);\r\n        } else {\r\n            this.#element = element;\r\n        }\r\n\r\n        this.#droppables = [];\r\n        this.#itemCache = new WeakMap();\r\n\r\n        this.container = container;\r\n        this.axis = axis;\r\n        this.exclude = exclude;\r\n        this.delay = delay;\r\n        this.offset = offset;\r\n        this.resistance = resistance;\r\n        this.handle = handle;\r\n        this.helper = helper;\r\n        this.revert = revert;\r\n        this.revertDuration = revertDuration;\r\n        this.scrollSpeed = scrollSpeed;\r\n        this.selector = selector;\r\n        this.tolerance = tolerance;\r\n        this.setHelperSize = setHelperSize;\r\n        this.grid = grid;\r\n\r\n        if(typeof this.container === 'string') {\r\n            this.container = document.querySelector(this.container);\r\n        }\r\n\r\n        this.#boundOnMouseDown = event => {\r\n            return this.onMouseDown(event);\r\n        };\r\n\r\n        this.element.addEventListener('mousedown', this.#boundOnMouseDown);\r\n    }\r\n\r\n    /**\r\n     * Starts dragging if the correct elements have been targeted and delay and resistance have been meet.\r\n     *\r\n     * @param event\r\n     * @returns {Promise<void>}\r\n     */\r\n    async onMouseDown(event) {\r\n        let startPosition = {x: event.clientX + window.pageXOffset, y: event.clientY + window.pageYOffset},\r\n            currentPosition = {x: startPosition.x, y: startPosition.y},\r\n            target = this.#element,\r\n            cancelMouseTracking = null,\r\n            cancelTimer = null,\r\n            distanceBrokenPromise,\r\n            timerPromise,\r\n            offset;\r\n\r\n        // Only start dragging if a draggable child of the element is targeted.\r\n        // If selector is null then the entire element is draggable and should be the target.\r\n        if(this.selector) {\r\n            target = event.target.closest(this.selector);\r\n\r\n            if(!target || !this.#element.contains(target)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Only start dragging if the handle was targeted.\r\n        // If handle is null then the entire target is the handle.\r\n        if(this.handle) {\r\n            let handle = event.target.closest(this.handle);\r\n\r\n            if(!handle || !target.contains(handle)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // If any excluded elements are targeted ignore the event.\r\n        if(this.exclude) {\r\n            let exclude = event.target.closest(this.exclude);\r\n\r\n            if(exclude && target.contains(exclude)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Find the offset of the event.\r\n        if(typeof this.offset === 'function') {\r\n            offset = this.offset(target, event);\r\n        } else if(Array.isArray(this.offset)) {\r\n            offset = {\r\n                x: this.offset[0],\r\n                y: this.offset[1]\r\n            };\r\n        } else if(typeof this.offset === 'object') {\r\n            offset = {\r\n                x: this.offset.x,\r\n                y: this.offset.y\r\n            };\r\n        } else {\r\n            offset = {x: 0, y: 0};\r\n        }\r\n\r\n        // Prevent default browser actions.\r\n        event.preventDefault();\r\n\r\n        // At this point we can be sure that a draggable item was\r\n        // targeted by it's handle and no excluded items where clicked.\r\n\r\n        // Creates a promise that both tracks the current mouse coords and resolve\r\n        // when the user passes the given resistance.\r\n        distanceBrokenPromise = new Promise(resolve => {\r\n            let isDistanceBroken = this.resistance <= 0;\r\n\r\n            if(isDistanceBroken) {\r\n                resolve('complete');\r\n            }\r\n\r\n            let onMouseMove = event => {\r\n                currentPosition.x = event.clientX + window.pageXOffset;\r\n                currentPosition.y = event.clientY + window.pageYOffset;\r\n                event.preventDefault();\r\n\r\n                if(!isDistanceBroken && calcDistance(currentPosition.x, currentPosition.y, startPosition.x, startPosition.y) > this.resistance) {\r\n                    resolve('complete');\r\n                    isDistanceBroken = true;\r\n                }\r\n            };\r\n\r\n            // Cancel mouse tracking and resolve the promise to canceled if hasn't already been resolve.\r\n            // This function must be called or their will be a memory leak before onMouseDown completes.\r\n            cancelMouseTracking = () => {\r\n                if(onMouseMove) {\r\n                    document.removeEventListener('mousemove', onMouseMove);\r\n\r\n                    if(!isDistanceBroken) {\r\n                        resolve('canceled');\r\n                    }\r\n\r\n                    onMouseMove = null;\r\n                }\r\n            };\r\n\r\n            document.addEventListener('mousemove', onMouseMove);\r\n        });\r\n\r\n        // Creates a promise that resolve when after the delay time passes or the user cancels the drag by\r\n        // releasing the mouse button.\r\n        timerPromise = new Promise(resolve => {\r\n            let timer = null;\r\n\r\n            if(this.delay >= 0) {\r\n                timer = setTimeout(() => {\r\n                    resolve(\"complete\");\r\n                    timer = null;\r\n                }, this.delay);\r\n            } else {\r\n                resolve('complete');\r\n            }\r\n\r\n            // cancel the timer and resolve it to canceled if it is still active.\r\n            cancelTimer = () => {\r\n                if(timer) {\r\n                    clearTimeout(timer);\r\n                    resolve('canceled');\r\n                }\r\n            };\r\n        });\r\n\r\n        // cancel the timer and mouse tracking if they are still active.\r\n        let onMouseUp = event => {\r\n            event.preventDefault();\r\n            cancelTimer();\r\n            cancelMouseTracking();\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n        };\r\n\r\n        document.addEventListener('mouseup', onMouseUp);\r\n\r\n        // Wait until the delay time and distance have passed or failed.\r\n        let [timerStatus, distanceStatus] = await Promise.all([timerPromise, distanceBrokenPromise]);\r\n\r\n        // Ensure that mouse tracking has been canceled.\r\n        if(cancelMouseTracking) cancelMouseTracking();\r\n\r\n        // At this point both the timer and distance status should have passed or failed.\r\n        // If either failed do nothing.\r\n        if(timerStatus === 'complete' && distanceStatus === 'complete') {\r\n            this.startDragging(target, {\r\n                offsetX: offset.x,\r\n                offsetY: offset.y,\r\n                // Make relative to client.\r\n                startingX: currentPosition.x,\r\n                startingY: currentPosition.y\r\n            });\r\n        }\r\n    }\r\n\r\n    async startDragging(element, pos) {\r\n        let cache = this.#itemCache.get(element),\r\n            mousePosition = {x: pos.startingX, y: pos.startingY};\r\n\r\n        if(!cache) {\r\n            cache = {isDragging: false, fx: null, rect: null, helper: null, element: element};\r\n            this.#itemCache.set(element, cache);\r\n        }\r\n\r\n        if(cache.isDragging) {\r\n            return;\r\n        }\r\n\r\n        cache.isDragging = true;\r\n\r\n        if(cache.fx) {\r\n            await cache.fx.cancel();\r\n            cache.fx = null;\r\n        }\r\n\r\n        let target = element,\r\n            container = this.container,\r\n            scroller = null,\r\n            dropTargets = [],\r\n            startPosition = new Rect(element),\r\n            startingClientRect = startPosition;\r\n\r\n        startPosition = startPosition.translate(\r\n            window.pageXOffset,\r\n            window.pageYOffset\r\n        );\r\n\r\n        if(!cache.rect) {\r\n            cache.rect = startPosition;\r\n        }\r\n\r\n        if(typeof container === 'string') {\r\n            container = document.querySelector(container);\r\n        }\r\n\r\n        if(this.helper) {\r\n            if(typeof this.helper === 'function') {\r\n                target = this.helper(element);\r\n            } else {\r\n                target = this.helper;\r\n            }\r\n\r\n            if(this.setHelperSize) {\r\n                target.style.width = startPosition.width + \"px\";\r\n                target.style.height = startPosition.height + \"px\";\r\n            }\r\n\r\n            target.style.pointerEvents = 'none';\r\n\r\n            if(!target.parentElement && element.parentElement) {\r\n                element.parentElement.appendChild(target);\r\n            }\r\n\r\n            target.classList.add('ui-drag-helper');\r\n\r\n            cache.helper = target;\r\n        }\r\n\r\n        let refreshDropTargets = (rect) => {\r\n            // drag-enter\r\n            let mouseX = mousePosition.x - window.pageXOffset,\r\n                mouseY = mousePosition.y - window.pageYOffset,\r\n                currentDropTargets,\r\n                detail = {clientX: mouseX, clientY: mouseY};\r\n\r\n            if(rect !== null) {\r\n                currentDropTargets = this.getDropTargets(rect, {mouseX, mouseY});\r\n            } else {\r\n                currentDropTargets = [];\r\n            }\r\n\r\n            for(let dropTarget of currentDropTargets) {\r\n                if(dropTargets.indexOf(dropTarget) === -1) {\r\n                    dispatchDropEvent(this, 'drag.enter', element, target, null, rect, true, true, false, detail, dropTarget);\r\n                }\r\n            }\r\n\r\n            for(let dropTarget of dropTargets) {\r\n                if(currentDropTargets.indexOf(dropTarget) === -1) {\r\n                    dispatchDropEvent(this, 'drag.leave', element, target, null, rect, true, true, false, detail, dropTarget);\r\n                }\r\n            }\r\n\r\n            // drag-leave\r\n            dropTargets = currentDropTargets;\r\n        };\r\n\r\n        let onMouseMove = event => {\r\n            event.preventDefault();\r\n            let rect = _moveElementToPosition(this, target, event.clientX, event.clientY, pos.offsetX, pos.offsetY, _selectElementRect(container, this, target, element));\r\n\r\n            mousePosition.x = event.clientX + window.pageXOffset;\r\n            mousePosition.y = event.clientY + window.pageYOffset;\r\n\r\n            if(this.scrollSpeed > 0) {\r\n                if(scroller) {\r\n                    scroller.cancel();\r\n                    scroller = null;\r\n                }\r\n\r\n                scroller = ScrollHelper.buildScrollHelper(element, target, rect, pos, this, event, this.scrollSpeed, container);\r\n            }\r\n\r\n            refreshDropTargets(rect);\r\n\r\n            publishDragMoveEvent(this, element, target, event, rect);\r\n        };\r\n\r\n        let onMouseUp = async event => {\r\n            event.preventDefault();\r\n            document.removeEventListener('mousemove', onMouseMove);\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n            cache.isDragging = false;\r\n            element.classList.remove('ui-dragging');\r\n\r\n            if(scroller) {\r\n                scroller.cancel();\r\n                scroller = null;\r\n            }\r\n\r\n            let accepted = false,\r\n                isDefaultPrevented = false,\r\n                reverted = false,\r\n                rect = new Rect(target);\r\n\r\n            publishDragDropEvent(this, element, target, event, rect, false, {\r\n                isDefaultPrevented() {\r\n                    return isDefaultPrevented;\r\n                },\r\n\r\n                isAccepted() {\r\n                    return accepted;\r\n                },\r\n\r\n                accept() {\r\n                    accepted = true;\r\n                },\r\n\r\n                preventDefault() {\r\n                    isDefaultPrevented = true;\r\n                }\r\n            });\r\n\r\n            if(this.revert && !accepted) {\r\n                refreshDropTargets(cache.rect);\r\n                rect = cache.rect;\r\n\r\n                if(!this.revertDuration) {\r\n                    if(target !== element) {\r\n                        target.parentElement.removeChild(target);\r\n                    } else {\r\n                        let pos = startPosition.translate(\r\n                            -window.pageXOffset,\r\n                            -window.pageYOffset\r\n                        );\r\n\r\n                        setElementClientPosition(target, pos, 'translate3d');\r\n                    }\r\n                } else {\r\n                    cache.fx = _revert(target, cache.rect, this.revertDuration);\r\n\r\n                    await cache.fx;\r\n\r\n                    if(target !== element) {\r\n                        target.parentElement.removeChild(target);\r\n                    }\r\n                }\r\n\r\n                reverted = true;\r\n            } else {\r\n                if(target !== element) {\r\n                    target.parentElement.removeChild(target);\r\n                    setElementClientPosition(element, rect, 'translate3d');\r\n                }\r\n            }\r\n\r\n            this.#itemCache.delete(element);\r\n\r\n            dispatchDropEvent(this, 'drag.end', element, target, event, rect, true, true, true, {accepted, reverted}, element);\r\n        };\r\n\r\n        // Set target to starting position.\r\n        if(mousePosition.x !== undefined && mousePosition.y !== undefined) {\r\n            let rect = _moveElementToPosition(this, target, mousePosition.x - window.pageXOffset, mousePosition.y - window.pageYOffset, pos.offsetX, pos.offsetY, _selectElementRect(container, this, target, element));\r\n            refreshDropTargets(rect);\r\n        }\r\n\r\n        document.addEventListener('mousemove', onMouseMove);\r\n        document.addEventListener('mouseup', onMouseUp);\r\n        element.classList.add('ui-dragging');\r\n\r\n        dispatchDropEvent(this, 'drag.start', element, target, null, startingClientRect, true, true, true, null);\r\n    }\r\n\r\n    getDropTargets(rect, mousePos) {\r\n        let r = [];\r\n\r\n        /**\r\n         * @type {number|String|Function|string}\r\n         */\r\n        let testFunction = this.tolerance,\r\n            type = typeof testFunction;\r\n\r\n        if(type === 'string') {\r\n            // noinspection JSCheckFunctionSignatures\r\n            if(reg_percentage_test.test(testFunction)) {\r\n                // noinspection JSCheckFunctionSignatures\r\n                testFunction = buildTestIntersectionFunction(parseFloat(testFunction) / 100);\r\n            }\r\n        } else if(type === 'number') {\r\n            testFunction = buildTestIntersectionFunction(testFunction);\r\n        }\r\n\r\n        for(let droppable of this.#droppables) {\r\n            if(testFunction(droppable, rect, mousePos, this)) {\r\n                r.push(droppable);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    connect(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        this.#droppables.push(droppable);\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    disconnect(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        let i = this.#droppables.indexOf(droppable);\r\n\r\n        if(i !== -1) {\r\n            this.#droppables.splice(i, 1);\r\n        }\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    hasDroppable(droppable) {\r\n        if(typeof droppable === 'string') {\r\n            droppable = document.querySelector(droppable);\r\n        }\r\n\r\n        return this.#droppables.indexOf(droppable) !== -1;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    get droppables() {\r\n        return this.#droppables.slice(0);\r\n    }\r\n\r\n    get element() {\r\n        return this.#element;\r\n    }\r\n}\r\n\r\n\r\nfunction _dispatchDropEvent(self, target, name, options) {\r\n    let customEvent = new CustomEvent(name, {\r\n        bubbles: options.bubble,\r\n\r\n        detail: {\r\n            name,\r\n            target,\r\n            draggable: self,\r\n            ...options.detail\r\n        }\r\n    });\r\n\r\n    target.dispatchEvent(customEvent);\r\n}\r\n\r\n\r\nfunction _revert(target, position, revertDuration, onFrame=null) {\r\n    let starting = new Rect(target);\r\n\r\n    let animation = new Animation({\r\n        frames: {\r\n            '0%': {\r\n                left: starting.left + window.pageXOffset,\r\n                top: starting.top + window.pageYOffset\r\n            },\r\n\r\n            '100%': {\r\n                left: position.left,\r\n                top: position.top\r\n            }\r\n        },\r\n\r\n        applyFrame(fx, frame) {\r\n            setElementClientPosition(fx.element, {\r\n                left: frame.left - window.pageXOffset,\r\n                top: frame.top - window.pageYOffset\r\n            }, 'translate3d');\r\n\r\n            if(onFrame) onFrame(fx);\r\n        }\r\n    });\r\n\r\n    return animation.animate(target, {duration: revertDuration});\r\n}\r\n\r\n\r\n/**\r\n * Takes a client (x, y) position and some offset coords and move the element to the given position.\r\n *\r\n * @param self\r\n * @param element\r\n * @param x\r\n * @param y\r\n * @param offsetX\r\n * @param offsetY\r\n * @param container\r\n * @private\r\n * @returns {*|Rect}\r\n */\r\nfunction _moveElementToPosition(self, element, x, y, offsetX, offsetY, container) {\r\n    let rect = new Rect(element),\r\n        startingRect = rect;\r\n\r\n    rect = rect.moveTo({left: x, top: y});\r\n\r\n    offsetX = offsetX || 0;\r\n    offsetY = offsetY || 0;\r\n\r\n    rect = rect.translate(-offsetX, -offsetY);\r\n\r\n    if(self.axis === 'y') {\r\n        rect = new Rect(\r\n            startingRect.left,\r\n            rect.top,\r\n            startingRect.right,\r\n            rect.bottom\r\n        );\r\n    } else if(self.axis === 'x') {\r\n        rect = new Rect(\r\n            rect.left,\r\n            startingRect.top,\r\n            rect.right,\r\n            startingRect.bottom\r\n        );\r\n    }\r\n\r\n    if(typeof self.grid === 'number' && self.grid) {\r\n        let left = Math.floor(rect.left / self.grid) * self.grid,\r\n            top = Math.floor(rect.top / self.grid) * self.grid;\r\n\r\n        rect = new Rect(left, top, left + startingRect.width, top + startingRect.height);\r\n    }\r\n\r\n    if(container) {\r\n        container = new Rect(container);\r\n        rect = rect.fit(container);\r\n    }\r\n\r\n    setElementClientPosition(element, rect, 'translate3d');\r\n    return rect;\r\n}\r\n\r\n\r\n// noinspection JSCommentMatchesSignature\r\n/**\r\n * For module use only.  Selects the element either by css selector, if it's a string, or resolve a function.\r\n * If the element is already element is is returned direction.  Returns null if not element is provided.\r\n *\r\n * @param element\r\n * @param dragInstance\r\n * @param target\r\n * @returns {null|*}\r\n * @private\r\n */\r\nfunction _selectElementRect(element, dragInstance, target, originalTarget) {\r\n    if(element) {\r\n        let type = typeof element;\r\n\r\n        if(type === 'function') {\r\n            return new Rect(element.call(dragInstance, target, originalTarget, dragInstance));\r\n        } else if(type === 'string') {\r\n            return new Rect(document.querySelector(element));\r\n        }\r\n\r\n        return new Rect(element);\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\n/**\r\n * Returns the first scrollable parent.\r\n *\r\n * @param element\r\n * @returns {HTMLElement|null}\r\n * @private\r\n */\r\nfunction _getScrollParent(element) {\r\n    let o = element.parentElement;\r\n\r\n    while(o) {\r\n        if (o.scrollWidth > o.clientWidth || o.scrollHeight > o.clientHeight) {\r\n            return o;\r\n        }\r\n\r\n        o = o.parentElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n\r\nfunction _getScrollRect(element) {\r\n    if(element === window || element.nodeName === \"HTML\") {\r\n        return new Rect(0, 0, window.innerWidth, window.innerHeight);\r\n    } else {\r\n        return new Rect(element);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Helper class that is used to control scrolling when the element is dragged outside of bounds.\r\n */\r\nclass ScrollHelper {\r\n    constructor(element, scrollXSpeed=0, scrollYSpeed=0, onFrame=null) {\r\n        this.frameID = null;\r\n        this.element = element;\r\n        this.scrollXSpeed = scrollXSpeed;\r\n        this.scrollYSpeed = scrollYSpeed;\r\n        this.onFrame = onFrame;\r\n        this.timestamp = performance.now();\r\n\r\n        let frame = timestamp => {\r\n            let delta = (timestamp - this.timestamp) / 1000;\r\n\r\n            this.timestamp = timestamp;\r\n\r\n            this.element.scrollLeft += delta * this.scrollXSpeed;\r\n            this.element.scrollTop += delta * this.scrollYSpeed;\r\n\r\n            if(this.onFrame) {\r\n                this.onFrame(this);\r\n            }\r\n\r\n            this.frameID = window.requestAnimationFrame(frame);\r\n        };\r\n\r\n        this.frameID = window.requestAnimationFrame(frame);\r\n    }\r\n\r\n    cancel() {\r\n        if(this.frameID) {\r\n            window.cancelAnimationFrame(this.frameID);\r\n            this.frameID = null;\r\n        }\r\n    }\r\n\r\n    static getScrollSpeed(rect, scrollParentRect) {\r\n        let r = {x: 0, y: 0};\r\n\r\n        if(rect.right > scrollParentRect.right) {\r\n            r.x = clamp((rect.right - scrollParentRect.right) / rect.width, -1, 1);\r\n        } else if(rect.left < scrollParentRect.left) {\r\n            r.x = clamp((rect.left - scrollParentRect.left) / rect.width, -1, 1);\r\n        }\r\n\r\n        if(rect.bottom > scrollParentRect.bottom) {\r\n            r.y = clamp((rect.bottom - scrollParentRect.bottom) / rect.width, -1, 1);\r\n        } else if(rect.top < scrollParentRect.top) {\r\n            r.y = clamp((rect.top - scrollParentRect.top) / rect.width, -1, 1);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static buildScrollHelper(element, target, rect, pos, dragInstance, event, scrollSpeed, container) {\r\n        let scrollParent = _getScrollParent(element);\r\n\r\n        if(scrollParent) {\r\n            let scrollParentRect = _getScrollRect(scrollParent),\r\n                speed = ScrollHelper.getScrollSpeed(rect, scrollParentRect);\r\n\r\n            if(speed.x || speed.y) {\r\n                return new ScrollHelper(scrollParent, speed.x * scrollSpeed, speed.y * scrollSpeed, (scroller) => {\r\n                    let rect = _moveElementToPosition(this, target, event.clientX, event.clientY, pos.offsetX, pos.offsetY, _selectElementRect(container, dragInstance, target, element));\r\n\r\n                    let scrollRect = new Rect(scroller.element);\r\n\r\n                    setElementClientPosition(target, rect, 'translate3d');\r\n\r\n                    if(scrollRect.contains(rect)) {\r\n                        scroller.cancel();\r\n                        scroller = null;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function ScrollArea(selector) {\r\n    return function() {\r\n        let element = selector;\r\n\r\n        if(typeof element === 'string') {\r\n            element = document.querySelector(element);\r\n        }\r\n\r\n        let rect = new Rect(element),\r\n            scroll = getScroll(element);\r\n\r\n        rect.left -= scroll.scrollLeft;\r\n        rect.top -= scroll.scrollTop;\r\n        rect.right = rect.left + element.scrollWidth;\r\n        rect.bottom = rect.top + element.scrollHeight;\r\n\r\n        return rect;\r\n    }\r\n}\r\n\r\n\r\nexport function clone(opacity=null, className=null, zIndex=null) {\r\n    if(typeof opacity === 'object' && opacity.nodeType) {\r\n        return opacity.cloneNode(true);\r\n    }\r\n\r\n    return function(element) {\r\n        let r = element.cloneNode(true);\r\n\r\n        if(opacity !== null) {\r\n            r.style.opacity = opacity;\r\n        }\r\n\r\n        if(className) {\r\n            r.className = className;\r\n        }\r\n\r\n        r.style.position = \"absolute\";\r\n        if(zIndex !== null) r.style.zIndex = zIndex;\r\n\r\n        return r;\r\n    }\r\n}\r\n\r\n\r\nfunction publishDragMoveEvent(self, element, helper, event, rect, bubbles=false, options=null) {\r\n    return dispatchDropEvent(self, 'drag.move', element, helper, event, rect, bubbles, true, true, options);\r\n}\r\n\r\n\r\nfunction publishDragDropEvent(self, element, helper, event, rect, bubbles=true, options=null) {\r\n    return dispatchDropEvent(self, 'drag.drop', element, helper, event, rect, bubbles, true, true, options);\r\n}\r\n\r\n\r\nfunction dispatchDropEvent(self, name, element, helper, originalEvent, currentRect, bubbles=false, dispatch=true, publish=false, detail=null, target=null) {\r\n    let eventPackage = {\r\n        name,\r\n        draggable: self,\r\n        target: helper,\r\n        element,\r\n        originalEvent: null,\r\n        rect: currentRect\r\n    };\r\n\r\n    if(originalEvent) {\r\n        eventPackage.originalEvent = originalEvent;\r\n        eventPackage.clientX = originalEvent.clientX;\r\n        eventPackage.clientY = originalEvent.clientY;\r\n    }\r\n\r\n    if(!target) {\r\n        target = element;\r\n    }\r\n\r\n    if(detail) {\r\n        Object.assign(eventPackage, detail);\r\n    }\r\n\r\n    if(publish) {\r\n        self.publish(name, eventPackage);\r\n    }\r\n\r\n    if(dispatch) {\r\n        let customEvent = new CustomEvent(name, {\r\n            bubbles,\r\n            detail: detail\r\n        });\r\n\r\n        target.dispatchEvent(customEvent);\r\n    }\r\n}\r\n"],"sourceRoot":""}