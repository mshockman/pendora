{"version":3,"sources":["webpack://pendora/./jekyll/js/pages/menubar_example.js","webpack://pendora/./src/core/Publisher.js","webpack://pendora/./src/core/errors.js","webpack://pendora/./src/core/utility.js","webpack://pendora/./src/menu2/DropDown.js","webpack://pendora/./src/menu2/Menu.js","webpack://pendora/./src/menu2/MenuBar.js","webpack://pendora/./src/menu2/MenuItem.js","webpack://pendora/./src/menu2/MenuNode.js","webpack://pendora/./src/menu2/decorators.js"],"names":["MenuBarExamplePage","deep","items","_n","text","x","r","i","node","children","buildTestMenu","href","push","main","document","getElementById","menu","MenuBar","createItems","appendTo","window","Publisher","_topics","topic","callback","fn","on","off","args","apply","arguments","length","callbacks","cb","splice","slice","ExtendableError","message","name","constructor","Error","captureStackTrace","stack","IndexError","KeyError","ValueError","NotImplemented","ValidationError","AssertionError","REG_WHITESPACE","clamp","value","minValue","maxValue","Math","max","min","firstValue","item","undefined","all","iterable","any","proto","descriptor","placement","randomChoice","array","floor","random","arraysEqual","array1","array2","l","parseHTML","html","template","createElement","innerHTML","trim","content","fragment","createDocumentFragment","firstChild","appendChild","isEmptyObject","object","key","emptyElement","element","removeChild","addClasses","classes","split","classList","add","removeClasses","remove","assignAttributes","attributes","hasOwnProperty","setAttribute","setElementOffset","coords","nodeType","getElementOffset","Array","isArray","left","top","offset","getBoundingClientRect","style","getComputedStyle","parseInt","box","pageXOffset","pageYOffset","getScroll","isWindow","scrollLeft","scrollTop","variable","setInterval","setScroll","scroll","scrollTo","selectElement","selector","context","querySelector","jquery","assert","condition","parseBooleanOrInt","radix","defaultValue","TypeError","type","Number","isNaN","parseBooleanOrFloat","parseFloat","parseBoolean","parseIntValue","parseFloatValue","parseAny","parsers","parser","e","validateChoice","choices","indexOf","choice","findChild","child","filterChildren","getOwnProperty","obj","propName","getPropertyByPath","path","parts","part","DropDown","target","closeOnBlur","timeout","autoActivate","toggle","closeOnSelect","menuNodeType","render","init","button","isActive","clearTimer","parent","activate","setActiveItem","event","MenuNode","Menu","multiple","openOnHover","deactivateOnItemHover","events","MenuItemClass","MenuItem","isVisible","activeItems","activeItem","deactivate","onClick","onMouseOver","onMouseOut","onSelect","arrow","body","className","_captureDocumentClick","onDocumentClick","contains","addEventListener","publish","dispatchEvent","CustomEvent","detail","bubbles","console","trace","clearItems","removeEventListener","data","submenu","attachSubMenu","append","action","index","_children","parentElement","getMenuBody","removeItem","isMenuItem","_parent","querySelectorAll","originalEvent","relatedTarget","startTimer","toggleOff","toggleOn","nodeName","addClass","addAction","inherit","show","hide","dispatchTopic","location","hasEvent","detachSubMenu","isDisabled","preventDefault","hasSubMenu","select","MENU_MAP","WeakMap","_props","_timers","_element","_isActive","_isVisible","_isDisabled","isController","boundEvents","handleEvent","getTargetNode","getEventDelegator","hasElement","o","call","getDescendants","grandchild","time","interval","clear","cancel","timer","status","id","clearInterval","setTimeout","clearTimeout","instance","get","isMenu","closest","getOffsetSibling","set","dataset","initializer","kind","configurable","enumerable","root","publishTargetEvent","bubble","desc","wrapper"],"mappings":"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","file":"chunk-0.bundle.js","sourcesContent":["import {MenuBar} from \"menu2\";\r\n\r\n\r\nexport default class MenuBarExamplePage {\r\n    constructor() {\r\n\r\n    }\r\n\r\n    buildTestMenu(deep, items, _n=0) {\r\n        let text = (x) => `Child Item #${x}`;\r\n        if(_n === 0) text = (x) => `Root Item #${x}`;\r\n\r\n        let r = [];\r\n\r\n        for(let i = 0; i < items; i++) {\r\n            let node = {\r\n                text: text(i)\r\n            };\r\n\r\n            if(_n < deep) {\r\n                node.children = this.buildTestMenu(deep, items, _n + 1);\r\n            } else {\r\n                node.href = '#';\r\n            }\r\n\r\n            r.push(node);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    load() {\r\n        let main = document.getElementById('content');\r\n\r\n        let menu = new MenuBar();\r\n\r\n        menu.createItems(\r\n            this.buildTestMenu(3, 5)\r\n        );\r\n\r\n        menu.appendTo(main);\r\n        window.menu = menu;\r\n    }\r\n}","\r\n\r\nexport default class Publisher {\r\n    constructor() {\r\n        this._topics = {};\r\n    }\r\n\r\n    on(topic, callback) {\r\n        if(!this._topics[topic]) this._topics[topic] = [];\r\n        this._topics[topic].push(callback);\r\n        return this;\r\n    }\r\n\r\n    once(topic, fn) {\r\n        let on = (...args) => {\r\n            this.off(topic, fn);\r\n            return fn.apply(this, args);\r\n        };\r\n\r\n        on.fn = fn;\r\n        this.on(topic, fn);\r\n        return this;\r\n    }\r\n\r\n    off(topic, callback) {\r\n        if(arguments.length === 0) {\r\n            // CLear all topics.\r\n            this._topics = {};\r\n            return this;\r\n        } else if(arguments.length === 1) {\r\n            // Clear single topic.\r\n            this._topics[topic] = [];\r\n            return this;\r\n        }\r\n\r\n        if(!this._topics || !this._topics[topic] || !this._topics[topic].length) {\r\n            // Topic list was either empty or didn't exist.  No need to remove anything.  Return;\r\n            return this;\r\n        }\r\n\r\n        let callbacks = this._topics[topic];\r\n\r\n        for(let i = 0; i < callback.length; i++) {\r\n            let cb = callbacks[i];\r\n            if(cb === callback || cb.fn === callback) {\r\n                callbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(callbacks.length === 0) {\r\n            delete this._topics[topic];\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    hasEvent(topic, callback) {\r\n        if(arguments.length === 1) {\r\n            return !!this._topics[topic];\r\n        } else {\r\n            let callbacks = this._topics[topic];\r\n\r\n            for(let i = 0; i < callbacks.length; i++) {\r\n                let cb = callbacks[i];\r\n                if(cb === callback || cb.fn === callback) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    publish(topic, ...args) {\r\n        if(this._topics[topic]) {\r\n            let callbacks = this._topics[topic].slice(0);\r\n\r\n            for(let cb of callbacks) {\r\n                cb.apply(this, args);\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n}","\r\nexport class ExtendableError extends Error {\r\n    constructor(message) {\r\n        // noinspection JSCheckFunctionSignatures\r\n        super(message);\r\n        this.name = this.constructor.name;\r\n\r\n        // noinspection JSUnresolvedVariable\r\n        if(typeof Error.captureStackTrace === 'function') {\r\n            // noinspection JSUnresolvedFunction\r\n            Error.captureStackTrace(this, this.constructor);\r\n        } else {\r\n            this.stack = (new Error(message)).stack;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class IndexError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class KeyError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class ValueError extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class NotImplemented extends ExtendableError {\r\n\r\n}\r\n\r\n\r\nexport class ValidationError extends ExtendableError {\r\n    constructor(message, node) {\r\n        super(message);\r\n        this.node = node;\r\n        this.children = [];\r\n    }\r\n}\r\n\r\n\r\nexport class AssertionError extends ExtendableError {\r\n    constructor(message) {\r\n        super(message);\r\n    }\r\n}\r\n","import {AssertionError} from './errors';\r\nconst REG_WHITESPACE = /\\s+/;\r\n\r\n\r\n/**\r\n * Clamps a value between a minimum and maximum values.\r\n * @param value\r\n * @param minValue\r\n * @param maxValue\r\n * @returns {*}\r\n */\r\nexport function clamp(value, minValue=null, maxValue=null) {\r\n    if(minValue !== null) {\r\n        value = Math.max(value, minValue);\r\n    }\r\n\r\n    if(maxValue !== null) {\r\n        value = Math.min(value, maxValue);\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Takes an iterable and returns the first none null or undefined value.\r\n * @param args\r\n */\r\nexport function firstValue(args) {\r\n    for(let item of args) {\r\n        if(item !== null && item !== undefined) {\r\n            return item;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Takes an iterable and returns true if all of the values are trueish.\r\n * @param iterable\r\n */\r\nexport function all(iterable) {\r\n    for(let item of iterable) {\r\n        if(!item) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n/**\r\n * Takes an iterable and returns true if any of the values are trueish.\r\n * @param iterable\r\n */\r\nexport function any(iterable) {\r\n    for(let item of iterable) {\r\n        if(item) return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n\r\nexport function proto(descriptor) {\r\n    descriptor.placement = \"prototype\";\r\n    return descriptor;\r\n}\r\n\r\n\r\n/**\r\n * Returns a random value from an array.\r\n * @param array\r\n * @returns {*}\r\n */\r\nexport function randomChoice(array) {\r\n    return array[Math.floor(Math.random()*array.length)];\r\n}\r\n\r\n\r\n/**\r\n * Checks to see if 2 arrays are \"equal\".\r\n * @param array1\r\n * @param array2\r\n */\r\nexport function arraysEqual(array1, array2) {\r\n    if(array1 === array2) return true; // The same object.\r\n    if(array1 == null || array2 == null) return false;\r\n    if(array1.length !== array2.length) return false;\r\n\r\n    for(let i = 0, l = array1.length; i < l; i++) {\r\n        if(array1[i] !== array2[i]) return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n/**\r\n * Parses an html string into a document fragment.\r\n *\r\n * @param html\r\n * @return {DocumentFragment}\r\n */\r\nexport function parseHTML(html) {\r\n    let template = document.createElement('template');\r\n    template.innerHTML = html.trim();\r\n\r\n    if(template.content) {\r\n        return template.content;\r\n    } else {\r\n        // Doesn't support template tag.\r\n        let fragment = document.createDocumentFragment();\r\n        while(template.firstChild) fragment.appendChild(template.firstChild);\r\n        return fragment;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Tests to see if the object is empty.\r\n *\r\n * @param object\r\n * @return {boolean}\r\n */\r\nexport function isEmptyObject(object) {\r\n    // noinspection LoopStatementThatDoesntLoopJS\r\n    for(let key in object) {\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n/**\r\n * Empties a dom element.\r\n *\r\n * @param element\r\n */\r\nexport function emptyElement(element) {\r\n    while(element.firstChild) element.removeChild(element.firstChild);\r\n}\r\n\r\n\r\n/**\r\n * Adds classes to an element.  Can take a space separated list of classes.\r\n *\r\n * @param element\r\n * @param classes\r\n */\r\nexport function addClasses(element, classes) {\r\n    if(typeof classes === 'string') {\r\n        classes = classes.split(REG_WHITESPACE);\r\n    }\r\n\r\n    element.classList.add(...classes);\r\n}\r\n\r\n\r\n/**\r\n * Removes classes to an element.  Can take a space separated list of classes.\r\n *\r\n * @param element\r\n * @param classes\r\n */\r\nexport function removeClasses(element, classes) {\r\n    if(typeof classes === 'string') {\r\n        classes = classes.split(REG_WHITESPACE);\r\n    }\r\n\r\n    element.classList.remove(...classes);\r\n}\r\n\r\n\r\n/**\r\n * Assigns attributes in an object to an element.\r\n * @param element\r\n * @param attributes\r\n */\r\nexport function assignAttributes(element, attributes) {\r\n    for(let key in attributes) {\r\n        if(attributes.hasOwnProperty(key)) {\r\n            element.setAttribute(key, attributes[key]);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Sets an elements position relative to the document.\r\n *\r\n * @param element\r\n * @param coords\r\n */\r\nexport function setElementOffset(element, coords) {\r\n    if(coords.nodeType) {\r\n        coords = getElementOffset(element);\r\n    } else if(Array.isArray(coords)) {\r\n        coords = {\r\n            left: coords.left,\r\n            top: coords.top\r\n        };\r\n    }\r\n\r\n    let offset = element.getBoundingClientRect();\r\n\r\n    let style = getComputedStyle(element),\r\n        left = parseInt(style.left, 10) || 0,\r\n        top = parseInt(style.top, 10) || 0;\r\n\r\n    element.style.left = (left + (coords.left - offset.left)) + 'px';\r\n    element.style.top = (top + (coords.top - offset.top)) + 'px';\r\n}\r\n\r\n\r\n/**\r\n * Returns the top and left position of an element relative to the document.\r\n *\r\n * @param element\r\n * @return {{top: number, left: number}}\r\n */\r\nexport function getElementOffset(element) {\r\n    let box = element.getBoundingClientRect();\r\n\r\n    return {\r\n        left: box.left + window.pageXOffset,\r\n        top: box.top + window.pageYOffset\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Normalizing accessing scroll position for an element.\r\n *\r\n * Windows and elements have different ways of accessing their scroll left and scroll top values on IE.\r\n * This function normalizes this behavior so getScroll(variable).scrollLeft always works.\r\n * @param element\r\n * @returns {{left, top}}\r\n */\r\nexport function getScroll(element) {\r\n    if(isWindow(element)) {\r\n        return {\r\n            scrollLeft: element.pageXOffset,\r\n            scrollTop: element.pageYOffset\r\n        };\r\n    } else {\r\n        return {\r\n            scrollLeft: element.scrollLeft,\r\n            scrollTop: element.scrollTop\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Test to see if the variable is a window.\r\n * @param variable\r\n * @returns {boolean}\r\n */\r\nexport function isWindow(variable) {\r\n    return variable && typeof variable === 'object' && setInterval in variable;\r\n}\r\n\r\n\r\n/**\r\n * Normalizes setting a scroll position for an element.\r\n * Windows on ie and elements with overflow scroll have different ways of setting the scroll position.\r\n * This methods normalizes them.\r\n * @param element - The element to scroll\r\n * @param scroll - An object with a left or a top property or both.\r\n */\r\nexport function setScroll(element, scroll) {\r\n    if(element.scrollTo) {\r\n        element.scrollTo(scroll);\r\n    } else {\r\n        element.scrollLeft = scroll.left;\r\n        element.scrollTop = scroll.top;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Matches a single dom element based on the given selector.\r\n * Can take a css selector string, a jquery object, a dom element, a document element or a document fragment.\r\n * If a css selector is passed it will query for the element.\r\n * If a jquery object is passed it will return the first matched element.\r\n * If an element is passed it will return that element.\r\n *\r\n * If a context is provided and the selector was a css selector, the selectors scope will be limited to that element.\r\n * Otherwise the context will be the document.\r\n *\r\n * @param selector\r\n * @param context\r\n * @returns {Element|Document|DocumentFragment}\r\n */\r\nexport function selectElement(selector, context=null) {\r\n    if(!context) {\r\n        context = document;\r\n    } else {\r\n        context = selectElement(context);\r\n    }\r\n\r\n    if(typeof selector === 'string') {\r\n        return context.querySelector(selector);\r\n    } else if(selector.jquery) {\r\n        return selector[0];\r\n    } else if(selector.nodeType === 1 || selector.nodeType === 9 || selector.nodeType === 11) {\r\n        return selector;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Asserts that a condition is true or raises an AssertionError.\r\n * @param condition - condition to check.\r\n * @param message - message on fail.\r\n * @throws AssertionError\r\n */\r\nexport function assert(condition, message) {\r\n    if(!condition) {\r\n        throw new AssertionError(message);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse the value into a boolean value or a integer.  Returns the default value on failure if provided.\r\n * Otherwise throws a TypeError.\r\n * @param value\r\n * @param radix\r\n * @param defaultValue\r\n * @returns {boolean|number|*}\r\n */\r\nexport function parseBooleanOrInt(value, radix=10, defaultValue=TypeError) {\r\n    let type = typeof value;\r\n\r\n    if(type === 'boolean' || type === 'number') {\r\n        return value;\r\n    }\r\n\r\n    if(value === 'true') {\r\n        return true;\r\n    } else if(value === 'false') {\r\n        return false;\r\n    }\r\n\r\n    value = parseInt(value, radix);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into boolean or int.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse the value into a boolean value or a float.  Returns the default value on failure if provided.\r\n * Otherwise throws a TypeError.\r\n * @param value\r\n * @param defaultValue\r\n * @returns {boolean|number|*}\r\n */\r\nexport function parseBooleanOrFloat(value, defaultValue=TypeError) {\r\n    let type = typeof value;\r\n\r\n    if(type === 'boolean' || type === 'number') {\r\n        return value;\r\n    }\r\n\r\n    if(value === 'true') {\r\n        return true;\r\n    } else if(value === 'false') {\r\n        return false;\r\n    }\r\n\r\n    value = parseFloat(value);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into boolean or int.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Attempts for parse a boolean value from a string.  Returns the defaultValue on failure if provided.  Otherwise throws\r\n * a TypeError.\r\n * @param value\r\n * @param defaultValue\r\n * @returns {boolean|*}\r\n */\r\nexport function parseBoolean(value, defaultValue=TypeError) {\r\n    if(typeof value === 'boolean') {\r\n        return value;\r\n    } else if(value === 'true') {\r\n        return true;\r\n    } else if(value === 'false') {\r\n        return false;\r\n    } else {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into boolean.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse a string into an integer.  Returns the default value on failure if set.  Otherwise throws a\r\n * TypeError.\r\n * @param value\r\n * @param radix\r\n * @param defaultValue\r\n * @returns {number}\r\n */\r\nexport function parseIntValue(value, radix=10, defaultValue=TypeError) {\r\n    value = parseInt(value, radix);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into integer.\");\r\n        } else {\r\n            // noinspection JSValidateTypes\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Attempts to parse a string into an integer.  Returns the default value on failure if set.  Otherwise throws a\r\n * TypeError.\r\n * @param value\r\n * @param defaultValue\r\n * @returns {number}\r\n */\r\nexport function parseFloatValue(value, defaultValue=TypeError) {\r\n    value = parseFloat(value);\r\n\r\n    if(Number.isNaN(value)) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Could not parse value into float.\");\r\n        } else {\r\n            // noinspection JSValidateTypes\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/**\r\n * Runs multiple parsers and returns the first one that doesn't throw a TypeError.\r\n * @param value\r\n * @param parsers\r\n * @returns {*}\r\n */\r\nexport function parseAny(value, ...parsers) {\r\n    for(let parser of parsers) {\r\n        try {\r\n            return parser(value);\r\n        } catch(e) {\r\n            if(!(e instanceof TypeError)) {\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n\r\n    throw new TypeError(\"Could not parse value.\");\r\n}\r\n\r\n\r\n/**\r\n * Validates that the value is one of the given choices.\r\n * @param value\r\n * @param choices\r\n * @param defaultValue\r\n * @returns {TypeErrorConstructor|*}\r\n */\r\nexport function validateChoice(value, choices, defaultValue=TypeError) {\r\n    if(choices.indexOf(value) === -1) {\r\n        if(defaultValue === TypeError) {\r\n            throw new TypeError(\"Invalid choice.\");\r\n        } else {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\nexport function choice(...args) {\r\n    return function(value) {\r\n        if(args.indexOf(value) === -1) {\r\n            throw new TypeError(\"Invalid Choice\");\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns first child element that matches the test function.\r\n * @param element - Parent element\r\n * @param fn - Test Function\r\n * @returns {Element}\r\n */\r\nexport function findChild(element, fn) {\r\n    for(let i = 0, l = element.children.length; i < l; i++) {\r\n        let child = element.children[i];\r\n\r\n        if(fn(child)) {\r\n            return child;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Creates a filtered list of element from the children that match the test function.\r\n * @param element - Parent element.\r\n * @param fn - Test function.\r\n * @returns {Array}\r\n */\r\nexport function filterChildren(element, fn) {\r\n    let r = [];\r\n\r\n    for(let i = 0, l = element.children.length; i < l; i++) {\r\n        let child = element.children[i];\r\n\r\n        if(fn(child)) {\r\n            r.push(child);\r\n        }\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\n\r\n/**\r\n * Returns the object own property or the default value if it does not have that property.\r\n * @param obj\r\n * @param propName\r\n * @param defaultValue\r\n * @returns {*}\r\n */\r\nexport function getOwnProperty(obj, propName, defaultValue=undefined) {\r\n    if(obj.hasOwnProperty(propName)) {\r\n        return obj[propName];\r\n    } else {\r\n        return defaultValue;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Returns the obj value by following it's property path.  For example getPropertyByPath(a, 'b.c.d') is equivalent to\r\n * a.b.c.d but can be passed in string form.\r\n * @param obj\r\n * @param path\r\n * @returns {*}\r\n */\r\nexport function getPropertyByPath(obj, path) {\r\n    let parts = path.split('.'),\r\n        r = obj;\r\n\r\n    for(let part of parts) {\r\n        r = r[part];\r\n    }\r\n\r\n    return r;\r\n}\r\n","import MenuNode from \"./MenuNode\";\r\n\r\n\r\nexport default class DropDown extends MenuNode {\r\n    constructor({target, text, closeOnBlur=true, timeout=false, autoActivate=false, toggle=\"both\", closeOnSelect=true}) {\r\n        super();\r\n\r\n        this.menuNodeType = \"dropdown\";\r\n\r\n        this.closeOnBlur = closeOnBlur;\r\n        this.timeout = timeout;\r\n        this.autoActivate = autoActivate;\r\n        this.toggle = toggle;\r\n        this.closeOnSelect = closeOnSelect;\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render(text);\r\n        }\r\n\r\n        this.init();\r\n    }\r\n\r\n    render(text) {\r\n        let element = document.createElement('div'),\r\n            button = document.createElement('button');\r\n\r\n        button.type = \"button\";\r\n        button.innerHTML = text;\r\n\r\n        element.appendChild(button);\r\n\r\n        return element;\r\n    }\r\n\r\n    activate() {\r\n        if(this.isActive) return; // Already active\r\n\r\n        this.isActive = true;\r\n\r\n        this.clearTimer('autoActivate');\r\n\r\n        if(this.parent) {\r\n            if(!this.parent.isActive) {\r\n                this.parent.activate();\r\n            }\r\n\r\n            this.parent.setActiveItem(this, true);\r\n        }\r\n    }\r\n\r\n    deactivate() {\r\n\r\n    }\r\n\r\n    onMouseOver(event) {\r\n\r\n    }\r\n\r\n    onMouseOut(event) {\r\n\r\n    }\r\n\r\n    onClick(event) {\r\n\r\n    }\r\n}\r\n","import MenuNode from \"./MenuNode\";\r\nimport MenuItem from \"./MenuItem\";\r\n\r\n\r\nexport default class Menu extends MenuNode {\r\n    constructor({target=null, closeOnBlur=false, timeout=false, autoActivate=true, multiple=false, openOnHover=true,\r\n                    toggle=\"both\", closeOnSelect=true, deactivateOnItemHover=true, ...context}={}) {\r\n        super();\r\n        this.menuNodeType = \"menu\";\r\n        this.events = null;\r\n        this.MenuItemClass = MenuItem;\r\n\r\n        this.closeOnBlur = closeOnBlur;\r\n        this.timeout = timeout;\r\n        this.autoActivate = autoActivate;\r\n        this.multiple = multiple;\r\n        this.openOnHover = openOnHover;\r\n        this.toggle = toggle;\r\n        this.closeOnSelect = closeOnSelect;\r\n        this.deactivateOnItemHover = deactivateOnItemHover;\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render(context);\r\n        }\r\n\r\n        this.isVisible = false;\r\n\r\n        this.init();\r\n\r\n        // On child is activate\r\n        // deactivate siblings if multiple is false.\r\n        this.on('activate', (target) => {\r\n            if(target.parent === this) {\r\n                if (!this.isActive) {\r\n                    this.activate();\r\n                }\r\n\r\n                if (!this.multiple) {\r\n                    for (let activeItem of this.activeItems) {\r\n                        if (activeItem !== target) {\r\n                            activeItem.deactivate();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        this.on('deactivate', (target) => {\r\n            if(target.parent === this) {\r\n                if (this.isActive && this.activeItems.length === 0) {\r\n                    this.deactivate();\r\n                }\r\n            }\r\n        });\r\n\r\n        this.on('event.click', (event) => this.onClick(event));\r\n        this.on('event.mouseover', (event) => this.onMouseOver(event));\r\n        this.on('event.mouseout', (event) => this.onMouseOut(event));\r\n        this.on('menuitem.selected', (event) => this.onSelect(event));\r\n    }\r\n\r\n    render({arrow=false}={}) {\r\n        let element = document.createElement('div'),\r\n            body = document.createElement('div');\r\n\r\n        element.className = \"menu\";\r\n        body.className = \"menu__body\";\r\n\r\n        if(arrow) {\r\n            let arrow = document.createElement('div');\r\n            arrow.className = \"menu__arrow\";\r\n            element.appendChild(arrow);\r\n        }\r\n\r\n        element.appendChild(body);\r\n        return element;\r\n    }\r\n\r\n    activate() {\r\n        if(!this.isActive) {\r\n            let parent = this.parent;\r\n\r\n            // Set isActivate flag and add active classes.\r\n            this.isActive = true;\r\n\r\n            // Register document click handler\r\n            if(this.closeOnBlur && !this._captureDocumentClick) {\r\n                this._captureDocumentClick = {\r\n                    target: document,\r\n\r\n                    onDocumentClick: (event) => {\r\n                        if(!this.element.contains(event.target)) {\r\n                            this.deactivate();\r\n                        }\r\n                    }\r\n                };\r\n\r\n                this._captureDocumentClick.target.addEventListener('click', this._captureDocumentClick.onDocumentClick);\r\n            }\r\n\r\n            // Notify parent that submenu activated.\r\n            if(parent) {\r\n                parent.publish('submenu.activate', this);\r\n            }\r\n\r\n            this.publish('menu.activate');\r\n\r\n            // Dispatch dom events.\r\n            this.element.dispatchEvent(new CustomEvent('menu.activate', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    deactivate() {\r\n        if(this.isActive) {\r\n            console.trace(\"Menu deactivate\");\r\n            // Set flag and remove active classes.\r\n            this.isActive = false;\r\n\r\n            // Clear any active child items.\r\n            this.clearItems();\r\n\r\n            // Remove document click handler that tracks user clicks outside of menu tree.\r\n            if(this._captureDocumentClick) {\r\n                this._captureDocumentClick.target.removeEventListener('click', this._captureDocumentClick.onDocumentClick);\r\n                this._captureDocumentClick = null;\r\n            }\r\n\r\n            // clear timers\r\n            this.clearTimer('timeout');\r\n\r\n            for(let child of this.children) {\r\n                child.clearTimer('activateItem');\r\n            }\r\n\r\n            // Notify parent that submenu deactivated.\r\n            let parent = this.parent;\r\n            if(parent) {\r\n                parent.publish('submenu.deactivate', this);\r\n            }\r\n\r\n            this.publish('menu.deactivate');\r\n\r\n            // Dispatch dom events.\r\n            this.element.dispatchEvent(new CustomEvent('menu.deactivate', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    show() {\r\n        if(!this.isVisible) {\r\n            this.isVisible = true;\r\n\r\n            if(this.parent) this.parent.publish('submenu.shown', this);\r\n            this.publish('menu.shown', this);\r\n\r\n            this.element.dispatchEvent(new CustomEvent('menu.show', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    hide() {\r\n        if(this.isVisible) {\r\n            this.isVisible = false;\r\n\r\n            if(this.parent) this.parent.publish('submenu.hidden', this);\r\n            this.publish('menu.hidden', this);\r\n\r\n            this.element.dispatchEvent(new CustomEvent('menu.hide', {\r\n                detail: this,\r\n                bubbles: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Tree methods.\r\n\r\n    createItems(data) {\r\n        for(let {children, ...args} of data) {\r\n            let item = new this.MenuItemClass(args);\r\n\r\n            if(children && children.length) {\r\n                let submenu = new Menu();\r\n                item.attachSubMenu(submenu);\r\n                submenu.createItems(children);\r\n            }\r\n\r\n            this.append(item);\r\n        }\r\n    }\r\n\r\n    addItem(text, action) {\r\n        let item = new this.MenuItemClass({text, action});\r\n        this.append(item);\r\n        return this;\r\n    }\r\n\r\n    removeItem(item) {\r\n        let index = this._children.indexOf(item);\r\n        if(index !== -1) {\r\n            this._children.splice(index, 1);\r\n            if(item.element.parentElement) item.element.parentElement.removeChild(item.element);\r\n        }\r\n    }\r\n\r\n    hasItem(item) {\r\n        return this._children.indexOf(item) !== -1;\r\n    }\r\n\r\n    append(item) {\r\n        let body = this.getMenuBody();\r\n\r\n        body = body[body.length - 1];\r\n\r\n        if(item.nodeType) {\r\n            body.appendChild(item);\r\n            return this;\r\n        }\r\n\r\n        if(item.parent) {\r\n            item.parent.removeItem(item);\r\n        }\r\n\r\n        item.appendTo(body);\r\n\r\n        if(item.isMenuItem && item.isMenuItem()) {\r\n            item._parent = this;\r\n            this._children.push(item);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    get activeItems() {\r\n        let r = [];\r\n\r\n        for(let item of this.children) {\r\n            if(item.isActive) {\r\n                r.push(item);\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    clearItems() {\r\n        for(let child of this.activeItems) {\r\n            child.deactivate();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns list of all menu bodies for the menu.\r\n     *\r\n     * Menu bodies are where item are appended when using function like addItem or append.  They will be added to the\r\n     * last menu body in the menu.\r\n     *\r\n     * @returns {NodeListOf<HTMLElementTagNameMap[string]> | NodeListOf<Element> | NodeListOf<SVGElementTagNameMap[string]>}\r\n     */\r\n    getMenuBody() {\r\n        return this.element.querySelectorAll(':scope > .menu__body');\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Event Handlers\r\n\r\n    onMouseOver(event) {\r\n        this.clearTimer('timeout');\r\n    }\r\n\r\n    onMouseOut(event) {\r\n        if(!this.element.contains(event.originalEvent.relatedTarget)) {\r\n            if(this.isActive && typeof this.timeout === 'number' && this.timeout >= 0) {\r\n                this.startTimer('timeout', () => {\r\n                    this.deactivate();\r\n                }, this.timeout);\r\n            }\r\n        }\r\n    }\r\n\r\n    onClick(event) {\r\n        if(event.target === this) {\r\n            if(this.isActive && this.toggleOff) {\r\n                this.deactivate();\r\n            } else if(!this.isActive && this.toggleOn) {\r\n                this.activate();\r\n            }\r\n        }\r\n    }\r\n\r\n    onSelect(event) {\r\n        if(this.closeOnSelect && this.isActive) {\r\n            this.deactivate();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Will return true if menu items should toggle on.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get toggleOn() {\r\n        return this.toggle === 'on' || this.toggle === 'both';\r\n    }\r\n\r\n    /**\r\n     * Will return true if menu items should toggle off.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get toggleOff() {\r\n        return this.toggle === 'off' || this.toggle === 'both';\r\n    }\r\n}","import Menu from \"./Menu\";\r\n\r\n\r\nexport default class MenuBar extends Menu {\r\n    constructor({target=null, closeOnBlur=true, timeout=false, autoActivate=false, multiple=false, openOnHover=true,\r\n                    toggle=\"both\", closeOnSelect=true, deactivateOnItemHover=true}={}) {\r\n        super({\r\n            target, closeOnBlur, timeout, autoActivate, multiple, openOnHover,\r\n            toggle, closeOnSelect, deactivateOnItemHover\r\n        });\r\n\r\n        this.isVisible = true;\r\n    }\r\n\r\n    render(context) {\r\n        let element = document.createElement('div');\r\n\r\n        element.className = \"menubar\";\r\n\r\n        return element;\r\n    }\r\n\r\n    getMenuBody() {\r\n        return [this.element];\r\n    }\r\n}\r\n","import MenuNode from \"./MenuNode\";\r\nimport {inherit, publishTargetEvent} from \"./decorators\";\r\n\r\n\r\nexport default class MenuItem extends MenuNode {\r\n    @inherit toggle;\r\n    @inherit autoActivate;\r\n    @inherit openOnHover;\r\n\r\n    constructor({text, action, href=null, target, classes, nodeName=\"div\", ...context}={}) {\r\n        super();\r\n\r\n        if(target) {\r\n            this.element = target;\r\n        } else {\r\n            this.element = this.render({text, nodeName, href, ...context});\r\n        }\r\n\r\n        if(classes) {\r\n            this.addClass(classes);\r\n        }\r\n\r\n        if(action) this.addAction(action);\r\n\r\n        this.toggle = 'inherit';\r\n        this.autoActivate = 'inherit';\r\n        this.openOnHover = 'inherit';\r\n\r\n        this.on('event.click', (event) => this.onClick(event));\r\n        this.on('event.mouseover', (event) => this.onMouseOver(event));\r\n        this.on('event.mouseout', (event) => this.onMouseOut(event));\r\n        this.on('menuitem.selected', (event) => this.onSelect(event));\r\n    }\r\n\r\n    render({text, nodeName=\"div\", href=null}={}) {\r\n        let element = document.createElement(nodeName),\r\n            button = document.createElement('a');\r\n\r\n        element.className = \"menuitem\";\r\n        button.type = \"button\";\r\n        button.innerHTML = text;\r\n        button.className = \"menuitem__button\";\r\n\r\n        if(href) {\r\n            button.href = href;\r\n        }\r\n\r\n        element.appendChild(button);\r\n        return element;\r\n    }\r\n\r\n    activate() {\r\n        if(this.isActive) return;\r\n        this.isActive = true;\r\n\r\n        this.clearTimer('activateItem');\r\n\r\n        if(this.submenu) {\r\n            this.submenu.show();\r\n        }\r\n\r\n        this.publish('activate', this);\r\n\r\n        if(this.parent) {\r\n            this.parent.publish('activate', this);\r\n        }\r\n\r\n        this.element.dispatchEvent(new CustomEvent('menuitem.activate', {\r\n            detail: this,\r\n            bubbles: true\r\n        }));\r\n    }\r\n\r\n    deactivate() {\r\n        if(!this.isActive) return;\r\n        this.isActive = false;\r\n\r\n        if(this.submenu) {\r\n            this.submenu.deactivate();\r\n            this.submenu.hide();\r\n        }\r\n\r\n        this.publish('deactivate', this);\r\n        if(this.parent) this.parent.publish('deactivate', this);\r\n\r\n        this.element.dispatchEvent(new CustomEvent('menuitem.deactivate', {\r\n            detail: this,\r\n            bubbles: true\r\n        }));\r\n    }\r\n\r\n    select() {\r\n        this.publish('selected');\r\n        this.dispatchTopic('menuitem.selected', {target: this});\r\n\r\n        this.element.dispatchEvent(new CustomEvent('menuitem.selected', {\r\n            detail: this,\r\n            bubbles: true\r\n        }));\r\n    }\r\n\r\n    isMenuItem() {\r\n        return true;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Action management\r\n\r\n    addAction(action) {\r\n        if(typeof action === 'string') {\r\n            let fn = () => {\r\n                window.location = action;\r\n            };\r\n\r\n            this.on('selected', fn);\r\n            return fn;\r\n        } else {\r\n            this.on('selected', action);\r\n            return action;\r\n        }\r\n    }\r\n\r\n    removeAction(action) {\r\n        this.off('selected', action);\r\n    }\r\n\r\n    hasAction(action) {\r\n        return this.hasEvent('selected', action);\r\n    }\r\n\r\n    clearActions() {\r\n        this.off('selected');\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Manage submenu\r\n\r\n    attachSubMenu(submenu) {\r\n        if(this.submenu) {\r\n            throw new Error(\"MenuItem can only have one submenu.\");\r\n        }\r\n\r\n        if(submenu.parent) {\r\n            submenu.parent.detachSubMenu();\r\n        }\r\n\r\n        submenu._parent = this;\r\n        this._children = [submenu];\r\n\r\n        if(!submenu.element.parentElement) {\r\n            submenu.appendTo(this.element);\r\n        }\r\n    }\r\n\r\n    detachSubMenu(remove=true) {\r\n        let submenu = this.submenu;\r\n\r\n        if(submenu) {\r\n            this._children = [];\r\n            submenu._parent = null;\r\n            if(remove) submenu.remove();\r\n        }\r\n\r\n        return submenu;\r\n    }\r\n\r\n    hasSubMenu() {\r\n        return !!this.submenu;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Event handlers\r\n\r\n    onSelect(event) {\r\n        if(this.closeOnSelect && this.isActive) {\r\n            this.deactivate();\r\n        }\r\n    }\r\n\r\n    onClick(event) {\r\n        if(this.isDisabled) {\r\n            event.preventDefault();\r\n        }\r\n\r\n        if(event.target !== this) return;\r\n\r\n        if(this.parent) {\r\n            this.parent.publish('click-item', this, event);\r\n        }\r\n\r\n        if(!this.isActive && this.toggleOn) {\r\n            this.activate();\r\n        } else if(this.isActive && this.toggleOff && this.hasSubMenu()) {\r\n            this.deactivate();\r\n        }\r\n\r\n        if(this.isActive && !this.hasSubMenu()) {\r\n            this.select();\r\n        }\r\n    }\r\n\r\n    onMouseOver(event) {\r\n        this.clearTimer('timeout');\r\n        if(this.element.contains(event.originalEvent.relatedTarget)) return;\r\n\r\n        if(event.target === this) {\r\n            // When the mouse moves on an item clear any active items in it's submenu.\r\n            if (this.submenu) {\r\n                this.submenu.clearItems();\r\n            }\r\n\r\n            let activate = this.parent && this.parent.isActive ? this.openOnHover : this.autoActivate;\r\n\r\n            if (this.parent) {\r\n                this.parent.publish('mouse-enter-item', this, event);\r\n            }\r\n\r\n            if (!this.isActive && !this.isDisabled) {\r\n                if (activate === true) {\r\n                    this.activate();\r\n                } else if (typeof activate === 'number' && activate >= 0) {\r\n                    this.startTimer('activateItem', () => {\r\n                        if (!this.isDisabled) {\r\n                            this.activate();\r\n                        }\r\n                    }, activate);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    onMouseOut(event) {\r\n        if(this.element.contains(event.originalEvent.relatedTarget)) return;\r\n\r\n        this.clearTimer('activateItem');\r\n\r\n        if(this.parent) {\r\n            this.parent.publish('mouse-leave-item', this, event);\r\n        }\r\n\r\n        if(!this.hasSubMenu() && this.isActive) {\r\n            this.deactivate();\r\n        }\r\n\r\n        if(this.isActive && typeof this.timeout === 'number' && this.timeout >= 0) {\r\n            this.startTimer('timeout', () => {\r\n                this.deactivate();\r\n            }, this.timeout);\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Getters and Setters\r\n\r\n    /**\r\n     * Will return true if menu items should toggle on.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get toggleOn() {\r\n        return this.toggle === 'on' || this.toggle === 'both';\r\n    }\r\n\r\n    /**\r\n     * Will return true if menu items should toggle off.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    get toggleOff() {\r\n        return this.toggle === 'off' || this.toggle === 'both';\r\n    }\r\n\r\n    get submenu() {\r\n        return this._children[0];\r\n    }\r\n\r\n    set submenu(value) {\r\n        if(!value) {\r\n            this.detachSubMenu();\r\n        } else {\r\n            this.attachSubMenu(value);\r\n        }\r\n    }\r\n}","import Publisher from \"core/Publisher\";\r\nimport {KeyError} from \"core/errors\";\r\nimport {addClasses, removeClasses} from \"core/utility\";\r\n\r\n\r\nexport const MENU_MAP = new WeakMap();\r\n\r\n\r\nexport default class MenuNode extends Publisher {\r\n    constructor() {\r\n        super();\r\n        this._parent = null;\r\n        this._children = [];\r\n        this._props = {};\r\n        this._timers = {};\r\n        /**\r\n         * @type {undefined|null|HTMLElement}\r\n         * @private\r\n         */\r\n        this._element = undefined;\r\n\r\n        this._isActive = false;\r\n        this._isVisible = true;\r\n        this._isDisabled = false;\r\n\r\n        this.nodeType = null;\r\n        this.isController = false;\r\n    }\r\n\r\n    init() {\r\n        if(this.boundEvents) return;\r\n\r\n        this.boundEvents = {};\r\n\r\n        let handleEvent = (event) => {\r\n            let target = this.getTargetNode(event.target);\r\n\r\n            if(target.getEventDelegator() === this) {\r\n                target.dispatchTopic(`event.${event.type}`, {\r\n                    target,\r\n                    originalEvent: event\r\n                });\r\n            }\r\n        };\r\n\r\n        this.boundEvents.onMouseOver = handleEvent;\r\n        this.boundEvents.onMouseOut = handleEvent;\r\n        this.boundEvents.onClick = handleEvent;\r\n\r\n        this.element.addEventListener('click', this.boundEvents.onClick);\r\n        this.element.addEventListener('mouseover', this.boundEvents.onMouseOver);\r\n        this.element.addEventListener('mouseout', this.boundEvents.onMouseOut);\r\n        this.isController = true;\r\n    }\r\n\r\n    destroy() {\r\n        if(this.events && this.hasElement()) {\r\n            this.element.removeEventListener('click', this.boundEvents.onClick);\r\n            this.element.removeEventListener('onMouseOut', this.boundEvents.onMouseOut);\r\n            this.element.removeEventListener('onMouseOver', this.boundEvents.onMouseOver);\r\n        }\r\n\r\n        this.isController = false;\r\n        this.boundEvents = null;\r\n        this.element = null;\r\n    }\r\n\r\n    /**\r\n     * Renders the component.\r\n     */\r\n    render() {\r\n\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Actions\r\n\r\n    /**\r\n     * Returns the parent MenuNode\r\n     * @returns {null|MenuNode}\r\n     */\r\n    get parent() {\r\n        return this._parent || null;\r\n    }\r\n\r\n    /**\r\n     * Returns the root node of the menu tree.\r\n     *\r\n     * @returns {MenuNode}\r\n     */\r\n    get root() {\r\n        let r = this,\r\n            o = this;\r\n\r\n        while(o) {\r\n            o = o.parent;\r\n\r\n            if(o) {\r\n                r = o;\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Returns the closest parent menu.\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get parentMenu() {\r\n        let parent = this.parent;\r\n        return parent.closest(node => node.nodeType === 'menu');\r\n    }\r\n\r\n    /**\r\n     * Returns the closest parent item.\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get parentItem() {\r\n        let parent = this.parent;\r\n        return parent.closest(node => node.nodeType === 'menuitem' || node.nodeType === 'dropdown');\r\n    }\r\n\r\n    /**\r\n     * Returns the next sibling node.\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get nextSibling() {\r\n        return this.getOffsetSibling(1);\r\n    }\r\n\r\n    /**\r\n     * Returns the previous sibling node.\r\n     * @returns {MenuNode|null}\r\n     */\r\n    get previousSibling() {\r\n        return this.getOffsetSibling(-1);\r\n    }\r\n\r\n    get children() {\r\n        return this._children.slice(0);\r\n    }\r\n\r\n    get isActive() {\r\n        return this._isActive;\r\n    }\r\n\r\n    set isActive(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this._isActive) {\r\n            if(value) {\r\n                this.element.classList.add('active');\r\n            } else {\r\n                this.element.classList.remove('active');\r\n            }\r\n\r\n            this._isActive = value;\r\n        }\r\n    }\r\n\r\n    get isDisabled() {\r\n        return this._isDisabled;\r\n    }\r\n\r\n    set isDisabled(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this._isDisabled) {\r\n            if(value) {\r\n                this.element.classList.add('disabled');\r\n            } else {\r\n                this.element.classList.remove('disabled');\r\n            }\r\n\r\n            this._isDisabled = value;\r\n        }\r\n    }\r\n\r\n    get isVisible() {\r\n        return this._isVisible;\r\n    }\r\n\r\n    set isVisible(value) {\r\n        value = !!value;\r\n\r\n        if(value !== this._isVisible) {\r\n            if(value) {\r\n                this.element.classList.remove('hidden');\r\n            } else {\r\n                this.element.classList.add('hidden');\r\n            }\r\n\r\n            this._isVisible = value;\r\n        }\r\n    }\r\n\r\n    hasElement() {\r\n        return !!this._element;\r\n    }\r\n\r\n    get element() {\r\n        if(this._element === undefined) {\r\n            this.element = this.render();\r\n        }\r\n\r\n        return this._element;\r\n    }\r\n\r\n    set element(value) {\r\n        if(this._element) {\r\n            MENU_MAP.delete(this._element);\r\n            this._element = undefined;\r\n        }\r\n\r\n        if(typeof value === 'string') {\r\n            this._element = document.querySelector(value);\r\n            MENU_MAP.set(this._element, this);\r\n        } else if(typeof value === 'function') {\r\n            this._element = value.call(this);\r\n            MENU_MAP.set(this._element, this);\r\n        } else if(value) {\r\n            this._element = value;\r\n            MENU_MAP.set(this._element, this);\r\n        } else {\r\n            this._element = value; // null or undefined\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Return the sibling offset from the current node.\r\n     *\r\n     * @param offset\r\n     * @returns {null|MenuNode}\r\n     */\r\n    getOffsetSibling(offset=1) {\r\n        let parent = this.parent;\r\n\r\n        if(parent) {\r\n            let children = parent.children,\r\n                i = children ? children.indexOf(this) : -1;\r\n\r\n            if(i >= 0) {\r\n                i += offset;\r\n\r\n                if(i >= 0) {\r\n                    return children[i];\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Appends the component to the target selector.\r\n     *\r\n     * @param selector {string|HTMLElement|{append}}\r\n     */\r\n    appendTo(selector) {\r\n        if(typeof selector === 'string') {\r\n            document.querySelector(selector).appendChild(this.element);\r\n        } else if(selector.appendChild) {\r\n            selector.appendChild(this.element);\r\n        } else if(selector.append) {\r\n            selector.append(this.element);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes the component from the dom.\r\n     *\r\n     * @returns {MenuNode}\r\n     */\r\n    remove() {\r\n        if(this.element.parentElement) {\r\n            this.element.parentElement.removeChild(this.element);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Returns the closest MenuNode up the tree that matches the provided test function.\r\n     *\r\n     * @param fn {function(node)}\r\n     * @returns {MenuNode|null}\r\n     */\r\n    closest(fn) {\r\n        let o = this;\r\n\r\n        while(o) {\r\n            if(fn.call(this, o)) return o;\r\n            o = o.parent;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Yields all descendants.\r\n     *\r\n     * @returns {IterableIterator<MenuNode>}\r\n     */\r\n    *getDescendants() {\r\n        for(let child of this.children) {\r\n            yield child;\r\n\r\n            for(let grandchild of child.getDescendants()) {\r\n                yield grandchild;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a timer with the given name.  Only one timer with that name can be active per object.\r\n     * If another timer with the same name is created the previous one will be cleared if `clear` is true.\r\n     * Otherwise if `clear` is false a KeyError with be thrown.  The callback function for the timer is called\r\n     * with the current object as it's `this` and the timer object as it's only parameter following the pattern\r\n     *\r\n     * this::fn(timer);\r\n     *\r\n     * @param name {String} The name of the timer.\r\n     * @param fn {function(timer)} Function to call.\r\n     * @param time {Number} The time to wait.\r\n     * @param interval If true setInterval will be used instead of setTimeout\r\n     * @param clear If true an previous timers of the same name will be canceled before creating a new one.  Otherwise a KeyError will be thrown.\r\n     * @returns {{status, id, cancel, type}}\r\n     */\r\n    startTimer(name, fn, time, interval=false, clear=true) {\r\n        if(clear && this._timers[name]) {\r\n            this._timers[name].cancel();\r\n        } else if(this._timers[name]) {\r\n            throw new KeyError(\"Timer already exists.\");\r\n        }\r\n\r\n        let timer = this._timers[name] = {\r\n            status: 'running',\r\n            id: null,\r\n            cancel: null,\r\n            type: null,\r\n        };\r\n\r\n        if(interval) {\r\n            let id = timer.id = setInterval((timer) => {\r\n                fn.call(this, timer);\r\n            }, time, timer);\r\n\r\n            timer.type = 'interval';\r\n\r\n            timer.cancel = () => {\r\n                if(this._timers[name] === timer) {\r\n                    clearInterval(id);\r\n                    delete this._timers[name];\r\n                    timer.status = 'canceled';\r\n                }\r\n            };\r\n        } else {\r\n            let id = timer.id = setTimeout((timer) => {\r\n                delete this._timers[name];\r\n                timer.status = 'complete';\r\n                fn.call(this, timer);\r\n            }, time, timer);\r\n\r\n            timer.type = 'timeout';\r\n\r\n            timer.cancel = () => {\r\n                if(this._timers[name] === timer) {\r\n                    clearTimeout(id);\r\n                    delete this._timers[name];\r\n                    timer.status = 'canceled';\r\n                }\r\n            };\r\n        }\r\n\r\n        return timer;\r\n    }\r\n\r\n    /**\r\n     * Clears the timer with the given name.\r\n     *\r\n     * @param name\r\n     * @returns {boolean} True if a timer was canceled. False if not timer exists.\r\n     */\r\n    clearTimer(name) {\r\n        if(this._timers[name]) {\r\n            this._timers[name].cancel();\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Returns the timer object if it exists.\r\n     *\r\n     * @param name\r\n     * @returns {*}\r\n     */\r\n    getTimer(name) {\r\n        return this._timers[name];\r\n    }\r\n\r\n    /**\r\n     * Returns the MenuNode that is responsible for delegating the events.\r\n     *\r\n     * @returns {null|{isController}|any}\r\n     */\r\n    getEventDelegator() {\r\n        let o = this.element;\r\n\r\n        while(o) {\r\n            let instance = MENU_MAP.get(o);\r\n\r\n            if(instance && instance.isController) {\r\n                return instance;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    getTargetNode(target) {\r\n        let o = target;\r\n\r\n        while(o) {\r\n            let instance = MENU_MAP.get(o);\r\n\r\n            if(instance) {\r\n                return instance;\r\n            }\r\n\r\n            if(o === this.element) {\r\n                break;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    getTargetItem(target) {\r\n        let o = target;\r\n\r\n        while(o) {\r\n            let instance = MENU_MAP.get(o);\r\n\r\n            if(instance && instance.isMenuItem()) {\r\n                return instance;\r\n            }\r\n\r\n            if(o === this.element) {\r\n                break;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    getTargetMenu(target) {\r\n        let o = target;\r\n\r\n        while(o) {\r\n            let instance = MENU_MAP.get(o);\r\n\r\n            if(instance && instance.isMenu()) {\r\n                return instance;\r\n            }\r\n\r\n            if(o === this.element) {\r\n                break;\r\n            }\r\n\r\n            o = o.parentElement;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    isMenuItem() {\r\n        return false;\r\n    }\r\n\r\n    isMenu() {\r\n        return false;\r\n    }\r\n\r\n    dispatchTopic(topic, ...args) {\r\n        let o = this;\r\n\r\n        while(o) {\r\n            o.publish(topic, ...args);\r\n            o = o.parent;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    //------------------------------------------------------------------------------------------------------------------\r\n    // Getters and Setters\r\n\r\n    get id() {\r\n        return this.element.id;\r\n    }\r\n\r\n    set id(id) {\r\n        if(this.element) this.element.id = id;\r\n    }\r\n\r\n    get classList() {\r\n        return this.element.classList;\r\n    }\r\n\r\n    get dataset() {\r\n        return this.element.dataset;\r\n    }\r\n\r\n    get style() {\r\n        return this.element.style;\r\n    }\r\n\r\n    set style(style) {\r\n        this.element.style = style;\r\n    }\r\n\r\n    addClass(classes) {\r\n        return addClasses(this.element, classes);\r\n    }\r\n\r\n    removeClass(classes) {\r\n        return removeClasses(this.element, classes);\r\n    }\r\n\r\n    static getInstance(element) {\r\n        return MENU_MAP.get(element);\r\n    }\r\n}","/**\r\n * Decorates a property so that it can take special keywords to inherit it's value up the parent tree.\r\n *\r\n * If it's value is \"inherit\" or \"root\" special actions are taken.\r\n *\r\n * On \"inherit\" the getter will use this.parent[key] as it's value or return undefined.\r\n * On \"root\" the getter will use this.root[key] as it's value or return undefined.\r\n *\r\n * If the value is anything else is behaves like normal.\r\n *\r\n * Usage:\r\n *  @inherit myField = <default value>;\r\n *\r\n * @param target\r\n * @returns {{kind: string, placement: string, descriptor: {set(*): void, enumerable: boolean, get(): (*|*), configurable: boolean}, key: *}|undefined|*}\r\n */\r\nexport function inherit(target) {\r\n    let key = target.key,\r\n        initializer = target.initializer || function() { return undefined };\r\n\r\n    return {\r\n        kind: 'method',\r\n        placement: 'prototype',\r\n        key: target.key,\r\n        descriptor: {\r\n            configurable: true,\r\n            enumerable: false,\r\n\r\n            get() {\r\n                let value = this._props[key];\r\n                if(value === undefined) value = initializer();  // todo set to init\r\n\r\n                if(value === 'inherit') {\r\n                    return this.parent ? this.parent[key] : undefined;\r\n                } else if(value === 'root') {\r\n                    let root = this.root;\r\n                    return root ? root[key] : undefined;\r\n                } else {\r\n                    return value;\r\n                }\r\n            },\r\n\r\n            set(value) {\r\n                this._props[key] = value;\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\n\r\nexport function publishTargetEvent(topic, bubble=false) {\r\n    return function(descriptor) {\r\n        let {value, ...desc} = descriptor.descriptor;\r\n\r\n        function wrapper(event) {\r\n            if(this.getTargetNode(event.target) === this) {\r\n                if(bubble) {\r\n                    this.dispatchTopic(topic, this, event);\r\n                } else {\r\n                    this.publish(topic, this, event);\r\n                }\r\n\r\n                return value.call(this, event);\r\n            }\r\n        }\r\n\r\n        return {\r\n            placement: descriptor.placement,\r\n            key: descriptor.key,\r\n            kind: descriptor.kind,\r\n            descriptor: {\r\n                value: wrapper,\r\n                ...desc\r\n            }\r\n        };\r\n    };\r\n}"],"sourceRoot":""}